        <!DOCTYPE html>
        <html lang="en">
        <head><title>FBAC-LSM [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/369609/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/368942/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/369609/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>FBAC-LSM</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Did you know...?</b>
<p>
LWN.net is a subscriber-supported publication; we rely on subscribers
       to keep the entire operation going.  Please help out by <a
       href="/Promo/nst-nag4/subscribe">buying a subscription</a> and keeping LWN on the
       net.
</blockquote>
<div class="FeatureByline">
           By <b>Jake Edge</b><br>January 13, 2010</br>
           </div>
<p>
Process sandboxes for security are getting lots of attention these days.
There are standalone utilities like <a
href="http://lwn.net/Articles/368690/">isolate</a> and <a
href="http://wiki.laptop.org/go/Rainbow">Rainbow</a>, sandboxes integrated
into applications like the <a
href="http://lwn.net/Articles/347547/">Chromium sandbox</a>, as well as tools that
use existing LSMs such as the <a
href="http://danwalsh.livejournal.com/28545.html">SELinux sandbox</a>.
Furthermore, 
there are various proposals floating around to add Linux kernel features in
support of application sandboxes, such as the <a
href="http://lwn.net/Articles/332974/">seccomp additions</a> and <a
href="http://lwn.net/Articles/368730/">network restrictions</a>.  An LSM
specifically designed for application sandboxing, which uses
a new model called Functionality-Based Application
Confinement (FBAC), was <a
href="http://lwn.net/Articles/366468/">introduced</a> on linux-kernel back
in December. 
</p>

<p>
<a href="http://schreuders.org/FBAC-LSM">FBAC-LSM</a> came out of Z. Cliffe
Schreuders's PhD research, and is a 
prototype implementation of the FBAC model.  It uses an earlier version of
the LSM interface, with the AppArmor pathname-based hooks and still needs "<q>quite a bit of work to be done before it is ready for production systems or
formal code review.</q>"  Schreuders is looking for collaborators to
work on completing the project, presumably with an eye towards getting it
into the mainline.
</p>

<p>
The basic idea behind FBAC is to make security policy more accessible and
understandable to users, so that application restrictions are more widely
adopted.  A major component of the FBAC system is a GUI-based policy
manager that can guide users through setting policies for particular
applications.  Users specify the high-level needs of an application based
on its type (such as web browser or file editor) and the policy manager
will help create the policies that will govern its behavior.

<p>
In developing the policy manager, Schreuders analyzed over a hundred
different applications to extract common behaviors that could be
encapsulated in the FBAC policies.  This allows the policy manager to
automate certain aspects of developing policies for new applications,
including things like configuration files, network ports, and other
resources that the application requires.
The policy manager also has a "learning mode" where it can observe the
application and suggest additional privileges that might be granted.

<p>
FBAC has the underlying concept of "functionalities", which are essentially
a set of permissions for file and network operations that are allowed.
These are fine-grained permissions for things like "file_read",
"file_getattr", "file_execute", "dir_mkdir", "network_incoming", etc.
The permissions which are granted to a particular functionality are listed
in its definition.


<p>
Functionalities are hierarchical, so that they can incorporate other,
lower-level permissions into one that governs an entire application or
class of applications.  In addition, they are parameterized so that a
functionality can be applied to multiple different applications, with the
parameters specifying the particular files, directories, and network
destinations that the permissions are granted for. 
</p>

<p>
Both mandatory access control (MAC) and discretionary access control (DAC)
are supported by FBAC.  Application policy can be permanently set by an
administrator, so that an ordinary user cannot make changes, or FBAC can
be configured to allow users to further restrict applications beyond the
policies set by the administrator.  The confinement of an application then
depends on the intersection of these mandatory and discretionary policies.

<p>
Allowing users to specify reduced privileges for arbitrary applications
risks running afoul of the problems with <tt>setuid()</tt> programs that
other sandboxing mechanisms (the network restrictions feature mentioned
above for example) have encountered.  Some means of stopping unprivileged
users from changing the environment expected by <tt>setuid()</tt> programs
will need to be provided.
</p>

<p>
The interface to FBAC-LSM is via a filesystem which is mounted at
<tt>/sys/kernel/security/fbac-lsm</tt>.  Various files in the directory
allow querying the existing installed policies as well as adding new ones.
There are several steps to sending the policy information, with each piece
being written to a separate file in the directory.  That is followed by 
"commit" 
being written to <tt>/sys/kernel/security/fbac-lsm/commit</tt>, which
actually causes the policy to be processed.  That is rather race-prone, but
is required by the <tt>sysfs</tt> "one value per file" rule. It seems
likely that FBAC-LSM will eventually change its interface to a 
private filesystem like those used by
Smack and SELinux.
</p>

<p>
FBAC is a different approach from that taken by other security solutions, but
it has enough similarities that Schreuders has plans to make the policy
manager read and write AppArmor and <a
href="http://seedit.sourceforge.net/">SEEdit</a> policies.  But FBAC
definitely 
lives up to its prototype billing.  The code is rather disorganized and
littered with commented-out sections that make it somewhat hard to follow. 
</p>

<p>
The current incarnation of FBAC-LSM certainly has the feel of code that was
put together somewhat hurriedly for a PhD dissertation, rather than as a "real" LSM.  But it
does embody some interesting ideas that merit further attention.  One of
the biggest hurdles faced by various security solutions (for which SELinux
is the poster child) is the complexity of developing and&mdash;more
importantly&mdash;understanding the policies that are being used.  That
complexity is something that Schreuders set out to reduce with FBAC.  It
remains to be seen if he has succeeded with that, but any such attempt is
worthy of a look.
</p><br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Security-Security_modules">Security/Security modules</a></td></tr>
            <tr><td><a href="/Security/Index/">Security</a></td><td><a href="/Security/Index/#Linux_Security_Modules_LSM">Linux Security Modules (LSM)</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/369609/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor369781"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">FBAC-LSM</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jan 14, 2010 10:44 UTC (Thu)
                               by <b>cliffe</b> (guest, #62958)
                              [<a href="/Articles/369781/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Thanks for the well educated write-up. <br>
<p>
I agree, the code is a bit of a mess in places, particularly the vfs interface you accurately described. Thanks for persevering! I am in the process of cleaning up code, and yes there is lots of work to be done. As you mentioned, I am looking for contributors to help make FBAC-LSM a production ready system. So if anyone is interested please let me know. <br>
<p>
As part of my research I conducted a usability study which compared FBAC-LSM with AppArmor and SELinux. The results were encouraging! Adding (reduced feature) export to FBAC-LSM should provide some of the usability benefits of FBAC-LSM to these systems. Users can then benefit from the stability of the other systems while FBAC-LSM continues to be improved. FBAC-LSM policy manager may even be extended to completely manage other LSMs such as AppArmor.<br>
<p>
Allowing users to restrict the applications they run lets them protect their own security interests: such as controlling which applications have access to particular files they own. It can cause problems if programs assume they have more privileges than they have. In most cases it is the responsibility of the software developers to check that their assumptions are valid and that the program has access to the resources they expect access to. Most of the applications I have studied so far have fairly predictable needs, and are well modelled by FBAC functionalities. You bring up an interesting point, that the security goals of an administrator might actually require the granting of privileges to a program that a normal user runs, and that allowing a normal user to take these privileges away could present problems. I think that in most cases it is in the best interests of users to grant setuid programs the resources they require. If preventing access to resources causes the programs to misbehave in an insecure fashion, then perhaps the programs need to be updated. Having said that, it would not be hard to extend FBAC to allow administrators to specify which applications users are allowed to create policies for. I would be interested in further justifications for this.<br>
<p>
Z. Cliffe Schreuders<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/369781/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor373185"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">FBAC-LSM</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 5, 2010 20:09 UTC (Fri)
                               by <b>oak</b> (guest, #2786)
                              [<a href="/Articles/373185/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Couldn't running of setuid programs be just disabled when security <br>
policies are in effect?<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/373185/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor369799"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">FBAC-LSM</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jan 14, 2010 12:40 UTC (Thu)
                               by <b>Trou.fr</b> (subscriber, #26289)
                              [<a href="/Articles/369799/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I really think Linux should have a mainline sandbox that can be used easily by non-root users to confine untrusted or exposed applications easily.<br>
<p>
Since now the main threat for a desktop system is the browser/mail client, it makes no sense to run it with the same priviledges as the logged in user, where it can effectively access all the critical data.<br>
<p>
Windows malwares have been doing ransom blackmail : pay me to decrypt your important files I have found on your hard drive. Microsoft did make the good choice with the lower privilege mode introducted with IE7 in Vista.<br>
<p>
Actually the chromium sandbox seems great, i would need a standalone version, maybe Google could release it separately.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/369799/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor369838"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Links</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jan 14, 2010 17:01 UTC (Thu)
                               by <b>mstone</b> (subscriber, #58824)
                              [<a href="/Articles/369838/">Link</a>] 
      </p>
      
      </div>
      </summary>
      Trou.fr wrote: 
<blockquote>I really think Linux should have a mainline sandbox that can be used easily by non-root users to confine untrusted or exposed applications easily.</blockquote>

You don't seem to be alone in this opinion: <a href="http://sandboxing.org">sandboxing.org</a> catalogues the work of several tens of people who feel the same way and who are looking for ideas and help on making their work more accessible. Start some conversations with them!
      
          <div class="CommentReplyButton">
            <form action="/Articles/369838/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor369964"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">FBAC-LSM</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jan 15, 2010 16:00 UTC (Fri)
                               by <b>SEJeff</b> (guest, #51588)
                              [<a href="/Articles/369964/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You need to look into lxc, it isn't technically a sandbox, but not far from <br>
it. It is closer to a solaris zone than anything else.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/369964/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2010, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
