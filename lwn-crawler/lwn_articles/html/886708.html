        <!DOCTYPE html>
        <html lang="en">
        <head><title>When and why to deprecate filesystems [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/886708/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/886686/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/886708/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>When and why to deprecate filesystems</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>LWN.net needs you!</b>
<p>
Without subscribers, LWN would simply not exist.  Please consider
       <a href="/Promo/nst-nag2/subscribe">signing up for a subscription</a> and helping
       to keep LWN publishing.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>March 7, 2022</br>
           </div>
It is a good bet that a significant amount of code in the kernel is
entirely unused.  Even so, that code must still be maintained and shipped,
posing an ongoing cost to the development community.  What should be done
with code that is unmaintained and, possibly, unused?  Answering that
question requires understanding which users still exist, if any, and taking
a hard look at what the future support requirements for that code will be.
The kernel community has recently discussed this problem in the context of
filesystems, and the Reiserfs filesystem in particular, with a focus on <a
href="/Articles/599580/">the approaching 2038 deadline</a>.

<p>
Removing support for old hardware is difficult enough, but there does often
come a point where it becomes possible.  If a particular device has been
unavailable for years and nobody can point to one in operation, it may be
time to remove the support from the kernel.  Another strong sign is a
complete lack of maintainer interest; that led to the recent <a
href="/ml/linux-mm/CAK8P3a0pr9_gHOieWf_gd4sFx7Z+urp420hMOBH+Hp5s-3-76g@mail.gmail.com/">decision</a>
to remove support for the NDS architecture, for example.  Filesystems can
be harder, though; they are independent of the hardware and can thus live
far longer than any particular device type.  Users can hold onto a familiar
filesystem type for a long time after most of the world has moved on.

<p>
Reiserfs is certainly a case in point; this filesystem was first <a
href="/1999/1111/kernel.php3">covered in LWN</a> in 1999; it found its way
into the 2.4.1 kernel the next year despite <a
href="/2000/0608/kernel.php3">a fair amount of opposition</a> based on the
allegedly stable nature of 2.4 releases.  There were a number of reasons
for the inclusion of Reiserfs; chief among them, perhaps, was that it was
the first Linux filesystem to support journaling.  This filesystem
attracted a fair amount of interest in its early days and some
distributions adopted it as the default choice, but its own
developers quickly moved on to other things; by 2004, Hans Reiser was <a
href="/Articles/82480/">arguing against</a> enhancing Reiserfs, saying
instead that his new Reiser4 filesystem should be adopted instead.  In the
end, Reiser4 was never merged, but Reiserfs lives on in the kernel.
<p>
Recently, Matthew Wilcox <a
href="/ml/linux-kernel/YhIwUEpymVzmytdp@casper.infradead.org/">observed</a>
that maintenance of Reiserfs appears to have stopped.  So he naturally
wondered if there were still any active Reiserfs users, or whether perhaps
the filesystem could be removed.  Keeping it around has costs associated
with it, after all, and it is getting in the way of some enhancements he
would like to make.
<p>
As noted above, there is not normally a natural point where kernel
developers can conclude that there is no value in keeping a filesystem
implementation in the kernel.  Reiserfs still works for any users still
running it, and they 
would be within their rights to see its removal as causing just the sort of
regression that the kernel community so loudly disallows.  So the best that
can usually be done is to place a prominent deprecation warning in the
kernel itself and wait a few years; if opposition to the removal does not
materialize during that time, it is probably safe to do.  <a
href="/ml/linux-fsdevel/20220225125445.29942-1-jack@suse.cz/">A patch
adding that deprecation</a> has been posted and seems likely to be merged
for the 5.18 kernel release.
<p>
During the discussion, Byron Stanoszek did <a
href="/ml/linux-kernel/3ce45c23-2721-af6e-6cd7-648dc399597@winds.org/">surface</a>
to confess his ongoing use of Reiserfs and desire to see it supported for a
bit longer.  Jan Kara <a
href="/ml/linux-kernel/20220224084636.tdobyxoql5xtxkx7@quack3.lan/">responded</a>
by noting the limited nature of the support Reiserfs gets now:
<p>
<blockquote class="bq">
	Frankly the reality of reiserfs is that it gets practically no
	development time and little testing. Now this would not be a big
	problem on its own because what used to work should keep working
	but the rest of the common filesystem infrastructure keeps moving
	(e.g. with Matthew's page cache changes, new mount API, ...) and so
	it can happen that with a lack of testing &amp; development reiserfs
	will break without us noticing. So I would not consider reiserfs a
	particularly safe choice these days and rather consider migration
	to some other filesystem.
</blockquote>
<p>
Kara did offer to extend the deprecation period for Reiserfs, though, if it
were really necessary.
<p>
As it happens, Stanoszek raised an issue that plays into the timing of the
deprecation of Reiserfs, and highlights one of the issues associated with
deprecation in general.  Even the most dedicated users of Reiserfs will
eventually find themselves wanting to move on because that filesystem has a
year-2038 problem.  In January of that
year, the timestamps used within Reiserfs will overflow, leading to overall
confusion.  Since these timestamps are buried deeply within the on-disk
filesystem format, they can't be fixed with a simple code tweak.
Evacuating any data from Reiserfs filesystems before then seems
like a prudent thing to do.
<p>
This might not seem like an urgent problem, since the deadline is over
15&nbsp;years away.  But there are reasons to take action now, which is why
Dave Chinner <a
href="/ml/linux-kernel/20220222221614.GC3061737@dread.disaster.area/">asserted</a>
that the time had come to deprecate all filesystems that are not
2038-ready.  He later <a
href="/ml/linux-kernel/20220225225600.GO3061737@dread.disaster.area/">explained</a>
in more detail:
<P>
<blockquote class="bq">
	With that in mind, this is why we've already deprecated non-y2038k
	compliant functionality in XFS so that enterprise kernels can mark
	it deprecated in their next major (N + 1) release which will be
	supported for 10 years. They can then remove that support it in the
	N+2 major release after that (which is probably at least 5 years
	down the track) so that the support window for non-compliant
	functionality does not run past y2038k.
</blockquote>
<p>
The point is that deprecating a filesystem in the mainline kernel does not
change the fact that it was included in recent long-term-support kernels.
The 5.15 kernel will, if past patterns hold, be supported until 2028; it
will have Reiserfs in it that whole time.  As Wilcox <a
href="/ml/linux-kernel/YhfzUc8afuoQkx/U@casper.infradead.org/">pointed
out</a>, that serves as a sort of lifeline for users who cannot move away
from the filesystem immediately, which may be a good thing.  But it also
poses an ongoing problem for developers charged with maintaining those kernels.
<p>
That is because supporting deprecated code in a long-term-stable kernel will be
increasingly difficult.  Ted Ts'o <a
href="/ml/linux-kernel/YhltiUy/WtA0Dz5g@mit.edu/">noted</a> that
maintainers of stable kernels will not be able to rely on upstream for
fixes anymore, 
and any fixes that are made may not propagate to all kernels due to the
lack of a central location for them.  So doing high-quality maintenance of
Reiserfs for six years, after it has been removed from the mainline, will
be a challenge.  Any enterprise kernels based on that stable release
may include Reiserfs for longer than that.  Enterprise distributors
have to think in terms of supporting current kernel features for as long
as 15&nbsp;years; if they want to avoid the additional challenge of
supporting year-2038-incapable
filesystems after that date, the deprecation process needs to start now.
<p>
The implication is that we are likely to see other filesystem deprecations
before too long.  The NFSv3 protocol, for example, uses 32-bit time values
and will break in 2038.  The ext3 filesystem has similar problems; in this
case, the data can be read as an ext4 filesystem, but the on-disk format
simply cannot represent times correctly.  So, like the XFSv4 on-disk
format, which is also not year-2038 capable, ext3 needs to be migrated away
from.
<p>
These deprecations will likely cause some unhappiness among users who have
stuck with a working solution for years; switching to a new filesystem type
can make people nervous.  But the alternative is worse.  Year 2038 provides
a nice (and legitimate) excuse for developers to remove some old and
unloved filesystems a bit more quickly than they might otherwise be able
to.  Once that passes, deciding when old filesystems should go will, once
again, be a more difficult problem.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Filesystems-Deprecation_policy">Filesystems/Deprecation policy</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/886708/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor887079"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 7, 2022 17:32 UTC (Mon)
                               by <b>post-factum</b> (subscriber, #53836)
                              [<a href="/Articles/887079/">Link</a>] (26 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
BTW, does anyone still use JFS?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887079/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887084"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 7, 2022 18:36 UTC (Mon)
                               by <b>linuxrocks123</b> (guest, #34648)
                              [<a href="/Articles/887084/">Link</a>] (23 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yes.  I&#x27;m using it on a MythTV system since I read somewhere it&#x27;s supposedly good for lots of very large files.<br>
<p>
I don&#x27;t use it on my newer MythTV systems since I later discovered that ext4-without-journal works fine for MythTV.  ext4-without-journal is my goto filesystem for everything now, although I really wish ext4 would get COW support.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887084/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887086"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 7, 2022 19:15 UTC (Mon)
                               by <b>calumapplepie</b> (guest, #143655)
                              [<a href="/Articles/887086/">Link</a>] (21 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think it&#x27;s highly unlikely that anyone will add COW to the EXT filesystems.<br>
These days, the EXT filesystem is the &#x27;ol reliable&#x27; of linux filesystems.  It&#x27;s stable, easy to recover from crashes, simple enough in structure, and an excellent compromise between keeping data local and spreading things out.  It&#x27;s very low overhead: at the end of the day, you just find the block and change it.  COW, even just of individual files rather than all metadata, requires a lot of additional work for every operation.  For instance, deleting a file doesn&#x27;t just mean removing the extents, but it also means checking other files to see if they&#x27;re using those extents rather than just marking them as free.  You also lose the nice, low-fragmentation behavior on hard disks where seeking is costly: file blocks stop tending to be in nice ordered segments, and start tending to be chaotically placed across the disk.  These aren&#x27;t properties you want in a filesystem that is trying its very best to be as stable, reliable, lightweight, and boring as it can be.<br>
<p>
Ext4 is so reliable that even if the first 600 MB of your workhorse laptop&#x27;s disk are overwritten with, say, the Debian Testing installation ISO because you wrote of=/dev/sda instead of of=/dev/sdb, you can recover almost all your data and have a fully functional system again with a bit of effort, some abuse of fsck, and a bit of quality time with debsums.  I don&#x27;t think I can say the same about BTRFS, though I can&#x27;t say I&#x27;ve tested that theory.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887086/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887099"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 7, 2022 21:01 UTC (Mon)
                               by <b>Paf</b> (subscriber, #91811)
                              [<a href="/Articles/887099/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
&quot;but it also means checking other files to see if they&#x27;re using those extents rather than just marking them as free.&quot;<br>
<p>
No, it means checking the extent reference count, no need to know who&#x27;s using it.  It&#x27;s not expensive.  The other reasons you gave are real downsides, though.<br>
<p>
But I do agree that EXT4 is not going to suddenly become a COW file system.  For one thing, a COW file system is a different design point that is very far from globally superior to an extent based file system.  It is different, with advantages and disadvantages.<br>
<p>
It could *conceivably* gain some limited COW capabilities like I believe XFS has, where it can be done optionally for specific files.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887099/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887126"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 6:16 UTC (Tue)
                               by <b>linuxrocks123</b> (guest, #34648)
                              [<a href="/Articles/887126/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The XFS thing is what I&#x27;m hoping to have eventually.  I want just enough COW to be able to do cp --reflink=always and run rmlint.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887126/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor888010"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 16, 2022 3:14 UTC (Wed)
                               by <b>nevyn</b> (guest, #33129)
                              [<a href="/Articles/888010/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Probably want to explicitly ask for reflink support, as the COW bits are implied and has some chance of being done.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/888010/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor888586"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 20, 2022 6:50 UTC (Sun)
                               by <b>oldtomas</b> (guest, #72579)
                              [<a href="/Articles/888586/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
&quot;No, it means checking the extent reference count&quot;<br>
<p>
Yes, but. If you look at the garbage collector community you soon realize that /maintaining/ those refcounts is expensive. It means one write access for each change in refcount.<br>
<p>
That&#x27;s why when GC performance starts to matter, most drop the first (naive) refcount implementation.<br>
<p>
For file systems things won&#x27;t be that different.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/888586/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor887105"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 7, 2022 22:08 UTC (Mon)
                               by <b>amarao</b> (subscriber, #87073)
                              [<a href="/Articles/887105/">Link</a>] (16 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
We&#x27;ve used btrfs on jbod for this exact reason. If we loose one (not the first) drive, btrfs can recover data from other drives without dark magic. Just mount and copy.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887105/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887125"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 6:03 UTC (Tue)
                               by <b>calumapplepie</b> (guest, #143655)
                              [<a href="/Articles/887125/">Link</a>] (14 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Well, I followed the rigorous backup protocol of &quot;nah, I don&#x27;t need that&quot;.  Unfortunately, I have not learned my lesson.<br>
<p>
Also, I object to the implication that any dark magic was required.  Magic, yes: but I didn&#x27;t need anything too dark and evil.  Of course, it would&#x27;ve been nice to know that BEFORE I sacrificed those lambs.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887125/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887141"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 12:29 UTC (Tue)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/887141/">Link</a>] (13 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Well, I learnt the lesson when I installed a new program-in-testing, and it killed my integritysetup.service. All three disks of my raid-5 failed to appear. Cue panic stations.<br>
<p>
So I now have an 8TB backup drive. I&#x27;ve still to automate backups with systemd timers, but as I run ext4 over lvm (over raid over dm-integrity for my live system) over spinning rust, I just take lvm snapshots as my first stage backup, followed by rsync --in-place to lvm snapshots of my backups.<br>
<p>
Just buy the biggest, cheapest (and yes SMR is fine for this) drive you can get your hands on, and set up rsync backups.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887141/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887142"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 13:01 UTC (Tue)
                               by <b>geert</b> (subscriber, #98403)
                              [<a href="/Articles/887142/">Link</a>] (12 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Using rsync to a single backup drive is not a real backup solution.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887142/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887187"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 15:34 UTC (Tue)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/887187/">Link</a>] (11 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It&#x27;s a lot better than having only one copy of the data (or all copies on the same drive).<br>
<p>
Yes I ought to think about having multiple backups, but one backup is a major advance on none.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887187/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887188"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 16:04 UTC (Tue)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/887188/">Link</a>] (10 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Nothing that is not automated is a real backup solution either. At the *very least* you need a backup and an offsite backup that&#x27;s being kept up to date (and an offsite backup that&#x27;s actually offsite and disconnected, and the two swapped occasionally). Without that, one electrical storm and you might well lose everything, all at once.<br>
<p>
Personally I&#x27;d be lost without historical backups as well -- ever so often I find I need something &quot;as it was before Sep 15 last year&quot; or something like that, and with proper backups you can get that sort of thing in minutes. This is not even hard. All the tools exist: all you need is a bit of scripting and a cronjob.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887188/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887194"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 16:54 UTC (Tue)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/887194/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Offsite? Where? :-) For a home system that could be a problem (unless I put a bare drive in the garage...)<br>
<p>
As for historical, that&#x27;s why I use lvm. Take a snapshot, do the inplace rsync, and I get a full backup for the price of an incremental.<br>
<p>
I don&#x27;t plan to clean out my incrementals, unless I&#x27;m running short of disk space.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887194/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887201"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 17:11 UTC (Tue)
                               by <b>rgmoore</b> (<b>&#x272D; supporter &#x272D;</b>, #75)
                              [<a href="/Articles/887201/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>Offsite? Where? :-) For a home system that could be a problem (unless I put a bare drive in the garage...)</blockquote>

<p>If you're limiting yourself to critical files- or if you're willing to spend more- you could back up to the cloud.  It's definitely offsite, and it has its own layers of protection.  If you're serious, you'd want some solution that would let you encrypt your files locally, so anyone who gets a copy of your cloud files won't be able to read all your secrets.  Of course you probably want that for any off-site backup.


      
          <div class="CommentReplyButton">
            <form action="/Articles/887201/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887203"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 17:21 UTC (Tue)
                               by <b>geert</b> (subscriber, #98403)
                              [<a href="/Articles/887203/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yep, dropping off at relatives LUKS-encrypted USB hard drives containing Amanda vtapes.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887203/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887208"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 17:36 UTC (Tue)
                               by <b>rgmoore</b> (<b>&#x272D; supporter &#x272D;</b>, #75)
                              [<a href="/Articles/887208/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>I keep an off-site backup in a locked desk drawer at work, but I still keep that encrypted.  Transparent encryption is easy enough that it's silly not to use it on any USB hard drive whose contents you care at all about keeping secret.


      
          <div class="CommentReplyButton">
            <form action="/Articles/887208/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor887211"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 18:16 UTC (Tue)
                               by <b>smurf</b> (subscriber, #17840)
                              [<a href="/Articles/887211/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You can do the same thing with btrfs snapshots. Way faster than rsync because it doesn&#x27;t have to scan a complete hierarchy only to discover that nothing has changed.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887211/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887238"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 23:10 UTC (Tue)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/887238/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
???<br>
<p>
How does btrfs snapshot magic everything onto a different hard drive?<br>
<p>
And to the best of my knowledge, btrfs raid-5 is still in experimental eat-your-data status ...<br>
<p>
I use lvm on my live raid-5 array to take live snapshots, and lvm/rsync on my backup drive to take full/incremental backups.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887238/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887251"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 9, 2022 6:08 UTC (Wed)
                               by <b>calumapplepie</b> (guest, #143655)
                              [<a href="/Articles/887251/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<a href="https://btrfs.wiki.kernel.org/index.php/Incremental_Backup">https://btrfs.wiki.kernel.org/index.php/Incremental_Backup</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887251/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor887408"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 10, 2022 2:31 UTC (Thu)
                               by <b>bartoc</b> (guest, #124262)
                              [<a href="/Articles/887408/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
btrfs raid5 is arguably less &quot;eat your data&quot; than lvm raid5, since it does actually checksum and can, in fact, detect when drives are doing bogus stuff. You need to be quite careful with scrubbing regularly (and per drive) and with what you do if you need to rebuild the array. I don&#x27;t really recommend running raid5/6 in any system using SATA drives, they are too willing to lie to you and try and cover up impending failures.<br>
<p>
Tbh ZFS&#x27; raid5 also leaves something to be desired since it avoids the write hole by doing things that can have pretty bad performance consequences down the line (esp with how unwilling ZFS is to muck around with stuff on disk, in general). I&#x27;m hoping bcachefs&#x27; approach pays off (it does raid5 by initially writing the data in raid10 (or at least mirrored), committing that, then later rewriting that mirror to raid5 and atomically updating the filesystem metadata once it&#x27;s done.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887408/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887816"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 14, 2022 15:10 UTC (Mon)
                               by <b>hkario</b> (subscriber, #94864)
                              [<a href="/Articles/887816/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
btrfs raid5 is still marked as experimental, while yes, HDDs lying about their ability to read valid data is an issue, that can be fixed by placing dm-integrtiy below MD-raid and then RAID-5 works fine<br>
<p>
also, HDDs lying about bad sectors is not only a RAID-5 issue, it&#x27;s just as likely to impact RAID-1 setups<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887816/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor887339"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 9, 2022 21:27 UTC (Wed)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/887339/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Offsite? Where? :-) For a home system that could be a problem (unless I put a bare drive in the garage...)</font><br>
<p>
You give a drive to a friend you see sometimes and swap it. (I do this with several friends and relatives living at different distances from me.)<br>
<p>
You really don&#x27;t want to use lvm snapshots to do long-term historical backups: IIRC, writes slow down proportional to the number of snapshots in place. For comparison and to see what you can do with an actual automated backup system, I have 9103 backup snapshots currently accessible in my onsite backup (mostly once-every-three-hourly backups of /home). Most of the backups took under a minute to run (and, obviously, happened with no human intervention at all). LVM would grind completely to a halt long before you reached *that* sort of scale.<br>
<p>
<font class="QuotedText">&gt; I don&#x27;t plan to clean out my incrementals, unless I&#x27;m running short of disk space.</font><br>
<p>
Quite so -- and since bup uses rsync-style deduplication and also compresses the backups, that&#x27;s going to be a long time.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887339/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor887128"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 7:42 UTC (Tue)
                               by <b>ibukanov</b> (guest, #3942)
                              [<a href="/Articles/887128/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
For me the biggest attraction of BTRFS is that it check-sums everything. So checking for validity of all data is just one command that runs close to max read speed of the drive. I periodically run it and if the errors will be reported I will restore data from the backup.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887128/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor887231"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 22:20 UTC (Tue)
                               by <b>clump</b> (subscriber, #27801)
                              [<a href="/Articles/887231/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There used to be the &quot;ext3cow&quot; project. I absolutely think the ext* filesystems should keep progressing. Of course ext4 is still being developed, but why not create an ext5 with features like COW?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887231/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor887123"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 4:07 UTC (Tue)
                               by <b>kschendel</b> (subscriber, #20465)
                              [<a href="/Articles/887123/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
JFS, there&#x27;s a name from the past.  A database company I worked for in the late 2000&#x27;s ended up using JFS because it worked well with the larger files and rather weird / slow disk array hardware that was being used.<br>
<p>
As I recall, JFS&#x27;s achilles heel (or, one of them) was that it was horrible at allocating blocks to growing files when there was a lot of concurrent writing / allocating.  I worked up a patch set that made the allocation a lot better under those conditions, but we ran into sporadic rare corruption errors.  We were trying to figure out whether they were hardware or my patch set, when the company was bought out ...<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887123/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor888449"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 18, 2022 19:50 UTC (Fri)
                               by <b>cypherpunks2</b> (guest, #152408)
                              [<a href="/Articles/888449/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I&#x27;ve used JFS for a production system recently due to its very low memory overhead. It&#x27;s a nice filesystem.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/888449/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor887085"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 7, 2022 18:48 UTC (Mon)
                               by <b>error27</b> (subscriber, #8346)
                              [<a href="/Articles/887085/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think it was Eric Biederman who proposed that some file systems should only compile under User Mode Linux.  That&#x27;s config which let&#x27;s you create an executable kernel which you can boot with ./linux.  Then you would mount the image from the UML kernel and export it over NFS or whatever to the real kernel.<br>
<p>
The advantage is if the UML kernel crashes, that&#x27;s just an application.  It doesn&#x27;t take down your whole system.  The disadvantage is that it would be slower but if it&#x27;s a USB disk, then it&#x27;s not going to be fast in the first place.  We would only do this for less used and less trusted filesystems.<br>
<p>
It wouldn&#x27;t be super hard to create a set of tools which would remove the complexity for the user.  Everyone who hears the idea is like, &quot;Yes.  That sounds very easy to do from a technical perspective which makes it too boring to do.&quot;  So no one has implemented the idea.  But it&#x27;s a good idea.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887085/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887089"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 7, 2022 19:13 UTC (Mon)
                               by <b>willy</b> (subscriber, #9762)
                              [<a href="/Articles/887089/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That does nothing to remove the maintenance costs of each filesystem. It makes the badly maintained filesystems less insecure (to a certain extent ... they can still exfiltrate data).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887089/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor887092"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 7, 2022 19:39 UTC (Mon)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/887092/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
These days it&#x27;s probably better to just use FUSE for that. It&#x27;s far easier to program with. It&#x27;s also unlikely that you&#x27;ll need high performance from these kinds of filesystems.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887092/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor887095"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 7, 2022 20:03 UTC (Mon)
                               by <b>dezgeg</b> (subscriber, #92243)
                              [<a href="/Articles/887095/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It in fact has been implemented in LKL (Linux Kernel Library) - where the kernel is compiled as a userspace library, which then is used to implement a FUSE filesystem which can mount any filesystem supported by the kernel (lklfuse).<br>
<p>
Sadly, last commit seems to be from 2020: <a href="https://github.com/lkl/linux">https://github.com/lkl/linux</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887095/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor887139"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 11:24 UTC (Tue)
                               by <b>eru</b> (subscriber, #2753)
                              [<a href="/Articles/887139/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Is UML still a thing? Its web page (http://user-mode-linux.sourceforge.net/) talks about kernel 2.6...<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887139/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887143"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 13:05 UTC (Tue)
                               by <b>geert</b> (subscriber, #98403)
                              [<a href="/Articles/887143/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Plenty of activity, cfr. <a href="http://lists.infradead.org/pipermail/linux-um/.">http://lists.infradead.org/pipermail/linux-um/.</a><br>
Looks like it&#x27;s not yet archived on lore.kernel.org, though.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887143/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor887708"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 12, 2022 19:27 UTC (Sat)
                               by <b>rwmj</b> (subscriber, #5474)
                              [<a href="/Articles/887708/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
libguestfs does this (albeit with qemu rather than UML).  In fact its purpose is to provide a secure enclave where filesystem exploits (both kernel and userspace) cannot affect the host.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887708/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor887098"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">missing y2038 support</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 7, 2022 21:11 UTC (Mon)
                               by <b>arnd</b> (subscriber, #8866)
                              [<a href="/Articles/887098/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
While this sounds like as good an excuse for removing file systems as any other, I don&#x27;t think this should be the main reason. Half the  file system implementations we have by now only exist in order to access old disk images, and this works regardless of whether one is able to create new files or not. We originally had a patch to refuse writable mounts on file systems that have known y2038 bugs, making those images read-only, but that got Nack&#x27;ed and we ended up with just a warning printed to the console.<br>
<p>
Side note: reiserfs doesn&#x27;t actually have a y2038 problem at all, it uses unsigned 32-bit timestamps with a range from 1970 to 2106. <a href="https://kernelnewbies.org/y2038/vfs">https://kernelnewbies.org/y2038/vfs</a> lists the limits, I think only ext2/ext3, coda, exofs, hostfs, and ufs1 still have the y2038 problem, and a few others have been changed to interpret the seconds as unsigned.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887098/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887113"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">missing y2038 support</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 2:02 UTC (Tue)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/887113/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
A disk image is just a very elaborate archive format. I&#x27;m 85% sure that, if someone is really using it, then userspace tools will exist or be created, regardless of whether the kernel supports it or not.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887113/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor887129"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">missing y2038 support</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 8:03 UTC (Tue)
                               by <b>pm215</b> (subscriber, #98099)
                              [<a href="/Articles/887129/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Looking at that chart, if I have an ext2/3/4[*] file system on disk, is there a command I can use to determine whether it&#x27;s the ext4-with-new-inodes type or a y2038-problem ext2/ext3/old-ext4 type? And is there a way to in-place convert to the new format, or is it necessary to create a whole new filesystem and copy over all the data ?<br>
<p>
[*] I think of all these as basically the same thing, which may or may not be an incorrect mental model, but which I suspect is not an uncommon one...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887129/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887130"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">missing y2038 support</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 8:22 UTC (Tue)
                               by <b>TomH</b> (subscriber, #56149)
                              [<a href="/Articles/887130/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Sure, run &quot;dumpe2fs -h &lt;device&gt;&quot; and look at the inode size. It needs to be 256 bytes or larger to support extended timestamps.<br>
<p>
You can increase the size with &quot;tune2fs -I &lt;device&gt;&quot; but a fsck needs to be done first so the filesystem will need to be unmounted and you probably want to read what the manual page says before trying it.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887130/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887134"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">missing y2038 support</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 9:02 UTC (Tue)
                               by <b>arnd</b> (subscriber, #8866)
                              [<a href="/Articles/887134/">Link</a>] 
      </p>
      
      </div>
      </summary>
      Ah, I did not know that tune2fs could do it, should have read your reply first. However, it seems this does not help with 

<pre>
Changing the inode size not supported for filesystems with the flex_bg feature enabled.
</pre>

It apparently works on ext4 file systems without the flex_bg feature, and on ext2/ext3 images that do not support flex_bg in the first place, but apparently not on small ext4 images that were created with flex_bg or had it (irreversibly) added later.



      
          <div class="CommentReplyButton">
            <form action="/Articles/887134/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor887210"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">missing y2038 support</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 17:55 UTC (Tue)
                               by <b>smurf</b> (subscriber, #17840)
                              [<a href="/Articles/887210/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Alternately you can convert the file system to btrfs, in-place.<br>
<p>
SCNR <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887210/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor887227"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">missing y2038 support</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 19:37 UTC (Tue)
                               by <b>pm215</b> (subscriber, #98099)
                              [<a href="/Articles/887227/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Cheers. Looks like only my /boot filesystems are non-y2038-ready (probably because as Arnd notes else-thread that&#x27;s still the default for less-than-512MB).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887227/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor887131"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">missing y2038 support</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 8:48 UTC (Tue)
                               by <b>arnd</b> (subscriber, #8866)
                              [<a href="/Articles/887131/">Link</a>] 
      </p>
      
      </div>
      </summary>
      I don't think you can convert between those in place without a full backup/restore.

One way to find out the inode format is to use the "stats" command in debugfs. It appears that at least in e2fsprogs version 1.45.7, the default in mkfs is still to use small inodes for smaller file system images, regardless of the file system type, so an ext2 file system image over 512MB is not actually compatible with the ext2 format unless you manually set the inode size, and smaller ext4 images continue having the y2038 problem:

<pre>
$ truncate --size=511M ext4.img
$ mkfs -t ext4  -q  ext4.img
$ echo stats | debugfs ext4.img 2&gt;&amp;1 | grep "Inode size"
Inode size:	          128

$ truncate --size=512M ext2.img
$ mkfs -t ext2  -q ext2.img
$ echo stats | debugfs ext2.img 2&gt;&amp;1 | grep "Inode size"
Inode size:	          256
</pre>

The defaults are configured in /etc/mke2fs.conf, which on my system contains:

<pre>
        small = {
                inode_size = 128
                inode_ratio = 4096
        }
</pre>

Removing this bit makes mkfs use 256 byte inodes by default, regardless of the size.



      
          <div class="CommentReplyButton">
            <form action="/Articles/887131/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor887519"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">missing y2038 support</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 10, 2022 17:42 UTC (Thu)
                               by <b>jccleaver</b> (subscriber, #127418)
                              [<a href="/Articles/887519/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; We originally had a patch to refuse writable mounts on file systems that have known y2038 bugs, making those images read-only, but that got Nack&#x27;ed and we ended up with just a warning printed to the console.</font><br>
<p>
This really seems like something to bubble back up, at least in preparation for the actual post-2038 strategy. I can&#x27;t think of a better solution for how to properly handle something that is perfectly readable fine but which has no way to encode properly-readable vital (i.e. security) metadata about an operation.<br>
<p>
Just leave this feature flag disabled for now, and builders can enable it as desired; with a full flip in the years to come.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887519/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor887106"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 7, 2022 22:41 UTC (Mon)
                               by <b>jhoblitt</b> (subscriber, #77733)
                              [<a href="/Articles/887106/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
+1 to deprecate NFS v2/v3 in the kernel, even if it is only the server support.  Ganesha has v3 server support for anyone unable to migrate to v4 and I have at least see fuse NFS clients. I have no doubt that NFS v2 will still be in use in the year 2222 but it is a shame for the kernel community to have to keep maintaining obsolete protocols when there are user-space alternatives.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887106/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887140"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 11:27 UTC (Tue)
                               by <b>jlayton</b> (subscriber, #31672)
                              [<a href="/Articles/887140/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I too would like to see v2/3 go the way of the Dodo, but I don&#x27;t think we&#x27;ll probably be able to drop them that easily. One of the problems there is that at least some pNFS layouts (e.g. flexfiles) can use NFSv3 as a transport protocol, and some folks (Hammerspace, for instance) can use v3 servers as pNFS DS&#x27;s. They may be able to eventually use v4.1 instead, but that sort of transition will take time.<br>
<p>
This is probably a good discussion for the upcoming NFS Bakeathon.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887140/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor887709"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 12, 2022 19:29 UTC (Sat)
                               by <b>rwmj</b> (subscriber, #5474)
                              [<a href="/Articles/887709/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I&#x27;d be happier with this is NFSv4 user mapping wasn&#x27;t such a massive screw-up to the extent that on my home network I just mapped every local user to a single nobody user on NFS because getting anything else to work was impossible.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887709/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887710"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 12, 2022 20:25 UTC (Sat)
                               by <b>jhoblitt</b> (subscriber, #77733)
                              [<a href="/Articles/887710/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The documentation is definitely suboptimal. AFAIK, useful idmaping requires krb5. I haven&#x27;t dug into the details -- this may be a server implementation decision instead of a limitation of the v4 protcol.  If krb5 is in use, there is a good chance that UIDs/GIDs are coordinated and idmaping isn&#x27;t nessicary. I use v4 heavily at my $day_job without remapping without much complaint other than there being no showmount equiv (but I think it so be possible to write a usespacer cli client that does ls on the root export). <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887710/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor887111"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 1:46 UTC (Tue)
                               by <b>pabs</b> (subscriber, #43278)
                              [<a href="/Articles/887111/">Link</a>] (10 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The comment about migrating off Reiserfs reminds me of what I see as a significant gap in Linux (V)FS functionality; unless I missed something there is no in-kernel functionality to copy/move a file and all associated characteristics and metadata from one FS to another. So you have to use userspace tools and hope they or you didn&#x27;t forget something (like the rsync sparse mode option) or reflinks or the immutable bit or ACLs etc.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887111/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887115"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 2:10 UTC (Tue)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/887115/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Not all filesystems can support the same metadata in the first place. Old-school FAT, for example, rounds timestamps to a resolution of two seconds, and I&#x27;m pretty sure it entirely lacks support for POSIX file modes, much less extended nonsense like ACLs. NTFS has &quot;alternate data streams,&quot; which I have never heard of existing under any other filesystem. There was allegedly some version of HFS+ which supported directory hard links. And so on...<br>
<p>
This only has the slightest chance of working if both the source and the destination FS&#x27;s are effectively equivalent (e.g. both ext4 with the same set of mount options). Even then, what happens if you try to copy a file (not directory) with a link count greater than one? Does it just break the link, and make a brand-new file on the destination? Or does the kernel somehow know that you were also planning to copy another link to the same file, and therefore it needs to recreate the hard link on the other side when you get around to copying that second link? rsync has enough information to figure that out, but the kernel probably does not.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887115/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887116"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 2:18 UTC (Tue)
                               by <b>pabs</b> (subscriber, #43278)
                              [<a href="/Articles/887116/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yeah, definitely a complicated feature, but the issues you bring up don&#x27;t seem unsurmountable. Options to ignore certain features could be added. A recursive option could let the kernel know that yes you want that link.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887116/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887232"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 22:42 UTC (Tue)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/887232/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Options to ignore certain features could be added.</font><br>
<p>
The problem is that, in practice, either it errors out every time a feature can&#x27;t be copied and wasn&#x27;t explicitly excluded, or else it silently swallows the error and loses your data. That might not sound so bad, until you realize that you&#x27;re going to lose a lot of rather basic information in some cases; FAT in particular is extremely lossy, and will lose symlinks (and everything else that is not a &quot;regular file&quot; or directory), (probably) simple permissions, and almost certainly all forms of &quot;extended&quot; attributes such as ACLs. I also don&#x27;t believe it supports hard links, and some particularly old versions don&#x27;t even support subdirectories.<br>
<p>
<font class="QuotedText">&gt; A recursive option could let the kernel know that yes you want that link.</font><br>
<p>
This opens up an enormous can of worms. What happens if the process receives a signal while it&#x27;s inside a recursive kernelspace copy operation? Does the whole operation fail with EINTR, and you have to start over from scratch? What happens if file #2,758 can&#x27;t be copied, do you just return EIO and make the application deal with it? More generally, how do you handle exceptional circumstances while the copy is taking place?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887232/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor887405"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 10, 2022 2:23 UTC (Thu)
                               by <b>bartoc</b> (guest, #124262)
                              [<a href="/Articles/887405/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I seem to recall some additions to `copy_file_range` to allow this in some situations, perhaps only between two different filesystems of the same type (btrfs to btrfs or so on).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887405/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor887192"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 16:38 UTC (Tue)
                               by <b>stevie-oh</b> (subscriber, #130795)
                              [<a href="/Articles/887192/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; NTFS has &quot;alternate data streams,&quot; which I have never heard of existing under any other filesystem</font><br>
<p>
Mac OS&#x27; HFS had them first, there they are called &quot;resource forks&quot;.<br>
<p>
In fact, the entire reason NTFS has Alternate Data Streams is that Microsoft wanted to make it possible to use a Windows server as a file server for a group of Macs.<br>
<p>
<a href="https://en.wikipedia.org/wiki/NTFS#Alternate_data_stream_">https://en.wikipedia.org/wiki/NTFS#Alternate_data_stream_</a>(ADS)<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887192/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887257"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 9, 2022 7:44 UTC (Wed)
                               by <b>eru</b> (subscriber, #2753)
                              [<a href="/Articles/887257/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Judging by that Wikipedia article, alternate data streams are now used for similar purposes as Linux uses extended attributes. So not an entirely useless feature.<br>
Copying from NTFS to a modern Linux file system could use an extended attribute to simulate a stream, unless it contains too much data.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887257/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887406"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 10, 2022 2:26 UTC (Thu)
                               by <b>bartoc</b> (guest, #124262)
                              [<a href="/Articles/887406/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
yes, however really you might want some translation (in particular for mark-of-the-web).<br>
<p>
NTFS supports actual extended attributes too, so you have some risk of collision if you try and merge ADS and ntfs xattr.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887406/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor888452"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 18, 2022 19:55 UTC (Fri)
                               by <b>cypherpunks2</b> (guest, #152408)
                              [<a href="/Articles/888452/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
ADS and xattrs aren&#x27;t entirely equivalent. One important aspect of ADS is that the stream cannot be accessed without knowing the name, whereas you can list all existing xattrs for a file without knowing them.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/888452/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor888565"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 19, 2022 23:34 UTC (Sat)
                               by <b>smurf</b> (subscriber, #17840)
                              [<a href="/Articles/888565/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I find that very hard to believe, given that (a) you couldn&#x27;t backup your system without that function and (b) you get pointers to numerous utilities as well as the relevant Windows kernel functions when you do a simple web search for &quot;enumerate alternate data streams&quot;.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/888565/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor887119"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2022 2:36 UTC (Tue)
                               by <b>dtlin</b> (subscriber, #36537)
                              [<a href="/Articles/887119/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
ext[234] grabbed the dump+restore names, XFS has xfsdump+xfsrestore. But with the feature set varying so much between filesystems, it&#x27;s probably tough to create something more general without getting as complex as rsync.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887119/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor887407"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 10, 2022 2:27 UTC (Thu)
                               by <b>bartoc</b> (guest, #124262)
                              [<a href="/Articles/887407/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think there are some ... special circumstances ... around reiserfs that may contribute to people not really wanting to maintain it, or have their names associated with it.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887407/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor887516"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 10, 2022 16:38 UTC (Thu)
                               by <b>smurf</b> (subscriber, #17840)
                              [<a href="/Articles/887516/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
To be fair, reiserfs had problems way before Mr. Reiser decided to embark on a path that ended behind bars. (He&#x27;s likely to get out sometime next year.)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/887516/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor888313"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 17, 2022 18:19 UTC (Thu)
                               by <b>mrugiero</b> (guest, #153040)
                              [<a href="/Articles/888313/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Well, that&#x27;s hysteria, plain and simple. Nobody will think you&#x27;re friends with him because you maintain a piece of tech. Just rename it if it bothers you so much, the GPL allows for renaming projects as long as you keep the license and copyright notices.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/888313/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor888323"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 18, 2022 8:21 UTC (Fri)
                               by <b>smurf</b> (subscriber, #17840)
                              [<a href="/Articles/888323/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It&#x27;s not what others think. It&#x27;s what I think.<br>
<p>
Suppose I find an intractable ext4 bug, no biggie I ask Theodore Tso. A problem with reiserfs, well, I can conceivably ask Mr. Reiser sometime next year, but I kindof doubt he&#x27;s even been able to look at that code during the time he was imprisoned.<br>
<p>
Also, the world has moved on, give me a reason why anybody would want to start using reiserfs today, instead of btrfs or ext4 or xfs or <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/888323/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor888417"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 18, 2022 14:52 UTC (Fri)
                               by <b>mrugiero</b> (guest, #153040)
                              [<a href="/Articles/888417/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There&#x27;s a different between &quot;not wanting to be associated&quot; with someone and not being able to ask them for help with technical stuff. You can get acquaintance with code without Reiser, even if it&#x27;s harder. Besides, I don&#x27;t need to give you a reason to start using reiserfs because I don&#x27;t think anyone should, it might have been pretty advanced at the time, but its glory years have passed. That doesn&#x27;t change the fact that &quot;oooohhhh its author is a murderer we shouldn&#x27;t use/maintain it&quot; is a piss poor argument.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/888417/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor888441"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 18, 2022 18:49 UTC (Fri)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/888441/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Asking Mr. Reiser to fix bugs in reiserfs, regardless of the reality of the situation, is a bit like bothering Mr. Young to fix bugs in ssleay.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/888441/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor888252"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 17, 2022 14:23 UTC (Thu)
                               by <b>mrugiero</b> (guest, #153040)
                              [<a href="/Articles/888252/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The only thing I can say is that a mandatory part of the deprecation process of filesystems should be to implement a FUSE driver for them. You never know when you&#x27;ll need to access an ancient drive to recover data, and that should be enough to cover that case.<br>
It could be a subtree in the kernel tree or a sister project under the Linux Foundation umbrella, but with a policy that you can&#x27;t deprecate the kernel driver without that in place.<br>
A simplification could be to only implement read features. Then when it gets obsoleted we still can access archives.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/888252/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor888316"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 17, 2022 18:25 UTC (Thu)
                               by <b>rmano</b> (guest, #49886)
                              [<a href="/Articles/888316/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I agree (at least in principle... The part on who should do it is a problem :-)).<br>
<p>
I still have CD-ROM burned in extfs around from the &#x27;90. The good part is that I don&#x27;t think that I&#x27;ll need them ever...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/888316/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor888336"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 17, 2022 20:58 UTC (Thu)
                               by <b>mrugiero</b> (guest, #153040)
                              [<a href="/Articles/888336/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; The part on who should do it is a problem :-)</font><br>
<p>
Well, the one who wants to deprecate should make sure the replacement is in place, IMO :) (Which doesn&#x27;t necessarily means doing it themselves, but at least finding someone)<br>
Besides, testing FUSE filesystems could possibly be done with a single test suite ran much less often as the code is expected to change less.<br>
Another idea to add work to someone else (TM) would be to require this to introduce new filesystems. It&#x27;d be nice to other OSes to be able to read whatever Linux brings and it would make it trivial to deprecate them later, as it&#x27;s much easier to write this when the know-how is already in your head rather than reverse engineering the work someone did 20 years ago.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/888336/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor888372"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 18, 2022 4:04 UTC (Fri)
                               by <b>pabs</b> (subscriber, #43278)
                              [<a href="/Articles/888372/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I&#x27;m looking forward to the Linux Kernel Library project being merged, that would probably allow using all Linux kernel filesystem code in userspace, then you could add a FUSE wrapper for them.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/888372/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor888379"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 18, 2022 8:20 UTC (Fri)
                               by <b>smurf</b> (subscriber, #17840)
                              [<a href="/Articles/888379/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That doesn&#x27;t help much. In the distant future you won&#x27;t be able to compile then-ancient kernels (i.e. those with reiserfs still in them) with then-current compilers, just like you can&#x27;t compile now-ancient kernels with gcc 12.<br>
<p>
It doesn&#x27;t matter (much) whether that kernel shall compile to a mere FUSE helper that exports a reiserfs file system, or a full-blown kernel you&#x27;d run in a VM (mount the reiserfs image there and export it to the host via NFS or CIFS). Assuming it&#x27;ll work in that then-current VM; that&#x27;s mostly likely, IMHO, but by no means assured.<br>
<p>
The solution is (assuming that there is no reiserfs support library you can use a shortcut) to extract a libreiserfs from the kernel and remove all the kernel idiosyncrasies from it. At that point it&#x27;s standard C plus libfuse and thus presumably easier to keep up-to-date with whatever fun incompatibilities the C and/or FUSE people will throw in your path in the future.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/888379/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor888369"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 18, 2022 13:40 UTC (Fri)
                               by <b>HelloWorld</b> (guest, #56129)
                              [<a href="/Articles/888369/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That&#x27;s ridiculous. We&#x27;re talking about a significant engineering effort for something that is going to be used exceedingly rarely. And it&#x27;s completely unnecessary too, because there&#x27;s an obvious solution for recovering the data: just run an older kernel in a VM and copy the data over. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/888369/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor888416"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 18, 2022 14:49 UTC (Fri)
                               by <b>mrugiero</b> (guest, #153040)
                              [<a href="/Articles/888416/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Suppose there comes a point where the intersection between supported filesystems is empty (we&#x27;ll reach that point eventually, ext4 and btrfs will eventually be obsolete too), how would you copy from reiserfs to an actually living filesystem? Mounting in 7 other kernels?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/888416/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor888428"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 18, 2022 16:49 UTC (Fri)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/888428/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>Something like tar or rsync over the hypervisor's networking would work just fine. After all, I can tar up a filesystem on a 1980s vintage UNIX system, or run PKZIP on a 1980s vintage DOS system, and uncompress the resulting archive on a modern Linux PC.


      
          <div class="CommentReplyButton">
            <form action="/Articles/888428/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor888587"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When and why to deprecate filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 20, 2022 7:50 UTC (Sun)
                               by <b>Shabbyx</b> (guest, #104730)
                              [<a href="/Articles/888587/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If the problem is recovering an old archive... Well just use an old kernel (in an old distro) for that half an hour you need to copy the data out. The scenario you are describing is an unlikely and a one-time event. Why bother with developing, testing and maintaing something for that one time you might need it when an old kernel would do?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/888587/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2022, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
