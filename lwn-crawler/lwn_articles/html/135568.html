        <!DOCTYPE html>
        <html lang="en">
        <head><title>The coding style enforcer [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/135568/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/134840/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/135568/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>The coding style enforcer</h1>
<div class="Byline">[Posted May 11, 2005 by corbet]
               <p>
               </div>
</div>
<div class="ArticleText">
The coding style document packaged with the kernel source contains a number
of clear rules; here's one of them:
<p>
<div class="BigQuote">
	Don't put multiple statements on a single line unless you have
	something to hide:

<pre>
        if (condition) do_this;
          do_something_everytime;
</pre>
</div>
<p>

Jesper Juhl recently found some code which evidently had something to hide,
and <a href="/Articles/135569/">submitted a patch</a> to break the
offending <tt>if</tt>
statements onto two lines.  Andrew Morton <a
href="/Articles/135570/">rejected</a> it:
<p>
<div class="BigQuote">
	There are about 88 squillion of these in the kernel.  I think it
	would be a mistake for me to start taking such patches, sorry.
</div>
<p>
In further discussion, however, Andrew seemed to agree that, perhaps,
cleaning up the kernel source to be more generally compliant with the
coding style documentation might be a good thing.  He just doesn't want to
cope with hundreds of little patches to that end.  He will, however,
consider a small number of very large patches.
<p>
So a major coding style cleanup seems likely to happen, perhaps before
2.6.12 comes out.  Applying this sort of patch so late in the cycle
<i>should</i> be safe; the intent is to change the formatting, but to make
no actual code changes.  Andrew also <a href="/Articles/135573/">plans</a>
to drop any changes which do not apply against the -mm tree, in the hopes
of minimizing the effects of the changes on patches maintained by other
developers. 
<p>
If all goes according to this plan, the final 2.6.12 patch could be large
indeed.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Coding_style">Coding style</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/135568/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor135607"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Backdoor</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 12, 2005 6:26 UTC (Thu)
                               by <b>miallen</b> (guest, #10195)
                              [<a href="/Articles/135607/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      This sounds like a great opportunity for someone to install a backdoor. All I have to do is fix up a <br>
squillion lines of code (plus a little something extra for my time) and send it in with my hotmail <br>
account :-&gt;<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/135607/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor135608"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Backdoor</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 12, 2005 6:52 UTC (Thu)
                               by <b>remijnj</b> (guest, #5838)
                              [<a href="/Articles/135608/">Link</a>] 
      </p>
      
      </div>
      </summary>
      Somebody already thought of that and <A href="http://lkml.org/lkml/2005/5/11/68">propposed a solution</A>. If the output is identical after the codechanges you are safe. 
<P>
Hmmm, unless the backdoor is only active if you enable a non-default setting. It would be quite nasty to only enable it when the "Fast routing" or "Netfilter NAT" option are enabled. This way it's hard to spot and will be enabled on most firewalls.
<P>
So this should be tested with allyesconfig or something similar...
      
          <div class="CommentReplyButton">
            <form action="/Articles/135608/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor135635"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The coding style enforcer</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 12, 2005 10:36 UTC (Thu)
                               by <b>NRArnot</b> (subscriber, #3033)
                              [<a href="/Articles/135635/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      If the patch is restricted to inserting whitespace, it could be validated by stripping all whitespace out of the affected code before and after applying the patch, and making sure that the result is identical. <br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/135635/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor135963"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The coding style enforcer</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2005 23:25 UTC (Fri)
                               by <b>roelofs</b> (guest, #2599)
                              [<a href="/Articles/135963/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <FONT COLOR="#440088"><I>If the patch is restricted to inserting whitespace, it could be validated by stripping all whitespace out of the affected code before and after applying the patch, and making sure that the result is identical.</I></FONT>

<P>
Or just using <TT>indent</TT> to canonicalize both "before" and "after" versions, then running diff on the two trees.

<P>
Heck, a few tweaks should allow one to use <TT>indent</TT> directly as the style-enforcement tool...

<P>
Greg
      
          <div class="CommentReplyButton">
            <form action="/Articles/135963/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor135721"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The coding style enforcer</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 12, 2005 14:44 UTC (Thu)
                               by <b>ncm</b> (guest, #165)
                              [<a href="/Articles/135721/">Link</a>] 
      </p>
      
      </div>
      </summary>
      Funny, I had a patch like that once, to fix all the macros meant to define a literal value, but that instead define an unparenthesized expression.  It got nowhere.  Maybe something like that would have a chance now.<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/135721/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor135828"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The coding style enforcer</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2005 3:54 UTC (Fri)
                               by <b>stock</b> (guest, #5849)
                              [<a href="/Articles/135828/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      What kind of crap is this? Andrew Morton will reject patches only because <br>
of their layout, instead of judging its effectiveness and functional use?  <br>
Instead he should apply his own stalin coding style demands to the <br>
submitted patch and send his "fancy cool" version of the patch back to <br>
the submitter.  <br>
 <br>
Fancy looking code, give me a break! Someone should give this clown the <br>
boot. <br>
 <br>
Not only did he mixup a stable branch 2.6.xx with a development branch, <br>
the OSDL organisation seems to have put some weird things in place also. <br>
So was it to be read not so long ago that a PR person of OSDL stated that <br>
for a stable kernel one is referred to the vendor of his Linux distro of <br>
choice. <br>
 <br>
"WordNet (r) 2.0" <br>
 public relations <br>
     n : a promotion intended to create goodwill for a person or <br>
         institution syn: PR <br>
 <br>
Since when do Linus[tm] or Morton nowadays needs a PR person? Maybe to <br>
explain that Linus really liked BitKeeper and didn't want to messup the <br>
kernel project? They start to look like politicians, say one thing, and <br>
get the opposite as a result : <a href="http://lwn.net/Articles/126763/">http://lwn.net/Articles/126763/</a>  "Is the <br>
kernel development process broken?" <br>
 <br>
Robert <br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/135828/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor135831"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The coding style enforcer</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2005 4:02 UTC (Fri)
                               by <b>stock</b> (guest, #5849)
                              [<a href="/Articles/135831/">Link</a>] 
      </p>
      
      </div>
      </summary>
      besides, automatic coding style enforcer...   <br>
  <br>
how sneaky evil is this? How in earth can someone identiy the coding  <br>
style of the original codesubmitter back?? Is this the automatic version  <br>
of white washing leaked code ?  <br>
  <br>
Robert  <br>
  <br>
  <br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/135831/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor135912"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The coding style enforcer</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2005 15:53 UTC (Fri)
                               by <b>amikins</b> (guest, #451)
                              [<a href="/Articles/135912/">Link</a>] 
      </p>
      
      </div>
      </summary>
      If you'll read it, you'll see that he rejected the patch because he doesn't want to get a ridiculous number of tiny patches.<br>
<p>
It's a workflow issue.<br>
<p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/135912/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor136252"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The coding style enforcer</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 17, 2005 15:42 UTC (Tue)
                               by <b>wilck</b> (guest, #29844)
                              [<a href="/Articles/136252/">Link</a>] 
      </p>
      
      </div>
      </summary>
      Did you read the article at all, or did you just take the chance to say that you dislike Andrew?<br>
<p>
If I get it right, Andrew didn't "reject patches only because of their layout", quite the opposite - he rejected a patch that did nothing but change the layout.<br>
<p>
<p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/136252/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor135880"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">I was hoping for a coding style enforcer</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2005 12:23 UTC (Fri)
                               by <b>walles</b> (guest, #954)
                              [<a href="/Articles/135880/">Link</a>] 
      </p>
      
      </div>
      </summary>
      Here I thought that somebody had written a script to look through the kernel for violations of well known and verifiable coding standards that everybody agrees upon (like the one described in the article).<br>
<p>
That didn't happen today unforturnately, but I still think that would be good.  Maybe next time...<br>
<p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/135880/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2005, Eklektix, Inc.<BR>
            
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
