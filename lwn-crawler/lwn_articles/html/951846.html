        <!DOCTYPE html>
        <html lang="en">
        <head><title>Trust in and maintenance of filesystems [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/951846/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/951632/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/951846/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>Trust in and maintenance of filesystems</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Benefits for LWN subscribers</b>
<p>
The primary benefit from <a href="/Promo/nst-nag5/subscribe">subscribing to LWN</a>
       is helping to keep us publishing, but, beyond that, subscribers get
       immediate access to all site content and access to a number of extra
       site features.  Please sign up today!
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>November 21, 2023</br>
           <hr>
<a href="/Articles/951847/">Maintainers Summit</a>
</div>
The Linux kernel supports a wide variety of filesystems, many of which are
no longer in heavy use — or, perhaps, any use at all.  The kernel code
implementing the less-popular filesystems tends to be relatively unpopular
as well, receiving little in the way of maintenance.  Keeping old
filesystems alive does place a burden on kernel developers, though, so it
is not surprising that there is pressure to remove the least popular ones.
At the 2023 Kernel Maintainers Summit, the developers talked about these
filesystems and what can be done about them.
<p>
Christoph Hellwig started the discussion by saying that it is hard for
developers to know how mature — how trustworthy and maintained — any given
filesystem is; that can often only be determined by talking to its users.
This information gap can be a bad thing, he said.  User space (in the form
of desktop environments in particular) has a strong urge to automatically
mount filesystems, even those that are unmaintained, insecure, and
untrustworthy.  This automounting exposes the system to security threats
and is always a bad idea, but it's a fact of life; maybe there needs to be
a way for the kernel to indicate to user space that some filesystems are
not suitable for mounting in this way.
<p>
<a href="/Articles/951850/"><img
src="https://static.lwn.net/images/conf/2023/lpc/ChristophHellwig-sm.png" alt="[Christoph
Hellwig]" title="Christoph Hellwig" class="lthumb"></a>

Another problem, he said, is fuzz testing.  He appreciates all of the work
that is going into fuzz-testing of filesystems, but it is not helpful if it
is being directed at filesystems that are not going to be fixed.  That is a
waste of resources; the fuzzer should, instead, be directed at filesystems
that will be fixed in response to problem reports.
<p>
The broader question, he continued, is how the kernel can do better at
getting rid of old and unmaintained code.  The process for doing so is
always "very ad hoc"; typically, some maintainer gets angry and sends a
removal patch, which is sometimes accepted.  What comes next is typically a
round of "whining in the Linux press".  Other projects have "reasonable
deprecation schedules", where features are annotated as being set for
removal in a couple of releases unless somebody who cares puts in the time
to maintain them properly.  The kernel, perhaps, could benefit from
something similar.
<p>
He closed by mentioning the prospect of the European <a
href="/Articles/944300/">Cyber Resilience Act</a>, which could put vendors
of products containing the kernel at risk.
<p>
Steve Rostedt said that, since most users run the kernels provided by
distributors, the right thing to do might be to educate those distributors
about which filesystems are trustworthy. Hellwig responded that, if the
community needs to educate in that way, it is doing something wrong; there
should be a better way to communicate this information.  Ted Ts'o said that
there are hundreds of distributions out there; it would be necessary for
the kernel community to decide which ones it cares about.  It could be
said, he suggested, that distributors that do not contribute back to the
kernel do not matter.
<p>
Linus Torvalds responded that he does not want anybody who would make that
argument as a developer on his kernel — a position that has not changed in
decades, he said.  Any approach that says "users don't matter" is wrong, he
said.  Hellwig answered that users need to know when a filesystem is
broken.  Dave Chinner suggested that the right approach is to talk to the
people who are setting the automounting policies — and the GNOME developers
in particular.
<p>
<h4>Communications</h4>
<p>
Kees Cook said that the maturity information for filesystems could be
stored as a field in the <tt>MAINTAINERS</tt> file; noises in the room made
it clear that this idea was not universally loved.  Hellwig said that file
is not the place to send users; perhaps, instead, the automounter could be
taught to only mount filesystems at a given maturity level or above.
Chinner noted that the XFS developers have shipped a udev rule saying
"don't automount XFS filesystems" for some time; perhaps that policy should
be centralized.  Torvalds said that everybody agrees that the current
"automount everything" policy is wrong, but it should not be blocked in the
kernel; this is a problem for the desktop environments.
<p>
Ts'o said that the problem comes down to communications; end users do not
read kernel configurations or documentation folders.  There is also no
agreement on the acceptable level of risk; kernel developers worry about
unmaintained filesystems, but GNOME developers think that everything should
be automounted.  That was a rule made by a product manager, he said, "and
you don't argue with product managers".  That, in turn, makes his life
miserable as he is inundated with syzbot reports for crashes resulting
from mounting malicious filesystems.  The kernel, he concluded, should
suggest a default policy that makes sense, but user space will make the
decision.
<p>
If we had some sort of filesystem maturity model, Hellwig said,
distributors would be able to use it to set an automounting policy.  Josef
Bacik said that it was just necessary to figure out a way to communicate
this information to user space.  Once that is in place, it's just a matter
of waiting a couple of years for the tooling to be updated.  He added
that the more interesting problem was that of deprecation; there is no
policy for doing that now.  He would like a way to tag kernel features as
being deprecated and slated for future removal.  Greg Kroah-Hartman pointed
out that this idea has been tried in the past (it was <a
href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=9c0ece069b32">abandoned</a>
in 2012); Bacik said that it was time to try again.
<p>
Kroah-Hartman said that the kernel drops drivers all the time, and that
perhaps the process should be formalized.  Torvalds answered that he will
always require a reason to deprecate code; the lack of reasons has annoyed
him in the filesystem discussion, he said.  He raised the "sysv" filesystem
(used on Unix version&nbsp;7 on PDP-11 machines and on some early
proprietary x86 Unix systems)
as an example; it is simple and places no burden on developers, so there is
no reason to deprecate it.  Bacik responded that there is no way to make
changes to sysv and be sure of not breaking it; when Torvalds asked if
anybody had encountered a problem with sysv, the answer from the room was
"we don't know".  He said that proved the lack of a cost, so nobody cares
if sysv remains in the tree.
<p>
There was a side discussion on the differences between filesystems and
drivers that started when Torvalds pointed out that there are many drivers
in the kernel that receive little or no testing.  Hellwig asserted that
there are many drivers that have not worked for years.  Kroah-Hartman said
that there is no difference between drivers and filesystems, but Arnd
Bergmann said that, for drivers, it's relatively clear when the associated
hardware no longer exists.  That is not the case for filesystems.  Thomas
Gleixner added that, if a driver stops working, it simply stops; a
filesystem, instead, can silently corrupt data.  Chinner agreed, pointing
out that one cannot fix filesystem corruption with a reboot.
<p>
Rostedt claimed that it is possible to test all of the filesystems in the
tree, since there is no special hardware needed, but the filesystem
developers disagreed.  Chinner said that, without a <tt>mkfs</tt> tool,
filesystem testing cannot be done; additionally, there is a need for a
filesystem checker and integration with the fstests suite.  Ts'o singled out
the ntfs filesystem; the tools are proprietary, but the kernel developers
took the kernel code without insisting that the tools be open.
<p>
According to Chinner, the quality of the kernel's filesystem
implementations has improved greatly over the last decade or so.  There are
something like 2,000 tests in the fstests suite; it even has 200
Btrfs-specific tests, where recently there were none.  The reliability of
the filesystems covered by fstests has gone way up; developers know that
the filesystems are good and can tell users so.  For the other filesystems,
nobody really knows.
<p>
Torvalds pointed out that one of those other filesystems, reiserfs, is in
fact deprecated and on its way out.  It is possible to remove code that
causes problems, but only if there is a good reason to do so.  Reiserfs may
still have a few users, given that SUSE defaulted to it for years, but he
is happy to remove it — as long as there are no complaints, which might
cause him to reconsider.  Brauner asked for a proper path toward that
removal, so that maintainers can effect removals without getting yelled at.
<p>
There was some discussion of how to communicate filesystem maturity
information to user space.  Ideas included an ELF section in module
binaries, a kernel-configuration option, an interface for automounters,
tainting the kernel when a low-quality filesystem is mounted, or requiring
a special "I know it's deprecated" mount option.  Dave Airlie suggested
working with the <a
href="https://www.freedesktop.org/wiki/Software/udisks/">udisks</a>
developers; Chinner said that he had tried that and "hit a brick wall"
before just adding a udev rule instead.  A few developers expressed
frustration with a perceived inability to get a response from user-space
developers on topics like this.
<p>
<h4>"Print a warning"</h4>
<p>
Torvalds said that there is no way to communicate this information to
existing user space, since that code is not prepared to receive that
message.  Instead, he said, just outputting a warning with
<tt>printk()</tt> can be effective; users see the errors and complain to
their distributors.  Suitable warnings could be added to the more
questionable filesystems.
<p>
That, Kroah-Hartman said, requires coming up with a list of good and bad
filesystems.  Hellwig said that there would need to be at least three
levels: "no trust", "generally maintained but don't mount untrusted
images", and "well maintained".  Torvalds said that this information could
be given to the kernel when a filesystem is registered, and a warning
printed if an untrusted filesystem is mounted.  "Enough arguing", he said,
it was time to just write a patch and try it.
<p>
The arguing was not done quite yet, though; Gleixner complained about
architectures that do not keep up with low-level core-kernel changes.  That
leaves him having to figure out how to fix "25&nbsp;PowerPC
subarchitectures", an impossible task for a developer without the hardware
and who is not an expert in that architecture.  Might there be a way to
tell architecture maintainers that they need to move forward to current
APIs or the support will be removed?
<p>
Hellwig concurred with the problem, saying that there is an implicit
assumption in the community that this sort of API cleanup is a low-priority
task; as a result it is easily blocked.  There needs to be a way to force
developers to move to newer APIs.  Bergmann mentioned the <a
href="/Articles/813201/">desire to remove high memory</a>, but 32-bit Arm
still needs it, so it cannot be removed from anywhere, imposing significant
costs on the kernel as a whole.  Chinner complained
that increasing amounts of work are being placed on maintainers to keep old
code working; maintainers are at the limit of what they can do now, and
this path is unsustainable, he said.
<p>
Torvalds repeated that it is possible to deprecate old code when there is a
good reason to do so.  When Gleixner again said that he cannot get
architecture maintainers to move to new APIs, Torvalds added that kernel
developers often add new APIs alongside old ones to avoid having to fix
everything at the outset.  Perhaps, he said, developers should try to avoid
that approach and, instead, just fix everything right away.  Gleixner said
that, for some changes, every subarchitecture must be fixed manually, which
is a huge job.
<p>
Christian Brauner said that he had similar problems with the adoption of
<a href="/Articles/759499/">the new mount API</a>; it took years to convert
a majority of the important filesystems, and he had to do a lot of the work
himself.  A lot of his patches were rejected, creating a frustrating
situation.  Hellwig added that, during this conversion, two more
filesystems using the old API were merged.  Torvalds suggested that, in
many of these cases, adding a warning might be all that is needed to put
pressure on maintainers to move forward.
<p>
The above discussion was supposed to fit into a 30-minute discussion slot;
readers who have gotten this far will be unsurprised to learn that it ran
significantly over.  At this point, the developers were in need of a break,
so this topic was put aside so that the rest of the agenda could be
addressed.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Filesystems-Deprecation_policy">Filesystems/Deprecation policy</a></td></tr>
            <tr><td><a href="/Archives/ConferenceIndex/">Conference</a></td><td><a href="/Archives/ConferenceIndex/#Kernel_Maintainers_Summit-2023">Kernel Maintainers Summit/2023</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/951846/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor952092"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 15:46 UTC (Tue)
                               by <b>willy</b> (subscriber, #9762)
                              [<a href="/Articles/952092/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
sysv will impose costs on me as part of the folio transition. I'm glad to hear it's not necessary to test it.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952092/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor952096"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 16:25 UTC (Tue)
                               by <b>brauner</b> (subscriber, #109349)
                              [<a href="/Articles/952096/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Just to clarify the conversion to the new mount api was a joint effort. There were a bunch of filesystems done by David  and Al and then I did a few more recently. But we also have Ian working on converting a few more. So this really is collective work.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952096/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor952123"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 17:00 UTC (Tue)
                               by <b>kees</b> (subscriber, #27264)
                              [<a href="/Articles/952123/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; at least three levels: "no trust", "generally maintained but don't mount untrusted images", and "well maintained"</span><br>
<p>
I had said at the start of the discussion that the information is ALREADY in the MAINTAINERS file (not that we could put it there: it's already there). If the point is that bugs go unaddressed, nothing new is needed beyond plumbing it to warnings or module metadata. Either it's orphaned or it's not:<br>
<p>
SYSV FILESYSTEM<br>
S:	Orphan<br>
<p>
NTFS FILESYSTEM<br>
S:	Supported<br>
<p>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952123/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952752"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 26, 2023 16:49 UTC (Sun)
                               by <b>patrakov</b> (subscriber, #97174)
                              [<a href="/Articles/952752/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The real question is whether insurance companies (e.g. AXA) would agree with these assessments when selling cyber insurance, or override them with their own judgment.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952752/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor952126"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 17:10 UTC (Tue)
                               by <b>ebassi</b> (subscriber, #54855)
                              [<a href="/Articles/952126/">Link</a>] (76 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; There is also no agreement on the acceptable level of risk; kernel developers worry about unmaintained filesystems, but GNOME developers think that everything should be automounted.</span><br>
<p>
I must have missed the memo in the secret GNOME cabal, because I don't remember ever discussing this particular bit of policy.<br>
<p>
Of course, if the Linux kernel developers don't even know which file systems are safe, how is user space even remotely going to be qualified to make that decision? After all, it's usually us who get a bug filed with "I can't access my USB drive when I plug it in, GNOME sucks".<br>
<p>
<span class="QuotedText">&gt; when Torvalds asked if anybody had encountered a problem with sysv, the answer from the room was "we don't know". He said that proved the lack of a cost, so nobody cares if sysv remains in the tree.</span><br>
<p>
This is horrific. The idea that dead/untested/untrusted code has no cost is… I have no words.<br>
<p>
<span class="QuotedText">&gt; A few developers expressed frustration with a perceived inability to get a response from user-space developers on topics like this.</span><br>
<p>
This was the idea of the Plumbers conference, before it became yet another Linux kernel conference.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952126/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952133"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 18:29 UTC (Tue)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/952133/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt;  &gt; when Torvalds asked if anybody had encountered a problem with sysv, the answer from the room was "we don't know". He said that proved the lack of a cost, so nobody cares if sysv remains in the tree.</span><br>
<p>
<span class="QuotedText">&gt; This is horrific. The idea that dead/untested/untrusted code has no cost is… I have no words.</span><br>
<p>
Point is, it's no cost to the developers. If there are no users, there are no bug reports, and nobody has to do anything.<br>
<p>
What they should do, imho, is flag this stuff as "unsupported, deprecated, not built by default". That way, it can wither on the vine until people complain that "it's stopped working". A fix to the build system to say "default no, deprecated" is a lot easier than a fix to delete it.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952133/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952387"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 20:25 UTC (Wed)
                               by <b>khim</b> (subscriber, #9252)
                              [<a href="/Articles/952387/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <font class="QuotedText">&gt; Point is, it's no cost to the developers. If there are no users, there are no bug reports, and nobody has to do anything.</font>

<p>It doesn't work like that. If there are no <b>legitimate</b> users there would be no bug reports.</p>

<p>If all the users of sysv filesystem are crackers who use to steal industrial secrets then there would be no bugreports, but that doesn't mean it's Ok to keep that code sitting there.</p>

<p>I'm actually surprised that no one raises the question of <b>drivers</b> that are unmaintained: pretending that you are some kind of strange USB gizmo is not hard, one <a href="https://www.youtube.com/watch?v=vOSpCoCmOns">may just use calculator</a> for that, no need to buy a dedicated hardware, so why there are so much discussion about hostile filesystems and not about other hostile hardware?</p>

<font class="QuotedText">&gt; What they should do, imho, is flag this stuff as "unsupported, deprecated, not built by default". That way, it can wither on the vine until people complain that "it's stopped working". A fix to the build system to say "default no, deprecated" is a lot easier than a fix to delete it.</font>

<p>For that to make sense default kernel config needs to be a bit closer to what distros use. Currently default kernel config is not related to what distros ship <b>at all</b>. Maybe <b>that</b> need to be fixed, too.</p>


      
          <div class="CommentReplyButton">
            <form action="/Articles/952387/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952388"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 20:29 UTC (Wed)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/952388/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; Currently default kernel config is not related to what distros ship at all. Maybe that need to be fixed, too.</span><br>
<p>
Yeah, general-purpose distros turn on pretty much everything, because one never knows what hardware (or filesystems, or netfilter stuff, etc) the user will have/want.  That used to be considered a good thing...<br>
<p>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952388/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952413"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 21:55 UTC (Wed)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/952413/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>Against that, having built a kernel with a huge number of modules, general-purpose distros often then package the modules in "sensible" chunks; for example, Fedora splits into <tt>kernel-modules</tt> and <tt>kernel-modules-extra</tt>, where "most" users don't need the latter.


      
          <div class="CommentReplyButton">
            <form action="/Articles/952413/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor952753"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 26, 2023 16:55 UTC (Sun)
                               by <b>patrakov</b> (subscriber, #97174)
                              [<a href="/Articles/952753/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The CIS benchmark actually requires the user to disable some filesystems. The automated check (which is what auditors and security companies use), unfortunately, requires that they are disabled in this particular way, or you won't get a free pass:<br>
<p>
Audit:<br>
Run the following commands and verify the output is as indicated:<br>
# modprobe -n -v udf<br>
install /bin/true<br>
# lsmod | grep udf<br>
&lt;No output&gt;<br>
<p>
Remediation:<br>
Edit or create a file in the /etc/modprobe.d/ directory ending in .conf<br>
Example: vim /etc/modprobe.d/udf.conf<br>
and add the following line:<br>
install udf /bin/true<br>
Run the following command to unload the udf module:<br>
# rmmod udf<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952753/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor954028"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 7, 2023 17:18 UTC (Thu)
                               by <b>Hello71</b> (subscriber, #103412)
                              [<a href="/Articles/954028/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That's actually a reasonable way to disable one filesystem though. The problem with CIS isn't their commands (usually), it's their whack-a-mole checklist bandwagon methodology. For example, it says to "disable secure redirects" by setting secure_redirects=0, but that actually disables redirect security checks, i.e. enables insecure redirects. They do also recommend setting accept_redirects=0 which actually does disable redirects, including secure redirects. So, their recommendation doesn't actually reduce security in this scenario, but it indicates that they don't have any idea what's actually going on, they just apply "security settings". Similarly, for filesystems, a correct approach (for servers at least) would be "disable automounting and only mount trusted disks", but that's hard to sell as a magic security script.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/954028/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor952131"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 18:46 UTC (Tue)
                               by <b>MarcB</b> (subscriber, #101804)
                              [<a href="/Articles/952131/">Link</a>] (18 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; Of course, if the Linux kernel developers don't even know which file systems are safe, how is user space even remotely going to be qualified to make that decision ...</span><br>
<p>
My impression is that the answer simply is: none are. If plain fuzzing is able to trigger bugs, even in the fully maintained filesystems, it is a given that smart/dedicated attackers can do so as well. Trying to come up with any maturity rating seems like a pointless guessing game.<br>
<p>
So the user space policy should be quite clear: Auto-Mount as little as possible. Ideally, only FUSE file systems that run as the currently logged in desktop user.<br>
Anything beyond that should require explicit configuration. In practice, anything more complex than VFAT will require some explicitly configured UID/GID mapping anyway, so it usually makes no sense to plug in a random disk. (And if it is a disk you are constantly using, then add it to fstab or create a mount unit).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952131/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952137"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 18:56 UTC (Tue)
                               by <b>ebassi</b> (subscriber, #54855)
                              [<a href="/Articles/952137/">Link</a>] (15 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; My impression is that the answer simply is: none are.</span><br>
<p>
Then we can pack up, and go home.<br>
<p>
<span class="QuotedText">&gt; So the user space policy should be quite clear: Auto-Mount as little as possible.</span><br>
<p>
You just said that no file system is safe, so "as little as possible" also means "don't mount the USB key I just plugged into my computer", which is going to go down like a lead balloon as soon as somebody installs Linux on their machine.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952137/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952139"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 19:58 UTC (Tue)
                               by <b>MarcB</b> (subscriber, #101804)
                              [<a href="/Articles/952139/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt;  Then we can pack up, and go home.</span><br>
<p>
As far as kernel filesystems go: It looks that way - unless someone is actually able to come up with a reliable list of secure file systems that still has meaningful overlap with actually used file systems. This seems unlikely.<br>
<p>
 &gt; You just said that no file system is safe, so "as little as possible" also means "don't mount the USB key I just plugged into my computer",...<br>
<p>
Which is why I mentioned (non-root) FUSE. The should easily be able to handle the USB key use case (which is the only use case that really works out-of-the-box anyway, because of the UID/GID mapping issue).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952139/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952161"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 23:36 UTC (Tue)
                               by <b>ebassi</b> (subscriber, #54855)
                              [<a href="/Articles/952161/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt;  Which is why I mentioned (non-root) FUSE.</span><br>
<p>
Sure, let's go with FUSE… except you don't get things like file monitoring on FUSE: <a href="https://github.com/libfuse/libfuse/issues/328">https://github.com/libfuse/libfuse/issues/328</a><br>
<p>
The FUSE2 vs FUSE3 situation is also still kind of problematic, with some stuff depending on one major version and conflicting with the other.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952161/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952205"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 10:00 UTC (Wed)
                               by <b>DemiMarie</b> (subscriber, #164188)
                              [<a href="/Articles/952205/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
FUSE is the supported and safe solution.<br>
<p>
It is quite clear that upstream filesystem developers simply do not have the resources to fix all of the bugs found by fuzzers.  There are too many vulnerabilities and not enough people to fix them.  Darrick J. Wong literally burned out over this.<br>
<p>
If GNOME needs to support mounting untrusted filesystem images, then it also needs to be responsible for fixing security problems that require malicious filesystems to exploit.  Otherwise users will continue to be in danger.<br>
<p>
I recommend spawning a separate virtual machine for each filesystem.  This is what libguestfs does, and it is the only reasonably secure approach.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952205/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952221"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 13:20 UTC (Wed)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/952221/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; If GNOME needs to support mounting untrusted filesystem images, then it also needs to be responsible for fixing security problems that require malicious filesystems to exploit. Otherwise users will continue to be in danger.</span><br>
<p>
s/GNOME/Linux/<br>
<p>
Fixed that for you.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952221/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952333"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 16:17 UTC (Wed)
                               by <b>DemiMarie</b> (subscriber, #164188)
                              [<a href="/Articles/952333/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      I really did mean GNOME.

Filesystem maintainers have stated that they do not have enough time to fix all the bugs found by fuzzing.  If fixing these bugs is important to GNOME, then GNOME needs to either do the work or persuade someone else (Red Hat?) to do so.


      
          <div class="CommentReplyButton">
            <form action="/Articles/952333/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952357"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 17:33 UTC (Wed)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/952357/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Let me quote you:   "If GNOME needs to support mounting untrusted filesystem images, [...] "<br>
<p>
Note the lack of "auto-" preceding "mounting"<br>
<p>
If the problem is the auto-mounting of filesystem images, then GNOME can do something about it.  However, the problem is deeper than that, and is a property of the underlying operating system (ie Linux).  So whether or not GNOME auto-mounts a malicious filesystem, or the user manually mounts the malicious filesystem [1], the problem remains.  <br>
<p>
I shouldn't have to point out that "mounting user-supplied filesystem images" is something that every non-toy system has to support as a basic, essential feature.  Every phone, every desktop system, and pretty much everything with a USB port. [2]<br>
<p>
You are blaming GNOME for a problem that lies outside its purview.   Should GNOME developers also be on the hook to fix buggy binary-only display drivers, or should they be able to rely on the promises those drivers make by claiming to support, say, OpenGL ES 3.2?<br>
<p>
[1] "Of course I want to access that USB stick, it's why I plugged it in!"<br>
[2] As it turns out, I can crash my car's radio by plugging in a well-formed filesystem that contains "too many" files.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952357/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor952404"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 21:23 UTC (Wed)
                               by <b>Conan_Kudo</b> (subscriber, #103240)
                              [<a href="/Articles/952404/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <p>FUSE is not a reasonable solution because virtually no Linux filesystems have actively maintained FUSE ports with parity to their in-kernel versions. An interesting solution would be to mainline the <a href="https://lkl.github.io/">Linux Kernel Library</a> project, which would allow all the in-kernel filesystems to be <em>easily</em> built as FUSE modules and run from user-space. We could then ship both variants and switch between them based on the trust domain of the storage itself.</p>
<p>Currently, it looks like <a href="https://github.com/lkl/linux/commits/master">the LKL code</a> is based on Linux kernel 6.1. Maybe someone who is interested in this can talk to them and help shepherd it into mainline.</p>


      
          <div class="CommentReplyButton">
            <form action="/Articles/952404/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952436"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 4:05 UTC (Thu)
                               by <b>DemiMarie</b> (subscriber, #164188)
                              [<a href="/Articles/952436/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
libguestfs solves this by doing the mount in a virtual machine.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952436/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor952217"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 12:56 UTC (Wed)
                               by <b>MarcB</b> (subscriber, #101804)
                              [<a href="/Articles/952217/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt;  Sure, let's go with FUSE… except you don't get things like file monitoring on FUSE: <a href="https://github.com/libfuse/libfuse/issues/328">https://github.com/libfuse/libfuse/issues/328</a></span><br>
<p>
This should not matter for the USB key use case. Everything else is so exotic that I cannot see how it justifies exposing everyone to this attack vector.<br>
If I want to use an external XFS filesystem (which is something I actually do), I can be bothered to configure this in fstab.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952217/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor952226"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 14:16 UTC (Wed)
                               by <b>smoogen</b> (subscriber, #97)
                              [<a href="/Articles/952226/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt;&gt; My impression is that the answer simply is: none are.</span><br>
<p>
<span class="QuotedText">&gt; Then we can pack up, and go home.</span><br>
<p>
I was told for the last 40 years, that it is generally impossible to make a 'general usage' filesystem 'safe' because of various 'logical paradoxes' ranging from Byzantine general to the halting problem. 'safe' is in quotes because you generally 'safe' filesystems come up with their own definition of safety which removes various 'freedoms' which open up the 'Devil's computer': 'the filesystem can't be removed or added after hardware initiation' , 'the filesystem has an outside of the operating system protector', etc. These usually remove the ability to use it in a 'general' purpose method versus a specialized method. And generally each of those descriptions also have 'methods of use' which if violated remove the 'safety'. AKA the system also assumes the drive which can't be removed or added after hardware initiation also can never be touched outside of the system (or that specific magnetic or electric fields won't be applied to it etc.)<br>
<p>
In the end, this is no different than waking up every morning. There are thousands of things which could cause us to end up in an unsafe condition of varying amounts. We have thus engineered our civilizations to put in lots of recovery methods to various extents, and usually that is enough to make us able to function the rest of the day. We have to engineer our systems in a similar method.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952226/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor952821"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 27, 2023 10:59 UTC (Mon)
                               by <b>DemiMarie</b> (subscriber, #164188)
                              [<a href="/Articles/952821/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
One option might be to rewrite the kernel filesystem implementations in safe Rust.  That should reduce the stream of vulnerabilities to a trickle, and I expect most of the remaining vulnerabilities to be denial of service only.<br>
<p>
Otherwise, the only safe solution is FUSE with a strong sandbox around the driver.  You can use libguestfs to mount any filesystem supported by Linux in a tightly sandboxed VM.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952821/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952823"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 27, 2023 12:09 UTC (Mon)
                               by <b>ojeda</b> (subscriber, #143370)
                              [<a href="/Articles/952823/">Link</a>] 
      </p>
      
      </div>
      </summary>
      Regarding Rust, I mentioned the idea of writing safe, read-only filesystems to a few people at LPC interested in experimenting with kernel Rust, using Wedson's recently posted <a href="https://lore.kernel.org/rust-for-linux/20231018122518.128049-1-wedsonaf@gmail.com/">VFS abstractions</a>. It would be interesting to see common filesystems implemented with those, even if read-only.



      
          <div class="CommentReplyButton">
            <form action="/Articles/952823/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor952948"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 27, 2023 18:01 UTC (Mon)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/952948/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; That should reduce the stream of vulnerabilities to a trickle, and I expect most of the remaining vulnerabilities to be denial of service only.</span><br>
<p>
Rust isn't going to do anything about lying disks unless their expectations are encoded in the type system in some way (e.g., an `inode` or `extent` object cannot be constructed unless its extents or sizes are verified as on-disk valid). That sounds terrible for performance if you ask me. It also does nothing to handle actively malicious hardware that changes data behind the kernel's back (any verification done basically becomes a TOCTOU in this situation…I don't see how it's possible to win here either). It'll fix buffer overflows (so if an extent metadata pointer has a mismatched size or something), but I don't think that's the kind of worry that is casting the shadow that is worried about here.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952948/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952952"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 27, 2023 18:58 UTC (Mon)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/952952/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <p>I think part of the fun here is deciding on what the threat model is; mine requires that the filesystem cannot be exploited to do anything other than read arbitrary blocks from the underlying block device, and write data that's deliberately written to the filesystem to blocks on the underlying block device (including metadata like updating mount counters). This has two corollaries:
<ol>
<li>A malicious storage device can only exploit the filesystem implementation to read or write other data on the same storage device. However, an entity creating such a storage device already has full access to read all the data on the device, and it's not on the filesystem implementation to prevent me writing interesting things to a device I can't trust.
<li>A crafted filesystem image can, at worst, result in creeping corruption of that filesystem, and not in damage to other filesystems on different storage devices, or even in different partitions on the same underlying device.
</ol>
<p>This is a threat model that isn't met by most in-kernel filesystems today - a suitably corrupt filesystem image on a non-malicious storage medium could, in principle, exploit the filesystem to the point of arbitrary code execution, which implies that a malicious storage device can do the same. In theory, a safe Rust filesystem implementation could meet my threat model, by parsing the filesystem, and ensuring that if the parsed data is crazy, the implementation errors out rather than overflowing a buffer or similar.


      
          <div class="CommentReplyButton">
            <form action="/Articles/952952/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor954299"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 10, 2023 3:15 UTC (Sun)
                               by <b>SAI_Peregrinus</b> (subscriber, #151778)
                              [<a href="/Articles/954299/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I agree with this threat model. <br>
<p>
It doesn't matter much if a filesystem can corrupt itself, as long as it can't corrupt the rest of the user's data. It matters a lot if a filesystem can corrupt the user's data on other filesystems.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/954299/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor952174"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 4:40 UTC (Wed)
                               by <b>dxld</b> (subscriber, #90530)
                              [<a href="/Articles/952174/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; only FUSE file systems that run as the currently logged in desktop user.</span><br>
<p>
I just want to point out that there's not much of a difference between root and the desktop user on a single-user machine. A rogue FS triggering an exploit to delete all of a user's files but not root's is still going to be plenty devastating.<br>
<p>
Ideally the system should start the FUSE filesystem implementation under a system user account (maybe even DynamicUser=yes) to at least have some isolation for when the impl. is buggy.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952174/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952362"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 18:39 UTC (Wed)
                               by <b>mcatanzaro</b> (subscriber, #93033)
                              [<a href="/Articles/952362/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Hm, this looks suspiciously close to an actual plan to improve the sorry situation. I wonder if this could work.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952362/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor952140"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 20:41 UTC (Tue)
                               by <b>ebiederm</b> (subscriber, #35028)
                              [<a href="/Articles/952140/">Link</a>] (28 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I tried having a session on this topic at Plumbers in 2018 in Vancouver. <br>
<p>
Unfortunately the right people did not show up to move this issue forward.<br>
<p>
As far as "safe" we have something like 3 filesystems believed to be safe: ramfs, tmpfs, and fuse.  They are marked that way in the kernel.<br>
<p>
Beyond that there are not any filesystems Itthat are safe to pick up in a parking lot, and plug into your computer.  Ext4 is the closest.  But no one supports safe operation against deliberately malformed filesystem images.<br>
<p>
If you limit yourself to ext4, fat, and isofs you have a reasonable chance to not be immediately pwned.<br>
<p>
There is a filesystem fuzzer that keeps running and reports how things break with deliberate filesystem corruption and it is burning out filesystem developers.<br>
 <br>
The very practical question is how do we get userspace to stop automounting filesystems, by default?<br>
<p>
The automounting of filesystems by userspace by default has never made sense as it has never been supported by the kernel.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952140/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952153"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 21:28 UTC (Tue)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/952153/">Link</a>] (18 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; The automounting of filesystems by userspace by default has never made sense as it has never been supported by the kernel.</span><br>
<p>
It is a very reasonable user expectation, going back all the way to the dawn of removeable storage.<br>
<p>
It's not "automounting" that is the problem, it's the fact that "of course I want to access this drive, it's why I plugged it in!" is the overwhelmingly common use case.  Even if the filesystems on the drive are not automounted, the user can be expected to immediately mount it (by double-clicking on an icon or whatever) and we're right back at square one.<br>
<p>
Please keep in mind that overwhelmingly common attack vector for these files isn't "maliciously malformed filesystem", it's "malicious files on a well-formed filesystem".<br>
<p>
<p>
<p>
<p>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952153/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952156"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 21:47 UTC (Tue)
                               by <b>ebiederm</b> (subscriber, #35028)
                              [<a href="/Articles/952156/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt;  It is a very reasonable user expectation, going back all the way to the dawn of removeable storage.</span><br>
<p>
Which is why the question I was trying to get answered at the time is how do we do this safely.<br>
<p>
The only answers I have found are fuse, and doing everything except the block device in user space.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952156/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952346"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 16:19 UTC (Wed)
                               by <b>DemiMarie</b> (subscriber, #164188)
                              [<a href="/Articles/952346/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Or in a guest virtual machine.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952346/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952383"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 19:59 UTC (Wed)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/952383/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; Or in a guest virtual machine.</span><br>
<p>
This would effectively collapse the "malicious filesystem" attack vector into the "malicious file on a well-formed filesystem" attack vector.<br>
<p>
Sure, it's an improvement, but it does feel like a major case of premature optimization, focusing on a 2% problem while ignoring the far-more-common 98%.<br>
<p>
(Meanwhile, how exactly are you supposed to designate a filesystem as "trusted" and what's to prevent an attacker from going after that designation, or subverting a supposedly-trusted filesystem?  Or are you advocating for forcing everyone to take a *massive* performance haircut by sandboxing _everything_?)<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952383/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor952397"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 21:08 UTC (Wed)
                               by <b>clump</b> (subscriber, #27801)
                              [<a href="/Articles/952397/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
A VM isn't a bad idea however it greatly increases the surface area for problems. libguestfs is a great tool however I've had guest mounts fail and I have no idea why. <br>
<p>
Mounts handled by VM's could be a good thing, however you then start down the path of putting everything risky in VM's or containers. This approach has its own challenges.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952397/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor952534"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 24, 2023 9:54 UTC (Fri)
                               by <b>geert</b> (subscriber, #98403)
                              [<a href="/Articles/952534/">Link</a>] (13 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Still, the GUI could offer some options or show some warnings, instead of blindly automounting anything. E.g.<br>
  - This is the first time you are mounting a &lt;foo&gt;fs? Do you want to mount it?<br>
      - For reading (and offer a "remount rw" option in the file manager),<br>
      - For reading and writing,<br>
      - Never auto-mount this type of file system,<br>
      [ ] Remember this choice.<br>
  - The device you just inserted is a multi-function USB device, and the storage part may be malicious. Are you sure you want to mount it?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952534/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952535"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 24, 2023 10:16 UTC (Fri)
                               by <b>mjg59</b> (subscriber, #23239)
                              [<a href="/Articles/952535/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
How do you expect an average user to have any insight into which filesystem types are trustworthy?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952535/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952542"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 24, 2023 11:19 UTC (Fri)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/952542/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; How do you expect an average user to have any insight into which filesystem types are trustworthy?</span><br>
<p>
You're expecting too little from your average luser - a big security mistake.<br>
<p>
Okay, well-trained lusers are hard to find, but if you can drum it in to them "if it looks odd, step back and think", you've won the battle. The "I'll click on anything" lusers are a lost cause whatever you do.<br>
<p>
One of my lusers was proud of me training her that way - "if something goes wrong, step away from that keyboard and mouse!". Didn't stop her regularly pestering me for help. But it massively increased my chances of being able to solve her problem.<br>
<p>
If we can train lusers to think "that looks suspicious", we've won.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952542/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor952540"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 24, 2023 11:16 UTC (Fri)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/952540/">Link</a>] (10 responses)
      </p>
      
      </div>
      </summary>
      <p>That last one is impossible to do perfectly - some multifunction USB devices appear as another vendor's mass storage (VID:PID copied from something the device manufacturer had lying around, I suspect), and reappear as their "real" function only when you send an "eject" SCSI command to them. But the real vendor's mass storage falls off the USB bus completely until replugged when you send it an "eject" command, which means that you can't send the eject command blindly; you first have to mount the device, see that the filesystem contents are that of the fake mass storage, and then unmount and eject.
<p>But given that the goal is to avoid mounting filesystems blindly, this is problematic. On top of that, how do you phrase "&lt;foo&gt;fs" so that it's human-friendly? As a nerd, I can handle "fat32", "exfat", "ntfs", "xfs", "hfsplus" etc in that position, but how do you expect an average computer user to know that "exfat", "hfsplus" and "udffs" are expected, but "sysv" is not?


      
          <div class="CommentReplyButton">
            <form action="/Articles/952540/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952543"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 24, 2023 11:27 UTC (Fri)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/952543/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Preface the file system type with "modern" or "legacy"?<br>
<p>
Not that that'll help a lot. We need to give the luser as much *relevant* information as possible (without overloading them) and hope that it either reassures them or raises a red flag. Which is highly context dependent so we can't make that decision for them.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952543/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952544"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 24, 2023 11:33 UTC (Fri)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/952544/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>Neither of those are particularly helpful in deciding if I should or should not mount this device; if I believe it came from an industrial control system running Windows 2000, should I mount it if it claims to be "legacy"? After all, Win2k is legacy by now, even though the likely FS on there is FAT32 or NTFS, which ought to be in the "modern" category.
<p>The only thing that works is to disable mounting from the GUI of filesystems that are deemed "too insecure". Then, as an advanced user, I can open a terminal and mount using sysv, adfs, or other unusual FS. But this now opens up a new problem - which filesystems are "secure enough" to automount?


      
          <div class="CommentReplyButton">
            <form action="/Articles/952544/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor952613"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 24, 2023 16:50 UTC (Fri)
                               by <b>geert</b> (subscriber, #98403)
                              [<a href="/Articles/952613/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You replace "&lt;foo&gt;fs" by more explanation.<br>
E.g. for hfsplus, you mention that it's typically used on Apple Macintosh systems; most people will understand that.<br>
E.g. for sysv, you mention that it's typically used on System V/Xenix/V7/Coherent systems, and that, unless you know what that means, you do not want to proceed.<br>
I guess the GUI usability people can come up with some sane wording ;-)<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952613/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952617"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 24, 2023 17:19 UTC (Fri)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/952617/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
But no matter what sort of explanation about the seen-it-before/age/type/quality/color/whatever is used, the overwhemingly common case is "Of course I want to access the device, that's why I plugged it in", turning the prompt/whatever into a completely subconscious, automatic "&lt;click on OK&gt;".<br>
<p>
Hate to say it, but the only path forward here seems to be to sandbox everything removeable (which in practice means everything other than stuff that shares the same physical drive as the rootfs) while (forever?) continiung to plug the bugs/holes in the implementations.<br>
<p>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952617/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952619"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 24, 2023 18:10 UTC (Fri)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/952619/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; But no matter what sort of explanation about the seen-it-before/age/type/quality/color/whatever is used, the overwhemingly common case is "Of course I want to access the device, that's why I plugged it in", turning the prompt/whatever into a completely subconscious, automatic "&lt;click on OK&gt;".</span><br>
<p>
As I said, you can't fix the "click on anything" luser.<br>
<p>
But if the user has plugged in a MOUSE, a "do you want to mount it?" prompt *should* raise eyebrows. If the user has found a USB stick in the car park, any information we can give them is a plus - provided they have minimal common sense (I know I know). Why abandon the lusers with a few working brain cells, all to avoid upsetting the lusers who have none?<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952619/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952620"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 24, 2023 18:22 UTC (Fri)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/952620/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <p>First, note that you do get a "do you want to mount this" prompt for each USB device that's plugged in - we only have to consider the case where the user is expecting to mount a USB device, but an attacker has set this up to break their security barriers (e.g. dropped off a USB stick in the car park with a malicious sysv filesystem on it).
<p>Second, there's a better policy than "hey, I could mount this" for all filesystems; allowlist a set of plausible external media filesystems, and only offer to mount devices that contain one of those filesystems. Make it hard to mount other filesystems (e.g. CLI tool, or option hidden in a menu instead of in the file manager sidebar); don't notify for filesystems that are suspicious.
<p>The only issue with this policy today is that there are filesystems (such as NTFS) that are plausible external media filesystems, but that aren't safe to mount if an attacker has had the chance to craft a malicious filesystem image.


      
          <div class="CommentReplyButton">
            <form action="/Articles/952620/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952624"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 24, 2023 19:23 UTC (Fri)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/952624/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; (e.g. dropped off a USB stick in the car park with a malicious sysv filesystem on it). </span><br>
<p>
...In other words, an attacker is after *you* specifically, already knows quite a lot about you and your environment, and has the resources and time to plan a stealthy attack.<br>
<p>
...In other words, you're already completely boned; you just don't know it yet.<br>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952624/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952632"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 24, 2023 22:57 UTC (Fri)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/952632/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>That's true for <em>any</em> attack on Linux users based on malicious filesystems right now; we're rare enough that you'd have to target us specifically, and not use a generic attack.
<p>And just because I found a USB stick in a car park doesn't mean it's targeting me - I could, for example, have picked it up in the grocery store parking lot, and it could have been targeted at the grocery store employees, not me. So the attacker knows very little about me and my environment, I'm just caught out because the grocery store environment is close enough to mine to be attacked.


      
          <div class="CommentReplyButton">
            <form action="/Articles/952632/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor952621"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 24, 2023 18:23 UTC (Fri)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/952621/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; But if the user has plugged in a MOUSE, a "do you want to mount it?" prompt *should* raise eyebrows. </span><br>
<p>
And I'm saying that no, it won't.<br>
<p>
<span class="QuotedText">&gt; Why abandon the lusers with a few working brain cells, all to avoid upsetting the lusers who have none?</span><br>
<p>
Because, even amongst infosec-aware folks, the _overwhelming overwhelming_ common use case will lure that prompt into an automatic, subconcious, "OK".<br>
<p>
It will barely budge the needle in the best case, and in the normal case, it'll just annoy users, if not become actually counterproductive.<br>
<p>
(Witness the Windows UAC escalation prompt, in case there's any doubt in what I'm saying)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952621/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952628"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 24, 2023 20:29 UTC (Fri)
                               by <b>johill</b> (subscriber, #25196)
                              [<a href="/Articles/952628/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; &gt; But if the user has plugged in a MOUSE, a "do you want to mount it?" prompt *should* raise eyebrows. </span><br>
<span class="QuotedText">&gt;  And I'm saying that no, it won't.</span><br>
<p>
It's pretty common for random devices to come with mass-storage of some sort integrated, for drivers or documentation. Some devices even require you to eject the "CD-ROM drive" before you can use them normally.<br>
<p>
So ... yeah, it won't?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952628/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor952158"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 22:32 UTC (Tue)
                               by <b>bartoc</b> (guest, #124262)
                              [<a href="/Articles/952158/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
     my impression is that modern GNOME doesn't automount (you need to actually click the filesystem to get it to mount),  and it strongly prefers to use fuse implementations for removable media even then. I think it might automount and use kernel filesystems for less removable media like SATA or SAS disks, NVME, etc.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952158/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952229"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 14:18 UTC (Wed)
                               by <b>cesarb</b> (subscriber, #6266)
                              [<a href="/Articles/952229/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; my impression is that modern GNOME doesn't automount (you need to actually click the filesystem to get it to mount)</span><br>
<p>
In my experience, it does automount hotplugged USB storage devices, going as far as asking for the LUKS password when the device is encrypted. I don't know if it has a whitelist, but at least VFAT, ext4, XFS, btrfs, and the CD/DVD filesystems (iso9660 and UDF) seem to be automounted.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952229/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor952227"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 14:08 UTC (Wed)
                               by <b>epa</b> (subscriber, #39769)
                              [<a href="/Articles/952227/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Safe operation against deliberately malformed filesystem images is currently not possible. But what about safe *read-only* operation? Do we perhaps have a chance at achieving that in a few limited cases?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952227/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor952365"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 19:03 UTC (Wed)
                               by <b>mcatanzaro</b> (subscriber, #93033)
                              [<a href="/Articles/952365/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Honestly I think you're approaching this problem with an unrealistic security model in mind. I will try to more precisely restate what others here have already mentioned. First, let's agree that the security risk of automounting a filesystem ***relative to manually mounting that same filesystem*** is zero. That is, if the user is going to manually mount the filesystem anyway, then automounting it doesn't make any security difference. Then the only remaining question is how likely are users to manually mount a filesystem that the desktop decided to not automount? This is up for debate, but I propose that users are *overwhelmingly* likely to want to manually mount the filesystem. It's not like users plug in USB devices or other storage media with the intent of not using them. So the desktop might as well go ahead and mount, because otherwise the user will imminently do so anyway. Automounting is convenient and will not make the user any less safe in practice.<br>
<p>
I view the discussion of whether or not to automount as a distraction from the real problem, which is how to make mounting filesystems safer. Fuzzing filesystems is surely part of the answer. Reducing the set of filesystems supported by the kernel, or perhaps making it harder to enable niche filesystems, would probably also be good to do. I also see an alternative proposal here that userspace should be using FUSE. I'm not familiar with FUSE and don't know if it's a good idea or not, but if nothing else at least that's attacking the underlying problem.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952365/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952392"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 20:56 UTC (Wed)
                               by <b>rra</b> (subscriber, #99804)
                              [<a href="/Articles/952392/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
One of the security threat models here does involve plugging in USB storage devices without intending to use them: they thought they were plugging in some other USB device that uses a file system as a malicious payload.<br>
<p>
It used to be that there were enough low-level attacks on the USB subsystem from a generic USB device being attached that one didn't need to bother to go all the way to a malicious file system, but I think a lot of them may have been cleaned up? It's possible that an automounted malicious file system hiding in a USB mouse or the like could now be the lower-effort attack.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952392/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952665"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 25, 2023 15:04 UTC (Sat)
                               by <b>mcatanzaro</b> (subscriber, #93033)
                              [<a href="/Articles/952665/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Actually I don't think generic attacks have been cleaned up. An easy example that we are still vulnerable to is the USB rubber ducky, which is a keyboard device that looks like a USB stick and can be programmed to submit malicious key presses. These are cheap and very easy to buy and deploy.<br>
<p>
The defense against such a device would be to present the user a dialog showing one picture of a USB storage device and one picture of a keyboard, and ask the user what device was plugged in? The user will click on the USB storage device, and then the desktop knows the user has plugged in a malicious device, without the user having to make any security decision. But we've never implemented this.<br>
<p>
That's a completely different problem to the malicious filesystem on a USB device, of course. A malicious filesystem is harder to defend against.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952665/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor952423"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 23:46 UTC (Wed)
                               by <b>cesarb</b> (subscriber, #6266)
                              [<a href="/Articles/952423/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; First, let's agree that the security risk of automounting a filesystem ***relative to manually mounting that same filesystem*** is zero. That is, if the user is going to manually mount the filesystem anyway, then automounting it doesn't make any security difference.</span><br>
<p>
There are at least two situations in which the user is not going to manually mount the filesystem anyway:<br>
<p>
1. The user is not even there. That is, if the screen is locked, it should never automount.<br>
<p>
2. The user did not think the device had a filesystem. For instance, the user thought the device was a keyboard or a mouse.<br>
<p>
As a borderline variant of this second situation, the device has multiple uses, and the user plugged the device to do something else. I often plug my smartphone into my computer to charge it, not to copy files from or to it (though I also do that occasionally).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952423/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952432"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 1:35 UTC (Thu)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/952432/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; As a borderline variant of this second situation, the device has multiple uses, </span><br>
<p>
I own two such devices; one is a cellular modem and the other is a label printer.  Both provide a mass-storage function containing a filesystem that contains the drivers/utilities necessary for $other_os to utilize the hardware.  I also own a pile of various microcontroller development boards that present entirely fake filesystems in order to facilitate easy, tool-less firmware updates.<br>
<p>
This approach is not new, and none of these device classes are terribly unusual.  (Incidently, earlier versions of the fake filesysstem on one of those microcontroller boards triggered pathological behavior and outright panics in the Linux USB stack, mass storage drivers, and even the FAT filesystem code!)<br>
<p>
But by all means, prevent auto-mounting when the user isn't physically present -- But what happens when the user returns?  Something I tend to do is plug a device into my system before I unlock it.  If someone else plugged in something as well, how do I identify which is the one I want, especially when it's quite common to have multiple mass storage devices plugged in at once?<br>
<p>
...And even if your device/filesystem is legitimate (ie well-formed) the files it contains more than likely are not trustable.  If the last decade of corporate security training has taught me anything, that's the threat vector they're most concerned about -- any anything truly sensitive has network access and/or USB ports completely disabled.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952432/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor952668"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 25, 2023 15:09 UTC (Sat)
                               by <b>mcatanzaro</b> (subscriber, #93033)
                              [<a href="/Articles/952668/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
1. Agreed, although the device will also be blocked by usbguard, which GNOME has supported for a while now. Distros should probably turn this on.<br>
<p>
2. Agreed, although I'm not sure why an attacker would go to the effort of making a keyboard present itself as a USB storage device. Maybe if you're trying to attack a secure facility where the employees know not to plug in USB storage devices but are allowed to use their own keyboards.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952668/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor952152"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 21:25 UTC (Tue)
                               by <b>ju3Ceemi</b> (subscriber, #102464)
                              [<a href="/Articles/952152/">Link</a>] (20 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The kernel devs answered your question : no filesystem code is safe against a crafted filesystem<br>
<p>
Hence : "This automounting exposes the system to security threats and is always a bad idea"<br>
<p>
You (the people who did automount) are doing something insecure by design<br>
Live with it and stop doing it<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952152/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952159"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 23:29 UTC (Tue)
                               by <b>ebassi</b> (subscriber, #54855)
                              [<a href="/Articles/952159/">Link</a>] (19 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Ask yourself this: what difference does it make if the device with the file system gets mounted automatically, or the user mounts it themselves as soon as it's available?<br>
<p>
If the answer is: "we get to blame the user, now", then please stop writing software or administering systems, and go do something else with your time.<br>
<p>
Otherwise, you need to figure out what to do when that happens.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952159/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952172"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 3:09 UTC (Wed)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/952172/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; If the answer is: "we get to blame the user, now", then please stop writing software or administering systems, and go do something else with your time.</span><br>
<p>
Workstations are hardly the primary use case of the kernel. Most Linux devices are Android; if you exclude them, most are probably in a server rack somewhere. Nobody should be plugging random drives into a server, and I think it is rare in practice to plug things into Androids too.<br>
<p>
In other words: For the vast majority of real actual Linux systems, automounting or even manual mounting is completely unnecessary (other than at boot time).<br>
<p>
I realize this is a somewhat unhelpful response, for the GNOME people, but nobody ever said that supporting GNOME is or should be the kernel's top priority.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952172/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952193"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 9:41 UTC (Wed)
                               by <b>tux3</b> (subscriber, #101245)
                              [<a href="/Articles/952193/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'm not sure I understand. Is the argument that we should not solve problems for workstation and laptop users of Linux, because there are many more people who have phones?<br>
This is a philosophy that works best if one is always part of the majority group, but I don't see that the kernel can't try to solve multiple problems at the same time and try to serve different types of users.<br>
<p>
Regardless, unmaintened filesystems don't cause trouble only for lap &amp; desk top users. Even from a purely inward-looking angle, I'm fairly sure server admins shouldn't see a reason to complain if filesystems they don't use are more clearly marked deprecated (or removed in an orderly manner), simplifying maintenance of the kernel they use.<br>
<p>
Arguing that people shouldn't solve problems you don't have is already a dubiously noble endeavor, but especially when everyone would benefit from a clean solution. The maintenance cost of entire filesystems that no one understands is not negligible.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952193/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor952200"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 9:50 UTC (Wed)
                               by <b>DemiMarie</b> (subscriber, #164188)
                              [<a href="/Articles/952200/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Android mounts untrusted f2fs filesystems on literally every boot.  If one can compromise Linux via a malicious f2fs filesystem, then one can bypass Android Verified Boot and persist a kernel compromise even after the initial bug that allowed it was patched.<br>
<p>
ChromeOS does the same thing with untrusted ext4 images and ChromeOS’s verified boot feature.<br>
<p>
If someone is aware of a security vulnerability in ext4 or f2fs that is not obviously limited to denial of service, that should be reported to the ChromeOS or Android security teams, respectively.  This includes problems found by fuzzers.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952200/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor952389"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 20:36 UTC (Wed)
                               by <b>khim</b> (subscriber, #9252)
                              [<a href="/Articles/952389/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <font class="QuotedText">&gt; Most Linux devices are Android</font>

<p>Which, of course, automatically mount filesystems from USB sticks, too.</p>

<p>Apple tried to resist for a long time (not because of security, but because they wanted to sell larger-storage models for extra $$), but today iPad <a href="https://support.apple.com/guide/ipad/external-storage-devices-ipad75b7b23f/ipados">does that</a>, too.</p>



      
          <div class="CommentReplyButton">
            <form action="/Articles/952389/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952390"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 20:38 UTC (Wed)
                               by <b>ju3Ceemi</b> (subscriber, #102464)
                              [<a href="/Articles/952390/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Are those mounted in kernel space ?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952390/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952391"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 20:42 UTC (Wed)
                               by <b>khim</b> (subscriber, #9252)
                              [<a href="/Articles/952391/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>Most of the time, yes. Remember that story <a href="https://sfconservancy.org/news/2013/aug/16/exfat-samsung/">when Samsung was pushed to publish sources for it's exFAT driver</a>. Why do you think it even developed that driver in the first place, hmm?</p>



      
          <div class="CommentReplyButton">
            <form action="/Articles/952391/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor952189"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 9:18 UTC (Wed)
                               by <b>ju3Ceemi</b> (subscriber, #102464)
                              [<a href="/Articles/952189/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You know, anybody can quite easily plug an USB stick in the back of my workstation, at work, I would not notice<br>
So when you say "the user", you mean "one human which is not necessarily the user but could be a malicious actor"<br>
<p>
But in fact, none of this matter.<br>
You have the current situation now : mounting untrusted filesystem is a security issue.<br>
Now, you must move based on that.<br>
<p>
You took the decision the carry that burden and push your users at risk without them even knowing something is happening.<br>
That is your call.<br>
<p>
I am a user too, and I do not automount stuff. When I plug a stick, I click "mount" and the stuff is mounted. And if I have no idea what the device that just spawned is, then I do not mount it.<br>
<p>
Indeed, fixing all the code in the world to make is secure would be nice. In the meantime, here we are.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952189/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor952209"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 10:07 UTC (Wed)
                               by <b>DemiMarie</b> (subscriber, #164188)
                              [<a href="/Articles/952209/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The filesystem should be mounted via FUSE in a tightly sandboxed environment, such as a KVM VM.  The sandbox then becomes the security boundary: an attacker can compromise the sandbox, but cannot then compromise the rest of the system.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952209/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor952216"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 11:30 UTC (Wed)
                               by <b>MarcB</b> (subscriber, #101804)
                              [<a href="/Articles/952216/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt;  Ask yourself this: what difference does it make if the device with the file system gets mounted automatically, or the user mounts it themselves as soon as it's available?</span><br>
<p>
This turns the attack from "simply plug this key into an unattended laptop" into "trick the laptop's owner into mounting it". This likely is much harder.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952216/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952222"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 13:47 UTC (Wed)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/952222/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; This turns the attack from "simply plug this key into an unattended laptop" into "trick the laptop's owner into mounting it". This likely is much harder.</span><br>
<p>
Then it's a good thing that the former doesn't automatically mount, eh?<br>
<p>
(I just verified this behaviour by plugging a storage device into my locked F39 laptop running GNOME 45 -- the kernel dmesg shows the device was detected, but nothing was mounted until I unlocked the screen then clicked on it)<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952222/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor952439"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 4:40 UTC (Thu)
                               by <b>magnus</b> (subscriber, #34778)
                              [<a href="/Articles/952439/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
On the desktop there could be a warning when first mounting an external (usb) drive that has not been seen before based on vendor and maybe some basic information that could be safely extracted from the drive without mounting it. And then maybe a "safe mode" allowing basic file browsing without mounting as if it was a zip file or such, possibly with the parsing isolated into a separate process. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952439/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952449"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 7:54 UTC (Thu)
                               by <b>mjg59</b> (subscriber, #23239)
                              [<a href="/Articles/952449/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If it's acceptable to mount the filesystem in some external process then why not just do that all the time? USB devices don't cryptographically verify their identity, so you can't simply trust data that the device is giving you in order to determine whether or not the data on it is trustworthy.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952449/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952455"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 9:07 UTC (Thu)
                               by <b>magnus</b> (subscriber, #34778)
                              [<a href="/Articles/952455/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
What i meant (maybe unclearly) was that you could have a user space process that understands the file system layout and just accesses the raw drive directly with read/write/seek and acts as a kind of ftp server for the drive, and in worst case crashes on a corrupted fs without taking the system with it. That would be for cases where you just want to browse contents of an untrusted usb drive and copy the odd file or so but wouldnt be a substitute for a proper mount.. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952455/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952460"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 10:07 UTC (Thu)
                               by <b>mjg59</b> (subscriber, #23239)
                              [<a href="/Articles/952460/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Isn't this just FUSE?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952460/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952462"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 11:00 UTC (Thu)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/952462/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <p>I read the comment as closer to <a href="https://wiki.gnome.org/Projects/gvfs">GVfs</a> in intent than to FUSE; a library that lets you read and write the FS using special case operations so that you know you're not on a trusted FS, but on a possibly untrusted device.


      
          <div class="CommentReplyButton">
            <form action="/Articles/952462/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952463"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 11:09 UTC (Thu)
                               by <b>mjg59</b> (subscriber, #23239)
                              [<a href="/Articles/952463/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I don't really see a beneficial difference there? You're going to go through the same amount of parsing code and it's going to be subject to the same set of vulnerabilities, so having that be out of process rather than in process seems like it's easier to impose constraints on it<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952463/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952464"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 11:22 UTC (Thu)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/952464/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>Both FUSE and GVfs put the FS parsing code in a separate process; the only significant difference is that the preferred way to access a FUSE protocol filesystem is to mount it like a "trusted" kernel filesystem, while GVfs is accessed via GIO calls that turn into DBus method calls. This means that if I have a GVfs style filesystem, it's harder to chain attacks into loading code from the filesystem than if I've got a FUSE filesystem (for example, if there's a bug in the program that I can exploit to make it pass an arbitrary path to <tt>dlopen</tt> or equivalent, I can't use it to <tt>dlopen</tt> something on a GVfs type filesystem, but I can in theory use it to <tt>dlopen</tt> something on a FUSE filesystem).
<p>That said, GNOME promptly breaks the extra security benefits of GVfs by having a FUSE bridge that automounts the filesystems as FUSE filesystems, so it's a wash in practice.


      
          <div class="CommentReplyButton">
            <form action="/Articles/952464/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor952513"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 20:26 UTC (Thu)
                               by <b>magnus</b> (subscriber, #34778)
                              [<a href="/Articles/952513/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I guess i was thinking about avoiding vulnerabilities in FUSE itself and also allowing a much smaller set of operations (basic file access but no mmaping etc) but maybe FUSE is simple enough to make the risk of using it low?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952513/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952525"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 24, 2023 4:12 UTC (Fri)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/952525/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The kernel-side FUSE was from the start designed to be robust against malicious data. BTW, it does support mmap.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952525/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor952381"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Userspace developers here!</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 19:41 UTC (Wed)
                               by <b>mcatanzaro</b> (subscriber, #93033)
                              [<a href="/Articles/952381/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; A few developers expressed frustration with a perceived inability to get a response from user-space developers on topics like this.</span><br>
<p>
Hmm, it seems like we have some communication issues to resolve. Just getting in touch shouldn't be hard.<br>
<p>
ebassi and myself both represent the GNOME security team, and we're both participating in the comments here on this LWN article, so you've at least got our attention if nothing else. We have left our thoughts regarding automounting in other comments on this article.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952381/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor952127"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 17:18 UTC (Tue)
                               by <b>josh</b> (subscriber, #17465)
                              [<a href="/Articles/952127/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt;  Hellwig concurred with the problem, saying that there is an implicit assumption in the community that this sort of API cleanup is a low-priority task; as a result it is easily blocked. There needs to be a way to force developers to move to newer APIs. Bergmann mentioned the desire to remove high memory, but 32-bit Arm still needs it, so it cannot be removed from anywhere, imposing significant costs on the kernel as a whole. Chinner complained that increasing amounts of work are being placed on maintainers to keep old code working; maintainers are at the limit of what they can do now, and this path is unsustainable, he said. </span><br>
<p>
If it's permitted to mark things as deprecated, and produce warnings when building architectures/drivers that haven't been updated, that'd be a substantial improvement. Usually producing new warnings is not allowed; if it were allowed that'd help nudge architecture/driver maintainers in the right direction.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952127/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor952136"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 19:14 UTC (Tue)
                               by <b>ballombe</b> (subscriber, #9523)
                              [<a href="/Articles/952136/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I never had any sympathy with the 'no bug report -&gt; no user' perspective.<br>
This is the wrong logic to apply.  Bugs are not a communication medium.<br>
If you want to know about users of your code, reach out to them, do not expect them to report spurious bugs just so you know they exist. Even if you purposely break the code to see whether they complain, the broken version might take years to reach them.<br>
<p>
Also sometime reporting a bug in a feature leads to the feature to be removed rather than fixed (e.g. console scrolling),<br>
so the incentive to report a bug can be negative.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952136/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952142"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2023 20:00 UTC (Tue)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/952142/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt;  I never had any sympathy with the 'no bug report -&gt; no user' perspective.</span><br>
<p>
Especially when the users expected to make the most use of these "obsolete" filesystems are most likely using Enterprise or LTS-type distributions, meaning that there could easily be literally years between a filesystem getting dropped upstream and the user discovering their old filesystems can't be read any more.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952142/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor952166"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 0:54 UTC (Wed)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/952166/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Preventing automounting doesn't really solve any problem.<br>
The user will mount a drive that the user has just plugged in. Why else would the user plug it in?<br>
<p>
The only solution is to fix the safety bugs in the filesystems and to completely disable or drop filesystems that nobody wants to fix.<br>
And the real problem here is social. Not technical.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952166/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952402"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 21:21 UTC (Wed)
                               by <b>hmh</b> (subscriber, #3838)
                              [<a href="/Articles/952402/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It does.  Requiring an user acknowledgement to mount avoids several issues such as passerby plugs device into a locked computer.<br>
<p>
In fact, automounting is so bad an idea, it is *not* done by default anymore in any distro, as far as I know.<br>
<p>
There is a report in this article comments already that fedora does not do this kind of foolhardy temerary automounting on gnome, and I know for a fact Debian doesn't do it in KDE (did not try gnome).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952402/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor952465"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 11:38 UTC (Thu)
                               by <b>dezgeg</b> (subscriber, #92243)
                              [<a href="/Articles/952465/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Would the user still be willing to mount if they'd see beforehand that the filesystem type is sysv or something equally weird/obsolete? <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952465/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952490"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 15:50 UTC (Thu)
                               by <b>anselm</b> (subscriber, #2796)
                              [<a href="/Articles/952490/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <blockquote><em>Would the user still be willing to mount if they'd see beforehand that the filesystem type is sysv or something equally weird/obsolete?</em></blockquote>
<p>
I'd say relying on random users being able to tell which file system implementations in the Linux kernel are weird, obsolete, etc. is probably a little naive. IMHO it's fairly safe to assume that people will just click on “OK” to get rid of the prompt.
</p>


      
          <div class="CommentReplyButton">
            <form action="/Articles/952490/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952539"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 24, 2023 10:44 UTC (Fri)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/952539/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>About the only way you can make that work, at all, is a whitelist, where you can click to mount "likely" filesystems (FAT32, exFAT, NTFS, xfs, ext4 etc), but need to do more work to mount an "unlikely" filesystem (sysv, minix etc) such as going into the filesystem reformatting tool and telling it you want to mount the filesystem.
<p>Even then, this isn't perfect, since there is a route to getting you to mount the filesystem by clicking, and malware will come with instructions telling you to do just that.


      
          <div class="CommentReplyButton">
            <form action="/Articles/952539/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor952176"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 4:49 UTC (Wed)
                               by <b>dxld</b> (subscriber, #90530)
                              [<a href="/Articles/952176/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I wonder, has anyone considered it's not the automounting itself that's the problem, but automounting while the system's owner is not in front of the machine?<br>
<p>
GrapheneOS has this setting to only allow USB devices to be enumerated when the screen isn't locked. Seems that's what we need on the Linux desktop too. I've implemented something like that for one of my embedded projects and it's actually pretty easy to implement: <a href="https://docs.kernel.org/usb/authorization.html">https://docs.kernel.org/usb/authorization.html</a> <br>
<p>
--Daniel<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952176/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952401"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 22, 2023 21:14 UTC (Wed)
                               by <b>hmh</b> (subscriber, #3838)
                              [<a href="/Articles/952401/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You likely want to allow HID devices through, otherwise you can shoot yourself very hard on the foot way too easily, if you  need said HID device to unlock and it goes through a disconnect event.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952401/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952452"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 8:20 UTC (Thu)
                               by <b>dxld</b> (subscriber, #90530)
                              [<a href="/Articles/952452/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Hmm. True, phones don't have that problem. Me personally I'd be happy to trade of not being able to unplug/replug HID devices for additional rogue USB protection as you can always just hit that (ACPI) power button to reboot, but I don't see a fundamental reason it shouldn't be possible to still allow HID devices through while locked.<br>
<p>
I might worry about the device switching role (HID-&gt;storage) while plugged, but IIRC only the host is allowed to change the selected USB device configuration but that'd be something to audit and test.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952452/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor952469"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 12:59 UTC (Thu)
                               by <b>ebassi</b> (subscriber, #54855)
                              [<a href="/Articles/952469/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; Seems that's what we need on the Linux desktop too.</span><br>
<p>
GNOME already requires an unlocked session for mounting USB devices.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952469/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor952441"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 6:32 UTC (Thu)
                               by <b>gdt</b> (subscriber, #6284)
                              [<a href="/Articles/952441/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
API-wise, user-space needs more information than just the estimate of robustness of the driver. Some filesystem information such as the label, size, creation date and other dates would assist users in deciding if the volume is to be mounted. That's going to require a specific function in every filesystem driver, so that those fields are retrieved from the superblock with the least possibility of bugs.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952441/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952448"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 7:52 UTC (Thu)
                               by <b>mjg59</b> (subscriber, #23239)
                              [<a href="/Articles/952448/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Why would any of that inform a user of whether they should mount the filesystem? Why would any hostile actor not simply set those values to something the user expects?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952448/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor952538"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 24, 2023 10:49 UTC (Fri)
                               by <b>gdt</b> (subscriber, #6284)
                              [<a href="/Articles/952538/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If hostile actors are a threat, then no USB storage which has ever passed out of the control and knowledge of the user should be connected to the system, let alone be considered for mounting. The user should regard the contents as irretrievable and shred the storage so the contents can't be retrieved by parties with more appetite for risk.<br>
<p>
Outside the infosec bubble, risks are gauged with more nuance. Information about the filesystem can prompt the user's memory if they have retained some form of control over the USB storage, even if that's a decade in a drawer.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952538/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor952456"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 9:03 UTC (Thu)
                               by <b>taladar</b> (subscriber, #68407)
                              [<a href="/Articles/952456/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; Hellwig said that there would need to be at least three levels: "no trust", "generally maintained but don't mount untrusted images", and "well maintained".</span><br>
<p>
If the kernel does add some sort of filesystem trust level the "actively developed but not yet ready for production use" use cases should also be considered since it is not just deprecated and unmaintained code that should not be used automatically.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952456/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor952482"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 23, 2023 14:38 UTC (Thu)
                               by <b>jd</b> (guest, #26381)
                              [<a href="/Articles/952482/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Obviously Reiserfs and Reiser4 are problematic, but what other filesystems are being eyeballed as potentially unused?<br>
<p>
It's worth considering that a lot of the filesystems on Linux have a range of use cases where they're optimal, but that many Linux distros default to single partitions rather than a mix-match approach with several partitions, and offer a very limited subset of filesystems even with manual partitioning. <br>
<p>
The practical upshot is that filesystems that are actually very useful and would improve a user's experience will be underutilised due to the added difficulty.<br>
<p>
I can understand why distros do this (it's easier to write and test the installer, behaviour is more predictable, and users have less to track), but if it's leading to user experiences being impacted and genuinely useful features withering on the vine, maybe that needs rethinking.<br>
<p>
The effort involved in installing new filesystems tools, reformatting partitions, and setting them back up is going to deter most people.<br>
<p>
It just bothers me that filesystems that might actually be really valuable might end up being chopped, where ultimately it's because to keep the installer simpler/smaller. <br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952482/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor952684"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 25, 2023 18:36 UTC (Sat)
                               by <b>raven667</b> (subscriber, #5198)
                              [<a href="/Articles/952684/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
What about waiting for an explicit action from the user accessing the filesystem to mount it, either clicking on it in the GUI or cd into the directory from cli with limits for automation like indexing utilities that might accidentally activate the mount. That should reduce a number of casual attack vectors where stuff happens in an unattended way, in addition to not mounting when locked and using sandboxed FUSE for removable media. <br>
<p>
Mechanisms dont have to be perfect to be useful <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/952684/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor953538"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Trust in and maintenance of filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 1, 2023 17:22 UTC (Fri)
                               by <b>mrshiny</b> (subscriber, #4266)
                              [<a href="/Articles/953538/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I don't understand the mentality of "don't check for security bugs in unmaintained code". If the code can't be removed, then those security bugs are still security bugs regardless of whether or not someone wants to fix them.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/953538/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2023, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
