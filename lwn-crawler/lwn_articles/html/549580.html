        <!DOCTYPE html>
        <html lang="en">
        <head><title>(Nearly) full tickless operation in 3.10 [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/549580/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/549089/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/549580/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>(Nearly) full tickless operation in 3.10</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Ready to give LWN a try?</b>
<p>
With a subscription to LWN, you can stay current with what is happening in the Linux and free-software community and take advantage of subscriber-only site features.  We are pleased to offer you <b><a href="https://lwn.net/Promo/nst-trial/claim">a free trial subscription</a></b>, no credit card required, so that you can see for yourself.  Please, join us!
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>May 8, 2013</br>
           </div>
On a typical Linux system, each running CPU will be diverted between 100
and 1000 times each second by the periodic timer interrupt.  That interrupt
is the CPU's cue to reconsider which process should be running, catch up
with read-copy-update (RCU) callbacks, and generally handle any necessary
housekeeping.  This periodic "tick" can be reasonably compared to the
infamous big kernel lock (BKL): it is convenient to have around, but it
also has an effect on performance that makes developers wish to abolish it.
The key difference might be that getting rid of the timer tick has taken
rather longer than was required to eliminate the BKL.  The 3.10 kernel will
take an important step in that direction, though, with the addition of the
"full NOHZ" mode — but a lot of limitations still apply.
<p>
Linux has had a partial solution to the timer tick problem for years in the form of the
<tt>CONFIG_NO_HZ</tt> configuration option.  If that option is set, the
timer tick will be turned off, but only 
when the CPU is idle.  This mode improves the situation considerably; it
allows idle CPUs to stay in deep sleep states, reducing power use.  Systems
with virtualized guests also benefit, since, otherwise, each guest
would be servicing timer interrupts when it should be doing nothing.
In short: disabling the timer tick when the processor is idle makes enough
sense that most distributions do it by default.
<p>
Indeed, given that letting sleeping CPUs lie is generally a good policy,
one might 
wonder why this behavior is optional at all.  The answer is that it
increases the cost of moving into and out of the idle state, (very)
slightly increasing the time it takes to get an idle CPU back to work.
That cost may be considered excessive in highly latency-sensitive
environments.  For everybody else, disabling the timer tick for idle CPUs
is almost certainly the right thing to do; for battery-powered systems that
is doubly true.
<p>
The next step — disabling the tick for non-idle processors — is a lot
more work with a smaller reward, so it is not surprising that it has taken
a while to come about.  Frederic Weisbecker finally <a
href="/Articles/420544/">took up the challenge</a> in 2010; after a lot of
changes and help by others (Paul McKenney made <a
href="/Articles/522262/">some significant RCU changes</a>, for example),
this work has been pulled into the 3.10 kernel.
<p>
In 3.10, the <tt>CONFIG_NO_HZ</tt> option has been replaced by a three-way
choice:
<p>
<ul>
<li> <b><tt>CONFIG_HZ_PERIODIC</tt></b> is the old-style mode wherein the 
     timer tick runs at all times.
<li> <b><tt>CONFIG_NO_HZ_IDLE</tt></b> (the default setting) will cause the tick
     to be disabled at idle, the way setting <tt>CONFIG_NO_HZ</tt> did in
     earlier kernels.  
<li> <b><tt>CONFIG_NO_HZ_FULL</tt></b> will enable the "full" tickless mode.
</ul>
<p>
The build-system code has been set up so that
"<tt>make&nbsp;oldconfig</tt>" on 3.10 should yield a configuration that
matches the previous setting of <tt>CONFIG_NO_HZ</tt>  with no intervention
required.  Full tickless 
mode defaults to off; selecting that mode will enable tasks to run without
the timer tick, but there are a number of things to be aware of.
<p>
Among those are the requirement that the CPUs available for running without
a timer tick must be designated at  boot time using the
<tt>nohz_full=</tt> command-line parameter.  The boot CPU cannot run in
this mode — at least one CPU needs to continue to receive interrupts and do
the necessary housekeeping.  The <tt>CONFIG_NO_HZ_FULL_ALL</tt>
configuration option causes all CPUs (other than the boot CPU) to run in
the full tickless mode by default; it can still be overridden with
<tt>nohz_full=</tt>, though.  The set of full tickless CPUs cannot be
changed after boot; 
the amount of work required to make that possible would be large, and there
does not seem to be a pressing need for this ability.

<p>
Even then, a running CPU will only disable the timer tick if there is a
<i>single</i> runnable process on that CPU.  As soon as a second process
appears, 
the tick is needed so that the scheduler can make the necessary time-slice
decisions.  And even with a single runnable process, it is not technically
tickless, since the timer tick still needs to happen at least once per
second to keep the scheduler happy.  But dropping from as high as 1000Hz to
1Hz is obviously a significant improvement.  Response-time jitter due to
timer interrupts will be nearly eliminated, and, <a
href="/Articles/549592/">according to Ingo Molnar</a>, as much as 1% of the
CPU's time will be saved.  
<p>
There are workloads out there that will benefit significantly from those
improvements.  High-performance computing (HPC) and realtime are obvious
candidates; in both cases, dedicating a CPU to a single task is a fairly
common tactic already.  But, in an era where even phones have quad-core
processors, having a single runnable process on a given CPU is not an
uncommon situation.
<p>

There are a lot more details to making full tickless operation work
properly; setting up a system to use this feature requires a fair amount of
fiddling at this time.  At a minimum, the administrator should make
extensive use of CPU affinities to keep unwanted processes (including
kernel threads) off the relevant processors.  Some RCU configuration is
required as well; see <a
href="/Articles/549593/">Documentation/timers/NO_HZ.txt</a> for lots of
details on the various options.

<p>
Full tickless operation, as seen in 3.10, is clearly a significant step
forward, but, equally clearly, this project is not yet complete.  There is a
fair amount of detail work to be done, including making the feature work on
32-bit processors (a patch exists), getting rid of that final
once-per-second tick, mitigating some unfortunate side effects on the
scheduler's statistics and load balancing, and fixing the inevitable bugs.
This is a large and invasive change to how the core kernel works; there
will almost certainly be some surprising behaviors that emerge once the tickless
mode starts to get wider testing.
<p>
The biggest item on the "to do" list, though, must surely be getting rid of
the single-runnable-process requirement.  Just in case the developers
involved did not already feel that way, Linus <a
href="/Articles/549595/">made his opinion on the matter clear</a>:
<p>
<div class="BigQuote">
	So as long as the NOHZ is for HPC-style loads, then quite frankly,
	I don't feel it is worth it. The _only_ thing that makes it worth
	it is that "future plans" part where it would actually help real
	loads.
</div>
<p>
So, chances are, this limitation will be removed from the tickless
implementation in some future development cycle, along with the other
various rough edges.  In the meantime, the 3.10 kernel will contain a
significant step forward in the evolution of the core Linux kernel: the
partial removal of a source of latency and overhead that has been there
since the very first kernel release.  Not even the big kernel lock endured
anywhere near that long.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Dynamic_tick">Dynamic tick</a></td></tr>
            <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Read-copy-update">Read-copy-update</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/549580/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor549659"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 8, 2013 16:12 UTC (Wed)
                               by <b>busterb</b> (subscriber, #560)
                              [<a href="/Articles/549659/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
So, what's the solution for running &gt;1 process per CPU with NO_HZ_FULL? Use syscalls as the hook for an implicit schedule 'pump'?<br>
<p>
Requiring the user to explicitly schedule with 'sched_yield' to produce a cooperative multitasking scenario might work well. I've worked on enough realtime systems to know that this can yield good performance if done correctly (since your performance-critical sections never get interrupted without you saying so), though it occasionally bites you if you forget to yield somewhere, e.g. waiting for a lock. I know I would have liked to have  had something like this in past system designs Instead, 'yielding' was done with coroutines or tasklets/threads.<br>
<p>
What about having the boot cpu do all the scheduling for all the other CPUs? Basically treat the other CPUs like a thread pool and distribute processes. Is the cost of IPIs too much for this to be practical?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/549659/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor549664"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 8, 2013 16:22 UTC (Wed)
                               by <b>busterb</b> (subscriber, #560)
                              [<a href="/Articles/549664/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
On a related note, it seems like quite a few multi-core SoC vendors have implemented their own patches for this behavior as well, e.g. Tilera's 'zero overhead' Linux. Glad to see if it becomes mainstream, maybe they'll all adopt just one way to do it.<br>
<p>
<a href="http://www.6windblog.com/linux-based-fast-path/">http://www.6windblog.com/linux-based-fast-path/</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/549664/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor549667"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 8, 2013 16:24 UTC (Wed)
                               by <b>simlo</b> (guest, #10866)
                              [<a href="/Articles/549667/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
After a little RTFC, I found that a HR-timer was used to calculate the next preemption point. I.e. instead of preempting on 100 Hz clock, it preempts exactly when the timeslot of the current process ends.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/549667/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor549699"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 8, 2013 18:50 UTC (Wed)
                               by <b>blitzkrieg3</b> (guest, #57873)
                              [<a href="/Articles/549699/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Okay, this makes absolutely perfect sense, but because of the way operating systems have been designed for the past 40 years, that solution completely eluded me.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/549699/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor549702"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 8, 2013 19:48 UTC (Wed)
                               by <b>intgr</b> (subscriber, #39733)
                              [<a href="/Articles/549702/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I got the same impression as you. I think the wording in the article is unfortunate.<br>
<p>
<font class="QuotedText">&gt; Even then, a running CPU will only disable the timer tick if there is a single runnable process on that CPU. As soon as a second process appears, the tick is needed so that the scheduler can make the necessary time-slice decisions</font><br>
<p>
It's misleading to call it "the tick" if it's not fixed to the HZ any more, seems more like a preemption timer.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/549702/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor549705"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 8, 2013 19:52 UTC (Wed)
                               by <b>corbet</b> (editor, #1)
                              [<a href="/Articles/549705/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      Confused.  If two processes are running, the period tick will run just like it does now.  What am I missing?  What is misleading?
      
          <div class="CommentReplyButton">
            <form action="/Articles/549705/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor549707"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 8, 2013 20:23 UTC (Wed)
                               by <b>intgr</b> (subscriber, #39733)
                              [<a href="/Articles/549707/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Sorry, it's much more likely that I am missing something.<br>
<p>
AFAICT the scheduler doesn't switch tasks at every timer tick, even when there is contention for a CPU -- it has its own concept of timeslice length that changes with load. So why does a contended CPU need to run the timer tick if it's not going to switch tasks?<br>
<p>
And grandparent wrote something that seemed to match that line of thinking:<br>
<p>
<font class="QuotedText">&gt; After a little RTFC, I found that a HR-timer was used to calculate the next preemption point. I.e. instead of preempting on 100 Hz clock, it preempts exactly when the timeslot of the current process ends.</font><br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/549707/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor549754"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 9, 2013 2:16 UTC (Thu)
                               by <b>nevets</b> (subscriber, #11875)
                              [<a href="/Articles/549754/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It's confusing because there's two things at play here. There's the hrtick and the scheduler_tick.<br>
<p>
The hrtick is used to denote exact time slices for the CFS scheduler to create more fairness. It really doesn't do much more than that. But this does not replace the scheduler_tick, which does among other things, keeps track of the SCHED_RR time slices, manages load balancing, and updates task timings.<br>
<p>
But I'm sure in the future the hrtick may be used more to get rid of the periodic tick.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/549754/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor550397"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2013 11:57 UTC (Mon)
                               by <b>dps</b> (guest, #5725)
                              [<a href="/Articles/550397/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I believe that real tickless operation with pre-emptition is possible. Instead of recalculating that the same process keeps the CPU every n microseconds, until it does not, one could compute when another process would win the CPU and only schedule an interrupt and that time. Any periods in which the process would keep the CPU does not need interruption.<br>
<p>
I know actually implementing this would not be trivial and I am not volunteering to do this myself.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/550397/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor550526"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 14, 2013 12:18 UTC (Tue)
                               by <b>Tobu</b> (subscriber, #24111)
                              [<a href="/Articles/550526/">Link</a>] 
      </p>
      
      </div>
      </summary>
      Part of the work will be to adjust the various accumulators, statistics, governors and feedback mechanisms to work when the timeslice they measure isn't constant any more.
      
          <div class="CommentReplyButton">
            <form action="/Articles/550526/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor549672"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 8, 2013 16:30 UTC (Wed)
                               by <b>linuxjacques</b> (subscriber, #45768)
                              [<a href="/Articles/549672/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<p>
The 64-bit only constraint makes me wonder how much this has been tested on non-x86 archs.<br>
<p>
I'm interested in it for 32-bit ppc.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/549672/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor549895"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 9, 2013 20:58 UTC (Thu)
                               by <b>bagder</b> (guest, #38414)
                              [<a href="/Articles/549895/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There's also code for (32bit) ARM as well that works. I'm not sure exactly in which tree/state it is though.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/549895/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor549687"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 8, 2013 18:02 UTC (Wed)
                               by <b>gby</b> (guest, #23264)
                              [<a href="/Articles/549687/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There is no inherent one second timer tick except on on a single CPU on the system. I think you got this wrong.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/549687/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor549693"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">One-second tick</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 8, 2013 18:29 UTC (Wed)
                               by <b>corbet</b> (editor, #1)
                              [<a href="/Articles/549693/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      See <a rel="nofollow" href="http://git.kernel.org/linus/265f22a975c1e4cc3a4d1f94a3ec53ffbb6f5b9f">this commit</a>.  One tick per second is still needed.
      
          <div class="CommentReplyButton">
            <form action="/Articles/549693/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor549745"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">One-second tick</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 9, 2013 0:18 UTC (Thu)
                               by <b>simlo</b> (guest, #10866)
                              [<a href="/Articles/549745/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Hmm, wouldn't it be more appropiate just to make sure the timer is set at a maximum of 1 second in the future after last time the scheduler ran instead of being run every second?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/549745/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor549735"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 8, 2013 22:56 UTC (Wed)
                               by <b>bgmarete</b> (guest, #47484)
                              [<a href="/Articles/549735/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
With regard to the necessity of setting CPU affinities so that processors marked for tickless operation do not acquire more than one process, wouldn't something like systemd ease the related administrative work? After all, I don't want to be messing around with taskset(1) on my laptop.<br>
<p>
Also, how does this relate to CPU hyperthreads? Can a hyperthread be in tickless mode while a sibling hyperthread is not? Or must the entire core be woken up (or not) by the timer ticks?<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/549735/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor549736"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Hyperthreading</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 8, 2013 23:05 UTC (Wed)
                               by <b>corbet</b> (editor, #1)
                              [<a href="/Articles/549736/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      If you want tickless for latency reasons, the last thing you're going to do is turn on hyperthreading.
      
          <div class="CommentReplyButton">
            <form action="/Articles/549736/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor549750"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Hyperthreading</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 9, 2013 1:15 UTC (Thu)
                               by <b>bgmarete</b> (guest, #47484)
                              [<a href="/Articles/549750/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Thanks for the reply Corbet. I have just finished reading a long series of articles, including some at Intel, which make your point clear.<br>
<p>
I would still like to know if each hyperthread can be independently put into full tickless mode (independent, that is, from its sibling), with the attendant power savings (if any). (Assume that I am interested only in saving battery power).<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/549750/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor549814"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Hyperthreading</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 9, 2013 13:14 UTC (Thu)
                               by <b>sheepdestroyer</b> (guest, #54968)
                              [<a href="/Articles/549814/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Also interested by that particular issue. Got a SandyBridge ultra-portable so 2 "real" cores + 2 HT and would like to know how much if any power save should i expect?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/549814/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor549863"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Hyperthreading</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 9, 2013 15:59 UTC (Thu)
                               by <b>drago01</b> (subscriber, #50715)
                              [<a href="/Articles/549863/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I doubt this will get you any noticeable power savings if at all. The most interesting part for power saving is the idle part which is already handled by CONFIG_NO_HZ<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/549863/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor549978"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Hyperthreading</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 10, 2013 8:43 UTC (Fri)
                               by <b>akeane</b> (guest, #85436)
                              [<a href="/Articles/549978/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The config option should be called: CONFIG_WINDOWS_311<br>
<p>
Really, "cooperative" multi-tasking?<br>
<p>
Really?<br>
<p>
Really...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/549978/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor550082"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Hyperthreading</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 10, 2013 18:59 UTC (Fri)
                               by <b>PaulMcKenney</b> (<b>&#x272D; supporter &#x272D;</b>, #9624)
                              [<a href="/Articles/550082/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Cute, but inaccurate.  ;-)<br>
<p>
If there is only one CPU-bound task runnable on a given CPU, there is no point in any scheduling decisions.<br>
<p>
If there are multiple tasks runnable on a given CPU, and if the currently running task is CPU-bound, then there is no point in any scheduling decisions until the next timeslice.<br>
<p>
Of course, things might change in the meantime, but in that case, this CPU will receive an interrupt and can therefore adjust as appropriate at that point in time.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/550082/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor550480"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Hyperthreading</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2013 21:46 UTC (Mon)
                               by <b>chloe_zen</b> (guest, #8258)
                              [<a href="/Articles/550480/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think you haven't been keeping up with current events (no pun intended); event-driven loops in a single OS thread are the New Way of getting the most I/O through a CPU.  This is a realistically useful optimization.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/550480/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor551238"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Hyperthreading</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 20, 2013 23:13 UTC (Mon)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/551238/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
So, ticks to look some day as outdated as polling?<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/551238/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor551245"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">ticks vs. polling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 21, 2013 7:49 UTC (Tue)
                               by <b>cladisch</b> (<b>&#x272D; supporter &#x272D;</b>, #50193)
                              [<a href="/Articles/551245/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>
<font class="QuotedText">&gt; ticks to look some day as outdated as polling?</font><br>
<p>
Polling is regularly checking the status, just because something that needs handling <em>might</em> have happened.
<p>
Ticks <em>are</em> polling.
      
          <div class="CommentReplyButton">
            <form action="/Articles/551245/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor551348"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 22, 2013 7:45 UTC (Wed)
                               by <b>chenlb206</b> (guest, #86317)
                              [<a href="/Articles/551348/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Thank open source guys. You are great~<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/551348/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor551740"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Does Tickless supports for Octeon-2 and ARM as well ?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 24, 2013 7:56 UTC (Fri)
                               by <b>ajaycavium</b> (guest, #91111)
                              [<a href="/Articles/551740/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Can anybody please tell this feature is supported for Octeon-2 and ARM as well or it is for x86 only.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/551740/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor551978"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Does Tickless supports for Octeon-2 and ARM as well ?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 28, 2013 8:29 UTC (Tue)
                               by <b>Ralf</b> (guest, #40688)
                              [<a href="/Articles/551978/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Octeon 2 support CONFIG_NO_HZ_IDLE but not yet CONFIG_NO_HZ_FULL.  Working on that.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/551978/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor552119"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Does Tickless supports for Octeon-2 and ARM as well ?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 29, 2013 9:46 UTC (Wed)
                               by <b>Ralf</b> (guest, #40688)
                              [<a href="/Articles/552119/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
MIPS support (tested on a 12 core Octeon+) is now available in <a rel="nofollow" href="http://git.linux-mips.org/?p=ralf/linux.git;a=commit;h=07f010e0f3b4e5afa54233190f7bbf91be403dfb">http://git.linux-mips.org/?p=ralf/linux.git;a=commit;h=07...</a><br>
<p>
Please send test reports to linux-mips@linux-mips.org.  Thanks!<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/552119/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor557036"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 1, 2013 12:28 UTC (Mon)
                               by <b>methanol</b> (guest, #91650)
                              [<a href="/Articles/557036/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Is there a way to show what the current "tick-mode" is? And can I force only one process to be on a particular cpu core?<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/557036/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor559119"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 16, 2013 21:31 UTC (Tue)
                               by <b>ParadoxUncreated</b> (guest, #87037)
                              [<a href="/Articles/559119/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It´s way more than 1% more cpu. Atleast in terms of visual performance. I did a low-jitter config on linux some time ago, that I have now perfected: <br>
<p>
<a rel="nofollow" href="http://ovekarlsen.com/Blog/turning-ubuntu-12-04-into-a-professional-low-jitter-os/">http://ovekarlsen.com/Blog/turning-ubuntu-12-04-into-a-pr...</a><br>
<p>
Choosing components for less jitter, reducing timer interrupts to 90hz, enabling low-latency behaviour etc, + renicing X etc, made doom 3 run perfectly on a core 2 duo, with a GTX 280. On Quakecon 2012 Carmack says that game is still taxing on some configurations. It actually requires an Intel E5 workstation with low jitter hardware, to run as good in a tweaked windows XP.<br>
<p>
The game does 3 passes to OpenGL pr frame. That seems to make it very jitter-sensitive. But with a low-jitter configured kernel, it runs perfectly.  That seems to apply to things like Wine also. Also Wine-games such as Half-life 2 still had some jitter, but much less.<br>
<p>
So low-jitter matters, if you want smooth gameplay on advanced game-engines. And a lot of data is pushed there. Generally the system seems very nice and responsive also. Much more like an optimal desktop system indeed.<br>
<p>
Peace Be With You.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/559119/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor559143"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 17, 2013 2:56 UTC (Wed)
                               by <b>hummassa</b> (guest, #307)
                              [<a href="/Articles/559143/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Your link says "maintenance mode".<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/559143/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor561913"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">(Nearly) full tickless operation in 3.10</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2013 6:37 UTC (Fri)
                               by <b>YAK</b> (guest, #91961)
                              [<a href="/Articles/561913/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
In file kernel/time/Kconfig, option "NO_HZ_FULL" depends on 64BIT, So is it only supported for 64 bit architecture ? i wanted to try it out on 32-bit ARM cortex A9 but i guess its not possible ? <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/561913/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor767908"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">kernel thread/process and full tickless mode?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 9, 2018 1:44 UTC (Tue)
                               by <b>henryc</b> (guest, #127733)
                              [<a href="/Articles/767908/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The article states, "the administrator should make extensive use of CPU affinities to keep unwanted processes (including kernel threads) off the relevant processors".<br>
<p>
I thought it wasn't possible to affine migration and kworker processes to other cores as they are per-core processes that bind to the specific cores.  RCU related processes can be moved as there is a kernel parameter for that.<br>
<p>
The article suggests that in order for a core to be in full nohz mode, "a running CPU will only disable the timer tick if there is a single runnable process on that CPU".  It sounds like it is necessary to move kernel processes such as migration and kworker out of the core.  Or kernel processes don't count?  I am a bit confused.<br>
<p>
If kernel processes count, then how to move them to other cores?  Can they be moved to another physical CPU?<br>
<p>
Thanks.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/767908/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2013, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
