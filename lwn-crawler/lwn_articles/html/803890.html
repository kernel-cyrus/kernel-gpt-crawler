        <!DOCTYPE html>
        <html lang="en">
        <head><title>Filesystem sandboxing with eBPF [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/803890/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/803669/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/803890/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>Filesystem sandboxing with eBPF</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>We're bad at marketing</b>
<p>
We can admit it, marketing is not our strong suit. Our strength is
writing the kind of articles that developers, administrators, and
free-software supporters depend on to know what is going on in the
Linux world. Please <a href="/Promo/nsn-bad/subscribe">subscribe today</a> to help us keep doing that, and so
we don’t have to get good at marketing.
</blockquote>
<div class="FeatureByline">
           By <b>Jake Edge</b><br>November 6, 2019</br>
           <hr>
<a href="/Archives/ConferenceByYear/#2019-Open_Source_Summit_Europe">OSS EU</a>
</div>
<p>
Running untrusted code in a safe manner is generally the goal of sandboxing
efforts.  The sandbox technique presented by Georgia Tech PhD student
Ashish Bijlani at <a 
href="https://events19.linuxfoundation.org/events/open-source-summit-europe-2019/">Open 
Source Summit Europe 2019</a> is no exception.  He has used something of a novel
scheme to allow unprivileged code to implement the sandbox policies using
BPF; the policies are then enforced by the kernel. 
</p>

<h4>Background</h4>

<p>
There are lots of use cases for running untrusted third-party code without
risking the contents of files on the system.  Two that he mentioned were
web-browser plugins obtained from potentially dodgy internet sites and
machine-learning code that one might like to evaluate. 
There is a spectrum of code that can be run,  from known-good code to known-bad
code; in between those is unknown, untrusted code.  Known-good code can be
whitelisted and known-bad code can be blacklisted, sandboxing is a
technique used for that code in the middle.   A sandbox is simply an
isolated and controlled execution environment, he said.
</p>

<a href="/Articles/804044/">
<img src="https://static.lwn.net/images/2019/osseu-bijlani-sm.jpg" border=0 hspace=5
align="right" alt="[Ashish Bijlani]" title="Ashish Bijlani" width=211
height=280>
</a>

<p>
Bijlani is focused on a specific type of sandbox: a filesystem sandbox.
The idea is to restrict access to sensitive data when running these
untrusted programs.  The rules would need to be dynamic as the restrictions
might need to change based on the program being run.  Some examples he gave
were to restrict access to the <tt>~/.ssh/id_rsa*</tt> files or to only
allow access to files of a specific type (e.g. only <tt>*.pdf</tt> for a PDF reader).
</p>

<p>
He went through some of the existing solutions to show why they did not
solve his problem, comparing them on five attributes: allowing dynamic
policies, usable by unprivileged users, providing fine-grained control,
meeting the security needs for running untrusted code, and avoiding excessive
performance overhead. 
Unix discretionary access control (DAC)—file
permissions, essentially—is available
to unprivileged users, but fails most of the other measures.  Most
importantly, it does not suffice to keep untrusted code from accessing
files owned by the user running the code.
SELinux
mandatory access control (MAC) does check most of the boxes (as can be seen
in the talk <a
href="https://static.sched.com/hosted_files/osseu19/20/OSSEUSandFS.pdf">slides
[PDF]</a>), but is not available to unprivileged users.
</p>

<p>
Namespaces (or <tt>chroot()</tt>) can be used to isolate filesystems and
parts of filesystems, but cannot enforce security policies, he said.  Using
<tt>LD_PRELOAD</tt> to intercept calls to filesystem operations
(e.g. <tt>open()</tt> or <tt>write()</tt>) is a way for unprivileged users to
enforce dynamic policies, but it can be bypassed fairly easily.  System
calls can be invoked directly, rather than going through the library calls,
or files can be mapped with <tt>mmap()</tt>, which will allow I/O to the
files without making system calls.  Similarly, <tt>ptrace()</tt> can be
used, but it suffers from <a
href="https://en.wikipedia.org/wiki/Time-of-check_to_time-of-use">time-of-check-to-time-of-use</a>
(TOCTTOU) races, which would allow the security protections to be bypassed.
</p>

<p>
<tt>ptrace()</tt> also suffers from high performance overhead (roughly
50%), as does the 
final option that Bijlani outlined: <a
href="https://en.wikipedia.org/wiki/Filesystem_in_Userspace">Filesystem in
Userspace</a> (FUSE).  A FUSE filesystem would check all of his boxes, but
it suffers from nearly 80% performance overhead.  He was
looking for a solution that would only add 5-10% overhead, he said.
</p>

<p>
That is what he has created with <a
href="https://sandfs.github.io">SandFS</a>.  It is a stackable filesystem
that can enforce unprivileged-user-specified policies on filesystem
access.  A user would invoke it this way:
<pre>
    $ sandfs -s sandfs.o -d /home/user /bin/bash
</pre>
The <tt>sandfs</tt> binary is unprivileged; it can be run by anyone.  The
example above would run 
<tt>bash</tt> within a sandbox for accesses to the
<tt>/home/user</tt> directory.  The sandbox is defined by
<tt>sandfs.o</tt>, which is
written in C and compiled by LLVM into BPF bytecode.
</p>

<p>
He talked a bit about
BPF and how it can be used, calling BPF "a key
enabling technology" for SandFS.  BPF maps provide a mechanism to
communicate between user space and BPF programs running in the kernel;
they also have a major role to play for SandFS.
More details on BPF can be found in <a
href="/Articles/740157/">this LWN article</a>.
</p>

<h4>Architecture</h4>

<p>
He then turned to the architecture of SandFS; there are a few different
components to it, starting with the SandFS daemon and SandFS library in
user space.  The daemon is what the <tt>sandfs</tt> binary talks to and the
library is available for those developing their own security policies.
There is also a modified version of <a
href="http://wrapfs.filesystems.org/">Wrapfs</a> that is used to intercept
the filesystem operations for the mounted filesystem.  A set
of SandFS BPF handlers are available in the kernel to implement the security checking
for each of the filesystem operations that are intercepted by SandFS
itself, which is the filesystem based on Wrapfs.
</p>

<p>
The basic operation is that the <tt>sandfs</tt> binary sends the BPF code
to the daemon, which loads it into the kernel.  If the BPF verifier does
not find a problem with the code, the next step is to mount SandFS on the
directory specified (<tt>/home/user</tt> in the example).  Any filesystem
operations will be intercepted by SandFS, which will call out to the BPF
programs loaded from user space in order to get access decisions.  SandFS
itself does not perform I/O, it simply passes any operations that were allowed by
the policies down to the lower-level filesystem (e.g. ext4 or XFS). 
</p>

<p>
The policies can consult BPF maps, which can be written from user space;
that allows for dynamic policies.  The BPF programs passed in from user
space in may look  
things up in the maps, such as path names, to determine whether to allow
access or not; it is even possible to alter parameters to the filesystem
operations based on the policies (e.g. to make all <tt>open()</tt> calls
read-only).  SandFS handles kernel objects, rather than parameters directly
passed by user space, so it avoids any TOCTTOU problems.
</p>

<p>
In the talk, he gave two example of BPF programs that could be used to
restrict access.  The first would consult the BPF map for the path being used as part of
the <tt>lookup()</tt> filesystem operation; if it found the path in the
map, it would return <tt>-EACCES</tt>, thus providing a way for user space
to restrict access to any part of the sandboxed directory.  The second
would look at the mode 
specified in <tt>open()</tt> operations, rejecting those with
<tt>O_CREAT</tt> and changing the mode to <tt>O_RDONLY</tt> for the rest.
</p>

<p>
He then showed some performance numbers for a few different types of operations,
comparing the time taken for them on ext4 versus SandFS.  Creating a
<tt>.tar.gz</tt> file of the 4.17 kernel showed the lowest overhead (4.57%,
61.05s vs. 63.84s).  Decompressing and expanding the tar file had the most
overhead (9.75%, 5.13s vs. 5.63s), while compiling the kernel
(<tt>make&nbsp;&#8209;j&nbsp;4 tinyconfig</tt>) came in at 9.28% (27.15s
vs. 29.67s).
</p>

<p>
The SandFS framework could be used in a number of different ways, Bijlani
said.  It could restrict access to private user data such as SSH keys.  It
could also be used to compartmentalize certain operations of a complex
application, such as a web browser; handling file and media formats could
be put into separate sandboxed processes.   Also, container-management
systems could stack 
multiple layers of SandFS checks to harden the filesystem access from their
containers. 
</p>

<p>
He wrapped up the talk by noting the the SandFS code is <a
href="https://github.com/sandfs/sandfs.github.io">available on GitHub</a>.
He has written an <a
href="https://dl.acm.org/citation.cfm?id=3265734">academic paper</a> on it
as well.  In addition, he pointed to some related work that he presented at OSS North
America in 2018 (<a
href="https://events19.linuxfoundation.org/wp-content/uploads/2017/11/When-eBPF-Meets-FUSE-Improving-Performance-of-User-File-Systems-Ashish-Bijlani-Georgia-Tech.pdf">slides
[PDF]</a>) and at the 2018 Linux Plumbers Conference (<a
href="https://www.youtube.com/watch?v=XmoJCHNEp2w">YouTube video</a>). 
</p>

<p>
[I would like to thank LWN's travel sponsor, the Linux Foundation, for travel assistance to attend Open Source Summit Europe in Lyon, France.]<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#BPF">BPF</a></td></tr>
            <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Filesystems">Filesystems</a></td></tr>
            <tr><td><a href="/Security/Index/">Security</a></td><td><a href="/Security/Index/#Linux_kernel-Filesystems">Linux kernel/Filesystems</a></td></tr>
            <tr><td><a href="/Security/Index/">Security</a></td><td><a href="/Security/Index/#Sandboxes">Sandboxes</a></td></tr>
            <tr><td><a href="/Archives/ConferenceIndex/">Conference</a></td><td><a href="/Archives/ConferenceIndex/#Open_Source_Summit_Europe-2019">Open Source Summit Europe/2019</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/803890/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor804049"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Filesystem sandboxing with eBPF</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 6, 2019 23:43 UTC (Wed)
                               by <b>roc</b> (subscriber, #30627)
                              [<a href="/Articles/804049/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; It could also be used to compartmentalize certain operations of a complex application, such as a web browser; handling file and media formats could be put into separate sandboxed processes.</font><br>
<p>
Web browsers already do the latter. Those sandboxed processes implement filesystem access filtering with seccomp policy that triggers SIGSYS on openat() and a SIGSYS handler that proxies the syscall to a broker process over IPC. AFAIK this isn't actually a performance problem because it's only used for loading libraries or config files, *not* for loading Web/media content --- because that normally doesn't come from the filesystem anyway, it's obtained from other browser subsystems via IPC.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804049/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor804055"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Filesystem sandboxing with eBPF</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 7, 2019 5:29 UTC (Thu)
                               by <b>gutschke</b> (subscriber, #27910)
                              [<a href="/Articles/804055/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I don't see any mention of suid-binaries, but given the very obvious potential for abuse, this filesystem hopefully prevents all new privileges, as soon as it has been mounted for a process hierarchy.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804055/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor804093"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">How does it protect itself?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 7, 2019 15:05 UTC (Thu)
                               by <b>NAR</b> (subscriber, #1313)
                              [<a href="/Articles/804093/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I might miss something, but if e.g. that PDF reader has a bug allowing arbitrary code execution - what stops the attacker turning off ("dynamically change policy") this sandbox protection?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804093/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor804160"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">How does it protect itself?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 8, 2019 3:20 UTC (Fri)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/804160/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Presumably the knob for controlling that is outside the sandbox? If they're already outside the sandbox, why not just use that state directly?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804160/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor806203"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">How does it protect itself?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 3, 2019 16:10 UTC (Tue)
                               by <b>cpuguy83</b> (guest, #107303)
                              [<a href="/Articles/806203/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The case for this would be containers, where you force an app to run within a specific context rather than the app setting up said context.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/806203/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor804168"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 8, 2019 12:01 UTC (Fri)
                               by <b>jorgegv</b> (subscriber, #60484)
                              [<a href="/Articles/804168/">Link</a>] (17 responses)
      </p>
      
      </div>
      </summary>
      <p>I think this mechanism could be used for implementing on-access antivirus on Linux, similar to the way it is implemented in Windows operating systems.</p>

<p>Some AV software (e.g. Sophos) are now using an out-of-tree module called TALPA, or even fanotify, but these come with their own limitations and/or problems (e.g. out-of tree patch, no NFSv4 support). This new implementation looks much cleaner and likely to enter mainstream kernel.</p>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804168/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor804212"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 8, 2019 19:48 UTC (Fri)
                               by <b>amacater</b> (subscriber, #790)
                              [<a href="/Articles/804212/">Link</a>] (16 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
And who really cares about Windows-based, Windows virus definition driven AV on Linux? Sophos - the folk whose kernel modules were deemed of too limited value to be included in a Linux kernel. AV on Linux, where single threaded processes hog whole cores on a CPU - about as much use as an ashtray inside the ISS:) <br>
<p>
Chkrootkit / rkhunter / clamav - maybe, but even then virtually all the rootkits were patched long ago - keeping software up to date solves this problem. The only justification for AV on Linux is if you're an ISP protecting a mailspool / web server serving Windows users. It will give them an illusion of relative safety tempered only by the unpatchable disaster that is Windows. Bitter, me?<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804212/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor804217"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 8, 2019 21:50 UTC (Fri)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/804217/">Link</a>] (15 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; And who really cares about Windows-based, Windows virus definition driven AV on Linux?</font><br>
People who run Linux in corporate settings?<br>
<p>
<font class="QuotedText">&gt; Chkrootkit / rkhunter / clamav - maybe, but even then virtually all the rootkits were patched long ago</font><br>
Linux has a new exploitable root hole about every 3-4 months. Even more when all of the infrastructure is considered.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804217/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor804230"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 9, 2019 12:31 UTC (Sat)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/804230/">Link</a>] (14 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; People who run Linux in corporate settings?</font><br>
<p>
Ah yes, to meet the "poorly implemented rootkit that does more harm than good" market.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804230/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor804234"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 9, 2019 20:39 UTC (Sat)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/804234/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Nope. Linux is freakingly insecure. It's protected right now basically by being very niche, so that attackers are not interested in it.<br>
<p>
If this changes, get ready for Linux ransomware and undetectable rootkits. There is no hardening at all in mainstream Linux distros.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804234/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor804236"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 9, 2019 21:28 UTC (Sat)
                               by <b>amacater</b> (subscriber, #790)
                              [<a href="/Articles/804236/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Linux is no longer niche - it's universal. Exploitable root hole every three months?  Please be so good as to look at the average Mean Time to Repair [MTTR] in Linux and common applications and compare this to the speed of comparable patching in the commercial applications.  <br>
<p>
If, say, Amazon and the Linux components of  Microsoft's Azure are too small to be regarded, please advise what you regard as important.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804236/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor804237"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 9, 2019 21:31 UTC (Sat)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/804237/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Android is universal. Desktop Linux is not, it barely exists.<br>
<p>
<font class="QuotedText">&gt; Exploitable root hole every three months? Please be so good as to look at the average Mean Time to Repair [MTTR] in Linux and common applications and compare this to the speed of comparable patching in the commercial applications.</font><br>
Uh, what? Most IoT and Android devices are not repaired at all, they just exist in a vulnerable state.<br>
<p>
The only thing preventing mass infections are gatekeepers in Play Store and the fact that most IoT devices don't execute arbitrary code.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804237/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor804241"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 10, 2019 2:14 UTC (Sun)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/804241/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; If this changes, get ready for Linux ransomware and undetectable rootkits. There is no hardening at all in mainstream Linux distros.</font><br>
<p>
Neither of which are (or can be) addressed by the current "enterprise antivirus" paradigm.<br>
<p>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804241/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor804242"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 10, 2019 2:23 UTC (Sun)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/804242/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
They can. Modern antiviruses have extensive anti-patching and with kernel integrity checks. It's possible to work around them, but not at all trivial even in the kernel mode.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804242/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor804270"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 11, 2019 7:41 UTC (Mon)
                               by <b>zlynx</b> (guest, #2285)
                              [<a href="/Articles/804270/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Which is a reason that they result in crashing Windows so often. And then Windows has to create little simulated environments for the AV so it can "watch" a pretend operating system.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804270/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor804272"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 11, 2019 8:41 UTC (Mon)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/804272/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'm using Windows with an AV for work and so far I haven't seen it crashing. Not once.<br>
<p>
<font class="QuotedText">&gt; And then Windows has to create little simulated environments for the AV so it can "watch" a pretend operating system.</font><br>
Windows doesn't do anything like this. It provides official hooks for AV software in the kernel mode, but doesn't do any emulation.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804272/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor804290"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 11, 2019 15:46 UTC (Mon)
                               by <b>zlynx</b> (guest, #2285)
                              [<a href="/Articles/804290/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Microsoft has to build hacks for nearly every release of Windows 10 because some company's idiot AV thinks it knows Windows better than Microsoft does.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804290/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor804324"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 11, 2019 15:52 UTC (Mon)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/804324/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Similarly, "enterprise" AV is responsible for reducing brand-new ultrabooks with nvme storage and making them perform about as well as a much older system with spinning rust.<br>
<p>
(seriously; I just saw a thread on my employer's intermal messaging boards about how our current enterprise AV suite makes compiles take nearly 3x longer than without it..)<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804324/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor804335"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 11, 2019 16:17 UTC (Mon)
                               by <b>dezgeg</b> (subscriber, #92243)
                              [<a href="/Articles/804335/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Not to mention all the extra security holes introduced by AVs doing complex parsing of file formats in processes running with SYSTEM permissions, e.g. <a href="https://googleprojectzero.blogspot.com/2015/09/kaspersky-mo-unpackers-mo-problems.html">https://googleprojectzero.blogspot.com/2015/09/kaspersky-...</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804335/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor804991"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 17, 2019 5:29 UTC (Sun)
                               by <b>daurnimator</b> (guest, #92358)
                              [<a href="/Articles/804991/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Indeed. However its a requirement of e.g. PCI-DSS Requirement 5.1.<br>
<p>
From <a rel="nofollow" href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf">https://www.pcisecuritystandards.org/documents/PCI_DSS_v3...</a><br>
<p>
<font class="QuotedText">&gt; 5.1 Deploy anti-virus software on all systems commonly affected by malicious software (particularly personal computers and servers)</font><br>
<p>
In most corporate settings where there is card data (and unless the business is willing to convince an auditor that Linux is not commonly affected by malicious software), you have to deploy *something* antivirusy.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/804991/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor805121"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2019 23:29 UTC (Mon)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/805121/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
SELinux not good enough any more?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/805121/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor805123"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2019 23:34 UTC (Mon)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/805123/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
SELinux has been crap all along. It's pretty much impossible to use on a regular desktop system.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/805123/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor805304"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Way forward to on-access antivirus in Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2019 16:20 UTC (Thu)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/805304/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I haven't had to disable it for years. I even have it enabled on some servers I have running too. So maybe your experience is out-of-date (it was indeed much harder to use…6, maybe 7 years ago)?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/805304/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor805254"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Filesystem sandboxing with eBPF</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2019 9:22 UTC (Thu)
                               by <b>rhdxmr</b> (guest, #44404)
                              [<a href="/Articles/805254/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Wow. SandFS is very cool example of eBPF program.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/805254/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2019, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
