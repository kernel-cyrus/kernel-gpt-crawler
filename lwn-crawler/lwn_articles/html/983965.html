        <!DOCTYPE html>
        <html lang="en">
        <head><title>Maximal min() and max() [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/983965/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/984217/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/983965/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>Maximal min() and max()</h1>
</div>
<div class="ArticleText">
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>August 1, 2024</br>
           </div>
Like many projects written in C, the kernel makes extensive use of the C
preprocessor; indeed, the kernel's use is rather more extensive than most.
The preprocessor famously has a number of sharp edges associated with it.
One might not normally think of increased compilation time as one of them,
though.  It turns out that some changes to a couple of conceptually simple
preprocessor macros — <tt>min()</tt> and <tt>max()</tt> — led to some truly
pathological, but hidden, behavior where those macros were used.
<p>
<h4><tt>min()</tt> and <tt>max()</tt> for the kernel</h4>
<p>
Your editor's well-worn, first-edition copy of <i>The C Programming
Language</i> introduces the preprocessor with this example:
<p>
<pre>
    #define max(A, B) ((A) &gt; (B) ? (A) : (B))
</pre>
<p>
The hazards that come with a macro like this, such as the double evaluation
of the arguments, were pointed out in the text.  Still, that did not
prevent kernel developers from making use of it; as <a
href="/2001/0823/kernel.php3">covered here</a> in 2001, there were over 150
definitions of <tt>min()</tt> and <tt>max()</tt> matching the above pattern
in the 2.4.8 kernel.
<blockquote class="ad">
<b><tt>$ sudo subscribe today</tt></b>
<p>
Subscribe today and elevate your LWN privileges. You’ll have
access to all of LWN’s high-quality articles as soon as they’re
published, and help support LWN in the process.  <a href="https://lwn.net/Promo/nst-sudo/claim">Act now</a> and you can start with a free trial subscription.
</blockquote>

<p>
At that time, Linus Torvalds decided that a consolidation made sense; he
added a single set of those macros meant to be used throughout the kernel.
He also changed the interface, though, adding a type parameter describing
how the comparison is to be performed — signed or unsigned integer, for
example.  The goal was to increase correctness, but the immediate effect
was to break compilation throughout the kernel; the result was <a
href="https://lore.kernel.org/lkml/20010824224232.52238.qmail@web10908.mail.yahoo.com/">a
classic linux-kernel flame war</a> of the type that, fortunately, tends not
to happen anymore.
<p>
Despite the complaints, the changes stuck — briefly.  When the 2.4.9.8
release came about in February 2002, it included a change described as:
"<q>make the three-argument (that everybody hates) 'min()' be 'min_t()',
and introduce a type-anal 'min()' that complains about arguments of
different types</q>".  The <tt>max()</tt> and <tt>min()</tt> macros were
back to their old form, but the definition had changed; they now looked
like:
<p>
<pre>
    #define min(x,y) ({ \
	const typeof(x) _x = (x);	\
	const typeof(y) _y = (y);	\
	(void) (&amp;_x == &amp;_y);		\
	_x &lt; _y ? _x : _y; })
</pre>
<p>
Unsurprisingly, the complexity of these macros only grew from there as
developers added more features for flexibility and type safety.  Numerous
variants have also been added for special cases.  Recently, <a
href="/ml/linux-kernel/b97faef60ad24922b530241c5d7c933c@AcuMS.aculab.com/">this
series from David Laight</a>, merged for the 6.7 kernel, made
<tt>min()</tt> and <tt>max()</tt> work properly in numerous cases where the
two arguments have different types.  All seemed well after that, and nobody
felt a compelling urge to change these macros for at least three
development cycles.
<p>
<h4>Maximal expansion</h4>
<p>
But, then, Arnd Bergmann <a
href="https://social.kernel.org/notice/AkDuGHsn0WuA1g1uD2">observed</a>
that the time required to compile the kernel had grown considerably in
recent releases, and that the preprocessor had a lot to do with it; one
file took a full 15&nbsp;seconds just to get through the preprocessor
stage.  The problem came down to a single line of code in <a
href="https://elixir.bootlin.com/linux/v6.10.2/source/arch/x86/xen/setup.c#L758"><tt>arch/x86/xen/setup.c</tt></a>: 
<p>
<pre>
    extra_pages = min3(EXTRA_MEM_RATIO * min(max_pfn, PFN_DOWN(MAXMEM)),
    		       extra_pages, max_pages - max_pfn);
</pre>
<p>
To see how this came about, it is worth looking at the 6.10 definitions of
the <tt>min()</tt> and <tt>max()</tt> macros and their variants, all of
which come from <a
href="https://elixir.bootlin.com/linux/v6.10.2/source/include/linux/minmax.h"><tt>include/linux/minmax.h</tt></a>.
To start with, <tt>min3()</tt> returns the minimum of three values; its
implementation is straightforward enough:
<p>
<pre>
    #define min3(x, y, z) min((typeof(x))min(x, y), z)
</pre>
<p>
That uses our old friend <tt>min()</tt>; indeed, it nests one
<tt>min()</tt> call inside another.  In 6.10, <tt>min()</tt> looks like
this:
<p>
<pre>
   #define min(x, y) __careful_cmp(min, x, y)
</pre>
<p>
The <tt>__careful_cmp()</tt> macro tries hard to perform a type-safe
comparison while evaluating the arguments only once; it also endeavors to
expand to a constant expression if its arguments are constant expressions.
That leads to a certain amount of complexity, implemented this way (best
read from bottom to top):
<p>
<pre>
    #define __cmp_op_min &lt;
    #define __cmp_op_max &gt;

    #define __cmp(op, x, y)	((x) __cmp_op_##op (y) ? (x) : (y))

    #define __cmp_once_unique(op, type, x, y, ux, uy) \
	({ type ux = (x); type uy = (y); __cmp(op, ux, uy); })

    #define __cmp_once(op, type, x, y) \
	__cmp_once_unique(op, type, x, y, __UNIQUE_ID(x_), __UNIQUE_ID(y_))

    #define __careful_cmp_once(op, x, y) ({			\
	static_assert(__types_ok(x, y),			\
		#op "(" #x ", " #y ") signedness error, fix types or consider u" #op "() before " #op "_t()"); \
	__cmp_once(op, __auto_type, x, y); })

    #define __careful_cmp(op, x, y)					\
	__builtin_choose_expr(__is_constexpr((x) - (y)),	\
		__cmp(op, x, y), __careful_cmp_once(op, x, y))
</pre>
<p>
Depending on the expressions passed in, this means that <tt>min3()</tt> can
end up generating a fair amount of code.  Even if one expects a large
expansion, though, the actual amount may lead to significant eyebrow
elevation: the single line of code shown above expands to <i>47MB</i> of
preprocessor output.  Bergmann explained this result this way:
<p>
<blockquote class="bq">
	It nests min() multiple levels deep with the use of min3(), and
	each one expands its argument 20 times times now (up from 6 back in
	linux-6.6). This gets 8000  expansions for each of the arguments,
	plus a lot of extra bits with each expansion. PFN_DOWN(MAXMEM)
	contributes a bit to the initial size as well.
</blockquote>
<p>
Kernel developers, as a rule, care deeply about efficiency; that is
especially true when it comes to the time required to do a kernel build.
So it is unsurprising that this problem attracted some attention once it
came to light.
<p>
<h4>Minimizing the problem</h4>
<p>
Lorenzo Stoakes <a
href="/ml/linux-kernel/c83c17bb-be75-4c67-979d-54eee38774c6@lucifer.local/">brought
the issue</a> to the linux-kernel mailing list, showing how the 6.7 changes
had made compilation time worse.   Laight <a
href="/ml/all/23bdb6fc8d884ceebeb6e8b8653b8cfe@AcuMS.aculab.com">posted a
patch series</a> one day later that attempted to mitigate the problem.
That series improved compilation time, though not enough to completely make
up for the build-time regressions seen.  It also ended up provoking some
warnings from the test bots, and some of the changes to the macros made
some developers (<a
href="/ml/all/24be8665-4717-4ee2-8a81-80fed5181736@app.fastmail.com">including
Bergmann</a>) nervous; those macros have reached a level of subtlety that
makes people reluctant to change them.  Torvalds, too, <a
href="/ml/all/CAHk-=wh_+muDANgpjC6_31QMh4OnKEOgbZiD_MymHxAHRZRyqg@mail.gmail.com">was
uncomfortable</a> with some of the changes, but he also wondered if they
were the right approach to take in the first place:
<P>
<blockquote class="bq">
	I do get the feeling that the problem came from us being much too
	clever with out min/max macros, and now this series is doubling
	down instead of saying "it wasn't really worth it".
</blockquote>
<p>
He later <a
href="/ml/all/CAHk-=whLcr11D28vu2NotZYn3GNH6BCTK57Zw4d4v7eut39z=g@mail.gmail.com">suggested</a>
simply reverting the 6.7 changes even though the previous code was
"<q>stupid and limited and caused us to have to be more careful about types
than was strictly necessary</q>" but, as Stoakes <a
href="/ml/all/d48ce3b3-9173-4309-aae6-96be42327f97@lucifer.local">pointed
out</a>, a lot of code in the kernel has since come to depend on the new
functionality that those changes added.  Reverting them now would not be a
straightforward task.
<p>
So Torvalds decided to take a bit of a different approach after <a
href="/ml/all/CAHk-=wjPr3b-=dshE6n3fM2Q0U3guT4reOoCZiBye_UMJ-qg1A@mail.gmail.com">observing</a>
that many of the worse expansion cases were, in the end, relatively simple
constant expressions.  Rather than try to fix the existing complex macros,
he just added a couple more with a familiar look to them:
<p>
<pre>
    /*
     * Use these carefully: no type checking, and uses the arguments
     * multiple times. Use for obvious constants only.
     */
    #define CONST_MIN(a,b) ((a)&lt;(b)?(a):(b))
    #define CONST_MAX(a,b) ((a)&gt;(b)?(a):(b))
</pre>
<p>
By the time these macros <a
href="https://git.kernel.org/linus/3a7e02c040b13">landed in the
mainline</a> they had naturally gained just a little complexity (and new
names):
<p>
<pre>
    #define MIN_T(type,a,b) __cmp(min,(type)(a),(type)(b))
    #define MAX_T(type,a,b) __cmp(max,(type)(a),(type)(b))
</pre>
<p>
He converted a number of the worst expansion cases to use the new macros
just prior to the 6.11-rc1 release, then merged <a
href="https://git.kernel.org/linus/017fa3e89187">a patch</a> taking away
the ability for <tt>min()</tt> and <tt>max()</tt> to work as part of a
constant expression.  That simplified the code somewhat at the cost of
making the macros unsuitable for use in places where constants are
needed, but the new macros can be used instead in such situations.
<p>
These changes will not entirely resolve the problem in cases where the
expressions are not constant, so chances are that more tweaks to the
regular <tt>min()</tt> and <tt>max()</tt> macros are in store.  Meanwhile,
though, we have had a convincing demonstration of the sorts of pitfalls
that can accompany this sort of extensive use of the C preprocessor.  It
can accomplish some magical-seeming effects, but spells of this nature
often have subtle and unpleasant side effects.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Build_system">Build system</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/983965/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor984251"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">compiler magic?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 14:50 UTC (Thu)
                               by <b>jhoblitt</b> (subscriber, #77733)
                              [<a href="/Articles/984251/">Link</a>] (13 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
As C doesn't allow one to write polymorphic functions, I am surprised there isn't a type safe compiler extension to handle these common operations.  Has this been discussed at the standards level for a future C version?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984251/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984271"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">compiler magic?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 15:52 UTC (Thu)
                               by <b>clugstj</b> (subscriber, #4020)
                              [<a href="/Articles/984271/">Link</a>] (12 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It's already there.  It's called "_Generic"<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984271/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984286"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">compiler magic?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 17:17 UTC (Thu)
                               by <b>quotemstr</b> (subscriber, #45331)
                              [<a href="/Articles/984286/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
And there's an even better one called "C++".<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984286/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984336"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">compiler magic?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2024 0:51 UTC (Fri)
                               by <b>DanilaBerezin</b> (guest, #168271)
                              [<a href="/Articles/984336/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Probably not happening any time soon.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984336/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984567"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">compiler magic?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 5, 2024 20:23 UTC (Mon)
                               by <b>cytochrome</b> (subscriber, #58718)
                              [<a href="/Articles/984567/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
We need to keep in mind what Max Planck wrote:<br>
<p>
A new scientific truth does not triumph by convincing its opponents and making them see the light, but rather because its opponents eventually die and a new generation grows up that is familiar with it ...<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984567/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor984393"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">compiler magic?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2024 15:34 UTC (Fri)
                               by <b>bmork</b> (subscriber, #88411)
                              [<a href="/Articles/984393/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; And there's an even better one called "C++".</span><br>
<p>
I see I'm not the only one missing the good old flame wars :-)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984393/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor984432"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">compiler magic?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2024 23:32 UTC (Fri)
                               by <b>iteratedlateralus</b> (guest, #102183)
                              [<a href="/Articles/984432/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
C++ has std::min()<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984432/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor984287"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">compiler magic?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 17:20 UTC (Thu)
                               by <b>jhoblitt</b> (subscriber, #77733)
                              [<a href="/Articles/984287/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Ha!  I guess I am happily obvious to what's going on in C...<br>
<p>
Doesn't the kernel already allow C11?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984287/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984297"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">compiler magic?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 17:59 UTC (Thu)
                               by <b>adobriyan</b> (subscriber, #30858)
                              [<a href="/Articles/984297/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
_Generic is in vogue these days!<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984297/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor984333"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">compiler magic?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2024 0:07 UTC (Fri)
                               by <b>gerdesj</b> (subscriber, #5446)
                              [<a href="/Articles/984333/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
"Ha! I guess I am happily obvious to what's going on in C..."<br>
<p>
I suspect you meant "oblivious" and yet I prefer "happily obvious" ... not too sure why.  Perhaps its staring me in the face.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984333/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor984335"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">compiler magic?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2024 1:00 UTC (Fri)
                               by <b>Keith.S.Thompson</b> (subscriber, #133709)
                              [<a href="/Articles/984335/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'm not sure how "_Generic" would be useful for min/max macros.<br>
<p>
The macro would have to list all the types you want the macros to work with, possibly with a "default:" to handle all types you haven't specified. But how would the code differ for different types?<br>
<p>
You could catch type mismatches, like "min(1, 1.5)", but that would require nested generic selections on both arguments.<br>
<p>
Personally, without having studied the kernel code that uses it, I would think that something simple like:<br>
<p>
#define MIN(x, y) ((x) &lt; (y) ? (x) : (y))<br>
#define MAX(x, y) ((x) &gt; (y) ? (x) : (y))<br>
<p>
would be sufficient. The all-caps macro names emphasize that the arguments might be evaluated more than once and remind users to be careful. Any code that uses them could be audited (not on every build) to ensure it behaves sanely.<br>
<p>
Quite possibly I'm missing something.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984335/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984397"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">compiler magic?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2024 16:30 UTC (Fri)
                               by <b>bluss</b> (subscriber, #47454)
                              [<a href="/Articles/984397/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think you're right. _Generic was created for one reason, to do "type generic" math functions, and they dispatch on a single argument. That's more or less what it's good for, single argument functions of numeric types.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984397/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984494"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">compiler magic?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 4, 2024 15:40 UTC (Sun)
                               by <b>fw</b> (subscriber, #26023)
                              [<a href="/Articles/984494/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Unfortunately, nested type-generic functions are common enough that this does not work due to the same macro expansion size issue that is discussed here. Any reasonable implementation of the type-generic math macros needs to use something else. GCC has __builtin_tgmath.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984494/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor984493"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">compiler magic?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 4, 2024 15:37 UTC (Sun)
                               by <b>fw</b> (subscriber, #26023)
                              [<a href="/Articles/984493/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
_Generic does not help to reduce preprocessor expansion because it's necessary to reference the argument at least twice.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984493/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor984282"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 17:14 UTC (Thu)
                               by <b>quotemstr</b> (subscriber, #45331)
                              [<a href="/Articles/984282/">Link</a>] (41 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Maybe the kernel should reconsider C++? If GDB can do it, Linux can too. Keep the .c file extension, like GDB does, if it makes people feel better. (Also, of course, continue the Rust project.) Don't want C++ name mangling? Write a post-build pass that rewrites mangled to unmangled symbols in the symbol table when unambiguous.<br>
<p>
C++ would allow the "shape" of the kernel to be unchanged (nobody makes you use, e.g. std::vector!) while allowing the kernel to replace macro abominations like the DEFINE_TRACE, 8000-macro-expansion max(), etc. with mere template abominations. Like mathematical infinities, some abominations are more abominable than others.<br>
<p>
C++'s template system _comprehensively_ solves the _entire class_ of problem this article discusses, and it does so in a way that's elegant, composable, comprehensible, and safe. There is literally no C program that cannot trivially be made a C++ program. <br>
<p>
Modern dialects (e.g. with variadic templates) so comprehensively clobbers ANSI C on safety and expressiveness without giving up an iota of performance that one struggles to imagine reasons other than mere inertia keeping C++'s safe and powerful type system out of kernel developer hands.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984282/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984288"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 17:21 UTC (Thu)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/984288/">Link</a>] (38 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yes, but the article is also about performance.<br>
With C++ the build performance goes down the drain.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984288/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984289"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 17:23 UTC (Thu)
                               by <b>quotemstr</b> (subscriber, #45331)
                              [<a href="/Articles/984289/">Link</a>] (28 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; With C++ the build performance goes down the drain.</span><br>
<p>
Does it? Why would it?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984289/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984291"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 17:30 UTC (Thu)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/984291/">Link</a>] (27 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Have you ever compiled a C++ file? It's dead slow compared to C. No matter what compiler is used.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984291/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984292"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 17:34 UTC (Thu)
                               by <b>quotemstr</b> (subscriber, #45331)
                              [<a href="/Articles/984292/">Link</a>] (18 responses)
      </p>
      
      </div>
      </summary>
      Uh, no?

A myth doesn't become truth just because someone repeats it emphatically enough.

<pre>
$ time for ((i=0; i &lt; 100; ++i)); do gcc -O2 foo.c; done

real	0m6.669s
user	0m4.412s
sys	0m2.237s

~
$ time for ((i=0; i &lt; 100; ++i)); do gcc -O2 -x c++ foo.c; done

real	0m6.995s
user	0m4.677s
sys	0m2.302s

$ cat foo.c
#include &lt;stdio.h&gt;

int
main()
{
  printf("hello world\n");
  return 0;
}

</pre>




      
          <div class="CommentReplyButton">
            <form action="/Articles/984292/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984296"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 17:59 UTC (Thu)
                               by <b>mussell</b> (subscriber, #170320)
                              [<a href="/Articles/984296/">Link</a>] (17 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That isn't C++ code, that is C code passed through a C++ compiler that uses nothing more than function calls. Once you start using templates like std::cout (which is what every C++ tutorial uses), compilation suffers dramatically as template instantiation can create the equivalent of thousands of lines of code, all for it to be deleted by a later compiler pass. This issue isn't unique to C++ as Rust uses the same technique, and as this article has shown, the same can happen with C macros. <br>
<p>
A quick check on my system shows that the idiomatic C++ code<br>
<p>
#include  &lt;iostream&gt;<br>
<p>
int main() {<br>
  std::cout &lt;&lt; "Hello, world!" &lt;&lt; std::endl;<br>
  return 0;<br>
}<br>
<p>
<p>
takes about 9x as long to compile using G++ compared to your idiomatic C code in GCC (0.27s vs 0.03s). Even building the C code in G++ takes 0.07s which is twice as long as GCC and about the same time as clang (not clang++).<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984296/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984302"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 18:05 UTC (Thu)
                               by <b>quotemstr</b> (subscriber, #45331)
                              [<a href="/Articles/984302/">Link</a>] (13 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; That isn't C++ code, that is C code passed through a C++ compiler that uses nothing more than function calls.</span><br>
<p>
It's C++ code that also happens to be valid C code. Compiling it as C++ is just as fast as compiling it as C. This result refutes mb's claim that compiling C++ is necessarily slow. There are more nuanced points to be made, as you do, but mb is dead-to-rights wrong.<br>
<p>
<span class="QuotedText">&gt; Once you start using templates like std::cout (which is what every C++ tutorial uses), compilation suffers dramatically as template instantiation can create the equivalent of thousands of lines of code, all for it to be deleted by a later compiler pass. </span><br>
<p>
And if you instantiate a C macro 8,000 times, performance suffers. Nobody is forcing you to use &lt;iostream&gt; or std::cout just because you're writing C++<br>
<p>
<span class="QuotedText">&gt; idiomatic C code in GCC (0.27s vs 0.03s)</span><br>
<p>
The Linux kernel isn't "idiomatic" C. Why should it be "idiomatic" C++? If the kernel can avoid massive macro expansions, it can avoid massive template instantiation too. My point is that both macros and C++ metaprogramming generate code, but the latter is a safer and more concise way to get to the same endpoint. <br>
<p>
There's nothing *inherent* in C++ that turns tight C programs into bloated Boost-Spirit-style masses of template expansions and specialization, no more so that C inherently turns programs into mazes of CPP macros.<br>
<p>
C++ template is a better meta-programming system than C macros, hands down. Neither language makes metaprogramming mandatory.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984302/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984307"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 18:12 UTC (Thu)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/984307/">Link</a>] (12 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt;This result refutes mb's claim that compiling C++ is necessarily slow. </span><br>
<p>
Not true.<br>
<p>
If all you have is C code, why on earth do you want to compile it with a C++ compiler?<br>
Of course you would have C++ code (templates) in there.<br>
That was *your* point. You want to replace C macros with C++ templates.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984307/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984312"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 18:36 UTC (Thu)
                               by <b>quotemstr</b> (subscriber, #45331)
                              [<a href="/Articles/984312/">Link</a>] (11 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
C++ makes you pay only for what you use. Why would a simple template be more expensive to instantiate than a simple preprocessor macro would be to expand? It's not as if C++ has only two mods: 1) C, and 2) Boost. There are plenty of useful intermediate points.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984312/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984314"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 18:47 UTC (Thu)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/984314/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Well, the simple fact that all existing C++ projects are slow to build.<br>
People use the features that are available.<br>
<p>
That's why they abuse the C preprocessor to the max (hehe) and that's why C++ features will be used, if available.<br>
That is the whole point of compiling with a C++ compiler.<br>
<p>
Show me a single C++ project that builds as fast as a comparable C project.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984314/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984316"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 18:49 UTC (Thu)
                               by <b>quotemstr</b> (subscriber, #45331)
                              [<a href="/Articles/984316/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The same argument applies to Rust, which if anything is even worse than C++ on monomorphization bloat potential, yes? Why worry about people abusing C++ metaprogramming but not Rust metaprogramming?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984316/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984317"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 18:51 UTC (Thu)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/984317/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yes, Rust has the same compilation speed problems.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984317/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984406"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2024 19:53 UTC (Fri)
                               by <b>walters</b> (subscriber, #7396)
                              [<a href="/Articles/984406/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
One thing that is definitely relevant and nice about Rust here though is that if you do e.g. `const FOO` you are guaranteed constant-time evaluation in an efficient way.<br>
<p>
And some of the major offenders seemed to end up being constant values:<br>
<p>
<a href="https://lwn.net/ml/all/CAHk-=wjPr3b-=dshE6n3fM2Q0U3guT4reOoCZiBye_UMJ-qg1A@mail.gmail.com/">https://lwn.net/ml/all/CAHk-=wjPr3b-=dshE6n3fM2Q0U3guT4re...</a><br>
<p>
```<br>
  #define pageblock_order    min_t(unsigned int, HUGETLB_PAGE_ORDER,<br>
MAX_PAGE_ORDER)<br>
```<br>
<p>
That could be `const PAGEBLOCK_ORDER: u32 = ...`...except yes,  I don't think there's any way yet to do min/max() (i.e. in a generic fashion) yet in Rust...blocked on "const fn in traits" <a href="https://github.com/rust-lang/rfcs/pull/2632">https://github.com/rust-lang/rfcs/pull/2632</a> I think? But one can trivially define a `const fn` for it and use it like:<br>
<p>
```<br>
mod someotherlib {<br>
    pub(crate) const FOO: u32 = 42;<br>
}<br>
<p>
const fn min_u32(a: u32, b: u32) -&gt; u32 {<br>
    if a &lt; b {<br>
        a<br>
    } else {<br>
        b<br>
    }<br>
}<br>
<p>
const BASIC_VAL: u32 = 20;<br>
const SOMEVAL: u32 = min_u32(someotherlib::FOO, BASIC_VAL);<br>
```<br>
<p>
There may even be a crate for `const fn` variants like that although it may be getting somewhat "left-pad" territory.<br>
<p>
(And maybe I am missing a clever way to use the more elegant, generic and Rust-native Ord trait <a href="https://doc.rust-lang.org/std/cmp/trait.Ord.html#method.min">https://doc.rust-lang.org/std/cmp/trait.Ord.html#method.min</a> in const expressions).<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984406/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984421"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2024 20:03 UTC (Fri)
                               by <b>adobriyan</b> (subscriber, #30858)
                              [<a href="/Articles/984421/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
__inline constexpr auto pageblock_order = min&lt;unsigned int&gt;(hugetlb_page_order, max_page_order);<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984421/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor984520"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 5, 2024 14:02 UTC (Mon)
                               by <b>cencer</b> (subscriber, #40823)
                              [<a href="/Articles/984520/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
FWIW C23 added support for constexpr objects https://open-std.org/JTC1/SC22/WG14/www/docs/n3018.html<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984520/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor984484"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 4, 2024 5:04 UTC (Sun)
                               by <b>ssmith32</b> (subscriber, #72404)
                              [<a href="/Articles/984484/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
No. That's been proved wrong above.<br>
<p>
If you're making a claim about *all* C++ projects, then, if there exists one C++ project that contradicts your point, you are *wrong*. <br>
<p>
So, you're wrong. QED.<br>
<p>
You could try a little nuance and subtlety...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984484/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984486"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 4, 2024 8:20 UTC (Sun)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/984486/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yes, you are right.<br>
A completely made up nonsense project that only exists to prove that I am wrong builds as fast as C.<br>
Any other real world projects builds slowly.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984486/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor984444"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2024 10:34 UTC (Sat)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/984444/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; It's not as if C++ has only two mods: 1) C, and 2) Boost. There are plenty of useful intermediate points.</span><br>
<p>
and _that_ is the problem with C++. Which intermediate point do you allow in your project?  No one can tell and endless debates ensue.<br>
<p>
For instance, everyone agrees that "modern" C++ is much more memory safe than C[*].  But what exact "intermediate point" is "modern"? Which "old" and unsafe features are now forbidden and must be replaced in everyone's code base at great re-validation expense? No one knows; not even Stroustrup: <a href="https://thenewstack.io/bjarne-stroustrups-plan-for-bringing-safety-to-c/">https://thenewstack.io/bjarne-stroustrups-plan-for-bringi...</a> By the time C++ experts have agreed on that, even Rust will be obsolete and replaced.<br>
<p>
This is what happens when you have too many cooks.<br>
<p>
[*] memory safety is not very important but it's a fashionable topic nowadays /s<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984444/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984445"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2024 12:20 UTC (Sat)
                               by <b>malmedal</b> (subscriber, #56172)
                              [<a href="/Articles/984445/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Herb Sutter has made a proposal that you can actually try yourself: <a href="https://hsutter.github.io/cppfront/">https://hsutter.github.io/cppfront/</a> I find it better than C++, but unsure if it is enough better to be worth the hassle. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984445/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984459"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2024 16:18 UTC (Sat)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/984459/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Interesting! I sincerely hope the C++ community eventually converges on one of these approaches that eventually wins over all the others and that one day every project can just check a box to add a safety check CI that rejects "old" C++. As long as you don't have such a simple level of automation, "modern C++" will keep being a science experiment. Sutter's proposition looks like it's ready for that, nice! Now it just needs to win :-)<br>
<p>
I don't know whether it will help with other C++ issues (e.g.; Perl-like, "write-only" possibilities) but having a memory safe C++ would be great for humankind. No, I'm not exaggerating: think about the gazillions of C++ lines the world depends on.<br>
<p>
Besides being a great language in itself, I think Rust has created a lot of pressure for C++ to (literally) clean up its act. Competition is good! Discussions about languages tend to be passionate, especially on "asocial" media but it would be great for the real world to end up with TWO good alternatives.<br>
<p>
You just don't want "too much" competition and too much fragmentation either, especially not with programming languages: there's no room for 10 different C++ variants - which is the problem for now. Funny for a language to be so old and so experimental and immature at the same time.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984459/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor984426"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2024 21:40 UTC (Fri)
                               by <b>magfr</b> (subscriber, #16052)
                              [<a href="/Articles/984426/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      That is not the recommended way to write Hello World! in C++ any more.
The new fancy way as of C++23 is

<pre>
#include &lt;print&gt;

int main()
{
  std::println("Hello World!");
}
</pre>



      
          <div class="CommentReplyButton">
            <form action="/Articles/984426/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984437"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2024 2:39 UTC (Sat)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/984437/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Oh thank ****, they're finally getting rid of iostream?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984437/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor984442"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2024 9:47 UTC (Sat)
                               by <b>excors</b> (subscriber, #95769)
                              [<a href="/Articles/984442/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That's based on the {fmt} library (<a href="https://fmt.dev">https://fmt.dev</a>), which has a basic benchmark at <a href="https://github.com/fmtlib/fmt?tab=readme-ov-file#benchmarks">https://github.com/fmtlib/fmt?tab=readme-ov-file#benchmarks</a> . fmt::print() is 5x faster to compile than libc++ iostreams, with half the executable size, and 3x faster run-time. Compared to libc printf it's 3x slower compile time, same executable size, and 20% faster run time (it sounds like most of the difference is in formatting floats).<br>
<p>
If you're not using C++20/23, you should probably use {fmt} anyway - I think it's an almost entirely compatible superset of the new std::format/std::print APIs, and it only requires C++11, and it's better than iostreams in every way.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984442/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor984303"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 18:02 UTC (Thu)
                               by <b>wtarreau</b> (subscriber, #51152)
                              [<a href="/Articles/984303/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It's even more visible on any project that combines both. "make" scrolls fast for a while and suddenly comes to a halt, and when you look at the last two lines, the first one starts with gcc and the second with g++. Anyone who builds libs regularly is used to seeing this!<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984303/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984305"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 18:17 UTC (Thu)
                               by <b>adobriyan</b> (subscriber, #30858)
                              [<a href="/Articles/984305/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Linux++ needs<br>
<p>
a) modules -- Microsoft claims importing _all_ of std is faster then _including_ just some headers (?) (&lt;vector&gt; ?)<br>
this solves (in theory) compile time degradation (which exists, Linux++ compiles noticeably slower than Linux)<br>
<p>
b) gcc needs to support C99 initializers in their full glory:<br>
forcing devs to place initalizers in order is downgrade in kernel programming experience.<br>
Clang can do it. See : <a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=113124">https://gcc.gnu.org/bugzilla/show_bug.cgi?id=113124</a><br>
<p>
c) tell clang devs that arithmetic on "void*" is fine, so both compilers can be supported<br>
<p>
gcc has -Wno-pointer-arith and Universe didn't collapse.<br>
<p>
Tell both groups that "void* - void*" is fine!<br>
<p>
d) deal with RESF<br>
does Rust support extern "C++" and what else is necessary? I don't know.<br>
Presumably interop goes via extern "C" but (!) all of kernel becomes extern "C++" and they want to interop potentially with _all_ kernel subsystems!<br>
<p>
Everything else is minor nuisance in comparison.<br>
<p>
Except implicit casts from void* to T* which is non issue but undoing 25 years of removing efforts in 1 commit... Oh.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984305/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984332"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 23:53 UTC (Thu)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/984332/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I was going to say "no, of course Rust doesn't do extern C++, nobody does that" - but it turns out I'm wrong and they do have extern "thiscall", which is Microsoft for "C++ but only if you use MSVC's mangling (which is also supported by GCC and Clang via __attribute__() syntax)." Unfortunately, according to MSDN:<br>
<p>
<span class="QuotedText">&gt; On ARM, ARM64, and x64 machines, __thiscall is accepted and ignored by the compiler. That's because they use a register-based calling convention by default.</span><br>
<p>
As far as I can tell, that works out to thiscall being usable on every platform *except* (modern) Windows, which is mildly amusing (and presumably not an issue for Linux, but IDK maybe it gives the WSL people a headache).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984332/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984337"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2024 0:57 UTC (Fri)
                               by <b>DanilaBerezin</b> (guest, #168271)
                              [<a href="/Articles/984337/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; but IDK maybe it gives the WSL people a headache</span><br>
<p>
WSL is an actual virtual machine. So AFAIK it shouldn't.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984337/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984356"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2024 9:58 UTC (Fri)
                               by <b>aragilar</b> (subscriber, #122569)
                              [<a href="/Articles/984356/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
WSL2 is a virtual machine (with a bespoke kernel), WSL1 is not (which I guess is what the parent is referring to?). I'm not sure if anyone is using WSL1 though still (I've heard it's better for some things such as how access to the Windows file system is provided than WSL2).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984356/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor984355"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">WSL</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2024 9:59 UTC (Fri)
                               by <b>rschroev</b> (subscriber, #4164)
                              [<a href="/Articles/984355/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
To avoid any confusion: WSL 2 is a virtual machine. WSL 1 isn't; it's a compatibility layer, with the Windows kernel implementing a large subset of Linux system calls.<br>
<p>
"WSL is an actual virtual machine" is probably mostly true: I think WSL 2 is used much more than WSL 1.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984355/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984359"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">WSL</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2024 10:35 UTC (Fri)
                               by <b>WolfWings</b> (subscriber, #56790)
                              [<a href="/Articles/984359/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
WSL1 needs to be explicitly enabled at this point on any recent version of Windows freshly installed, WSL2 is the only supported out-of-the-box model by default now. So the defaults available for WSL installs realistically today? Yes, it's all virtualization.<br>
<p>
But also a shockingly convenient setup since you can still run Windows binaries inside the WSL environment as well since it's also all just a local virtualized CIFS mount into all the VM filesystems.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984359/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor984423"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">WSL</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2024 20:49 UTC (Fri)
                               by <b>Heretic_Blacksheep</b> (guest, #169992)
                              [<a href="/Articles/984423/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<a href="https://learn.microsoft.com/en-us/windows/wsl/compare-versions">https://learn.microsoft.com/en-us/windows/wsl/compare-ver...</a><br>
<p>
"WSL is an actual virtual machine," as far as most people refer to it is not wrong. Almost no one is referring to WSL1 these days and they'll usually remember to specify if they are.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984423/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor984298"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2024 18:01 UTC (Thu)
                               by <b>adobriyan</b> (subscriber, #30858)
                              [<a href="/Articles/984298/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Plot twist: C++ min(a, b) turns out to be faster than macroexpanding C min/max macros.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984298/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984429"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2024 22:51 UTC (Fri)
                               by <b>wahern</b> (subscriber, #37304)
                              [<a href="/Articles/984429/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <p>
The problematic macro mess does more than 2-argument std:min. The earlier version,
<code><pre>
#define min(x,y) ({ \
	const typeof(x) _x = (x); \
	const typeof(y) _y = (y); \
	(void) (&amp;_x == &amp;_y); \
	_x &lt; _y ? _x : _y; })
</pre></code>

is the std:min equivalent, and should be at least as easy on the compiler. (That said, while C23 has typeof, statement expressions are still non-standard.) A trivial min3 could be written using the same typeof trick. The newer min3 and min rely on __careful_cmp, which (among other features) is apparently intended to safely permit comparison of integers of different type, similar to the classic MIN macro, but without the signed -&gt; unsigned conversion pitfall which can happen with integral promotion at the highest integral rank.
</p>
<p>
Disclaimer: I've not done much C++, but looking at the template interface, and testing some sample code, AFAICT std:min requires integers of the same type. Please correct me if I'm wrong. I would imagine any solution that permits safely and optimally comparing differently typed integers is going to be messy in most languages. If it's not messy--or at least verbose--it's not likely going to produce the most efficient machine code. It would be interesting to compare an equivalent C++ template solution in terms compiler memory and CPU cost. I wouldn't hazard a guess, and wouldn't be surprised by any particular result.
</p>









      
          <div class="CommentReplyButton">
            <form action="/Articles/984429/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984443"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2024 10:02 UTC (Sat)
                               by <b>roc</b> (subscriber, #30627)
                              [<a href="/Articles/984443/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The point of this article is that that definition of `min` is not really easy on the compiler because it expands x and y twice each, and if you use enough nesting you get exponential blowup in the size of the preprocessed code. Yes, a lot of that code is inside `typeof` so is less work for the compiler than generating code to evaluate the expression's value, but generating and then parsing a huge amount of preprocessed code is still a problem.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984443/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984475"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2024 21:58 UTC (Sat)
                               by <b>wahern</b> (subscriber, #37304)
                              [<a href="/Articles/984475/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I was replying to a tongue-in-cheek comment about C++ min (I assumed std:min) being faster than the min version discussed in the article, and was just pointing out that the problematic min version in the article isn't comparable to C++ std:min; that the comparable version is the *older*, simpler min (the one I pasted into my comment). A C++ version with semantics similar to the problematic C preprocessor version would probably require some template meta programming--i.e. similar recursion. Whether it would induce as much memory allocation, I don't know. Maybe not.<br>
<p>
Given that we're only dealing with integral types, and any type narrower than an int will be promoted to an int--reducing the set of possible permutations--one wonders whether some manual enumeration might help. Perhaps there are issues with qualified types and otherwise coercing the compiler to match arguments to a small enough set of _Generic cases? Maybe this is where C++ would shine, with a well defined set of template type matching rules, plus constexpr. (GCC provides constexpr for C code, but only in very recent versions, in anticipation of constexpr in C23.)<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984475/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor984513"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 5, 2024 10:13 UTC (Mon)
                               by <b>kleptog</b> (subscriber, #1183)
                              [<a href="/Articles/984513/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
With GCC you can use __auto_type to avoid the double expansion. It's even used as an example for max() in the GCC docs. [1]<br>
<p>
[1] <a href="https://gcc.gnu.org/onlinedocs/gcc/Typeof.html">https://gcc.gnu.org/onlinedocs/gcc/Typeof.html</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984513/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984516"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 5, 2024 12:54 UTC (Mon)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/984516/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
What's the betting the definition of "max" is older than __auto_type. It's all very well all these fancy features, but how often are they closing the stable door after the horse has bolted (and no-one realises there should be a horse inside that particular stall ...)<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984516/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984560"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 5, 2024 16:25 UTC (Mon)
                               by <b>kleptog</b> (subscriber, #1183)
                              [<a href="/Articles/984560/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Oh never mind. If you look at the macros in the article, you'll see an __auto_type buried in there, so they are aware of its existence. Apparently, they want sufficiently more magic that its doesn't save them in this case.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984560/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor984480"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2024 23:13 UTC (Sat)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/984480/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
After experimentation, it looks like you're right that std::min() does protect the type of its arguments, but it does not prevent implicit coercion of its return value. The following compiles (with -Wall -Werror) and outputs -2 (on platforms where a byte is 8 bits, which is most of them):<br>
<p>
#include &lt;algorithm&gt;<br>
#include &lt;iostream&gt;<br>
<p>
char find_min(unsigned char a, unsigned char b){<br>
    return std::min(a, b);<br>
}<br>
<p>
int main(){<br>
    std::cout &lt;&lt; int(find_min(255, 254)) &lt;&lt; std::endl;<br>
}<br>
<p>
To be fair, that's not really something that std::min() is capable of fixing, nor is it specific to C++ (C will do exactly the same thing, given the opportunity). I personally see this as one of C and C++'s cardinal sins, but it's not a reason to prefer one over the other.<br>
<p>
(No this is not UB, according to <a href="https://en.cppreference.com/w/cpp/language/implicit_conversion#Integral_conversions">https://en.cppreference.com/w/cpp/language/implicit_conve...</a> it is implementation-defined before C++20 and wrapping after.)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984480/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor986332"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 20, 2024 7:29 UTC (Tue)
                               by <b>daenzer</b> (subscriber, #7050)
                              [<a href="/Articles/986332/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
FWIW, your example works only on platforms where char is signed by default (or if built with -fsigned-char), which it isn't for all Linux ABIs. Can make it work universally by changing find_min's return type to "signed char".<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/986332/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor984436"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2024 23:57 UTC (Fri)
                               by <b>iteratedlateralus</b> (guest, #102183)
                              [<a href="/Articles/984436/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
 Maybe the kernel should reconsider C++? <br>
<p>
I think the major hurdle there is to have Linus accept C++ as a language he wants to use. He is not a fan of the language.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984436/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor984458"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">C++</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2024 16:00 UTC (Sat)
                               by <b>Sesse</b> (subscriber, #53779)
                              [<a href="/Articles/984458/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The kernel has made its choice for C replacement, and that choice is quite clearly Rust.<br>
<p>
(I'm not saying the answer is right, nor wrong)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984458/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor984431"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Classification as...</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2024 23:31 UTC (Fri)
                               by <b>iteratedlateralus</b> (guest, #102183)
                              [<a href="/Articles/984431/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
would this be considered technical debt?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984431/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor984998"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">What a great story</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 9, 2024 16:32 UTC (Fri)
                               by <b>mbp</b> (subscriber, #2737)
                              [<a href="/Articles/984998/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Thanks Jonathan!<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/984998/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2024, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
