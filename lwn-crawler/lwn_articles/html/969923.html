        <!DOCTYPE html>
        <html lang="en">
        <head><title>Warning about WARN_ON() [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/969923/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/970329/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/969923/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>Warning about WARN_ON()</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Benefits for LWN subscribers</b>
<p>
The primary benefit from <a href="/Promo/nst-nag5/subscribe">subscribing to LWN</a>
       is helping to keep us publishing, but, beyond that, subscribers get
       immediate access to all site content and access to a number of extra
       site features.  Please sign up today!
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>April 18, 2024</br>
           </div>
Kernel developers, like conscientious developers for many projects, will
often include checks in the code for conditions that are never expected to
occur, but which would indicate a serious problem should that expectation
turn out to be incorrect.  For years, developers have been encouraged (to
put it politely) to avoid using assertions that crash the machine for such
conditions unless there is truly no alternative.  Increasingly, though, use
of the kernel's <tt>WARN_ON()</tt> family of macros, which developers were
told to use instead, is also being discouraged.
<p>
A longstanding way to test for a condition that cannot be recovered from is
the <a
href="https://elixir.bootlin.com/linux/latest/source/include/asm-generic/bug.h#L51"><tt>BUG_ON()</tt>
macro</a>, which includes a test for the unexpected condition:
<p>
<pre>
    /* This can never happen, honest, would I lie? */
    BUG_ON(foo_ptr == NULL);
</pre>
<p>
A <tt>BUG_ON()</tt> call leads directly to a kernel panic, resulting
(usually) in the machine being rebooted.  There are times when there is no
alternative, but use of <tt>BUG_ON()</tt> has been discouraged for years.
Crashing the machine deprives the user of any chance of reacting to the
problem or saving work and can make it harder to track down the source of
the problem.  Even so, there are something like 12,000 <tt>BUG_ON()</tt>
instances in the kernel (not counting <tt>BUILD_BUG_ON()</tt>, which
only affects the build process and is not discouraged in the same way).
<p>
Instead, developers are told to use <a
href="https://elixir.bootlin.com/linux/latest/source/include/asm-generic/bug.h#L74"><tt>WARN_ON()</tt></a>,
which puts a traceback into the kernel log but does not crash the machine
(in theory, at least, but keep reading).  The kernel's <a
href="https://docs.kernel.org/process/coding-style.html#use-warn-rather-than-bug">coding-style
document</a> says:
<p>
<blockquote class="bq">
	Do not add new code that uses any of the BUG() variants, such as
	BUG(), BUG_ON(), or VM_BUG_ON(). Instead, use a WARN*() variant,
	preferably WARN_ON_ONCE(), and possibly with recovery
	code. Recovery code is not required if there is no reasonable way
	to at least partially recover.
</blockquote>
<p>
Increasingly, though, developers are being told to avoid using
<tt>WARN_ON()</tt> as well.  There are a couple of reasons for that.  One
is that any <tt>WARN_ON()</tt> that can be triggered from user space can be
used, at a minimum, to spam the system log, obscuring other events and
perhaps affecting system performance.  The other reason, though, applies
even to <tt>WARN_ON()</tt> calls that cannot be triggered in this way.
<p>
The kernel contains a sysctl knob called <a
href="https://docs.kernel.org/admin-guide/sysctl/kernel.html#panic-on-warn"><tt>panic_on_warn</tt></a>.
It does exactly what its name suggests: if this option is set, any
<tt>WARN_ON()</tt> call will cause the system to panic.  In essence, it
turns <tt>WARN_ON()</tt> calls into <tt>BUG_ON()</tt> calls.  This option
is set by users who see any warning as a sufficiently suspicious event
that, when one happens,
it is better to kill the system and start over.  Such users include many
Android devices and the host kernels run at cloud providers (and beyond).
Any <tt>WARN_ON()</tt> that actually triggers, in other words, has the
potential to bring down a lot of machines.
<p>
The same coding-style document <a
href="https://docs.kernel.org/process/coding-style.html#do-not-worry-about-panic-on-warn-users">advises
developers</a> that this outcome is something that <tt>panic_on_warn</tt>
users have explicitly opted into:
<p>
<blockquote class="bq">
	However, the existence of panic_on_warn users is not a valid reason
	to avoid the judicious use WARN*(). That is because, whoever
	enables panic_on_warn has explicitly asked the kernel to crash if a
	WARN*() fires, and such users must be prepared to deal with the
	consequences of a system that is somewhat more likely to crash.
</blockquote>
<p>
The current pressure against <tt>WARN_ON()</tt> use is not entirely
consistent with this advice, though.  Thus, Alex Elder was recently
motivated to <a
href="/ml/linux-kernel/20240414170850.148122-1-elder@linaro.org/">send a
patch</a> changing the advice given in the coding-style document.  Gone is
the language suggesting that <tt>panic_on_warn</tt> users were getting what
they asked for; the new text reads:
<p>
<blockquote class="bq">
	The existence of this option is not a valid reason to avoid the
	judicious use of warnings. There are other options: ``dev_warn*()``
	and ``pr_warn*()`` issue warnings but do **not** cause the kernel
	to crash. Use these if you want to prevent such panics.
</blockquote>
<p>
Christoph Hellwig was quick to <a
href="/ml/linux-kernel/ZhzgTeEHFF19N3UZ@infradead.org/">call</a> this
change "<q>wronger than wrong</q>": "<q>If you set panic_on_warn you get to
keep the pieces</q>".  Laurent Pinchart <a
href="/ml/linux-kernel/20240414194835.GA12561@pendragon.ideasonboard.com/">pointed
out</a> that the suggested alternatives are not the same; they are much
easier to ignore and, thus, less effective at getting developers to fix the
problem that the warning is trying to draw attention to.  Greg
Kroah-Hartman, though, <a
href="/ml/linux-kernel/2024041510-tacky-childlike-fc6d@gregkh/">was
happy</a> to see this change.  The recommendation to avoid
<tt>panic_on_warn</tt> has been ignored, he <a
href="/ml/linux-kernel/2024041544-fester-undead-7949@gregkh/">said</a>, so
new <tt>WARN_ON()</tt> calls should not be added.
<p>
To summarize the situation: over the years, <tt>BUG_ON()</tt> has been seen
as so destructive that developers are simply <a
href="https://docs.kernel.org/process/deprecated.html#bug-and-bug-on">told
not to use it at all</a>.  The <tt>WARN_ON()</tt> macro has, instead, taken
its place; but in settings where <tt>panic_on_warn</tt> is set, the end
result of a <tt>WARN_ON()</tt> call is essentially the same.  So,
naturally, use of <tt>WARN_ON()</tt> is also now discouraged much of the
time.
<p>
Whether the proposed documentation change will be applied is unclear; the
kernel's befuddled documentation maintainer, who has happily not been
appointed the arbiter of the kernel's coding style, makes a point of not
applying coding-style changes in the absence of a clear consensus.  It is
not clear that a consensus on this change exists currently.  Regardless of
that change, though, developers will continue to be encouraged toward
logging functions like <tt>pr_warn()</tt> instead of <tt>WARN_ON()</tt> —
until somebody inevitably adds a <tt>panic_on_pr_warn</tt> sysctl knob and
the whole process starts over again.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Warnings">Warnings</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/969923/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor970342"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 18, 2024 14:50 UTC (Thu)
                               by <b>ukleinek</b> (subscriber, #56625)
                              [<a href="/Articles/970342/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
When I was faced the last time with review feedback to not add a WARN_ON I had the same thought you had at the end of the article about panic_on_pr_warn.<br>
<p>
However I suggest to use number suffixes to keep the function names somewhat handy also after say 10 iterations. So I suggest to add a WARN_ON1() that should be recommended until this one is frowned upon, too. That's when we introduce WARN_ON2(). The panic_on_... parameter would just get the same suffix. Otherwise we end up with panic_on_warn_now_really_2026_honestly_yesIknowThisIsABadIdea_new.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970342/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor970424"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 18, 2024 20:33 UTC (Thu)
                               by <b>roc</b> (subscriber, #30627)
                              [<a href="/Articles/970424/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This is a fantastic idea, bravo!<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970424/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor970442"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 18, 2024 22:34 UTC (Thu)
                               by <b>snajpa</b> (subscriber, #73467)
                              [<a href="/Articles/970442/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
*if* the WARN_ONs contained a kernel version, year, year+month (or ...?), one could teach the panic_on_warn to recognize a cut off, that would be used to limit the warns that trigger a panic to already-known subset (so the kernel can be upgraded, panic_on_warn stays at the same value for most of the fleet while keeping an eye on just a subset where it gets bumped)...<br>
<p>
but that's a big if :-D it would probably be ugly to annotate all WARN_ONs with a tag for when they appeared - and not all kernels get built from a git clone... perhaps there could be an indirect file where that information could live, auto-generated from git?<br>
<p>
not that I care personally to implement it, I am happy with the current panic_on_warn as is, without complaints<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970442/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor970544"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 19, 2024 17:32 UTC (Fri)
                               by <b>Heretic_Blacksheep</b> (guest, #169992)
                              [<a href="/Articles/970544/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Theoretically it should just be given a comment like "//added &lt;date&gt; for &lt;specific check case that shouldn't happen&gt; NOTE: if you panic on this, that's YOUR choice".   Just because people abuse a sysctl tweak doesn't mean the rest of its users should lose a useful tool, which is kinda what that documentation change suggests.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970544/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor970471"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 19, 2024 11:40 UTC (Fri)
                               by <b>tialaramex</b> (subscriber, #21167)
                              [<a href="/Articles/970471/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Right, this is like the Euphemism Treadmill. From a engineering point of view this is futile, and so it would be appropriate for someone to authoritatively say no, we're not wasting our time on this.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970471/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor970376"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 18, 2024 15:04 UTC (Thu)
                               by <b>shironeko</b> (subscriber, #159952)
                              [<a href="/Articles/970376/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
it really sounds like not adding new use of WARN defeats the point of panic_on_warn. If we go down that route why not just make panic_on_warn a no-op instead?<br>
<p>
If the idea is that current use of WARN is too liberal and people are using it in reachable code, the perhaps the better idea is to define strictly when WARN is appropriate? or create different macros for different use-cases. rather than a blunt "don't use this".<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970376/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973420"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2024 7:05 UTC (Mon)
                               by <b>cpitrat</b> (subscriber, #116459)
                              [<a href="/Articles/973420/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Exactly that! Though some people do want panic_on_warn. So make panic_on_warn a no-op and introduce a really_panic_on_warn for users who know what they are doing :-)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973420/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor970379"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 18, 2024 15:09 UTC (Thu)
                               by <b>pbonzini</b> (subscriber, #60935)
                              [<a href="/Articles/970379/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
100% agreed with Christoph here.<br>
<p>
pr_warn is a completely different thing than WARN_ON. If syzbot triggers a WARN it's because something ought to be impossible; it's exactly what fuzzing is supposed to detect.  A pr_warn instead would go completely undetected and is mostly pointless.<br>
<p>
WARN_ON vs. WARN_ON_ONCE is a different story: WARN_ON_ONCE does not spam the syslog so it's better than WARN_ON almost always. But the fact that panic_on_warn is used in production systems where you cannot see the logs is not the developers' problem.<br>
<p>
Personally I'm going to add WARN_ONs to KVM liberally just like we did so far.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970379/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor970455"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 19, 2024 7:22 UTC (Fri)
                               by <b>david.hildenbrand</b> (subscriber, #108299)
                              [<a href="/Articles/970455/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
... unfortunately I (the author of that change) has to learn on lwn.net about that discussion. To me, that says a lot about how much time was spent looking into the history of that documentation, which is part of the introducing commit [1].<br>
<p>
So yes, I'll also continue to use and ACK *sane* use of WARN_ON_ONCE. Just as documented.<br>
<p>
[1] <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=1cfd9d7e43d5a1cf739d1420b10b1e65feb02f88">https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/...</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970455/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor970386"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 18, 2024 15:17 UTC (Thu)
                               by <b>epa</b> (subscriber, #39769)
                              [<a href="/Articles/970386/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Surely the panic_on_warn flag should also apply to dev_warn* and pr_warn* calls?<br>
Or at least they should have their own flags to panic -- for people who really want that?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970386/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor971060"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 24, 2024 17:01 UTC (Wed)
                               by <b>crystalwood</b> (guest, #168140)
                              [<a href="/Articles/971060/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Why would you want that?  Those prints aren't necessarily meant to indicate a kernel fault; e.g. it could be complaining about hardware or firmware, and it might happen on every boot.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/971060/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973422"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2024 7:12 UTC (Mon)
                               by <b>cpitrat</b> (subscriber, #116459)
                              [<a href="/Articles/973422/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think this was sarcastic <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973422/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor970382"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 18, 2024 15:22 UTC (Thu)
                               by <b>mfuzzey</b> (subscriber, #57966)
                              [<a href="/Articles/970382/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The nice (from a developpers point of view) thing about WARN_ON is that gives a stack trace which can be helpful in understanding why the situation occured which dev_warn() and pr_warn() don't do. The stack trace is also "noisier" which seems to help getting the problem reported.<br>
<p>
Maybe WARN_ON_NEVER_PANIC() or WARN_ON_MAY_PANIC() ?<br>
<p>
But the reasoning for avoiding WARN_ON() related to the panic_on_warn option seems very strange to me.<br>
If the system administrator / device manufacturer decides that rebooting on a warning is important to them that's their perogative right?<br>
If people stop using WARN_ON()  then panic_on_warn becomes pointless and the said administrators lose whatever they thought they were gaining by panic_on_warn.<br>
<p>
<p>
<p>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970382/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor971059"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 24, 2024 16:55 UTC (Wed)
                               by <b>crystalwood</b> (guest, #168140)
                              [<a href="/Articles/971059/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I vote for WHINE_ON()<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/971059/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor970333"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 18, 2024 15:31 UTC (Thu)
                               by <b>atnot</b> (subscriber, #124910)
                              [<a href="/Articles/970333/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Every time this situation comes up, I think of how much it mirrors the postel's law fallacy. There, while in the short term being lax about accepting slighly incorrect code reduces the amount of breakage, in practice over time it just proliferates that breakage unnoticed, until someone writes something that actually adheres to the spec and everything blows up. The solution to this has generally been much stricter conformance test suites and tightening up of protocols.<br>
<p>
It's not quite the same thing, but I do wonder how much better tooling we would have and how much more bugs would be found early and how much more robust things would be if coding errors reliably caused some sort of panic.<br>
<p>
There was a blogpost recently that strengthened this to me:<br>
<span class="QuotedText">&gt; Take Unix for example. If you call close on a file descriptor you never opened, you get an error code back. If you call open and hand it a null pointer instead of a pathname? You get an error code back. Both of these are violations of a system call’s preconditions, and both are handled through the same error mechanism that handles “file not found” and other cases that can happen in a correct program.</span><br>
<span class="QuotedText">&gt; On Hubris, if you break a system call’s preconditions, your task is immediately destroyed with no opportunity to do anything else.</span><br>
<span class="QuotedText">&gt; But combined with the kernel’s habit of faulting any task that looks at it funny, this makes the system’s behavior very unusual compared to most operating systems.</span><br>
<span class="QuotedText">&gt; And it’s been great.</span><br>
<span class="QuotedText">&gt; Initially I was concerned that I’d made the kernel too aggressive, but in practice, this has meant that errors are caught very early in development. A fault is hard to miss, and literally cannot be ignored the way an error code might be.</span><br>
<a href="https://cliffle.com/blog/hubris-reply-fault/">https://cliffle.com/blog/hubris-reply-fault/</a><br>
<p>
As noted, it also has the advantage of removing an absolute ton of untested error handling code for things that should never occur.<br>
<p>
I do recognize that this is a bit unrealistic with the way the kernel is currently written and suddenly changing course on it would be extremely painful. But I think one has to be careful to not make this situation worse.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970333/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor970414"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Recovery because you Expect Failure</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 18, 2024 19:03 UTC (Thu)
                               by <b>k3ninho</b> (subscriber, #50375)
                              [<a href="/Articles/970414/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I've got a number of things I'm thinking about which earn the label 'anti-fragile behaviour'. We can make systemic choices to never leave Undefined Behaviour as just UB, because it always needs clear direction; we can have a 'failure domain' where WARN_ON would enter a debugging state if there are developer credentials in place (whether a development workstation or monitoring a prod system for a rare set of causes) or else to attempt recovery while anticipating failure; BUG_ON might write system state to predefined protected store and, if this BUG_ON has not been triggered since power-on, flag it as being hit and KEXEC a fresh kernel.<br>
<p>
Being explicit about recovery, about unplanned failure, allows people to plan for it and to be robust when it goes wrong. I have spare CPU cycles and gigabytes of RAM and non-volatile storage, and I will accept lower performance to protect against outages.<br>
<p>
K3n.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970414/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor970447"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 19, 2024 0:48 UTC (Fri)
                               by <b>khim</b> (subscriber, #9252)
                              [<a href="/Articles/970447/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <font class="QuotedText">&gt; It's not quite the same thing, but I do wonder how much better tooling we would have and how much more bugs would be found early and how much more robust things would be if coding errors reliably caused some sort of panic.</font>

<p>It would have never worked. Remember that Tony Hoare story <a href="https://youtu.be/ybrQvs4x0Ps?t=1059">about Algol users and FORTRAN users</a>. That was decades ago.</p>

<p>And story back then was exactly the same as it is today: Algol users though it's extremely silly to remove runtime checks even in production while FORTRAN users were more of <i>I don't care about the subscript error I just want it to run</i> variety.</p>

<p>And the whole thing with FORTRAN lovers (who, later, become a BASIC lovers, PHP lovers, JavaScript lovers, <a href="https://www.dreamsongs.com/RiseOfWorseIsBetter.html">worse is better</a>) works like that because of that <a href="https://en.wikipedia.org/wiki/Lemon_socialism">Lemon socialism</a> (aka <i>privatization of gains and socialized of losses</i>).</p>

<p>If you, personally, benefit from the ability to run code with subscript errors (or any other gratuitous bugs) and may shift the blame (and accompanying losses!) when the whole thing would, inevitably, fall aparts on someone else then, of course, you would want to have ensure that there are as few checks as possible. Very often that “someone else” is the poor guy who actually pays for the whole things when s/he purchases cheap chineese gadget.</p>

<p>If, on the other hand, you are developing software which is not enabler or some kind of <a href="https://en.wikipedia.org/wiki/Shovelware">shovelware</a>, but something you, personally, want to develop and use for extended period of time… then you would want to apply <a href="https://en.wikipedia.org/wiki/Fail-fast_system">fail fast</a> approach as much as possible.</p>

<p>Linus managed to marry these two approaches to a large extent <b>and this is precisely what made Linux kernel the most popular OS kernel in existence</b>, but, of course, there are always intrinsic tension between proponents of these two approaches.</p>



      
          <div class="CommentReplyButton">
            <form action="/Articles/970447/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor970391"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 18, 2024 16:04 UTC (Thu)
                               by <b>rgb</b> (subscriber, #57129)
                              [<a href="/Articles/970391/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
So the kernel has the inverse of a trigger warning which needs to be protected by a trigger warning. I need to take my medicine now.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970391/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor970392"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 18, 2024 16:40 UTC (Thu)
                               by <b>iabervon</b> (subscriber, #722)
                              [<a href="/Articles/970392/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It seems to me like Android devices and the host kernels at cloud providers are not supposed to be debugged (from inside the live system) or provide a way for users to save their work. Cloud providers want their systems to panic on any condition that's unanticipated, because that fits neatly into their handling of hardware failures, and they want debugging of these conditions to happen on test systems that are not following that policy.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970392/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor970394"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 18, 2024 16:53 UTC (Thu)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/970394/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
panic_on_pr_warn=1 when?<br>
<p>
<span class="QuotedText">&gt;  The recommendation to avoid panic_on_warn has been ignored</span><br>
<p>
So?<br>
"It hurts, if I do this."<br>
I don't see the problem.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970394/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor970396"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 18, 2024 17:16 UTC (Thu)
                               by <b>adobriyan</b> (subscriber, #30858)
                              [<a href="/Articles/970396/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
panic_on_warn is hilarious.<br>
<p>
Those protecting against exploits with panic_on_oops should "#define WARN_ON BUG_ON" and spare us from yet another kernel option.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970396/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor970443"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 18, 2024 22:42 UTC (Thu)
                               by <b>kees</b> (subscriber, #27264)
                              [<a href="/Articles/970443/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Compile-time-only behavioral control options means people using Distro kernels are out of luck. It's important to keep these kinds of things at least as a boot-time flag.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970443/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor970940"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 24, 2024 1:47 UTC (Wed)
                               by <b>jwarnica</b> (subscriber, #27492)
                              [<a href="/Articles/970940/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Or they are in-luck because their primary source of support - volunteer or paid - has made an explicit choice to limit the scope of support, and thus, be better able to credibly provide support for that.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970940/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor970433"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 18, 2024 21:11 UTC (Thu)
                               by <b>roc</b> (subscriber, #30627)
                              [<a href="/Articles/970433/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
My experiences at Mozilla taught me that you want two kinds of assertions:<br>
A) "Something is wrong and it is dangerous to proceed. Emit debugging information and terminate." (e.g. when you suspect memory corruption)<br>
B) "Something is wrong but it's not important enough to terminate. Emit debugging information and continue." (e.g. when something is at the wrong position on the screen)<br>
<p>
People often complained that severity-B warnings were too easy to ignore (e.g. while testing) and wanted to make them severity-A instead. They were wrong. You instantly realize that's a bad idea when you're trying to debug a severity-A problem and you can't because you keep hitting a different severity-B problem that is incorrectly being treated as severity-A. You do need telemetry and management discipline to make sure that severity-B problems are tabulated and not ignored.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970433/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor970533"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 19, 2024 15:27 UTC (Fri)
                               by <b>shironeko</b> (subscriber, #159952)
                              [<a href="/Articles/970533/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Just temporarily remove that other assert locally while you are debugging?<br>
<p>
Also fast forward to when one realize that other error is exactly what caused the error you are debugging.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970533/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor970572"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 20, 2024 4:31 UTC (Sat)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/970572/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The problem is that the definition of "important" varies with the use case. I would say we need to consider at least three different situations:<br>
<p>
1. A "pet" where all of the code running in userspace (regardless of UID) is either trusted or (adequately) sandboxed.<br>
2. A "cattle" where all of the code running in userspace is trusted or sandboxed.<br>
3. A "cattle" where some of the code running in userspace is not trusted and not (adequately) sandboxed.<br>
<p>
In case (1), panicking is a big deal. It could cause serious data loss. We do not want to do it. In cases (2) and (3), there is other infrastructure that will deal with a panic. We will not lose (much) data, and whatever data loss does happen is "priced in" (i.e. we have accepted that we may lose it and planned accordingly). In cases (1) and (2), continuing in an invalid or unexpected case is somewhat likely to be safe (though obviously not certain). In case (3), we know that userspace is actively trying to take over the system at least some of the time, and continuing in an invalid or unexpected case would potentially make it easier for them to do that.<br>
<p>
There is also:<br>
<p>
4. A "pet " where some of the code running in userspace is not trusted and not (adequately) sandboxed.<br>
<p>
This describes the average user's home computer. Unfortunately, in this case, we're screwed, because we have to choose between possibly losing data, and possibly letting an attacker take over the system.<br>
<p>
In this thread, I think most people are taking the position that (4) is a lost cause (or at least, it requires finer-grained security than panic_on_warn can provide - see for example seccomp, SELinux, etc.), and therefore panic_on_warn should be calibrated to the expectations of (3) and maybe (2). That entails using WARN_ON liberally in contexts where a genuinely unexpected or invalid state arises, but conservatively or not at all in more mundane situations that may simply reflect a userspace-level misconfiguration. (4) can then be configured with panic_on_warn disabled, and other security measures can be applied to the extent practicable.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970572/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor970439"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 18, 2024 21:58 UTC (Thu)
                               by <b>nevets</b> (subscriber, #11875)
                              [<a href="/Articles/970439/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I have a strict requirement in my code that all WARN_ON() calls are used only to show that a bug happened in the kernel. If it is hit, it's a bug (I agree that this should never be used for incorrect user space input).<br>
<p>
Panic on WARN should never trigger, and if it does, then a fix to the kernel is urgently needed.<br>
<p>
I truly believe that this use should be encouraged.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970439/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor970444"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 18, 2024 22:46 UTC (Thu)
                               by <b>kees</b> (subscriber, #27264)
                              [<a href="/Articles/970444/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This is exactly the intent of WARN*(). It should be use for expected-to-be-totally-unreachable condition. Killing the entire system (e.g. BUG) reduces the likelihood that it will get caught/debugged/etc. But if userspace can reach it, something is very wrong. (And this is why many deployments set panic_on_warn: something impossible happened: we can no longer trust the integrity of the system.)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970444/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor970644"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 21, 2024 16:08 UTC (Sun)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/970644/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; The recommendation to avoid panic_on_warn has been ignored</span><br>
<p>
Of course it has been "ignored", because:<br>
<p>
<span class="QuotedText">&gt; we can no longer trust the integrity of the system</span><br>
<p>
That's the simple reason why this advice has been ignored: because it's really bad!<br>
<p>
"Something that should never happen, happened. Let's pretend nothing important happened and keep running anyway this monolithic kernel written in the programming language of memory corruptions". Unbelievable.<br>
<p>
If some crazy people or unusual use cases want panic_on_warn to be OFF for $reasons then let them - but don't let them force that bad choice on everybody else by changing the semantics of existing APIs. That's even more unbelievable.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970644/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor970651"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 21, 2024 16:21 UTC (Sun)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/970651/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yes, I also have panic-on-{oops, warn, ...} and panic-reboot enabled on my server systems.<br>
<p>
It makes a whole lot of sense to reboot when the system got into a state that was thought to be impossible.<br>
Going on as if nothing happened is not an option for me.<br>
<p>
I do understand why this behavior would not be ideal on desktop systems.<br>
There I'd like to be notified and make the decision manually.<br>
<p>
Suggesting pr_warn for "impossible" states is taking away this decision from administrators. Which is wrong. Kernel developers cannot decide what to do in these cases, because there's no single correct answer.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970651/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor970654"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 21, 2024 18:01 UTC (Sun)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/970654/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; Suggesting pr_warn for "impossible" states is taking away this decision from administrators. Which is wrong. Kernel developers cannot decide what to do in these cases, because there's no single correct answer.</span><br>
<p>
This. The job of kernel _developers_ is to 1) provide APIs with a "scale" of error levels defined as best as possible. As simple a scale as possible, but not simpler 2) Thoroughly enforce it through code reviews. The latter is not easy because error handling is hard to test, rarely ever tested, formally defining "levels" is also hard and many developers don't care about errors. So it'll never be perfect. But it's not optional and must be done as best as possible.<br>
<p>
Then, what to do with these error levels is a POLICY decision that belongs to the _administrator_ and specific use cases. BTW the _same_ administrator can be dealing with errors differently depending on the use cases.<br>
<p>
"Mechanism, not policy". Default values matter and sometimes they must be adjusted (slowly and carefully) but developers should never remove some knobs or change their semantics only because of the perception that "some" administrators don't understand them. First, developers can't possibly understand all use cases. Then what about all the administrators who have been using the knobs as intended the whole time? Why should they suffer? <br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970654/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor970941"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 24, 2024 2:02 UTC (Wed)
                               by <b>jwarnica</b> (subscriber, #27492)
                              [<a href="/Articles/970941/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt;"Mechanism, not policy". Default values matter and sometimes they must be adjusted (slowly and carefully) but developers should never remove some knobs or change their semantics only because of the perception that "some" administrators don't understand them. First, developers can't possibly understand all use cases. Then what about all the administrators who have been using the knobs as intended the whole time? Why should they suffer?</span><br>
<p>
Opensource allows people to get into things deeper than credible levels of safety. <br>
<p>
Absolutely it is true that "developers can't possibly understand all use cases", which suggest their offer of software that works should be credible. Not in any legal sense of "warranty for a particular purpose" but some level of credible thinking, analysis, testing. If you've tested 13 scenarios, say you've tested 13 scenarios, not 255 scenarios since that is the next smallest data type.<br>
<p>
If the downstream user wants to open up the code and test more, fine. They can do that. But that wasn't what the upstream provided and implied they tested; the user then is on the hook for what happens.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/970941/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor971063"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Warning about WARN_ON()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 24, 2024 18:23 UTC (Wed)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/971063/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; But that wasn't what the upstream provided and implied they tested; the user then is on the hook for what happens.</span><br>
<p>
The number of clones, branches, commits/versions and the Kconfig combinatorial explosion is so huge that "tested upstream" does not really mean anything. At best you could have metric measuring some distance from a git tag from Linus and the ,config he uses but would that be very useful?<br>
<p>
The linux kernel is not a product, it's a very large set of legos.<br>
<p>
"Upstream" is not a location, it's a direction. It's in the name.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/971063/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2024, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
