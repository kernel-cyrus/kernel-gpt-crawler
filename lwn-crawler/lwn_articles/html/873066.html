        <!DOCTYPE html>
        <html lang="en">
        <head><title>A disagreement over get_mm_exe_file() [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/873066/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/872947/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/873066/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>A disagreement over get_mm_exe_file()</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>This article brought to you by LWN subscribers</b>
<p>
Subscribers to LWN.net made this article &mdash; and everything that
       surrounds it &mdash; possible.  If you appreciate our content, please
       <a href="/Promo/nst-nag3/subscribe">buy a subscription</a> and make the next
       set of articles possible.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>October 18, 2021</br>
           </div>
Differences of opinion over which kernel symbols should be exported to
loadable modules have been anything but uncommon over the years.  Often,
these disagreements relate to which kernel capabilities should be available
to proprietary modules.  Sometimes, though, it hinges on the disagreements
over the best way to solve a problem.  The recent discussion around the
removal of an export for a core kernel function is a case in point.

<p>
Loadable modules, of course, are chunks of kernel code that are loaded into
the core kernel after the system boots.  Most modules are device drivers,
but a surprising amount of kernel functionality can be built in modular
form.  While code that is built into the kernel can use any symbol that is
accessible via the usual C scoping rules, loadable modules are rather more
constrained; they can only use symbols that have been explicitly exported
to them.  In theory, the exported-symbol interface is tightly regulated;
in practice, tens of thousands of symbols have been exported over the
years without a lot of oversight.  That said, the community still sees
occasional disagreements when a module developer 
wants to use a symbol that core-kernel developers do not wish to export.
<p>
The AMD GPU developers have recently run into a problem.  While much
user-space graphics code has long since moved over to using the <a
href="/Articles/653071/">atomic mode-setting API</a>, it would seem that
Chrome&nbsp;OS has only partially made that transition.  By using a mix of old
and new(ish) APIs, Chrome&nbsp;OS can get itself into a position where the
hardware will no longer cooperate with it; to prevent that from happening,
the amdgpu driver restricts the use of overlay planes for all clients.  <a
href="https://lore.kernel.org/amd-gfx/JIQ_93_cHcshiIDsrMU1huBzx9P9LVQxucx8hQArpQu7Wk5DrCl_vTXj_Q20m_L-8C8A5dSpNcSJ8ehfcCrsQpfB5QG_Spn14EYkH9chtg0=@emersion.fr/">This
message from Simon Ser</a> describes the situation in more detail and,
undoubtedly, more correctly.
<p>
This restriction makes Chrome&nbsp;OS work, but it also unnecessarily constrains
other clients that do not mix the APIs in this way.  In an attempt to get
around this problem, Ser <a
href="https://gitlab.freedesktop.org/agd5f/linux/-/commit/0d4da915c7098eca2aa6f559f42e33b5e9c7c5e8">added
a patch</a> that calls <a
href="https://elixir.bootlin.com/linux/v5.15-rc5/source/kernel/fork.c#L1249"><tt>get_mm_exe_file()</tt></a>
to get the name of the program that user space is running.  If (and only
if) that name 
is <tt>chrome</tt>, the restriction on overlay planes is enforced.  This
allows Chrome&nbsp;OS to continue working in its accustomed manner while giving
more freedom to other clients.
<p>
What Ser didn't know was that, back in September, Christoph Hellwig had <a
href="https://git.kernel.org/linus/05da8113c9ba">removed the export for
that function</a>, making it unavailable to loadable modules.  Once Ser's
patch hit linux-next, its reference to a symbol that was no longer exported
caused the build to break; linux-next maintainer Stephen Rothwell then duly <a
href="/ml/linux-next/20211008113116.4bdd7b6c@canb.auug.org.au/">reported
the break</a> back to the relevant maintainers.  At that point, Ser became
aware that his change was not going to work in the mainline kernel.
<p>
Ser's first response was to <a
href="/ml/linux-next/_POw9ikafXoqSFqiOb8SZb_uvRZ4okgD4qrl4EtJ0UBiQTV7pwV3pJIM20eIzmpuFWDeBF9NPD00r72ttX0mZZ0bNeH_J44MoaB-jfjrQSU=@emersion.fr/">ask</a>
whether <tt>get_mm_exe_file()</tt> could be exported once again, since the
amdgpu driver now uses it.  Hellwig <a
href="/ml/linux-next/20211011073348.GA10672@lst.de/">made it clear</a> that
he was not interested in doing that.  In that message and those that
followed, Hellwig was rather less than polite in his explanations, even
after Ser requested a change of tone.  There was, however, a real point to
be made despite the way in which it was conveyed.
<p>
Why should the kernel not export <tt>get_mm_exe_file()</tt>?  Hellwig's point is
that kernel code should never vary its behavior based on the name of the
program that is running in user space.  That name is entirely under the
control of user space and can change at any time, either for malicious
reasons or just in the course of normal development.  Beyond that, Chrome&nbsp;OS
will, one assumes, eventually be fixed to no longer mix APIs in this way,
at which point the check in the amdgpu driver will no longer be necessary,
and may indeed be harmful.  There will be no way to know, though, when that
check can 
be taken out.  So this little quirk, based on the name of the running
program, is likely to stay around for a long time, long past when it is
actually useful.
<p>
The problem remains, though, that changing the behavior of the amdgpu
driver will break existing Chrome&nbsp;OS systems.
The correct solution, according to Hellwig, is to require user space to
explicitly opt into the less-constrained behavior.  Chrome&nbsp;OS will not take
that option and will continue to work; more modern applications can request
that the restriction be removed.  Ser <a
href="/ml/linux-next/eOlxebs_u0NKPwzSFL2q48CRHVKEXqiWyoQcHWDsG5qHnhrrphhwczUtgd4bE1o1988Jja35uxf3pWwn2lU8I_5Tmyk1WzeKYQ7yi9qS4sc=@emersion.fr/">didn't
like this solution</a>: "<q>No, we can't have a 'I_AM_NOT_BROKEN' ioctl
for each and every uAPI mis-use.  User-space detection has been determined
to be the best course of action.</q>"  Hellwig <a
href="/ml/linux-next/20211011080135.GA11242@lst.de/">stood firm</a> in his
insistence that, if an API change breaks user space, the only correct
solution is a new call to enable that new behavior.
<p>
On October 14, Ser <a
href="https://lore.kernel.org/amd-gfx/20211014153433.169454-1-contact@emersion.fr/T/#u">reverted
the patch in question</a> in the amdgpu tree.  It does not appear that the
separate API call is forthcoming, though; instead, it looks like the
original patch will just be carried in the Chrome&nbsp;OS kernel instead.  That,
too, is a reasonable solution to this problem; the Chrome&nbsp;OS
developers will 
know when they can drop that patch and, meanwhile, it will not clutter up
the mainline kernel.
<p>
This little episode shows how control over the exporting of symbols to
modules is used to constrain what those modules can do in the hope of
improving the quality of the kernel's code base as a whole.  The end result
in this case looks to be headed in the right direction, even if the path to
that solution 
was more unpleasant than it needed to be.  The kernel project has gotten
better over the years at upholding technical standards while treating
developers in a respectful way, but there is clearly still progress to be
made on both fronts.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Modules-Exported_symbols">Modules/Exported symbols</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/873066/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor873225"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 18, 2021 15:37 UTC (Mon)
                               by <b>ttuttle</b> (subscriber, #51118)
                              [<a href="/Articles/873225/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This is rather trivially broken, as &quot;chromium&quot; on Chromium OS may exhibit the same problem and won&#x27;t be recognized as quirky.<br>
<p>
I&#x27;d expect the driver to implement something of a finer-grained interlock -- if Chrome OS tries to enable the cursor plane when the overlay plane is being used incompatibly, refuse to do it! If an app is using the two APIs at once, it gets to keep both pieces when they interact poorly.<br>
<p>
The resulting quirk should then be implemented in Chrome OS, not in the kernel -- maybe that means checking the driver name, testing to see if the cursor plane can be enabled on top of a non-fullscreen overlay plane, and avoiding use of the overlay plane if so.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873225/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873273"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2021 13:20 UTC (Tue)
                               by <b>hwentland</b> (subscriber, #113339)
                              [<a href="/Articles/873273/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; if Chrome OS tries to enable the cursor plane when the overlay plane is being used incompatibly, refuse to do it</font><br>
<p>
Doing so crashes the ChromeOS compositor, which isn&#x27;t nice to do and something we&#x27;d like to avoid. Hence, Simon&#x27;s patch.<br>
<p>
I wasn&#x27;t entirely happy with Simon&#x27;s patch but it fixed an awkward issue that was specific to AMD HW which is why I decided to take it. Carrying the patch in the Chrome tree until its compositor is fixed seems to be the best solution.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873273/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873276"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2021 13:36 UTC (Tue)
                               by <b>ttuttle</b> (subscriber, #51118)
                              [<a href="/Articles/873276/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Chrome adding that patch to their local kernel is absolutely an option! I just think it doesn&#x27;t belong upstream at all.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873276/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor873496"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 20, 2021 19:15 UTC (Wed)
                               by <b>mjg59</b> (subscriber, #23239)
                              [<a href="/Articles/873496/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
How about a more general solution - provide a DRM-level sysfs interface that allows process name/quirk pairs to be added at runtime and then just make it a userland problem?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873496/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873510"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 20, 2021 21:27 UTC (Wed)
                               by <b>blackwood</b> (guest, #44174)
                              [<a href="/Articles/873510/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Just runs afoul of the kernels &quot;never a regression when only upgrading the kernel&quot; rule. Which apparently we ended up tossing in here because the solution is too awful to merge or something like that.<br>
<p>
In userspace (well mesa3d) we do this all properly with quirk options and separate config file that matches on binaries and a few other things. And we ship a default config file with known necessary quirks.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873510/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor873397"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 20, 2021 8:34 UTC (Wed)
                               by <b>taladar</b> (subscriber, #68407)
                              [<a href="/Articles/873397/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It would likely also affect all those electron and similar apps embedding chrome. Matching the binary name just seems like a really, really bad solution for Chrome bugs in particular, even worse than in general.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873397/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873469"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 20, 2021 15:33 UTC (Wed)
                               by <b>blackwood</b> (guest, #44174)
                              [<a href="/Articles/873469/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It would neither affect your chrome or chromium browser nor your electron apps, because they are not compositors, and do not run on top of the kernel modesetting driver directly.<br>
<p>
They do use the render side of drm, but that on is not quirked. Only when you have a chrome process that&#x27;s actually doing kms compositing will any hack kick in, and in that case you do want it. So if you look at it it&#x27;s by far not as silly as it looks at first glance, and there&#x27;s not actually any known bad impact where we do not want it.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873469/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor873226"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 18, 2021 16:54 UTC (Mon)
                               by <b>ddevault</b> (subscriber, #99589)
                              [<a href="/Articles/873226/">Link</a>] (12 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I wasn&#x27;t in love with Ser&#x27;s patch, but the response from Hellwig was totally uncalled for.<br>
<p>
Good opportunity to remind everyone that there&#x27;s a code of conduct for Linux now:<br>
<p>
<a href="https://www.kernel.org/code-of-conduct.html">https://www.kernel.org/code-of-conduct.html</a><br>
<p>
The old days of intelligent jerks is not acceptable in modern kernel development. Kernel hackers don&#x27;t spring forth from the earth ready to write perfect patches - novices become experts only with good mentoring, not with berating and rude comments.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873226/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873227"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 18, 2021 17:15 UTC (Mon)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/873227/">Link</a>] (10 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Is Ser a new hacker, or an old hand who should know better?<br>
<p>
Linus has learnt that flames are not wise in any circumstances, but most of his were aimed at lieutenants who should have known better.<br>
<p>
Christoph, well I think I&#x27;ve had the odd run-in with him, and he might not yet have learnt that lesson ...<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873227/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873228"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 18, 2021 17:19 UTC (Mon)
                               by <b>ddevault</b> (subscriber, #99589)
                              [<a href="/Articles/873228/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I don&#x27;t think it really matters, but Ser is an experienced hacker outside of the kernel domain, an expert in the Linux graphics stack, and has contributed 80 patches to Linux to date. But like all of his patches, this one was reviewed by several other people and discussed at length and was deemed sufficient for inclusion in drm-next, only to run into cross-tree problems which no one could have foreseen. It was only when it inconvenienced Christoph that he felt that it was appropriate to levy abuse at Simon.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873228/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873234"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 18, 2021 17:54 UTC (Mon)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/873234/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Hmm...<br>
<p>
If it&#x27;s a well-reviewed patch, then yes flames *are* inappropriate ...<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873234/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873240"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 18, 2021 18:01 UTC (Mon)
                               by <b>ddevault</b> (subscriber, #99589)
                              [<a href="/Articles/873240/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Flames are simply inappropriate, unconditionally. The conduct policy is not contingent on the quality of the patch.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873240/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor873356"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2021 20:58 UTC (Tue)
                               by <b>atnot</b> (subscriber, #124910)
                              [<a href="/Articles/873356/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I&#x27;m sure it&#x27;ll be a relief for prospective kernel developers to learn that they will not have abuse hurled at them for submitting well intentioned patches.<br>
<p>
...that is of course, unless someone somewhere suddenly arbitrarily decides that it&#x27;s acceptable and also they deserve it.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873356/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor873278"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2021 13:56 UTC (Tue)
                               by <b>pbonzini</b> (subscriber, #60935)
                              [<a href="/Articles/873278/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>&gt; was deemed sufficient for inclusion in drm-next</blockquote>

<p>And I'm surprised about that, because Christoph makes good points: "Independent of that a check for a specific program as the callers makes no sense whatsoever as a given program and change over time.   (<a href="https://lwn.net/ml/linux-next/20211011074316.GA10882@lst.de/">here</a>) You cement in a mapping of an executable name to map to what you consider a "bug" without any way to fix it up. Which is even worse for a something fast moving like chrome/chromeos which will eventually gets its act together and fix things while you'll keep a weird feature mismatch just for it around forever. (<a href="https://lwn.net/ml/linux-next/20211011075125.GA11098@lst.de/">here</a>)".

<p>We can discuss the form of his complaint, but I honestly do agree with him that this should not have made it past the maintainers.





      
          <div class="CommentReplyButton">
            <form action="/Articles/873278/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873280"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2021 13:59 UTC (Tue)
                               by <b>ddevault</b> (subscriber, #99589)
                              [<a href="/Articles/873280/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Like I said upfront, Simon&#x27;s patch was not great. That&#x27;s no excuse for abusive language on the mailing list.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873280/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873323"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2021 15:52 UTC (Tue)
                               by <b>pbonzini</b> (subscriber, #60935)
                              [<a href="/Articles/873323/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Sure, I&#x27;m all for improved language and attitude, though in this case improvements could have been made from both sides. From a purely technical point of view, I still wonder how the patch could have been accepted by the maintainers, and if it would have been caught before it reached linux.git.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873323/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873327"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2021 16:01 UTC (Tue)
                               by <b>ddevault</b> (subscriber, #99589)
                              [<a href="/Articles/873327/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yeah, that is a fair thing to be concerned about.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873327/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor873470"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 20, 2021 15:36 UTC (Wed)
                               by <b>blackwood</b> (guest, #44174)
                              [<a href="/Articles/873470/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It was accepted because we discussed it on irc. It is a terrible option, but also it&#x27;s a least terrible option if you want upstream to both Just Work everywhere as much as possible, and also not block drivers from not being able to enable features.<br>
<p>
The solution is now that we force cros to carry more downstream patches, and there was just a talk at lpc about how that&#x27;s not a great thing for anyone involved.<br>
<p>
Occasionally real world engineering just sucks.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873470/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873489"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 20, 2021 18:24 UTC (Wed)
                               by <b>mfuzzey</b> (subscriber, #57966)
                              [<a href="/Articles/873489/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Is the new (cros carries the patch) solution that bad?<br>
<p>
It should only be temporary until cros can fix their user space code.<br>
<p>
Also cros is a full OS with their own Linux tree so it&#x27;s already set up to handle kernel patches.<br>
<p>
Agreed that out of tree patches aren&#x27;t good but when they&#x27;re temporary like this I think that&#x27;s better than polluting the upstream kernel indefinitely.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873489/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor874190"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 28, 2021 9:30 UTC (Thu)
                               by <b>polyp</b> (guest, #53146)
                              [<a href="/Articles/874190/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think the developer, which seems experienced, should know better than to push for a patch this stupid. I mean, come on, changing the behavior of a driver based on the name of the executable? In the mainline kernel. That&#x27;s just beyond crazy....<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/874190/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor873245"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 18, 2021 19:46 UTC (Mon)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/873245/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It sounds like there&#x27;s a whole comedy of errors here...<br>
<p>
1. Google sucks. Fix your own trillion-dollar software!<br>
<p>
2. I&#x27;m speaking out of line here, but a kernel-side GPU driver sniffing a browser user-agent to hide bugs is one of the most insane things I&#x27;ve ever seen. What&#x27;s more is there already are hundreds of I_AM{_NOT,}_BROKEN ioctl special cases for things like this, but they belong in /usr/share/drirc.d/, not /usr/src/linux/.<br>
<p>
3. The fact that it&#x27;s still possible to wedge the GPU from userspace at all, let alone through exposed APIs. If the old API is that dangerous to expose in parallel then just make it a wrapper or emulation layer for the new one, and make the legacy users swallow any performance hit. It&#x27;s not like anyone will care about the weight of a few thousand extra lines of workarounds in *the amdgpu driver*.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873245/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor873247"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 18, 2021 20:32 UTC (Mon)
                               by <b>airlied</b> (subscriber, #9104)
                              [<a href="/Articles/873247/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The problem being with I_AM_NOT_BROKEN ioctls is that how do you fix something after the horse has bolted.<br>
<p>
Revert early works fine if you catch misbehaviour early, if you don&#x27;t then you have to fall back to more extreme measures.<br>
<p>
We have one in the drm where X.org used an API in a really bad way a year or two after the API has been deployed. We ended up putting a new API trapdoor for future X.org but for current X.org matching the name was the least offensive answer. Invariable people start adding heuristics to &quot;detect&quot; behaviour patterns which often end up worse.<br>
<p>
That and hch was being an asshole for no reason. He knows he was, and we do have a CoC.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873247/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873261"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2021 6:25 UTC (Tue)
                               by <b>pbonzini</b> (subscriber, #60935)
                              [<a href="/Articles/873261/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I am not sure I will ever see the Linux code of conduct enforced...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873261/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873268"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2021 10:29 UTC (Tue)
                               by <b>blackwood</b> (guest, #44174)
                              [<a href="/Articles/873268/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
fd.o does, but there&#x27;s some obvious limits on what that achieves of course.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873268/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873274"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2021 13:25 UTC (Tue)
                               by <b>hwentland</b> (subscriber, #113339)
                              [<a href="/Articles/873274/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Slide 8 if anyone is interested in the fd.o CoC transparency report: <a href="https://indico.freedesktop.org/event/1/contributions/24/attachments/33/44/State%20of%20the%20X.org%20-%20XDC%202021.pdf">https://indico.freedesktop.org/event/1/contributions/24/a...</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873274/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor873279"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">CoC enforcement</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2021 13:53 UTC (Tue)
                               by <b>corbet</b> (editor, #1)
                              [<a href="/Articles/873279/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      It's rare, but it does occasionally happen; here's <a href="https://lore.kernel.org/lkml/1f5fb434-ca4b-bc10-92c4-411087ddf717@linuxfoundation.org/">an example</a>.


      
          <div class="CommentReplyButton">
            <form action="/Articles/873279/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873324"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">CoC enforcement</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2021 15:56 UTC (Tue)
                               by <b>pbonzini</b> (subscriber, #60935)
                              [<a href="/Articles/873324/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It&#x27;s not a great example, to be honest. It paints the CoC more as a tool to avoid annoyances, than as a way to improve the community overall.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873324/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873390"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">CoC enforcement</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 20, 2021 5:25 UTC (Wed)
                               by <b>lkundrak</b> (subscriber, #43452)
                              [<a href="/Articles/873390/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Exactly my thoughts. If anything, it seems to me that the person in question needs help.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873390/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor873335"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shocked at Hellwig’s behavior</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2021 17:40 UTC (Tue)
                               by <b>ms-tg</b> (subscriber, #89231)
                              [<a href="/Articles/873335/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If I didn’t know this was real, I might have thought this was comedy exaggerated for effect, to show how horrible Linux maintainers behave.<br>
<p>
What can be done? I was under the impression that Linus was committed to protecting the community from this sort of behavior where, instead of teaching or documenting a policy decision to be referenced in the future, or laying out a case to build alignment around avoiding unintended consequences, the maintainer repeatedly attacked the person.<br>
<p>
The contrast to workplaces, where this would never be tolerated, is shocking to me in 2021.<br>
<p>
Why would anyone willingly subject themselves to an engineering culture where this is tolerated?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873335/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873353"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shocked at Hellwig’s behavior</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2021 20:26 UTC (Tue)
                               by <b>josefbacik</b> (subscriber, #90083)
                              [<a href="/Articles/873353/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There really isn&#x27;t anything to be done.  The CoC doesn&#x27;t mean anything if there aren&#x27;t consequences to actions.  The common refrain is &quot;this wasn&#x27;t OK, but X was right.&quot;  Because in the end being right is the thing the community cares about the most, not about being professional.<br>
<p>
And what are you going to do? Tell one of the most prolific developers to go away for X time and think about what they&#x27;ve done?  This is a common attitude for a lot of the most senior maintainers in the community, there doesn&#x27;t appear to be any will to have anything real come from violating the CoC.  And even if there was punishment, what&#x27;s to say that changes behavior?  Changing the behavior and culture is far more valuable than simply temporarily banning people and hoping they change their ways on their own, but a much harder thing to accomplish.<br>
<p>
To answer your last question, they wouldn&#x27;t.  Even people like me who have been around for a long time are asking themselves the same question, and for myself have decided that I&#x27;m going to step away after I wrap up a few outstanding projects.  The cost of dealing with the more hard to deal with members of this community is becoming too high of a price to pay.  There&#x27;s always new blood that will come in and take up space, but lots that just won&#x27;t engage in the first place, and a few that will decide they&#x27;re done and go do something else.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873353/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873367"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shocked at Hellwig’s behavior</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2021 23:26 UTC (Tue)
                               by <b>ms-tg</b> (subscriber, #89231)
                              [<a href="/Articles/873367/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; There really isn&#x27;t anything to be done. The CoC doesn&#x27;t mean anything if there aren&#x27;t consequences to actions. The common refrain is &quot;this wasn&#x27;t OK, but X was right.&quot; Because in the end being right is the thing the community cares about the most, not about being professional.</font><br>
<p>
Even if this is the widespread response — does t the community want more people to align on what is “right” over time? If so, should teaching, writing policy documentation that can be referenced, and otherwise acting like effective engineering leaders be preferred?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873367/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873373"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shocked at Hellwig’s behavior</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 20, 2021 0:59 UTC (Wed)
                               by <b>josefbacik</b> (subscriber, #90083)
                              [<a href="/Articles/873373/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Even if this is the widespread response — does t the community want more people to align on what is “right” over time? If so, should teaching, writing policy documentation that can be referenced, and otherwise acting like effective engineering leaders be preferred?</font><br>
<p>
Yes exactly, that is the ideal outcome.  My point is there&#x27;s no pressure mechanism to push the community in that direction, the majority of senior developers and maintainers are comfortable with the status quo.  I want it to change, but I&#x27;m tired and simply don&#x27;t want to it anymore, and I suspect I&#x27;m not alone in that, so the end result will be more of the same for the foreseeable future.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873373/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873392"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shocked at Hellwig’s behavior</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 20, 2021 6:16 UTC (Wed)
                               by <b>pbonzini</b> (subscriber, #60935)
                              [<a href="/Articles/873392/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      The kind of depressing part is that it shouldn't be too hard. Like in the first message of the thread you just s/utter&nbsp;crap/bad&nbsp;ideas/ and you've done 99% of the job.

<p>That said, asking "Have you heard about the kernel no-regression rule?" sarcastically is not respectful either, and like most sarcasm it just comes across as silly/petty to me. So it's not like either side has an especially high ground.



      
          <div class="CommentReplyButton">
            <form action="/Articles/873392/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor874161"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shocked at Hellwig’s behavior</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 27, 2021 17:37 UTC (Wed)
                               by <b>nilsmeyer</b> (guest, #122604)
                              [<a href="/Articles/874161/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think the public nature of it all can cause it to spiral quickly since both are &quot;performing&quot; in frot of an audience. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/874161/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor874166"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shocked at Hellwig’s behavior</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 27, 2021 18:45 UTC (Wed)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/874166/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
All it needs is for Linus to weigh in with a &quot;what were you thinking about&quot; flame.<br>
<p>
But it probably does need Linus to weigh in and say &quot;cut this stuff out!&quot; A few Linus fireballs and that would almost certainly do the trick ...<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/874166/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor873376"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 20, 2021 1:25 UTC (Wed)
                               by <b>ilammy</b> (subscriber, #145312)
                              [<a href="/Articles/873376/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This reminds me of the story how old Windows had a hack in its kernel to avoid Age of Empires game crash, also specifically disabling some paging thing for AoE binaries.<br>
<p>
(Side note: I find it very sad that I was not able to find the source of this story because all search engine outputs are polluted all sorts of irrelevant things.)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873376/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873377"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 20, 2021 1:46 UTC (Wed)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/873377/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It was a workaround in Windows 3.1 for the DOS version of Sim City.<br>
<p>
<a href="https://www.joelonsoftware.com/2004/06/13/how-microsoft-lost-the-api-war/">https://www.joelonsoftware.com/2004/06/13/how-microsoft-l...</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873377/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor873400"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 20, 2021 8:48 UTC (Wed)
                               by <b>immibis</b> (guest, #105511)
                              [<a href="/Articles/873400/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I suspect Windows has a more sophisticated way of managing compatibility hacks than !strcmp(process-&gt;exe_file-&gt;name, &quot;chrome&quot;)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873400/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873402"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 20, 2021 10:00 UTC (Wed)
                               by <b>excors</b> (subscriber, #95769)
                              [<a href="/Articles/873402/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I suspect Windows has many different ways of managing compatibility hacks, but one of those ways is basically comparing the executable name. See HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers in the registry - mine has a few entries for applications I&#x27;ve installed, like &quot;C:\Program Files (x86)\Steam\steamapps\common\Quake\Glquake.exe&quot;=DWM8And16BitMitigation (&quot;The fix offers mitigation for applications that work in 8/16-bit display color mode because these legacy color modes are not supported in Windows 8&quot; according to <a href="https://docs.microsoft.com/en-us/windows/deployment/planning/compatibility-fixes-for-windows-8-windows-7-and-windows-vista">https://docs.microsoft.com/en-us/windows/deployment/plann...</a>).<br>
<p>
There&#x27;s also some that appear to be pre-set by Windows (since they&#x27;re for applications I&#x27;ve never used), e.g. HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\PenService lists a bunch of executables like &quot;iexplore.exe&quot; and &quot;photoshop.exe&quot;, and then sets the DisableFlickGestureDetection flag on (I think) application-specific window class names.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873402/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor873404"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A disagreement over get_mm_exe_file()</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 20, 2021 10:31 UTC (Wed)
                               by <b>immibis</b> (guest, #105511)
                              [<a href="/Articles/873404/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
As you can see, they are stored in some kind of database, not just hard-coded willy-nilly. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/873404/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2021, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
