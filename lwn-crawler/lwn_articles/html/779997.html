        <!DOCTYPE html>
        <html lang="en">
        <head><title>The case of the supersized shebang [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/779997/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/779826/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/779997/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>The case of the supersized shebang</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Did you know...?</b>
<p>
LWN.net is a subscriber-supported publication; we rely on subscribers
       to keep the entire operation going.  Please help out by <a
       href="/Promo/nst-nag4/subscribe">buying a subscription</a> and keeping LWN on the
       net.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>February 18, 2019</br>
           </div>
Regressions are an unavoidable side effect of software development; the
kernel is no different in that regard.  The 5.0 kernel introduced a change
in the handling of the "<tt>#!</tt>" (or "shebang") lines used to indicate
which interpreter should handle an executable text file.  The problem has
been duly fixed, but the incident shows how easy it can be to introduce
unexpected problems and highlights some areas where the kernel's
development process does not work as well as we might like.
<p>
By longstanding Unix convention, an attempt to execute a file that does not
have a recognized binary format will result in that file being passed
to an interpreter.  By default, the interpreter is a shell, which will
interpret the file as a shell script.  If, however, the file starts with the
characters "<tt>#!</tt>", the remainder of the first line will be treated
as the name of the interpreter to use (and possibly arguments to be passed
to that interpreter).  This mechanism allows programs written in almost any
interpreted language to be executed directly; the user need never know
which interpreter is actually doing the work behind the scenes.
<p>
<blockquote>
[<b>Update</b>: as noted in the comments, the above behavior is the result
of both kernel and user-space code; in particular, the default to a shell
is implemented within current shells and C libraries.]
</blockquote>
<p>
The array used to hold the shebang line is defined to
be 128 bytes in length.  That naturally
leads to the question of what happens if the line exceeds that length.  In
current kernels, the line will simply be truncated to fit the buffer, after
which execution proceeds as normal.  Or, at least, as normal as can be
expected given that part of the shebang line is now missing.  Recently,
Oleg Nesterov decided that this behavior is wrong; it could cause
misinterpreted arguments or, should the truncated line happen to be the
valid name of an interpreter executable in it own right, run the wrong
interpreter entirely.  He put together a patch (<a
href="https://git.kernel.org/linus/8099b047ecc4">merged for 5.0-rc1</a>)
changing that behavior; the kernel would fail the attempt to find an
alternative interpreter entirely in that situation, causing a fallback to
the default shell.
<p>
<h4>Trouble for NixOS</h4>
<p>
The <a href="https://nixos.org/">NixOS</a> distribution, it seems, takes an
unusual approach to the management of scripts.  As noted in <a
href="/ml/linux-kernel/CAN1fySViLgrLAHHfTHMef-Bkh73kUHKP-ava6TbgALeSE4LfFw@mail.gmail.com/">a
problem report</a> posted by Samuel Dionne-Riel on February&nbsp;13, NixOS
scripts can have shebang lines like:
<p>
<pre>
    #! /nix/store/mbwav8kz8b3y471wjsybgzw84mrh4js9-perl-5.28.1/bin/perl
       -I/nix/store/x6yyav38jgr924nkna62q3pkp0dgmzlx-perl5.28.1-File-Slurp-9999.25/lib/perl5/site_perl
       -I/nix/store/ha8v67sl8dac92r9z07vzr4gv1y9nwqz-perl5.28.1-Net-DBus-1.1.0/lib/perl5/site_perl
       -I/nix/store/dcrkvnjmwh69ljsvpbdjjdnqgwx90a9d-perl5.28.1-XML-Parser-2.44/lib/perl5/site_perl
       -I/nix/store/rmji88k2zz7h4zg97385bygcydrf2q8h-perl5.28.1-XML-Twig-3.52/lib/perl5/site_perl
</pre>
<p>
This line has been split for (relative) ease of reading; it is all a single
line in
the files themselves.  This line exceeds the maximum length by a fair
amount, triggering the new code.  The end result is that the Perl
interpreter is not invoked as expected and the attempt to execute the file
fails.  User-space code reacts by  passing the script to a
shell, which rather messily fails to do the right thing with it.  In other
words, a change intended to prevent scripts from being passed to the wrong
interpreter caused the system to start passing scripts to the wrong
interpreter. The NixOS
developers, rightly, saw this change as a regression; something that used
to work no longer does with the 5.0 kernel.
<p>
One might well wonder just how things worked before, since a truncated
version of that shebang line is still wrong.  It turns out that the Perl
interpreter is able to detect this truncation; it rereads the first line
itself and sets its arguments properly.  As long as the interpreter itself
is the correct one, things will work as expected.  As of 5.0-rc1, though,
the correct interpreter would no longer be invoked, and things went
downhill from there.
<p>
The kernel project's policy on this kind of change is clear, but Linus
Torvalds <a
href="/ml/linux-kernel/CAHk-=wjtH5ombebghG-SDNGppJF4a5bZAUqndtZ3tauWjgw5_w@mail.gmail.com/">reiterated
it</a> in this case anyway:
<p>
<div class="BigQuote">
	It doesn't matter if it "corrupted" things by truncating it. All
	that matters is "it used to work, now it doesn't"
<p>
	Yes, maybe it never *should* have worked. And yes, it's sad that
	people apparently had cases that depended on this odd behavior, but
	there we are.
</div>
<p>
The change has since been <a
href="https://git.kernel.org/linus/cb5b020a8d">reverted</a>, so NixOS will
be able to run 5.0 kernels.  There is work being done to achieve the
original goal (preventing the kernel from possibly running the wrong
interpreter) while not breaking existing users; that is proving harder than
one might expect and will almost certainly have to wait for&nbsp;5.1.
<p>
<h4>Regressions in stable kernels</h4>
<p>
Had that been the end of the story, it would have been just another case of
a regression introduced during the merge window, then corrected during the
stabilization period.  But, as it happens, this change found its way into
the <a href="/Articles/779597/">4.20.8</a>, <a
href="/Articles/779599/">4.19.21</a>, <a
href="/Articles/779600/">4.14.99</a>, and <a
href="/Articles/779601/">4.9.156</a>
stable kernel updates, despite the fact that neither the author nor the
maintainer who merged it (Andrew Morton) had marked it for stable
backporting.  Morton <a
href="/ml/linux-kernel/20190214122027.c0df36282d65dc9979248117@linux-foundation.org/">complained</a>,
noting that he had concluded that the patch should not be backported, but
that backport had happened anyway.
<p>
Not that long ago, the lack of an explicit tag would prevent a patch from
being backported to the stable releases, but the situation has changed
somewhat in recent years.
Along with many of the other changes in that set of especially large stable
kernel updates, Nesterov's patch had been automatically selected for
backporting by <a href="/Articles/764647/">Sasha 
Levin's machine-learning system</a>.  Greg Kroah-Hartman <a
href="/ml/linux-kernel/20190215070022.GD14473@kroah.com/">suggested</a>
that concerned developers and users should have noticed this patch and
complained before it was shipped: "<q>This came in through Sasha's
tools, which give people a week or so to say 'hey, this isn't a stable
patch!' and it seems everyone ignored that</q>".  The implication is
that, had people been paying attention, this regression would not have
found its way into the stable updates.

<p>
The patch in question was <a
href="/ml/linux-kernel/20190128154341.47195-301-sashal@kernel.org">flagged
for backporting</a> as part of a set of 304 selected for 4.20 on
January&nbsp;28.  It then found its way into the <a
href="/ml/linux-kernel/20190211141846.543045703@linuxfoundation.org">4.20.8
review notification</a> on February&nbsp;11.  That stable-release cycle
gave developers and users a mere 352 patches to look over, but perhaps some
understanding can be extended to those who didn't quite manage to evaluate
the whole set in time.  In truth, of course, there is little chance that
anybody can truly look at that patch volume (multiplied by several major
releases receiving stable updates at the same time) and pick out the bad
patch.  So some developers, <a
href="/ml/linux-kernel/20190215091000.GT4525@dhcp22.suse.cz/">such as
Michal Hocko</a>, have said (again) that the process of moving patches into
stable releases should be slower, perhaps waiting until those patches have
appeared in a major release from Torvalds.  That is especially true, <a
href="/ml/linux-kernel/20190218125603.GO4525@dhcp22.suse.cz/">he said</a>,
of the "<q>nice-to-have</q>" patches that don't address problems
users are complaining about.
<p>
Levin <a href="/ml/linux-kernel/20190215151912.GA10616@sasha-vm/">does not
think that will help</a>:
<P>
<div class="BigQuote">
	The fact is that many patches are not tested until they get to
	stable, whether we add them the same week they went upstream or
	months later.  This is a great case for this: I doubt anyone but
	NixOS does this crazy thing with shebang lines, so who else would
	discover the bug?
</div>
<p>
As a general rule, that might even be true, but it happens to not be in
this case: the NixOS developers <a
href="https://github.com/NixOS/nixpkgs/issues/53672">discovered the
problem</a> on January&nbsp;8, and <a
href="https://bugzilla.kernel.org/show_bug.cgi?id=202497">filed a
report</a> in the kernel bugzilla on February&nbsp;2.  The commit causing
the problem had been identified (through bisection) on February&nbsp;3.
Shipping the regression in the stable updates had nothing to do with its
discovery and reversion, in other words — the problem had already been
identified well before the stable kernels shipped it.
<p>
Even so, Levin <a
href="/ml/linux-kernel/20190215180026.GB10616@sasha-vm/">remains
adamant</a> that the process of automatically selecting patches for
backporting is the right thing to do:
<p>
<div class="BigQuote">
	The approach of manually deciding if a patch needs to go in stable
	is wrong and it doesn't scale. We need to beef up our testing story
	and make these decisions based off of that, and not our error-prone
	brains that introduced these bugs to begin with.
</div>
<p>
This is undoubtedly an issue that will arise again; there are a great many
fixes going into the kernel, and users of stable kernels (almost all of us)
benefit from getting those fixes.  But there are clearly some things that
can be improved here.  There was no test for this particular regression
because it had never occurred to anybody that things could break in that
way; we now know better, but no tests have been added yet.  A kernel
bugzilla instance that doesn't prevent a known-bad patch from getting into
a stable release is clearly not doing its job; the kernel community as a
whole lacks a convincing story on how bugs should be reported and tracked.
The kernel development process works well in many ways, but that does not
mean that it is without some glaring problems.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Development_model-Stable_tree">Development model/Stable tree</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/779997/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor780091"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 19:11 UTC (Mon)
                               by <b>TheJH</b> (subscriber, #101155)
                              [<a href="/Articles/780091/">Link</a>] (10 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; By longstanding Unix convention, an attempt to execute a file that does not have a recognized binary format will result in that file being passed to an interpreter. By default, the interpreter is a shell, which will interpret the file as a shell script.</font><br>
<p>
This part is implemented in userspace, not in the kernel; e.g. bash seems to implement this in shell_execve(), and glibc implements it for execlp() and execvp() in __execvpe_common(). Both of them do this when -ENOEXEC is returned by execve(). So if the kernel wants to hard-fail the execution of a file without letting userspace potentially fall back to script execution, it has to return a different error.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780091/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780099"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 19:55 UTC (Mon)
                               by <b>jspenguin</b> (guest, #120333)
                              [<a href="/Articles/780099/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It does implement it in the kernel. The glibc fallback is only for the case where there is no #! line, where bash will automatically assume it's a shell script, fork itself (without exec), and run the script under the child.<br>
<p>
You can verify the actual results of the system calls with strace. In the case of a script with a shebang, the execve call itself succeeds, indicating it was handled by the kernel.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780099/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780102"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 19:58 UTC (Mon)
                               by <b>TheJH</b> (subscriber, #101155)
                              [<a href="/Articles/780102/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I guess I should have written this more clearly; I was referring to the last quoted sentence, "By default, the interpreter is a shell, which will interpret the file as a shell script.".<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780102/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780275"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 18:49 UTC (Tue)
                               by <b>dona73110</b> (guest, #113155)
                              [<a href="/Articles/780275/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yeah, that line<br>
<p>
<font class="QuotedText">&gt;By default, the interpreter is a shell, which will interpret the file as a shell script</font><br>
<p>
is not really correct; it's a shell convention but the kernel will definitely _not_ use a default interpreter if the file does not start with #!<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780275/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780312"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2019 8:13 UTC (Wed)
                               by <b>epa</b> (subscriber, #39769)
                              [<a href="/Articles/780312/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Isn’t there an ancient convention, predating shebang lines, that if it doesn’t look like a binary executable it gets run through /bin/sh by default?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780312/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780317"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2019 11:19 UTC (Wed)
                               by <b>epa</b> (subscriber, #39769)
                              [<a href="/Articles/780317/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
OK, according to the historical lore linked later in this discussion, it's the shell that is responsible for treating an executable as a shell script if it looks like one.  Also Perl's exec() call does it.  But the raw system call and C library do not: trying to execl() an executable file which just contains 'echo hello' will fail.  It needs the shebang line.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780317/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780318"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2019 11:55 UTC (Wed)
                               by <b>pebolle</b> (guest, #35204)
                              [<a href="/Articles/780318/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Michael Kerrisk's TLPI (p. 575) points to execlp() and execvp() for that behaviour. A quick test showed that execlp() indeed treats such an executable file "as though [it] started with a line containing the string #!/bin/sh". <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780318/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780386"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2019 22:08 UTC (Wed)
                               by <b>foom</b> (subscriber, #14868)
                              [<a href="/Articles/780386/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Some shells *also* handle this themselves.<br>
<p>
E.g., with bash, if execve fails with -ENOEXEC, it will reset all the shell state and evaluate the #!-less script file directly in the post-fork bash process, rather than exec'ing anything at all (neither /bin/sh nor /bin/bash!)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780386/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780388"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2019 22:32 UTC (Wed)
                               by <b>pebolle</b> (guest, #35204)
                              [<a href="/Articles/780388/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I see. So it seems - or, put another way, strace showed me - that this behaviour of /bin/sh is what allows execlp() to do its, well, magic.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780388/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor780516"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 22, 2019 8:31 UTC (Fri)
                               by <b>epa</b> (subscriber, #39769)
                              [<a href="/Articles/780516/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Sounds like a handy trick to speed up your shell scripts!<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780516/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor780299"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2019 1:55 UTC (Wed)
                               by <b>scientes</b> (guest, #83068)
                              [<a href="/Articles/780299/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I came here to post the same thing. The article really should be fixed. Linux has nothing shell specific, and one of systemd's goals was to remove that dependancy, so reading this kind of irked me (really?????).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780299/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor780096"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 19:20 UTC (Mon)
                               by <b>fuhchee</b> (guest, #40059)
                              [<a href="/Articles/780096/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If you offload decisionmaking to a machine, and don't spend time supervising &amp; educating the machine on an ongoing basis, don't be surprised at surprising results.  Given the security vulnerability value of getting a malevolent patch into the -stable series, having the model available to play with allows adversaries to tune patches to pass that filter, and hide in the mob.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780096/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780314"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2019 9:35 UTC (Wed)
                               by <b>meuh</b> (guest, #22042)
                              [<a href="/Articles/780314/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Artificial intelligence gives artificial answers<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780314/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor780097"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Wrong interpreter</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 19:53 UTC (Mon)
                               by <b>rfunk</b> (subscriber, #4054)
                              [<a href="/Articles/780097/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
So if I understand the situation correctly, this patch was intended to avoid *maybe* getting the wrong interpreter (a situation that Unix users have known about for some 40 or 50 years) by falling back to the default shell -- which is almost certainly the wrong interpreter!<br>
<p>
If someone wanted to fix this longstanding misbehavior, the sensible approach would be to expand the interpreter-string buffer (maybe dynamically), not make over-long interpreter strings cause a fallback to a completely different interpreter.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780097/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780113"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Wrong interpreter</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 21:16 UTC (Mon)
                               by <b>jhoblitt</b> (subscriber, #77733)
                              [<a href="/Articles/780113/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The 128 char limit sounds like a lot but it has caused by a fair amount of grief over the years with build/CI systems with deep directly structures that host a copy of an interpreter in the bottom most leaves.  It would be fantastic if this could be increased, perhaps a sysctl default of the old 128 char limit.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780113/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor780124"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Wrong interpreter</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 22:20 UTC (Mon)
                               by <b>rgmoore</b> (<b>&#x272D; supporter &#x272D;</b>, #75)
                              [<a href="/Articles/780124/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <p>It's not just that they might get the wrong interpreter or (potentially more worrisome) get the right interpreter with a mangled set of parameters.  It's that at least some of the interpreters are smart enough to re-read the first line just in case it was truncated.  Honestly, re-reading the shebang line seems like the right thing for the interpreter to do.  The line is right there in the script that the interpreter has to read anyway, and it's documented that at least one operating system will mangle the line if it's too long.  Why wouldn't an interpreter reread it?
      
          <div class="CommentReplyButton">
            <form action="/Articles/780124/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780151"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Wrong interpreter</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 3:25 UTC (Tue)
                               by <b>gdt</b> (subscriber, #6284)
                              [<a href="/Articles/780151/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
From the interpreter author's point of view, they probably encountered this issue as non-program text appearing before the program text; their initial interest was unlikely to be around support of long argument lines but dealing with a compile bug.<br>
<p>
The interpreter authors were doing the 'right' thing: using the system library as intended and documented in the manual. That's why it doesn't initially occur to interpreter authors to re-construct the command line from argv and from the program text and then use a non-system parser to re-parse the command line options.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780151/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor780178"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Wrong interpreter</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 14:01 UTC (Tue)
                               by <b>NAR</b> (subscriber, #1313)
                              [<a href="/Articles/780178/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      The example Erlang script (escript) starts like this:

<PRE>
#!/usr/bin/env escript
%% -*- erlang -*-
%%! -smp enable -sname factorial -mnesia debug verbose
</PRE>

The first line is the portable shebang. Second is simple comment (maybe interpreted by emacs?), the third line also looks like a comment, but parsed by the interpreter and contains arguments for the interpreter. I guess this is done this way due to the limitations of <CODE>/usr/bin/env</CODE> so it cannot pass arguments directly to the interpreter. This seems to be a sensible approach.
      
          <div class="CommentReplyButton">
            <form action="/Articles/780178/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780272"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Wrong interpreter</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 18:30 UTC (Tue)
                               by <b>rweikusat2</b> (subscriber, #117920)
                              [<a href="/Articles/780272/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
-*- language -*- close to the start of some text file causes Emacs to switch to the major mode for language.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780272/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor780189"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Wrong interpreter</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 15:08 UTC (Tue)
                               by <b>anton</b> (subscriber, #25547)
                              [<a href="/Articles/780189/">Link</a>] 
      </p>
      
      </div>
      </summary>
      Gforth treats #! as starting a comment line.

<p>Why not reread the #! line and interpret it?  Because treating it as a comment is simpler, by quite a lot.  Consider a gforth script <code>script</code> that is invoked with

<pre>
./script scriptarg1 scriptarg2
</pre>

and starts with

<pre>
#! /usr/bin/gforth gfortharg
</pre>

Then the kernel constructs the following command line:

<pre>
/usr/bin/gforth gfortharg ./script scriptarg1 scriptarg2
</pre>

Note that gforth processes gfortharg before the rest of the command line.  Then, when it sees ./script, and the #! at its start, it might start doing something about this line.  But why, given that the kernel already does it nicely (well, in most cases at least)?

<p>One advantage of doing your own processing is that one could have more than one argument on the #! line, as demonstrated in the Perl case, but for now the pain has not been big enough to go to these lengths.

      
          <div class="CommentReplyButton">
            <form action="/Articles/780189/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor780278"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Wrong interpreter</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 19:00 UTC (Tue)
                               by <b>dona73110</b> (guest, #113155)
                              [<a href="/Articles/780278/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; So if I understand the situation correctly, this patch was intended to avoid *maybe* getting the wrong interpreter (a situation that Unix users have known about for some 40 or 50 years) by falling back to the default shell -- which is almost certainly the wrong interpreter!</font><br>
<p>
That's what corbet said but it's not exactly what's happening - if you look at the patch there's no default to a shell, it just returns an error that the file was not executable.<br>
<p>
The shell is the one that takes this "can't execute" error as a cue to interpret the file shell instead  :-x<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780278/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780279"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Wrong interpreter</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 19:11 UTC (Tue)
                               by <b>rfunk</b> (subscriber, #4054)
                              [<a href="/Articles/780279/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Wherever the shell fallback is implemented, the result is the same, so that seems irrelevant unless you're also going to patch all the shells that implement that fallback.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780279/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780310"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Wrong interpreter</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2019 6:49 UTC (Wed)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/780310/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Falling back on the default shell is not the same than falling back on the current shell.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780310/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor780107"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 20:57 UTC (Mon)
                               by <b>zblaxell</b> (subscriber, #26385)
                              [<a href="/Articles/780107/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
 #! /nix/store/mbwav8kz8b3y471wjsybgzw84mrh4js9-perl-5.28.1/bin/perl<br>
       -I/nix/store/x6yyav38jgr924nkna62q3pkp0dgmzlx-perl5.28.1-File-Slurp-9999.25/lib/perl5/site_perl<br>
       -I/nix/store/ha8v67sl8dac92r9z07vzr4gv1y9nwqz-perl5.28.1-Net-DBus-1.1.0/lib/perl5/site_perl<br>
       -I/nix/store/dcrkvnjmwh69ljsvpbdjjdnqgwx90a9d-perl5.28.1-XML-Parser-2.44/lib/perl5/site_perl<br>
       -I/nix/store/rmji88k2zz7h4zg97385bygcydrf2q8h-perl5.28.1-XML-Twig-3.52/lib/perl5/site_perl<br>
<p>
It seems odd to do that on the command line, when Perl has things like BEGIN{} blocks and @INC to manipulate the interpreter during the parse/compile phase.  Do other languages do what Perl does, or does NixOS do something else when the language isn't Perl?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780107/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780116"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 21:41 UTC (Mon)
                               by <b>jccleaver</b> (subscriber, #127418)
                              [<a href="/Articles/780116/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
perl has a very, very long tradition of DWIM-itude and silently adjusts for all sorts of weird behavior.<br>
<p>
I would not be surprised if this dated from the perl4 era or before, when one of the benefits of perl over shell was that it was a bit more predictable and forgiving than dealing with the *nix Wars' differing interpretations of sh/csh/ksh/tcsh/etc...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780116/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780165"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 10:07 UTC (Tue)
                               by <b>grawity</b> (subscriber, #80596)
                              [<a href="/Articles/780165/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <p>It gets better. If you give perl a script whose shebang line <em>does not</em> actually specify perl – e.g. if you accidentally run <code>perl ~/myscript.py</code> and that file specifies /usr/bin/python as interpreter – perl will helpfully run the script via /usr/bin/python for you.</p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/780165/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780624"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 24, 2019 9:17 UTC (Sun)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/780624/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
For a long time perl *also* had a bug where if the line looked like /path/to/perl$anyversion, it'd try to run it directly. That meant perl5 wouldn't run perl6 scripts at all, and probably would also break in weird situations with two perl5 environments on the system. It was fixed very recently, IIRC.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780624/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor780244"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 16:15 UTC (Tue)
                               by <b>roblucid</b> (guest, #48964)
                              [<a href="/Articles/780244/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
As a sysadmin who used Perl 4 there were key advantages over shell, otherwise some utilities would have to be C.  Perl was much faster than shell by reducing fork and calls to utilities, it gave access to the C library, so could read system DBM files for example directly.<br>
<p>
Indeed it re-read the #! line, IIRC to allow perl flags to be set and magic with env as perl at that time wasn't established in /usr/bin/perl.<br>
Perl had extreme portability, it would use some tricks to work on 'broken' systems too.<br>
<p>
The later Perl 5 gave more flexibility, but using dynamic libraries made the installation more fragile.  <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780244/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor780157"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 7:01 UTC (Tue)
                               by <b>epa</b> (subscriber, #39769)
                              [<a href="/Articles/780157/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Pasting together a command line with -I and other flags is something you can do programmatically and reliably, but editing the program text itself to add BEGIN blocks or whatever is much hairier.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780157/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780250"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 17:02 UTC (Tue)
                               by <b>zblaxell</b> (subscriber, #26385)
                              [<a href="/Articles/780250/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Not really?  Assuming it's a one-time adjustment during install, you just prepend, and in many cases you don't even need BEGIN:<br>
<p>
#! /nix/store/mbwav8kz8b3y471wjsybgzw84mrh4js9-perl-5.28.1/bin/perl<br>
use lib qw(<br>
  /nix/store/x6yyav38jgr924nkna62q3pkp0dgmzlx-perl5.28.1-File-Slurp-9999.25/lib/perl5/site_perl<br>
  /nix/store/ha8v67sl8dac92r9z07vzr4gv1y9nwqz-perl5.28.1-Net-DBus-1.1.0/lib/perl5/site_perl<br>
  /nix/store/dcrkvnjmwh69ljsvpbdjjdnqgwx90a9d-perl5.28.1-XML-Parser-2.44/lib/perl5/site_perl<br>
  /nix/store/rmji88k2zz7h4zg97385bygcydrf2q8h-perl5.28.1-XML-Twig-3.52/lib/perl5/site_perl<br>
);<br>
<p>
possibly adjusted to deal with the subtle differences between BEGIN { unshift(@INC, 'foo' }, use lib qw(foo), and -Ifoo--I remember there are some, but I don't remember what they are.<br>
<p>
IIRC Perl 4 doesn't have 'use' or 'BEGIN', so perl4 definitely needs the shebang hack...but perl4 also implements a lot of bizarre stuff like "execute perl embedded in non-MIME-encoded email message", and...not the shebang hack (or at least it's not documented).  Perl4 and NixOS are separated by a decade, so I doubt perl4's limitations had much to do with NixOS's design; however, early-2000's bugs in the Perl5 implementation could have been a problem for a project starting in 2003 (I know it was a problem with several of mine!).<br>
<p>
Anyway, the answer I was looking for is apparently "only Perl and Guile do that, and NixOS does it for historical reasons, and they're going to stop now."<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780250/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor802373"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 16, 2019 0:24 UTC (Wed)
                               by <b>cleverca22</b> (guest, #134998)
                              [<a href="/Articles/802373/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<a rel="nofollow" href="https://github.com/NixOS/nixpkgs/pull/55786">https://github.com/NixOS/nixpkgs/pull/55786</a><br>
<p>
and i have already written a PR to do exactly that<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/802373/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor780168"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 10:15 UTC (Tue)
                               by <b>zoobab</b> (guest, #9945)
                              [<a href="/Articles/780168/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
At least Nix knows how to reproductibility.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780168/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor780109"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 21:16 UTC (Mon)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/780109/">Link</a>] (15 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
What a mess. Several failures had to align perfectly for this to happen:<br>
<p>
1. NixOS doing weird things that only work because the Perl 5 runtime contains a hack to compensate for them (what do they do for other languages without a similar hack, and why is this one different?)<br>
2. The kernel using a fixed-size buffer with a weird legacy size (zero relation to PATH_MAX or ARG_MAX)<br>
3. There were no regression tests for this part of the kernel yet<br>
4. The kernel Bugzilla is functionally a bitbucket in a separate universe from normal kernel development<br>
5. As others have pointed out, the backporting process is only as smart as Youtube's recommendation algorithm<br>
<p>
Probably a few more I've overlooked too. After all that, we're left with only a revert and a vague promise to fix #3. That seems like a weak response at best.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780109/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780120"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 21:54 UTC (Mon)
                               by <b>grahamc</b> (guest, #111068)
                              [<a href="/Articles/780120/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; 1. NixOS doing weird things that only work because the Perl 5 runtime contains a hack to compensate for them (what do they do for other languages without a similar hack, and why is this one different?)</font><br>
<p>
Our Perl tooling is an older part of the NixOS ecosystem, and has received a bit less attention lately when compared to other languages. <br>
<p>
Perl's hack is not to compensate for us exactly, but presumably someone long ago who was bitten by the same problem. This hack existing is the reason we've allowed such a weird shebang to exist: it allowed us to and didn't cause us problems. Frankly, nobody noticed the shebang until the kernel broke it.<br>
<p>
We handle other languages much more sanely.<br>
<p>
<font class="QuotedText">&gt; 4. The kernel Bugzilla is functionally a bitbucket in a separate universe from normal kernel development</font><br>
<p>
Yes, this was a bit of a frustrating and troubling learning curve for us.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780120/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780121"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 21:56 UTC (Mon)
                               by <b>grahamc</b> (guest, #111068)
                              [<a href="/Articles/780121/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Oops, I meant to expand my reply to include: We're now fixing how Perl dependencies are handled, to not depend on gigantic shebangs.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780121/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780128"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 22:25 UTC (Mon)
                               by <b>rweikusat2</b> (subscriber, #117920)
                              [<a href="/Articles/780128/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There isn't really anything wrong with "depending on gigantic shebangs" with Perl as the perl program is supposed to handle this case to enable consistent behaviour regardless of #!-implementation limits like processing only one argument directly attached to the #! or truncating the line prior to parsing it (the perlrun manpage mentions a historic 32 character limit).<br>
<p>
A 127 character limit is documented behaviour for #! and Linux execve (the final byte being occupied by a 0).<br>
<p>
The patch (and everyone involved with that) is entirely to blame here as it changes documented, observable behaviour based on speculations about possible errors based on the wrong assumption that nothing but the kernel ever interprets the content of a #!-line. But perl has been intepreting this line since at least 5.004, probably longer (that's the earliest example I know of).<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780128/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor780122"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 22:08 UTC (Mon)
                               by <b>joncb</b> (guest, #128491)
                              [<a href="/Articles/780122/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That was pretty much my takeaway too.<br>
<p>
Fixing #4 seems like the way to go here. If the bug report managed to reach the right ear then the stable thing wouldn't have happened. Bonus points if this didn't require human input.<br>
<p>
There's a possible angle around having an explicit negative tag (i.e. "do not backport this") so that the system can distinguish between "human has decided this patch should not be backported" and "human has not evaluated this patch for backporting".<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780122/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor780125"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 22:32 UTC (Mon)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/780125/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; 2. The kernel using a fixed-size buffer</font><br>
<p>
That's not even slightly unusual. There are tons of places where syscalls and other kernel interfaces impose arbitrary limits on the sizes of things. Just about the only major exceptions are read()/write()-style interfaces such as file-likes and sockets.<br>
<p>
<font class="QuotedText">&gt; with a weird legacy size (zero relation to PATH_MAX or ARG_MAX)</font><br>
<p>
Frankly, I agree with the kernel here. Shebang lines are a convenience, and more importantly they're intended for use by the (userspace components of the) distro, and are accidentally useful to end users, but random other developers have (IMHO) no business writing shebang lines. The distro knows where Python is installed, so that it doesn't need to write #!/usr/bin/env python to force a PATH search. The distro has the prerogative (and responsibility) to stick interpreters in sensible directories like /usr/bin instead of some crazy deep path under /opt, so that short truncation is not a problem either. In short, shebangs are remarkably well-suited to the specific problems that distros need to solve when implementing standard binaries using a custom interpreter.<br>
<p>
The fact that shebangs also happen to be useful to end users sticking handy scripts in ~/bin is purely an accident. The idea that shebangs can or ought to be "portable" boggles the mind; just write a wrapper shell script. It's cleaner, more portable, and involves substantially less abuse of /usr/bin/env and other such "clever tricks."<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780125/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780136"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 22:48 UTC (Mon)
                               by <b>rweikusat2</b> (subscriber, #117920)
                              [<a href="/Articles/780136/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Frankly, I agree with the kernel here. Shebang lines are a convenience, and more importantly they're intended for use </font><br>
<font class="QuotedText">&gt; by the (userspace components of the) distro, and are accidentally useful to end users,</font><br>
<p>
<a href="https://www.in-ulm.de/~mascheck/various/shebang/4.0BSD_newsys_sys1.c.html">https://www.in-ulm.de/~mascheck/various/shebang/4.0BSD_ne...</a><br>
<p>
The assumption that people who aren't "involved with a distro" must be "end users" (who have no business programming anything) is ... interesting ...<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780136/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780142"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 1:24 UTC (Tue)
                               by <b>KaiRo</b> (subscriber, #1987)
                              [<a href="/Articles/780142/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
IMHO, even assuming that "end users" have no business programming is, erm, interesting, as I thought one point of FLOSS was that *anyone* can start programming and contributing.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780142/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor780164"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 9:36 UTC (Tue)
                               by <b>brooksmoses</b> (guest, #88422)
                              [<a href="/Articles/780164/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think you're misunderstanding NYKevin's point -- he specifically said "writing shebang lines", not "programming".<br>
<p>
If you're not writing code that's part a distro's userspace, you should (generally) be writing code to be portable across different distros.  (Even if you're an end-user with only one computer, you may well change your distro in the future and want to run your old code.)  However, a shebang line is not reliably portable -- to pick an example that I've recently been having pains with, "#!/usr/bin/python2" assumes that your distro has Python version 2 installed in /usr/bin/python2.  If you instead have only /usr/bin/python2.7, or /usr/local/bin/python2, or something else, then it doesn't work.  And shebangs don't follow the PATH, so you have to specify an absolute path.<br>
<p>
In the particular case I was having pains with, the relevant code was in a testsuite, and it would have been much nicer to have Autoconf find the right interpreter and then call it explicitly via something like "$PYTHON testfile.py".<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780164/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780177"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 13:48 UTC (Tue)
                               by <b>NAR</b> (subscriber, #1313)
                              [<a href="/Articles/780177/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <I>However, a shebang line is not reliably portable</I>
<P>
I guess that's why <CODE>/usr/bin/env</CODE> was invented for...
      
          <div class="CommentReplyButton">
            <form action="/Articles/780177/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780252"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 16:36 UTC (Tue)
                               by <b>rweikusat2</b> (subscriber, #117920)
                              [<a href="/Articles/780252/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Sort-of. It does a PATH seach internally. This may find some perl executable and it may even be the one supposed to execute a particular script. However, it might as well not. perl is a fairly stable execution environment, however, it has its share of "Let's break working stuff because it's just WRONG!" (that it works, presumably :-&gt;) people who add essentially random code changes[*] whose purpose doesn't seem to be known to anyone.<br>
<p>
[*] Eg, starting with perl 5.16, xs functions can't be loaded via Dynaloader anymore unless a new keyword is added to the existing   code. The documentation makes it very clear that loading xs-functions via Dynaloader Is Just Wrong[tm], but there's no positive justification for the change.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780252/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor780254"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 16:46 UTC (Tue)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/780254/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
No, that is not what /usr/bin/env was invented for. /usr/bin/env was invented for setting up different environment variables - that's why it's called "env."<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780254/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor780192"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 15:11 UTC (Tue)
                               by <b>rweikusat2</b> (subscriber, #117920)
                              [<a href="/Articles/780192/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
He wrote about "distro developers" vs "end user sticking scripts in ~/bin". This is a false dichotomy which is so false that it's laughable and all features of the system are ultimatively supposed to be useful to users.<br>
<p>
*If* you want to run other people's code, don't stick interpeters in /opt/var/local/ultima-thule/lib/bin/asterisk/moff just because this makes perfect sense to you.<br>
<p>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780192/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor780256"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 17:01 UTC (Tue)
                               by <b>zblaxell</b> (subscriber, #26385)
                              [<a href="/Articles/780256/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; However, a shebang line is not reliably portable</font><br>
<p>
I, for one, would prefer to solve that problem.<br>
<p>
i.e. have a namespace that I can reference from portable scripts, like "#!/prefix/org/python/python/2.7.5", where the python installation puts in as many symlinks as required to accurately state the level of backward compatibility achieved.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780256/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor780282"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 19:38 UTC (Tue)
                               by <b>jccleaver</b> (subscriber, #127418)
                              [<a href="/Articles/780282/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Frankly, I agree with the kernel here. Shebang lines are a convenience, and more importantly they're intended for use by the (userspace components of the) distro, and are accidentally useful to end users, but random other developers have (IMHO) no business writing shebang lines.</font><br>
<p>
That's... kind of insane. Is this point of view common? That might explain all the scripts I see written by devs (often java devs, but not always) that are kept chmod 644 and have no shebang.<br>
<p>
The first thing I do is make them executable and put the proper shebang in, unless there's some specific external $PATH call I need to wrap into it, which is just dumb... or weird.<br>
<p>
This actually feels like a decent shibboleth among *nix admins and... non-*nix developers.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780282/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor780130"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 22:39 UTC (Mon)
                               by <b>rgmoore</b> (<b>&#x272D; supporter &#x272D;</b>, #75)
                              [<a href="/Articles/780130/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <blockquote>Several failures had to align perfectly for this to happen:</blockquote>

<p>This is very often the case.  A functioning quality control system has multiple safeguards to protect defective products from being released, so any time one is released it must be the result of multiple failures.  That's why it's important to look at all the points of failure and try to fix them all rather than laying the blame on a single scapegoat.
      
          <div class="CommentReplyButton">
            <form action="/Articles/780130/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor780118"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 21:59 UTC (Mon)
                               by <b>aszlig</b> (subscriber, #91735)
                              [<a href="/Articles/780118/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Note that the actual problem here is not the ENOEXEC by itself, because the actual interpreter fits the 128 character limit. So returning ENOEXEC if the interpreter (but not the args) exceed the limit is fine (I think FreeBSD does it that way IIRC). The point where this was breaking things for us (and possibly other users) is that it was returning ENOEXEC if the *whole* shebang (including args) has exceeded the limit.<br>
<p>
Given that, I still wonder why we were the only ones hitting that bug so far, because I don't think Perl (and others) would add such a workaround if there were users hitting that issue.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780118/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780133"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 22:44 UTC (Mon)
                               by <b>dvdeug</b> (guest, #10998)
                              [<a href="/Articles/780133/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The perlrun manpage (mentioned above by rweikusat2) says "Because historically some operating systems silently chopped off kernel interpretation of the #! line after 32 characters, some switches may be passed in on the command line, and some may not; you could even get a "-" without its letter, if you're not careful." So the systems this was added for had one-fourth the limit Linux has, so it showed up much more often on them. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780133/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor780132"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 18, 2019 22:53 UTC (Mon)
                               by <b>rgmoore</b> (<b>&#x272D; supporter &#x272D;</b>, #75)
                              [<a href="/Articles/780132/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>I suspect that Perl has to include their workaround because there's more than one way to invoke a perl script.  They can be invoked either directly from the command line or by calling the interpreter with the script as an argument.  Because the arguments on the shebang line still have to work even if the script is called as an argument to the interpreter, the interpreter needs to be able to read them.  Automatically reading them no matter how the script is called seems like the logical approach to guarantee consistent behavior.
      
          <div class="CommentReplyButton">
            <form action="/Articles/780132/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor780147"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 2:06 UTC (Tue)
                               by <b>pabs</b> (subscriber, #43278)
                              [<a href="/Articles/780147/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Putting options into the shebang is generally not a good idea anyway, since someone could be running the script via the interpreter instead of running the script directly and the interpreter might not read the shebang to find its options.<br>
<p>
How many interpreters have special handling of the shebang like Perl does?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780147/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780152"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 4:34 UTC (Tue)
                               by <b>anguslees</b> (subscriber, #7131)
                              [<a href="/Articles/780152/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <p>It's much less common with the "modern" scripting languages (python/ruby), since they're usually treated as full-featured programming environments quite separate to any functionality they have as an interactive shell experience.

<p>Guile is pretty close, with a "\" "meta switch" and defining #! ... !# as comment delimiters.  You can do this:

<pre>
#!/usr/local/bin/guile \
-e main -s
!#
(define (main args)
  (display "hello, world!")
  (newline))
</pre>

Related, but different:

<p>Many other "scripting" languages use <code>#</code> as a comment character and can do some similar shell bootstrap hack too.  Most of these are used to lookup the language interpreter in the path, knowing only that <code>/bin/sh</code> exists.

<p>For some reason I never understood, the modern world has decided it is better to assume that <code>/usr/bin/env</code> exists instead (using env in this way still doesn't allow multiple args, unless you're using freebsd's <code>env -S</code> magic arg - also in coreutils 8.30 apparently).

<p>Perl:

<pre>
#!/bin/sh
#! -*-perl-*-
eval 'exec perl -x -wS $0 ${1+"$@"}'
    if 0;
# perl code continues here
</pre>

<p>Python:

<pre>
#!/bin/sh
''':'
if type python2 &gt;/dev/null 2&gt;/dev/null; then
  exec python2 "$0" "$@"
else
  exec python "$0" "$@"
fi
'''
# Python code continues here
</pre>

(and similar hacks for awk, ruby, etc)
      
          <div class="CommentReplyButton">
            <form action="/Articles/780152/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780167"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 10:14 UTC (Tue)
                               by <b>dottedmag</b> (subscriber, #18590)
                              [<a href="/Articles/780167/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
/usr/bin/env is always there, unlike other interpreters which may end up in /usr/bin, /usr/local/bin or, say, /opt/bin, depending on what the user installed on their machine (e.g. macOS MacPorts vs. Homebrew).<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780167/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780169"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 11:08 UTC (Tue)
                               by <b>Baughn</b> (subscriber, #124425)
                              [<a href="/Articles/780169/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Even NixOS has /use/bin/env, as the only file in /usr.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780169/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor780171"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 13:58 UTC (Tue)
                               by <b>DrHyde</b> (guest, #130508)
                              [<a href="/Articles/780171/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
/usr/bin/env is *not* always there. Some older or more obscure platforms have it elsewhere. IIRC I've run across this problem on SunOS and Unicos.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780171/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780246"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 16:01 UTC (Tue)
                               by <b>dbaker</b> (guest, #89236)
                              [<a href="/Articles/780246/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
One of my projects has some interesting hacks because Haiku has /bin/env (no /usr at all, IIRC)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780246/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780259"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 17:21 UTC (Tue)
                               by <b>DrHyde</b> (guest, #130508)
                              [<a href="/Articles/780259/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I believe that <a rel="nofollow" href="http://catb.org/jargon/html/V/vaxocentrism.html">http://catb.org/jargon/html/V/vaxocentrism.html</a> applies, except with modern Linux instead of VAX.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780259/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor780175"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 13:23 UTC (Tue)
                               by <b>smurf</b> (subscriber, #17840)
                              [<a href="/Articles/780175/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Those hacks are (a) wasteful (an extra interpreter needs to start up) and (b) fragile: Python, for instance, requires "from __future__ import …" statements to be the first statement in a file. Owch. "ln -s /bin/true /usr/bin/from", anybody?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780175/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780248"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 16:16 UTC (Tue)
                               by <b>tux3</b> (subscriber, #101245)
                              [<a href="/Articles/780248/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Experimentaly "from __future import ..." seems to work fine with a #!, or even random comments before.<br>
It seems python is happy as long as it's the first line actually executed, though the error message is confusing.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780248/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780249"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 16:17 UTC (Tue)
                               by <b>tux3</b> (subscriber, #101245)
                              [<a href="/Articles/780249/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Oh I just realized what message you were replying to, my mistake.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780249/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor780174"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 12:54 UTC (Tue)
                               by <b>bgoglin</b> (subscriber, #7800)
                              [<a href="/Articles/780174/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
typo in 1st sentence of 3rd paragraph: "to be be 128"<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780174/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780179"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 13:55 UTC (Tue)
                               by <b>tome</b> (subscriber, #3171)
                              [<a href="/Articles/780179/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
A bit OT but...<br>
<p>
I read the whole article and never noticed that typo until seeing your comment.  So it seems my brain did a perly DWIM on that sentence, or rather, RWTAM -- read what the author means.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780179/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor780184"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Typo</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 14:06 UTC (Tue)
                               by <b>corbet</b> (editor, #1)
                              [<a href="/Articles/780184/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      It's always the last change that gets you ... fixed.
<p>
For future reference, we prefer to get typo reports at lwn@lwn.net; that avoids cluttering the comment section with them.
      
          <div class="CommentReplyButton">
            <form action="/Articles/780184/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780277"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Typo</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 18:49 UTC (Tue)
                               by <b>tome</b> (subscriber, #3171)
                              [<a href="/Articles/780277/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Uh oh, I cluttered the clutter... and now this.  I'd best be quiet.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780277/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor780191"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">New version of the patch</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 15:03 UTC (Tue)
                               by <b>corbet</b> (editor, #1)
                              [<a href="/Articles/780191/">Link</a>] 
      </p>
      
      </div>
      </summary>
      I guess I was wrong about having to wait until 5.1 to try again; <a href="https://git.kernel.org/linus/b5372fe5dc84235dbe04998efdede3c4daa866a9">this patch</a> was just merged for 5.0.  It refuses to try to run a truncated interpreter name, but otherwise preserves the old behavior.
      
          <div class="CommentReplyButton">
            <form action="/Articles/780191/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor780258"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 17:21 UTC (Tue)
                               by <b>Anssi</b> (subscriber, #52242)
                              [<a href="/Articles/780258/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; If, however, the file starts with the characters "#!", the remainder of the first line will be treated as the name of the interpreter to use (and possibly arguments to be passed to that interpreter).</font><br>
<p>
Well, only a single argument, not "arguments".<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780258/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor780292"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 23:19 UTC (Tue)
                               by <b>ewen</b> (subscriber, #4772)
                              [<a href="/Articles/780292/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Leaving aside the initial regression (the #! line has always been prone to truncation; as other comments say it used to be truncated earlier in older Unixes, and older software like perl has workarounds for this for decades), the discussion about the regression induced in *stable* kernels is more worrying.  The discussion seems to be saying "whitelisting patches for the kernel stable tree is too hard and does not scale, so let's select them automatically and then let people blacklist the ones that shouldn't be backported".  The "spotting ones to blacklist" seems even less likely to reliably scale, with more false negatives ("spot the problem patch amongst the hundreds automatically added this week" missing some that should have been flagged "don't backport").<br>
<p>
If the "stable" kernels are going to have not-manually-selected/verified changes in them, and a shorter release cycle, it seems to me they'd increasingly become "alternative bleeding edge" kernels with older features, but "assorted newer patches added in for flavour."  At which point I wonder who would run them?  Those wanting actual stability probably end up relying on their distro kernel teams manual review, and those wanting the bleeding edge probably want the new features too.  In other words the explicit manual selection of "stable" changes, and the QA, is what makes them "stable" kernels.  Which seems increasingly not to be happening with the upstream kernel stable trees, because it's a lot of work.<br>
<p>
As a sysadmin my desire for "stable" anything is (almost) no regressions, and some fixes for critical issues.  Almost by definition with a preference for stability (ie, availability/reliability) over changes.<br>
<p>
Ewen<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780292/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor780293"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2019 23:47 UTC (Tue)
                               by <b>perennialmind</b> (guest, #45817)
                              [<a href="/Articles/780293/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>
It looks like musl libc doesn't have the rickety fallback to crazytown. I for one hope they leave this POSIX compliance "<a href="https://www.openwall.com/lists/musl/2018/03/09/1">bug</a>" as is.
</p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/780293/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor780303"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2019 4:10 UTC (Wed)
                               by <b>jeremyhetzler</b> (subscriber, #127663)
                              [<a href="/Articles/780303/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
More on how shebang works, and gory details of how it differs in various systems:<br>
<p>
<a href="https://www.in-ulm.de/~mascheck/various/shebang/">https://www.in-ulm.de/~mascheck/various/shebang/</a><br>
<p>
<p>
<p>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780303/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor780320"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2019 13:43 UTC (Wed)
                               by <b>smitty_one_each</b> (subscriber, #28989)
                              [<a href="/Articles/780320/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It's a shame that something bad happened, but, considering the man-years of effort put into the kernel and the princely sums paid to so many of the contributors...it almost seems a left-handed compliment that such boo-boos are so rare.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780320/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor780382"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Patch backports</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2019 20:32 UTC (Wed)
                               by <b>Spack</b> (subscriber, #77556)
                              [<a href="/Articles/780382/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
How come a test kernel can feed a stable kernel with backported patches? I would have expected that only patches within the Linux stable kernel 5.0 would be allowed to be backported to previous versions?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780382/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780548"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Patch backports</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 22, 2019 15:44 UTC (Fri)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/780548/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If that was the way it worked, then even serious bugs wouldn't get fixed more often than once every three months. That would render the stable kernels almost pointless, since you could always just upgrade to the also-stable Linus kernel the fixes came out of instead. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780548/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780608"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Patch backports</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 23, 2019 21:32 UTC (Sat)
                               by <b>NAR</b> (subscriber, #1313)
                              [<a href="/Articles/780608/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I guess people use -stable kernels because they explicitly do not want the latest version (due to fears about regressions, being locked to a version number, etc.). I don't know if they want a new -stable kernel every 3-4 days or just take a look at the top of their preferred -stable tree at their convenience (maybe once every quarter) and use that version.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780608/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780637"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Patch backports</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 24, 2019 22:52 UTC (Sun)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/780637/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I use stable kernels because I want serious bugfixes, stability fixes, and security fixes but don't want to run -rc kernels on the systems my job depends on that house all my data thankyouverymuch. This... does not seem like a terribly unusual requirement, to me. I specifically do not avoid updating because I "don't want the latest version": if I could reliably update without rebooting I'd do it within minutes of every stable kernel coming out (but ksplice is fiddly for a self-compiled kernel and requires patch-by-patch analysis to determine which changes can be applied and kgraft is just as bad, AIUI: not a thing you can just throw a new stable kernel at and say "magically update me to this without rebooting").<br>
<p>
Like most people operating small numbers of machines rather than huge failovered farms, I upgrade at irregular intervals, when a stable kernel with a bugfix seemingly serious enough to make it worth the annoyance-cum-terror of rebooting and flushing all my caches comes along -- though I suspect most people don't routinely read the git log and patch series of everything that hits -stable the way I do. (Rebooting is much less bad for performance than it used to be, thanks to bcache caching all the seeky metadata, but rebooting my core server is *always* terrifying: what if it never comes back up? It always has so far but this is a PC which means it's shit by definition, and I am not confident that all-Intel-mobo-plus-Intel-UEFI-only-one-corp-to-blame means it's reliable before the OS has started, not when I've *seen* the thing lock up once or twice when trying to enumerate its USB ports, exhaust some sort of watchdog timer, and autoreboot again before completing POST. I'm tempted to switch to kexec just to avoid most of that terror, but unfortunately kexec is even *less* routinely tested so the terror quotient would be greater. Yes of course I have backups, and backups of backups, and backups of backups of backups, but terror does not yield to common sense. I keep the ludicrous levels of backups anyway.)<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780637/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor781023"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Patch backports</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 1, 2019 1:48 UTC (Fri)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/781023/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'm thinking the whole concept of having a -stable branch might be wrong if this is how it works in practice. The label “stable” is always going to be wishful thinking at best, since the halting problem applies.<br>
<p>
One could argue it'd make sense to bless individual kernel versions as “stable” after a grace period passes with no complaints raised, but the existing process needs to be fixed so those complaints are heard before that can happen.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/781023/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor781091"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Patch backports</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 1, 2019 16:30 UTC (Fri)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/781091/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That's more or less what I do locally, with most of my systems containing no real persistent state (either all contents are rsynced nightly from the big network-critical server, or they're just outright NFS-mounted from it) and running latest stable and sometimes random rcs with local hacks... and said server running a "stable stable" which survived at least a couple of weeks on the other boxes, with obviously-crucial security fixes cherry-picked back into that if need be. (I tried the distributed systems approach, having N of every distributable crucial service on different machines, and found that unless you spent *ages* analyzing you ended up introducing N single points of failure rather than just one, so I've gone back to the "one great big single point of failure which is at least easy to identify" approach. It is also too heavy to lift and won't fit through the door so is probably fairly theft-proof.)<br>
<p>
This approach seems to work. I haven't lost any filesystems on the big server for, oh, almost a year now! :P<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/781091/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor780390"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2019 22:59 UTC (Wed)
                               by <b>neilbrown</b> (subscriber, #359)
                              [<a href="/Articles/780390/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Time for a new patch tag I guess:<br>
<p>
Fixes: NOTHING - don't ever back-port this to stable<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780390/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor780455"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The case of the supersized shebang</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 21, 2019 15:02 UTC (Thu)
                               by <b>rweikusat2</b> (subscriber, #117920)
                              [<a href="/Articles/780455/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
......... :-))<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780455/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor780409"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">binfmt_misc</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 21, 2019 8:24 UTC (Thu)
                               by <b>mm7323</b> (subscriber, #87386)
                              [<a href="/Articles/780409/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Couldn't you just use binfmt_misc to match on #! and then run a process that can open up the script and figure out the required interpreter and arguments in userspace?<br>
<p>
That should surely be possible for a distro that wants to do unusual things and only costs an extra exec() for starting up scripts which aren't known to be that fast anyway.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/780409/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2019, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
