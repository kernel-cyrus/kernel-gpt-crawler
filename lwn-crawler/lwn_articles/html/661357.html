        <!DOCTYPE html>
        <html lang="en">
        <head><title>Rich access control lists [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/661357/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/660867/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/661357/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>Rich access control lists</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>We're bad at marketing</b>
<p>
We can admit it, marketing is not our strong suit. Our strength is
writing the kind of articles that developers, administrators, and
free-software supporters depend on to know what is going on in the
Linux world. Please <a href="/Promo/nsn-bad/subscribe">subscribe today</a> to help us keep doing that, and so
we don’t have to get good at marketing.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>October 20, 2015</br>
           </div>
Linux has had support for POSIX access control lists (ACLs) since the
<a href="/Articles/14568/">2.5.46</a> development kernel was released in
2002 — despite the fact that POSIX has never formally 
adopted the ACL specification.  Over time, POSIX ACLs have been superseded
by other ACL mechanisms, notably the ACL scheme adopted with the NFSv4
protocol.  Linux support for NFSv4 ACLs is minimal, though; there is no
support for them at all in the virtual filesystem layer.  The Linux NFS server
supports NFSv4 ACLs by mapping them, as closely as possible, to POSIX ACLs.
Chances are, that will end with the merging of Andreas Gruenbacher's
<a href="/Articles/661078/">RichACLs patch set</a> for the 4.4 kernel.
<p>
The mode ("permissions") bits attached to every file and directory on a
Linux system 
describe how that object may be accessed by its owner, by members of the
file's group, and by the world as a whole.  Each class of user has three
bits regulating write, read, and execute access.  For many uses, that is
all the control a system administrator needs, but there are times where
finer-grained access control is useful.  That is where ACLs come in; they
allow the specification of access-control policies that don't fit into the
nine mode bits.  There are different types of ACLs, reflecting
their evolution over time.
<p>
<h4>POSIX ACLs</h4>
<p>
POSIX ACLs are clearly designed to fit in with traditional Unix-style
permissions.  They start by implementing the mode bits as a set of implicit
ACL entries (ACEs), so a file with permissions like:
<p>
<pre>
    $ ls -l foo
    -rw-rw-r--  1 linus penguins  804 Oct 18 09:40 foo
</pre>
<p>
Has a set of implicit ACEs that looks like:
<p>
<pre>
    $ getfacl foo
    user::rw-
    group::rw-
    other::r--
</pre>
<p>
The <tt>user</tt> and <tt>group</tt> ACEs that contain empty
name fields ("<tt>::</tt>") apply to the owner and group of the file itself.  
The administrator can add other <tt>user</tt> or <tt>group</tt> ACEs to
give additional permissions to named users and groups.  The actual access
control is implemented in a way similar to how the mode bits are handled.
If one of the <tt>user</tt> entries matches, the associated permissions are
applied.  Otherwise, if one of the <tt>group</tt> entries matches, that
entry is used; failing that, the <tt>other</tt> permissions are applied.
<p>
There is one little twist: the traditional mode bits still apply as well.
When ACLs are in use, the mode bits define the <i>maximum</i> permissions
that may be allowed.  In other words, ACLs cannot grant permissions that
would not be allowed by the mode bits.  The reason for this behavior is to
avoid unpleasant surprises for applications (and users) that do not
understand ACLs.  So a file with mode <tt>0640</tt> (<tt>rw-r-----</tt>)
would <i>not</i> allow group-write access, even if it had an ACE like:
<p>
<pre>
    group::rw-
</pre>
<p>
If a particular process matches a named ACE (by either user or group name),
that process is in the group class and is regulated
by the group mode bits on the file.  The owning group itself can be
given fewer permissions than the mode bits would otherwise allow.  See <a
href="http://users.suse.com/~agruen/acl/linux-acls/online/">this
article</a> for a detailed description of how it all works.
<p>
<h4>NFSv4 ACLs</h4>
<p>
When the NFS community took on the task of defining an ACL mechanism for
the NFS protocol, they chose not to start with POSIX ACLs; instead, they
started with something that looks a lot more like  Windows ACLs.  The
result is a rather more expressive and flexible ACL 
mechanism.  With one obscure exception, all POSIX ACLs can be mapped onto
NFSv4 ACLs, but the reverse is not true.
<p>
NFSv4 ACLs do away with the hardwired evaluation order used by POSIX ACLs.
Instead, ACEs are evaluated in the order they are defined.  Thus, for
example, a group ACE can override an owner ACE if the group ACE appears
first in the list.  NFSv4 ACEs can explicitly deny access to a class of
users.  Permissions bits are also additive in NFSv4 ACLs.  As
an example of this, consider a file with these ACLs:
<p>
<pre>
    group1:READ_DATA:ALLOW
    group2:WRITE_DATA:ALLOW
</pre>
<p>
These ACEs allow read access to members of <tt>group1</tt> and write access
to members of <tt>group2</tt>.  If a process that is a member of
<i>both</i> groups attempts to open this file for read-write access, the
operation will succeed.  When POSIX ACLs are in use, instead, the requested
permissions must all be allowed by a single ACE.
<p>
NFSv4 ACLs have a lot more permissions that can be granted and denied.
Along with "read data," "write data," and "execute," there are independent
permissions bits allowing append-only access, deleting the
file (regardless of permissions in the containing directory), deleting any
file contained within a directory, reading a file's metadata, writing the
metadata (changing the timestamps, essentially), taking ownership of the
file, and reading and writing a file's ACLs.
<p>
There is a set of bits controlling how ACLs are inherited from their
containing directories.  ACEs on directories can be marked as being
inheritable by files within those directory; there is also a bit to mark an
ACE  that should only propagate a single level down the hierarchy.  When a
file is created within the directory, it will be given the ACLs that are
marked as being inheritable in its parent directory.  This behavior
conflicts with POSIX, which requires that any "supplemental security
mechanisms" be disabled for new files.
<p>
ACLs can have an "automatic inheritance" flag set.  When an ACL change is
made to a directory, that change will be propagated to any files or
directories underneath that have automatic inheritance enabled — unless the
"protected" flag is also set.  Setting the "protected" flag happens whenever the
ACL or mode of the file have been set explicitly; that keeps inheritance
from overriding permissions that have been intentionally set to something
else.  The interesting twist here is that there is no way in Linux for user
space to
create a file without explicitly setting its mode, so the "protected" bit
will always be set on new files and automatic inheritance simply 
won't work.  NFS does have a way to create files without specifying the
permissions to use, though, so automatic inheritance will work in that case.
<p>
NFSv4 ACLs also differ in how permissions are applied to the world as a
whole.  The "other" class is called "<TT>EVERYONE@</tt>", and it means truly
everyone.  In normal POSIX semantics, if a process is in the "user" or
"group" class, the "other" permissions will not even be consulted; that
allows, <a href="/Articles/621612/">for example</a>, a specific group to be
blocked from a file that is otherwise world accessible.  If a file is made
available to everyone in an NFSv4 ACL, though, it is truly available to
everyone unless a specific "deny" ACE earlier in the list says otherwise.
<p>
<h4>RichACLs</h4>
<p>
The RichACLs work tries to square NFSv4 ACLs with normal POSIX
expectations.  To do so, it applies the mode bits in the same way that
POSIX ACLs do — the mode specifies the maximum access that is allowed.
Since there are far more access types in NFSv4 ACLs than there are mode
bits, a certain amount of mapping must be done.  So, for example, if the
mode denies write access, that will be translated to a denial of related
capabilities like "create file," "append data," "delete child," and more.
<p>
The actual relationship between the ACEs and the mode is handled via a set
of three masks, corresponding to owner, group, and other access.  If a
file's mode is set to deny group-write access, for example, the
corresponding bits will be cleared from the group mask in the ACL.
Thereafter, no ACE will be able to grant write access to a group member.
The original ACEs are preserved when the mode is changed, though; that
means that any additional access rights will be returned if the mode is
made more permissive again.  The masks can be manipulated directly, giving
more fine-grained control over the maximum access allowed to each class;
tweaking the masks can cause the file's mode to be adjusted to match.
<p>
There are some interesting complications in the relationship between the
ACEs, the masks, and the actual file mode.  Consider an example (from <a
href="http://www.bestbits.at/richacl/draft-gruenbacher-nfsv4-acls-in-posix-00.html">this
document</a>) where a file has this ACL:
<p>
<pre>
    OWNER@:READ_DATA::ALLOW
    EVERYONE@:READ_DATA/WRITE_DATA::ALLOW
</pre>
<p>
This ACL gives both read and write access to the owner.  If, however, the
file's mode is set to <tt>0640</tt>, the mask for <tt>EVERYONE@</tt> will
be cleared, denying owner-write access even though there is nothing in the
permissions that requires that.  Fixing this issue requires a special pass
through the ACL to grant the <tt>EVERYONE@</tt> flags to other classes
where the mode allows it.
<p>
A similar problem comes up when an <tt>EVERYONE@</tt> ACE grants access
that is denied by the owner or group mode bits.  Handling this case
requires inserting explicit DENY ACEs for <tt>OWNER@</tt> (or
<tt>GROUP@</tt>) ahead of the <tt>EVERYONE@</tt> ACE.
<p>
The RichACLs patch set implements all of this and more.  See <a
href="http://www.bestbits.at/richacl/">this page</a> and the <a
href="http://www.bestbits.at/richacl/man/richacl.7.txt">richacl.7 man
page</a> for more details.  As of this writing, though, there is still an
open question: how to handle RichACL support in Linux filesystems.
<p>
At the implementation level that question is easily answered; RichACLs are
stored as extended attributes, just like POSIX ACLs or SELinux labels.  The
problem is one of backward compatibility: what happens when a filesystem
containing RichACLs is mounted by a kernel that does not implement them?
Older kernels will not corrupt the filesystem (or the ACLs) in this case,
but neither will they honor the ACLs.  That can result in access being
granted that would have been denied by an ACL; it also means that ACL
inheritance will not be applied to new files.
<p>
To prevent such problems, Andreas <a href="/Articles/661364/">requested</a>
that a feature flag be added to the ext4 filesystem; that flag would
prevent the filesystem from being mounted by kernels that do not implement
RichACLs.  There was some discussion about whether this made sense; ext4
maintainer Ted Ts'o <a href="/Articles/661365/">felt</a> that the feature
flags were there to mark metadata changes that the <tt>e2fsck</tt> utility
needed to know about to avoid corrupting the filesystem.  RichACLs do not
apply, since filesystems don't pay attention to the contents of extended
attributes.
<p>
Over the course of the conversation, though, a consensus seemed to form
around the idea that the use of RichACLs is a fundamental filesystem
feature.  So it appears that once they are enabled for an ext4 filesystem
(either at creation time, or via <tt>tune2fs</tt>), that filesystem will be
marked as being incompatible with kernels that don't implement RichACLs.
Something similar will likely be done for XFS.
<p>
If things go as planned, this work will be mainlined during the 4.4 merge
window.  At that point, NFS servers should be able to implement the full
semantics of NFSv4 ACLs; the feature should also be of use to people
running Samba servers.  This patch set, the culmination of several years'
work, should provide a useful capability to server administrators who need
fully supported access control lists on Linux.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Access_control_lists">Access control lists</a></td></tr>
            <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#RichACLs">RichACLs</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/661357/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor661485"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 20, 2015 22:06 UTC (Tue)
                               by <b>barryascott</b> (subscriber, #80640)
                              [<a href="/Articles/661485/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The basis of the ACLs in Windows and VMS etc I recall is this:<br>
<p>
DoD 5200.28-STD "Orange Book", DoD Trusted Computer System <br>
<p>
<a href="http://csrc.nist.gov/publications/secpubs/rainbow/std001.txt">http://csrc.nist.gov/publications/secpubs/rainbow/std001.txt</a><br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661485/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor661504"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 1:41 UTC (Wed)
                               by <b>JeffBai</b> (guest, #103577)
                              [<a href="/Articles/661504/">Link</a>] (15 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; that filesystem will be marked as being incompatible with kernels that don't implement RichACLs</font><br>
<p>
Doesn't sound like some nice `protection'.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661504/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661517"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 4:00 UTC (Wed)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/661517/">Link</a>] (14 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yeah…it's not like one can expect user/group names and ids to match between systems anyways. And if you plop it in a system where you have root, the perms don't matter anyways. If you want real protection, put it behind LUKS or something similar.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661517/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661526"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 7:57 UTC (Wed)
                               by <b>mjthayer</b> (guest, #39183)
                              [<a href="/Articles/661526/">Link</a>] (13 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Permissions are not normally expected to afford protection against local root.  More the other way round - they are a mechanism that local root can deploy to protect against non-root.  From that point of view preventing file system mounting by kernels that do not understand the ACLs does make sense to me: as a hint to root that this is a bad idea, for the sort of people (lesser people like me) whose "rm" commands protect against "-r /".<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661526/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661541"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 12:44 UTC (Wed)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/661541/">Link</a>] (12 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I guess. Having another system mess up your RichACLs through ignorance (due to the kernel ignoring them) isn't nice. Malice isn't something that would have been prevented anyways.<br>
<p>
Can an old kernel at least mount the filesystem read-only?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661541/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661560"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 15:01 UTC (Wed)
                               by <b>felixfix</b> (subscriber, #242)
                              [<a href="/Articles/661560/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Read-only would still allow ignoring anti-read permissions.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661560/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661561"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 15:16 UTC (Wed)
                               by <b>niner</b> (subscriber, #26151)
                              [<a href="/Articles/661561/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Which is irrelevant. File permissions have never protected in any way from physical access. If you can boot the machine with an older kernel, it's safe to assume, that you have root or even physical access. Both is enough to circumvent any file permissions anyway.<br>
<p>
If you're not improving security by denying read only mount and you're not preventing any erroneous modifications, then why prohibit it?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661561/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661582"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 16:23 UTC (Wed)
                               by <b>felixfix</b> (subscriber, #242)
                              [<a href="/Articles/661582/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Do I misunderstand you?  Are you actually saying that because root and physical access can override any file permission security, get rid of file permissions?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661582/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661588"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 16:34 UTC (Wed)
                               by <b>niner</b> (subscriber, #26151)
                              [<a href="/Articles/661588/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I honestly don't know how my comment can be interpreted in that way, but it obviously can :)<br>
So, no, it absolutely was not meant in that way.<br>
<p>
If you as an attacker want to circumvent file permissions and the way you do it is by booting a different kernel, no feature bit in the world can stop you. To boot the other kernel you either have physical access to the media, or at least root access to the machine. So the feature bit is completely worthless as protection.<br>
<p>
File permissions are a security device in a running system. Once the system is not running anymore be it because the drives are removed or the system is rebooted, the security is gone. That's why we have disk encryption. Disk encryption won't help you if the attacker breaks into the running system. File permissions may. But disk encryption helps you where file permissions won't: with offline attacks.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661588/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661598"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 16:55 UTC (Wed)
                               by <b>bfields</b> (subscriber, #19510)
                              [<a href="/Articles/661598/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Right, understood, but this is more something to keep administrators from shooting themselves in the foot, like warnings on rm -rf /, or -EBUSY on attempts to mount the same block device twice.<br>
<p>
If you're mounting an ACL-protected filesystem on a multi-user system that isn't capable of enforcing them then there's a reasonable chance you're just making a mistake.<br>
<p>
I assume there's some way to clear the flag if you still really want to do it.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661598/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661659"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 23:06 UTC (Wed)
                               by <b>neilbrown</b> (subscriber, #359)
                              [<a href="/Articles/661659/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
(off-topic tangent)<br>
<font class="QuotedText">&gt; -EBUSY on attempts to mount the same block device twice.</font><br>
<p>
You are showing your age!  It has been for many years that trying to mount an already-mounted block device simply creates a bind-mount.<br>
You do get -EBUSY if you mount a block device on a directory where the same block device is mounted, but I think that is just to stop repeated "mount -a" from flooding the mount table.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661659/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661677"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 1:52 UTC (Thu)
                               by <b>bfields</b> (subscriber, #19510)
                              [<a href="/Articles/661677/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <blockquote>You are showing your age!</blockquote>

<p>Already??

<blockquote>It has been for many years that trying to mount an already-mounted block device simply creates a bind-mount.  You do get -EBUSY if you mount a block device on a directory where the same block device is mounted, but I think that is just to stop repeated "mount -a" from flooding the mount table.</blockquote>

<p>Sigh; I was paying attention to <a href="http://www.spinics.net/lists/util-linux-ng/msg12002.html">this</a>, honest!  Thanks for the correction.
      
          <div class="CommentReplyButton">
            <form action="/Articles/661677/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor661658"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 23:03 UTC (Wed)
                               by <b>smoogen</b> (subscriber, #97)
                              [<a href="/Articles/661658/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You just have never system administered a system where the owner wanted everything 7777 root:root because file permissions are evil.. that was exactly the same argument on why he ( a PHD of many sciences ) didn't think any file perms were needed. [And I have heard it enough times that you can never tell if a person is wanting to get rid of them all or just with why this shooting you in the foot prevention isn't really good. ]<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661658/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661665"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 0:15 UTC (Thu)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/661665/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;  You just have never system administered a system where the owner wanted everything 7777 root:root because file permissions are evil.</font><br>
So pretty much every system out there? <br>
<p>
XKCD explains that succinctly: <a rel="nofollow" href="https://xkcd.com/1200/">https://xkcd.com/1200/</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661665/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor661594"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 16:35 UTC (Wed)
                               by <b>mjthayer</b> (guest, #39183)
                              [<a href="/Articles/661594/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I could see sense in optionally allowing root to mount the file system read-only (or read-write for that matter), if it required them to add an "I really meant this" parameter.  My understanding of the article is that this is not planned.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661594/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor662242"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 28, 2015 10:24 UTC (Wed)
                               by <b>Seegras</b> (guest, #20463)
                              [<a href="/Articles/662242/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The problem is not mounting filesystems and ignoring the permissions the ACLs specify. The problem is having something mount a filesystem containing ACLs and modifying the contents, thereby DESTROYING the ACLs already specified in the filesystem.<br>
<p>
You don't mind something ignoring the ACLs, but you don't want it to delete them. ACL-insensitive-but-ACL-preserving ;)<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/662242/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor662325"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 28, 2015 23:55 UTC (Wed)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/662325/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Right. So why is read-only mounting not allowed?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/662325/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor661525"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 7:57 UTC (Wed)
                               by <b>mbunkus</b> (subscriber, #87248)
                              [<a href="/Articles/661525/">Link</a>] (48 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Jon, you've written that "This behavior conflicts with POSIX, which requires that any "supplemental security mechanisms" be disabled for new files." I'm not sure I understand what you mean, exactly.<br>
<p>
POSIX ACLs already have default ACLs on directories which are applied to all new entries created within such a directory. Doesn't this fall under the same term of "supplemental security mechanisms"? And what does "supplemental" mean in the first place? Is a directory's sticky bit deemed to be a base security mechanism or would that not qualify and be "summplemental" as well?<br>
<p>
Near the end you mention Samba which I've been meaning to ask about, too. At the moment Samba stores NT(FS)-specific ACLs in extended attributes (Make sure your backup software saves those, too!). Are the RichACL a strict superset of NT(FS) ACLs so that Samba could switch to using them instead of extended attributes for kernels and file systems that support RichACLs? And how would RichACLs interact with NFSv4 or later – would they be transmitted or would they be stripped down to what NFSv4 ACLs can do?<br>
<p>
And while we're on the topic of extended attributes: does anyone know of work going into making NFS support extended attributes?<br>
<p>
I'm looking at this specificially as an admin of various networks in which Linux and Windows clients access the same file servers via NFS and CIFS. I'd appreciate any insight into what's on the horizon wrt. ACLs, extended attributes, NFS etc.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661525/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661535"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 11:28 UTC (Wed)
                               by <b>jlayton</b> (subscriber, #31672)
                              [<a href="/Articles/661535/">Link</a>] (46 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yes, the samba devs are the main ones that have been clamouring for RichACLs. Allowing better windows semantics is one of the primary use-cases for them. Their current form is good enough for samba to make use of them.<br>
<p>
For NFSv4, they'd be translated into what NFSv4 ACLs can do. We do have to follow the protocol, after all. FWIW, knfsd currently translates NFSv4 ACLs into POSIX acls and back, but that's necessarily lossy. This should allow for much better semantics (though there are still some open questions about how this will work when idmapping fails).<br>
<p>
There is a draft proposal to add xattr support to NFSv4:<br>
<p>
   <a href="https://tools.ietf.org/html/draft-ietf-nfsv4-xattrs-01">https://tools.ietf.org/html/draft-ietf-nfsv4-xattrs-01</a><br>
<p>
...and I think there are some patches that add this support, though it's unlikely they'll be merged until it's a little farther along.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661535/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661537"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 12:02 UTC (Wed)
                               by <b>mbunkus</b> (subscriber, #87248)
                              [<a href="/Articles/661537/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Thank you very much. That's exactly what I wanted to know.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661537/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661603"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 17:23 UTC (Wed)
                               by <b>bfields</b> (subscriber, #19510)
                              [<a href="/Articles/661603/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>Note that draft only covers what on Linux are the "user.*" extended attributes:  "This document restricts the allowed namespaces to user-managed metadata only, in order to prevent the development of non-interoperable implementations. It requires that the attribute key/value MUST not be interpreted by the NFS clients and servers."

<p>So for example the special system.posix_acl_{access,default} xattrs used to manage posix acls still wouldn't be exposed over NFS.
      
          <div class="CommentReplyButton">
            <form action="/Articles/661603/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor661562"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 15:23 UTC (Wed)
                               by <b>nybble41</b> (subscriber, #55106)
                              [<a href="/Articles/661562/">Link</a>] (17 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; though there are still some open questions about how this will work when idmapping fails</font><br>
<p>
Isn't this a general problem with DENY-type access control lists? It's relatively easy to force a client to prove that it *should* have access with a cryptographic challenge authentication protocol. But when you have user- or group-specific DENY entries in the ACL, you're asking the client to prove that it *shouldn't* have access, which isn't in the client's interest.<br>
<p>
In particular, dropping a group membership should never *increase* a program's permissions.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661562/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661597"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 16:47 UTC (Wed)
                               by <b>jra</b> (subscriber, #55261)
                              [<a href="/Articles/661597/">Link</a>] (16 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That presumes the client is in charge of the access token. On modern auth systems the client can't modify its own token (it's cryptographically protected), the server keeps it on the clients behalf.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661597/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661614"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 19:09 UTC (Wed)
                               by <b>nybble41</b> (subscriber, #55106)
                              [<a href="/Articles/661614/">Link</a>] (15 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I assume you're referring to the ability to drop group membership. Yes, the server can assign groups to each authenticated user and not let the client modify the set of groups, but unless you're assuming a closed set of user accounts, what prevents the client from using an account other than the one which was denied permission? Is there a "guest" account? Can one request the creation of a new account (or otherwise gain control over an account) which isn't a member of the group?<br>
<p>
Even if the process can't remove groups itself, an administrator can, and it's counter-intuitive that removing a user from a group might increase that user's privileges.<br>
<p>
Whitelists are better than blacklists. Attempting to enumerate all the bad accounts or groups is poor security practice.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661614/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661629"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 20:18 UTC (Wed)
                               by <b>fandingo</b> (guest, #67019)
                              [<a href="/Articles/661629/">Link</a>] (14 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; it's counter-intuitive that removing a user from a group might increase that user's privileges.</font><br>
<p>
It's only counter-intuitive because that's what you're used to. If you learned on systems with NFSv4-style ACLs, this wouldn't be confusing. We just need to get used to the idea of negative permissions. <br>
<p>
<font class="QuotedText">&gt; Whitelists are better than blacklists. Attempting to enumerate all the bad accounts or groups is poor security practice.</font><br>
<p>
Sure, I guess, but nobody is talking about using allow *or* deny lists exclusively. They're talking about being able to mix them to apply complex policies. I imagine one place where allow and deny will be routinely combined is with daemons. They get an allow for append-only write access, and explicit denies for read, delete, and general write accesses. That's a completely reasonable policy. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661629/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661649"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 22:42 UTC (Wed)
                               by <b>nybble41</b> (subscriber, #55106)
                              [<a href="/Articles/661649/">Link</a>] (13 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; It's only counter-intuitive because that's what you're used to. If you learned on systems with NFSv4-style ACLs, this wouldn't be confusing.</font><br>
<p>
No, it's counter-intuitive because of how groups work in the real world. Being a member of a group is a privilege, not a burden. Being accepted into a group has positive connotations; rejection is negative.<br>
<p>
Obviously one can learn to use either system, but whether or not it's deemed intuitive shouldn't depend on which system you had prior experience with. It should be based on what someone with no prior experience with ACLs would expect.<br>
<p>
<font class="QuotedText">&gt; I imagine one place where allow and deny will be routinely combined is with daemons. They get an allow for append-only write access, and explicit denies for read, delete, and general write accesses. That's a completely reasonable policy.</font><br>
<p>
The reasonable version is a "default deny" policy. Don't just deny access to the daemons, deny access to everyone by default (as POSIX ACLs and standard permissions would), and grant the daemons append-only access. If other users or groups should have read, delete, or general write access, grant it to them specifically, not as a default.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661649/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661654"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 22:56 UTC (Wed)
                               by <b>fandingo</b> (guest, #67019)
                              [<a href="/Articles/661654/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; No, it's counter-intuitive because of how groups work in the real world. Being a member of a group is a privilege, not a burden. Being accepted into a group has positive connotations; rejection is negative.</font><br>
<p>
What about prison inmates? What about people on no-fly lists? Groups have negative connotations and restrict behavior all the time.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661654/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661795"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 17:50 UTC (Thu)
                               by <b>nybble41</b> (subscriber, #55106)
                              [<a href="/Articles/661795/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; What about prison inmates? What about people on no-fly lists?</font><br>
<p>
Personally, I tend to think of those from the opposite (positive) point of view. The group of members of society in good standing; the group of people granted the privilege of flying. (Which should be the same as the first group, but that's a whole other discussion...)<br>
<p>
Obviously any particular set of rules can be implemented either way. The problem mainly arises when you add new users to the system. In a pure whitelist scenario, you only have to decide what the new user *should* have access to. Anything you don't grant access to is off-limits, which is a safe default. If you build your system around DENY rules then you also have to make sure the new user gets added to the appropriate blacklists, or they'll have more access than you intended.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661795/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661805"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 18:26 UTC (Thu)
                               by <b>fandingo</b> (guest, #67019)
                              [<a href="/Articles/661805/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Personally, I tend to think of those from the opposite (positive) point of view. The group of members of society in good standing; the group of people granted the privilege of flying. (Which should be the same as the first group, but that's a whole other discussion...)</font><br>
<p>
What a coincidently self-serving stance, but it's still a tortured viewpoint that's incorrect. It simply doesn't comport with reality. The government does not maintain a list of people authorized to fly, so there's no group there. They do maintain list for no-fly and mistakenly-no-fly people. Same thing for inmates; there's no list of free civilians, but there are lists (per jurisdiction) of those incarcerated. To get a list of free people, you need to derive that from the difference between the census and those in prison. The implementation dictates POV. <br>
<p>
<font class="QuotedText">&gt; Obviously any particular set of rules can be implemented either way. The problem mainly arises when you add new users to the system. In a pure whitelist scenario, you only have to decide what the new user *should* have access to. Anything you don't grant access to is off-limits, which is a safe default. If you build your system around DENY rules then you also have to make sure the new user gets added to the appropriate blacklists, or they'll have more access than you intended.</font><br>
<p>
Meh, that's what administrative user-management tools are for. Let the software handle it. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661805/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor662563"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 30, 2015 17:17 UTC (Fri)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/662563/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; &gt; Being accepted into a group has positive connotations; rejection is negative.</font><br>
<p>
<font class="QuotedText">&gt; What about prison inmates? What about people on no-fly lists? Groups have negative connotations and restrict behavior all the time.</font><br>
<p>
You missed that sentence of the OP ... Prison inmates aren't ACCEPTED, they're PLACED. Likewise the no-fly. You can split groups into two types, the ones you JOIN, and the ones that other people PUT you in. Yes, the latter are normally places you'd rather not be.<br>
<p>
But if you treat ACLs as the former type of group, then it makes everything a lot simpler.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/662563/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor661791"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 17:36 UTC (Thu)
                               by <b>eternaleye</b> (guest, #67051)
                              [<a href="/Articles/661791/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Being a member of a group is a privilege, not a burden. Being accepted into a group has positive connotations; rejection is negative.</font><br>
<p>
I'll note that even on classic mode bits, a group can restrict access. See above on how "the other permission is not even consulted if user or group match" - because of that, u=rw,g=,o=r is an entirely valid permission that denies read only for a specific group.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661791/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661802"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 18:18 UTC (Thu)
                               by <b>nybble41</b> (subscriber, #55106)
                              [<a href="/Articles/661802/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; I'll note that even on classic mode bits, a group can restrict access.</font><br>
<p>
Right, and I don't consider that intuitive either. The effective permissions should be a bitwise-OR of the applicable fields, not simply the first match.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661802/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661947"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 24, 2015 17:20 UTC (Sat)
                               by <b>jubal</b> (subscriber, #67202)
                              [<a href="/Articles/661947/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I guess you wouldn't like pam_access either.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661947/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor661812"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 18:55 UTC (Thu)
                               by <b>idra</b> (guest, #36289)
                              [<a href="/Articles/661812/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;&gt; It's only counter-intuitive because that's what you're used to. If you learned on systems with NFSv4-style ACLs, this wouldn't be confusing.</font><br>
<font class="QuotedText">&gt; No, it's counter-intuitive because of how groups work in the real world. Being a member of a group is a privilege, not a burden. Being accepted into a group has positive connotations; rejection is negative.</font><br>
<p>
This is not the reason why negative ACLs are bad, they are bad because they do not fail safe.<br>
If an ACL is accidentally dropped in a Posix like system you lose access, with DENY ACLs if a DENY ACL is dropped then you gain access, which is a much worse failure mode.<br>
<p>
Pure Windows semantics are even worse, and *are* counterintuitive, because not only they provide DENY ACLs, they are also *ordered*. And many admins do not understand the complex relationship that arises when you DENY *after* an ALLOW. Reason why the GUI clients in Windows do actually re-order ACLs so that all DENY instructions always come first, and they hide the fact order matters for the NT Kernel.<br>
<p>
Of course hilarity ensues if you intentionally ordered an ALLOW ACL before a DENY ACL with a CLI tool and then someone just add a completely unrelated instruction via the GUI. Your careful ACL breaks as the gUI reorders everything; but at least in that case it fails safe because you end up denying access to a larger set, not allowing more access.<br>
<p>
<font class="QuotedText">&gt; The reasonable version is a "default deny" policy. Don't just deny access to the daemons, deny access to everyone by default (as POSIX ACLs and standard permissions would), and grant the daemons append-only access. If other users or groups should have read, delete, or general write access, grant it to them specifically, not as a default.</font><br>
<p>
In some rare cases it may be simpler to add exceptions (all users but Joe should be able to read this file), but usually the need of an exception is a sympthom of a much deeper broken system/process elsewhere.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661812/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661822"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 20:10 UTC (Thu)
                               by <b>fandingo</b> (guest, #67019)
                              [<a href="/Articles/661822/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; This is not the reason why negative ACLs are bad, they are bad because they do not fail safe.</font><br>
If an ACL is accidentally dropped in a Posix like system you lose access, with DENY ACLs if a DENY ACL is dropped then you gain access, which is a much worse failure mode.<br>
<p>
This is entirely incorrect and undermines your entire point. ACL resolution order is an explicit feature of Linux ACLs (and traditional POSIX mode bits). Let's say I'm using traditional ACLs, and a file has permissions r-----rw-. It's owned by me, and the group doesn't matter. This is a negative policy! I am not allowed to write to this file, but others are. If the user "ACL is accidently dropped" to, say, change ownership (ACLs are a combination of a user/group object and mode bits), I end up with more permissions than I'm supposed to. This is specifically mentioned in the article. <br>
<p>
<font class="QuotedText">&gt; And many admins do not understand the complex relationship that arises when you DENY *after* an ALLOW.</font><br>
<p>
How do I put this nicely? I don't want design limitations because some people are too stupid to learn the tools. That's their problem. Don't mount with the Richacl option if you don't know what you're doing. <br>
<p>
<font class="QuotedText">&gt; Reason why the GUI clients in Windows do actually re-order ACLs so that all DENY instructions always come first, and they hide the fact order matters for the NT Kernel.</font><br>
<p>
I don't see why this matters at all. It's an implementation issue that the software completely handles for you, and it sounds like a good decision. <br>
<p>
<font class="QuotedText">&gt; Pure Windows semantics are even worse, and *are* counterintuitive, because not only they provide DENY ACLs, they are also *ordered*. And many admins do not understand the complex relationship that arises when you DENY *after* an ALLOW. Reason why the GUI clients in Windows do actually re-order ACLs so that all DENY instructions always come first, and they hide the fact order matters for the NT Kernel.</font><br>
<p>
I don't understand what you're getting at. Back in the early NT days, yes, there were tooling problems, but those have been long corrected. Maybe you can be more specific, but this has been fixed for ages. There are some low-level APIs that allow insertion of ACLs without resolving the overall policy, but they're counter-recommended and proper versions have been around for a long time. But, hey, nothing like a Linux forum criticizing Microsoft with severely outdated information. <br>
<p>
<font class="QuotedText">&gt; In some rare cases it may be simpler to add exceptions (all users but Joe should be able to read this file), but usually the need of an exception is a sympthom of a much deeper broken system/process elsewhere.</font><br>
<p>
I agree with this statement. I haven't once advocated for broad use of denial policies. Instead, I'm arguing that the ACL implementation needs to allow this expressiveness because there are legitimate situations where it's needed. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661822/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661959"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 25, 2015 1:44 UTC (Sun)
                               by <b>idra</b> (guest, #36289)
                              [<a href="/Articles/661959/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; This is entirely incorrect and undermines your entire point. ACL resolution order is an explicit feature of Linux ACLs (and traditional POSIX mode bits). Let's say I'm using traditional ACLs, and a file has permissions r-----rw-. It's owned by me, and the group doesn't matter. This is a negative policy! I am not allowed to write to this file, but others are.</font><br>
<p>
Sorry man but you are very confused. First of all with as Posix permissions and not Posix ACLs, that said the default is no access ---, you have been given read access by turning on the r bit. Perimissions cannot be accidentally dropped so that case does not apply to the basix posix permissions. In any case if that bit were dropped you'd lose read access, whic is consistent with what I said.<br>
<p>
<font class="QuotedText">&gt; How do I put this nicely? I don't want design limitations because some people are too stupid to learn the tools. That's their problem. Don't mount with the Richacl option if you don't know what you're doing.</font><br>
<p>
Tools are as good as they are usable by *normal* people. A car only a F1 drvier can use is ... how can I put it nicely ... useless to everyone but the 20 odd F1 driver on the planet, which is to say uselss.<br>
<p>
Now RichACLs are not *that* hard, but my experience tells me that ACL systems the include ordered deny policy are a double-edged sword, and the balance between complexity and usefulness is wrongly tilted. All this said I need RichACLs to be able to reach compatibility with Windows ACLs so I'll take them as they come.<br>
<p>
<font class="QuotedText">&gt; I don't understand what you're getting at.</font><br>
<p>
Sadly obvious.<br>
<p>
<font class="QuotedText">&gt; Back in the early NT days, yes, there were tooling problems, but those have been long corrected. Maybe you can be more specific, but this has been fixed for ages. There are some low-level APIs that allow insertion of ACLs without resolving the overall policy, but they're counter-recommended and proper versions have been around for a long time. But, hey, nothing like a Linux forum criticizing Microsoft with severely outdated information. </font><br>
<p>
Look, those issues were not bugs that got fixed and are there no more, they are fundamental usability issues that are due to the semantics chosen. They just got "handled" by adjustment done by the GUI tools. Now there is no criticizing here *at all* (that's all in your mind pal), but only making people unfamiliar with these semantics that the *same* problems will now be found in systems used by Linux admins. They can be solved the same way, by forcing the tools to reorder the ACIs and massahe the ACLs, but afaik the tools do not do that today.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661959/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661965"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 25, 2015 4:30 UTC (Sun)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/661965/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; that said the default is no access ---</font><br>
<p>
No, the default is 0777. You set umask to take bits away.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661965/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor661980"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 25, 2015 9:06 UTC (Sun)
                               by <b>paulj</b> (subscriber, #341)
                              [<a href="/Articles/661980/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Bizarre, why use order-significant ACLs if to make them usable tools must then - all, consistently! - normalise the order somewhat?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661980/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor662438"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 29, 2015 14:56 UTC (Thu)
                               by <b>fest3er</b> (guest, #60379)
                              [<a href="/Articles/662438/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Sounds like a firewall. First apply blacklists (those individuals and groups who are to be denied access at all times). Next apply whitelists (those individuals and groups always allowed access). Then apply mixed allow/deny rules that may allow access or may deny access. Finally, if access hasn't already been allowed or denied, deny it. Easy concept. Non-trivial implementation.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/662438/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor661609"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 17:49 UTC (Wed)
                               by <b>drag</b> (guest, #31333)
                              [<a href="/Articles/661609/">Link</a>] (25 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I would be very happy to see better compatible ACLs with Windows and NFSv4. <br>
<p>
In Windows-world their extended ACLs are used as of a matter of course.  In Linux-land the the POSIX ACLs are almost never used. I expect that people that use them the most are Samba users.  Next biggest is likely NFSv4 users... <br>
<p>
I think this may be a big win for Linux in general.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661609/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661628"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 20:11 UTC (Wed)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/661628/">Link</a>] (24 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; In Windows-world their extended ACLs are used as of a matter of course.</font><br>
So much that consumer versions of Windows actually ship with something that resembles Unix permissions.<br>
<p>
<font class="QuotedText">&gt;  In Linux-land the the POSIX ACLs are almost never used.</font><br>
Which is really telling. Do we actually _need_ extended ACLs used anywhere except for fileservers?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661628/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661630"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 20:25 UTC (Wed)
                               by <b>fandingo</b> (guest, #67019)
                              [<a href="/Articles/661630/">Link</a>] (23 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Which is really telling. Do we actually _need_ extended ACLs used anywhere except for fileservers?</font><br>
<p>
The problem with Linux ACLs is that they don't allow novel permission schemes. It's still just RWX. The issue that Richacl is trying to solve is much broader than multiple RWX policies. <br>
<p>
Here's the simplest general use-case for Richacls: every daemon that writes to a log file. W, whether through POSIX or Linux ACLs, is simply too crude for secure logging. That's a major reason why so much stuff needlessly goes through syslog just to end up on the local file system. So, yeah, I expect the append-only Richacl to be used a lot. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661630/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661634"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 21:01 UTC (Wed)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/661634/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; The problem with Linux ACLs is that they don't allow novel permission schemes. </font><br>
Do we _need_ novel permission schemes? They are pretty much useless for anything except fileservers. And fileservers are not that popular anymore.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661634/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661642"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 21:27 UTC (Wed)
                               by <b>fandingo</b> (guest, #67019)
                              [<a href="/Articles/661642/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Ummm, yes we do. I provided a really simple example of where this is really needed. You're just saying the same thing that caused my initial reply.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661642/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661650"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 22:35 UTC (Wed)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/661650/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Except that there's simply no guarantee that a large write will be atomic. If many writers are appending into one file, they _will_ get corruption eventually. And anyway, rsyslog or journald have already pretty much solved this problem.<br>
<p>
I worked with Windows ACLs extensively. That's the reason why I hate complicated permission systems.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661650/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661655"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 22:57 UTC (Wed)
                               by <b>fandingo</b> (guest, #67019)
                              [<a href="/Articles/661655/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You're assuming multiple writers, but I don't know why. This has nothing to do with ACLs. It's an IO synchronization problem. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661655/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor662434"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 29, 2015 14:13 UTC (Thu)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/662434/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;  I worked with Windows ACLs extensively. That's the reason why I hate complicated permission systems.</font><br>
<p>
As others have said, it's just so complicated ...<br>
<p>
And I know I've said it before, but Pr1mos just had read, write, use. For files or directories. So that makes six different permissions. And using them was simple - if your user was explicitly specified, that was what you got. If you weren't explicitly named, but your groups were, those permissions were added together. And if neither your user, nor a group you were in, was specified, you just got the default permissions. Very simple, very easy to understand.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/662434/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor661637"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 21:16 UTC (Wed)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/661637/">Link</a>] (17 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; That's a major reason why so much stuff needlessly goes through syslog just to end up on the local file system.</font><br>
<p>
you are ignoring the fact that if things are written to go through syslog, even if they end up on the local filesystem in many/most cases, it's far nicer when you do want to do more than just write to the local disk.<br>
<p>
having to poll local filesystems for changes to log files and then scrape them is a very poor thing to do.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661637/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661638"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 21:16 UTC (Wed)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/661638/">Link</a>] (16 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
... besides, aren't we being told that the solution to all logging is to write to the systemd journal anyway?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661638/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661639"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 21:24 UTC (Wed)
                               by <b>fandingo</b> (guest, #67019)
                              [<a href="/Articles/661639/">Link</a>] (15 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'm not getting into another journal discussion with you. Anyways, there's plenty of programs that log data that doesn't need to or can't go through syslog. Applications running in containers are a prime example that typically lack syslog capabilities. <br>
<p>
Not everything is centralized either. Additionally, you'd use this exact same append-only policy on the files that syslog does write, making your point moot. I don't know about you, but I don't run my applications or centralized syslog systems on a file server.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661639/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661643"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 21:31 UTC (Wed)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/661643/">Link</a>] (14 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There's no reason why syslog support can't be used in containers, either from running syslog inside the container, or having the host syslog daemon create /dev/log inside the container to capture the logs<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661643/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661645"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 22:02 UTC (Wed)
                               by <b>fandingo</b> (guest, #67019)
                              [<a href="/Articles/661645/">Link</a>] (13 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Jeez. I'm not arguing that it's technically impossible. The idea of running an unrelated logging daemon in a container is antithetical to the idea of containers. Passing through a socket isn't always appealing either. That being said, you're missing the point. Currently, if you want to securely write log messages to a daemon you need a different trusted daemon to do that, but if you're just logging to local files, I don't need that diversion. I just need a security mechanism that doesn't allow a compromised application to wipe out its log files; I don't need a logging daemon. In this example, a logging daemon is nothing more than a side-effect of an insufficient permission model. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661645/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661652"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 22:38 UTC (Wed)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/661652/">Link</a>] (12 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
A compromised application can just spam the log files with 2Mb zero-filled data pages. It will scramble other writers and make analysis difficult.<br>
<p>
And there are much better ways to do it already, anyway.<br>
<p>
Do you have less contrived examples? Preferably not involving a "mainframe shared among faculty and students" textbook scenario that is pretty much irrelevant right now.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661652/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661656"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 23:03 UTC (Wed)
                               by <b>fandingo</b> (guest, #67019)
                              [<a href="/Articles/661656/">Link</a>] (11 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You think containers are a contrived example? There are plenty of situations that need WORM semantics where append-only is important. Any transaction processing system that appends to a file would benefit from that security. <br>
<p>
<font class="QuotedText">&gt; A compromised application can just spam the log files with 2Mb zero-filled data pages. It will scramble other writers and make analysis difficult.</font><br>
<p>
That's better than a 0B file that was maliciously truncated...<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661656/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661661"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 23:19 UTC (Wed)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/661661/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If you trust the kernel and permissions to protect the file from being truncated once you have a malicious actor taking over your binary, you have a lot more trust than I do.<br>
<p>
Anything important like that sort of log data, I want off on a separate machine.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661661/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661662"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 0:04 UTC (Thu)
                               by <b>fandingo</b> (guest, #67019)
                              [<a href="/Articles/661662/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Anything important like that sort of log data, I want off on a separate machine.</font><br>
<p>
I already addressed this in a previous comment.<br>
<p>
<font class="QuotedText">&gt;&gt; Additionally, you'd use this exact same append-only policy on the files that syslog does write, making your point moot.</font><br>
<p>
Wherever that data hits disk, it's advantageous to be able to restrict to `append_data`, even when that writing is happening on a separate system. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661662/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661663"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 0:09 UTC (Thu)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/661663/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Wherever that data hits disk, it's advantageous to be able to restrict to `append_data`, even when that writing is happening on a separate system.</font><br>
<p>
advantageous, yes<br>
<p>
but worth how much in the face of the added complications, bugs and performance hit?<br>
<p>
Also, to make use of this, the applications are going to have to be modified in linux-only ways. Some apps won't care, but others try to be cross platform, so this sort of churn won't be welcome.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661663/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661670"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 0:56 UTC (Thu)
                               by <b>fandingo</b> (guest, #67019)
                              [<a href="/Articles/661670/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; but worth how much in the face of the added complications, bugs and performance hit?</font><br>
<p>
It's worth 42. I don't know how to answer the obviously loaded, rhetorical question. You'll need to offer data about performance implications before I'll get into that topic; it's just FUD otherwise.<br>
<p>
<font class="QuotedText">&gt; Also, to make use of this, the applications are going to have to be modified in linux-only ways. Some apps won't care, but others try to be cross platform, so this sort of churn won't be welcome.</font><br>
<p>
For the most part, this isn't something that applications will interact with at all. (I suppose beyond EACCESS when there is a violation, but they have to deal with that anyways.) It will be handled just like SELinux policy: The Linux distribution writes and maintains it. <br>
<p>
There is specialized software that may need to interact with Richacl specifically, but I just don't see it being a major problem. The only places where it may cause a problem is when a project is sloppy with it's open(2) mode flags, which should be tightened regardless of Richacl. If a piece of software is diligent, writing a policy for that software package isn't any challenge. <br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661670/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor661666"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 0:17 UTC (Thu)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/661666/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;  You think containers are a contrived example? There are plenty of situations that need WORM semantics where append-only is important. Any transaction processing system that appends to a file would benefit from that security. </font><br>
If you want real WORM for auditing purposes then file permissions are not enough. <br>
<p>
Append-only mode also does not guarantee atomicity, so I'm curious to see the actual systems that depend on it. I'm not aware of anything non-trivial.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661666/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661668"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 0:27 UTC (Thu)
                               by <b>smckay</b> (guest, #103253)
                              [<a href="/Articles/661668/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Does HDFS count? As appending is the only kind of writing you can do. ;)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661668/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661669"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 0:29 UTC (Thu)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/661669/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
As far as I know, no HDFS implementations depend on filesystem-level append-only permissions.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661669/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor661674"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 1:13 UTC (Thu)
                               by <b>fandingo</b> (guest, #67019)
                              [<a href="/Articles/661674/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I neither said nor implied it did. IO synchronization is a separate problem. Perhaps down the road, they can add additional Richacl types (unsigned int leaves a lot of available flags) for open(2) modes like O_SYNC (and other associated syscalls) to allow Richacl policy to require or prohibit that option. <br>
<p>
<font class="QuotedText">&gt; so I'm curious to see the actual systems that depend on it.</font><br>
<p>
I'm not sure any piece of software itself could "depend" on it. From the software's perspective, it's just eliminating extraneous syscalls and mode flags. It's the software distribution's (or perhaps the adventurous sys admin's) job to write and distribute a policy. The policy separation and delegation to distributions is same as SELinux. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661674/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661676"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 1:30 UTC (Thu)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/661676/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
And to guarantee that the entries are also semantically correct, perhaps we can add another permission to attach an XML (or even ASN.1) schemas to files? <br>
<p>
Of course, some people might also forbid any file activity on Sundays, so we need a special permission for that as well.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661676/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661678"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 1:50 UTC (Thu)
                               by <b>fandingo</b> (guest, #67019)
                              [<a href="/Articles/661678/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Sure, if you want to do that, although some file systems have xattr length limitations. I'd treat ACLs the same as LSMs: Pick anyone you want (and stack them if you like and support is implemented). The data will be stored in xattrs defined by that ACL module, and a file system feature flag can be used to force (or indicate if a bypass kernel cmdline / config option is set) a kernel to use that ACL module.<br>
<p>
Nonetheless, I doubt you'd have many people in such a scheme. But, let's dial it back from absurdity.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661678/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661835"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 22:58 UTC (Thu)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/661835/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
No. Complex LSMs proved to be a total failure - NOBODY understands how SELinux works, so on most systems it just sits idly and eats resources.<br>
<p>
At least with modebits I can understand what's happening immediately. With Windows ACLs you can't do that - you have to carefully evaluate the rules, keeping their order in mind. POSIX ACLs are ok-ish, they at least play nicely with the regular Unix permissions.<br>
<p>
And your examples are so far extremely poor. If you need to constrain a daemon to use only O_APPEND - then write an LSM module for that. No need at all to rape file permissions. And if you are doing it over NFS then get a proper rsyslog, for FSM's sake.<br>
<p>
So what are other examples, apart from the contrived O_APPEND?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661835/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor661554"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 14:58 UTC (Wed)
                               by <b>agruen</b> (subscriber, #6613)
                              [<a href="/Articles/661554/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There are two kinds of inheritance: the first defines the permissions that files and directories inherit from their parent directory when created, the equivalent to Default POSIX ACLs. Those don't conflict with POSIX.<br>
<p>
The second mechanism, Automatic Inheritance, extends the first: ACEs which are inherited from the parent are marked as such; when the parent permissions are modified, the inherited permissions change as well. This is implemented by walking the directory tree and updating all ACLs, in user-space.<br>
<p>
Automatic Inheritance works well enough as long as the inherited permissions are not modified. POSIX syscalls that create files or directories have a mode parameter which defines the maximum permissions that may be granted, and appling that mode to the inherited ACL counts as a modification, however. The effect is that Automatic Inheritance is immediately stopped at create time.<br>
<p>
Both CIFS and NFSv4 have "create without a create mode" operations though; they can emulate those by doing normal creates and re-enabling Automatic Inheritance. That's the best we can do at the moment.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661554/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor661531"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">History Repeats</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 8:49 UTC (Wed)
                               by <b>ldo</b> (guest, #40946)
                              [<a href="/Articles/661531/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <P>I was <A HREF="http://list.waikato.ac.nz/pipermail/wlug/2015-August/013714.html">reading about MULTICS</A> a little while back, and discovered that its protection system didn’t suffer from the problem that POSIX-based systems have with multiple users trying to manage files in a common “group” directory—that every file can only have one owner, it cannot belong collectively to the group.

<P>It looks like RichACLs finally solve that problem.
      
          <div class="CommentReplyButton">
            <form action="/Articles/661531/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661600"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">History Repeats</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 17:15 UTC (Wed)
                               by <b>bfields</b> (subscriber, #19510)
                              [<a href="/Articles/661600/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      Well, we've had posix ACLs since 2002, I think.  Rich ACLs are more about SMB, NFSv4, and Windows compatibility.

(And without posix ACLs you can share files using groups.)
      
          <div class="CommentReplyButton">
            <form action="/Articles/661600/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor662674"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">History Repeats</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 1, 2015 2:25 UTC (Sun)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/662674/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Pr1mos was a Multics derivative. And it had ACLs since v19.4 (actually, 19.0 but they were broken quite bad), and that came out about 1984. I can't remember the details, but I know I came across a v19.2 system (very unusual), and when I tried to use some commands they crashed the system ...<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/662674/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor661559"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 15:40 UTC (Wed)
                               by <b>fandingo</b> (guest, #67019)
                              [<a href="/Articles/661559/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      Perhaps I'm missing something, but why are we keeping the POSIX 3-bit modes at all (when Richacl is enabled)? Why are we preserving that outmoded 3-bit POSIX, and allowing it to impact Richacls? As I understand it, anyone using Richacls should set POSIX perms to 777 in every case without exception. I can't come up with a situation where somebody would use Richacls, but implement the POSIX+Richacls policy by using POSIX ACLs whose effect is to "break" Richacls. 

If this is going to be a FS mount option, which it is, and use FS metadata to tie that FS to 4.4+ Richacl kernels, which it does, I really don't see any purpose in preserving anything from POSIX ACLs.

Users who stick with POSIX ACLs won't be affected either way. Users who migrate to Richacls will end up fighting against useless POSIX ACLs; they do nothing but interfere with what you're trying to do in the Richacl. 

I'm really excited that permissions are finally getting more expressive on Linux. I worry that continuing to integrate with POSIX ACLs is going to undercut all this work. 
      
          <div class="CommentReplyButton">
            <form action="/Articles/661559/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661647"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 22:10 UTC (Wed)
                               by <b>daniels</b> (subscriber, #16193)
                              [<a href="/Articles/661647/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Because userspace will expect that changing a POSIX mode to a certain value through chmod(2) will have the effect of masking access to that particular uid/gid/everyone, for the specified mode, regardless of which filesystem is mounted. The filesystem type doesn't give you the ability to opt out of POSIX semantics.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661647/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661651"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 23:06 UTC (Wed)
                               by <b>fandingo</b> (guest, #67019)
                              [<a href="/Articles/661651/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Because userspace will expect that changing a POSIX mode to a certain value through chmod(2) will have the effect of masking access to that particular uid/gid/everyone, for the specified mode, regardless of which filesystem is mounted.</font><br>
<p>
There's absolutely no reason why this needs to be done in POSIX bits, though. If the file/file-system is Richacl enabled, translate the chmod(2) (or the variety of other POSIX ACL syscalls) to Richacl -- solely operating on the Richacl xattrs. The POSIX bits, then, are just a virtual representation of Richacl xattrs. <br>
<p>
I'd argue that we'd be far better off switching to native Richacl solely. Continue to support traditional POSIX ACL syscalls, but they all get translated to Richacl for both policy evaluation and storage. (I'm only advocating for this strategy due to the agreement of making Richacl a compatibility-breaking filesystem feature.) Richacl offers a superset of features from POSIX and Linux ACLs; it makes more sense to stop duplicating information, and at least for kernel internals, entirely switch to the most expressive system. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661651/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661667"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 0:19 UTC (Thu)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/661667/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; I'd argue that we'd be far better off switching to native Richacl solely. Continue to support traditional POSIX ACL syscalls, but they all get translated to Richacl for both policy evaluation and storage. </font><br>
I vomited a little. Personally, I'm not against some FS-specific ACL perversions. Just wash your hands after using it.<br>
<p>
But forcing your insanity on others? No way.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661667/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661673"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 0:59 UTC (Thu)
                               by <b>fandingo</b> (guest, #67019)
                              [<a href="/Articles/661673/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
What's the insanity? If you don't want to express anything beyond POSIX ACLs, it's nothing more than a storing data in a different format. Plus, it's not some brand-new format; it's using well-tested xattrs. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661673/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661675"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 1:09 UTC (Thu)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/661675/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;  What's the insanity? If you don't want to express anything beyond POSIX ACLs, it's nothing more than a storing data in a different format.</font><br>
And a translation layer. And significant additional overhead (xattrs are SLOW compared to the fastpath).<br>
<p>
So no, it's definitely not something I'd want to ever see close to my systems.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661675/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor661912"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 23, 2015 19:59 UTC (Fri)
                               by <b>nevyn</b> (guest, #33129)
                              [<a href="/Articles/661912/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Speed should override any other concerns here, look at the time of a large rsync on files with just modes vs. those which have xattrs or ACLs.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661912/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor661679"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2015 2:05 UTC (Thu)
                               by <b>bfields</b> (subscriber, #19510)
                              [<a href="/Articles/661679/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <blockquote>There's absolutely no reason why this needs to be done in POSIX bits, though. If the file/file-system is Richacl enabled, translate the chmod(2) (or the variety of other POSIX ACL syscalls) to Richacl -- solely operating on the Richacl xattrs. The POSIX bits, then, are just a virtual representation of Richacl xattrs.</blockquote>

<p>Note that POSIX ACLs are quite a bit more complicated than mode bits, I wouldn't lump them together.

<p>You can think of Andreas's patches as already implementing mode bits on top of Richacls, if you'd like.  I'm not sure exactly what your complaint is there.

<p>Going further and implementing full POSIX ACLs on top of Richacls would also be possible, but quite complicated, and I think Andreas's choice not to do that is reasonable.
      
          <div class="CommentReplyButton">
            <form action="/Articles/661679/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor661631"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 20:19 UTC (Wed)
                               by <b>AndreiG</b> (guest, #90359)
                              [<a href="/Articles/661631/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Rich ACLs ... ? Are they written in Ruby, or what ? :D<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661631/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor661633"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 21, 2015 20:50 UTC (Wed)
                               by <b>BlueLightning</b> (subscriber, #38978)
                              [<a href="/Articles/661633/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Linked with gold, surely.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661633/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor661996"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 25, 2015 22:48 UTC (Sun)
                               by <b>skissane</b> (subscriber, #38675)
                              [<a href="/Articles/661996/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; With one obscure exception, all POSIX ACLs can be mapped onto NFSv4 ACLs</font><br>
And what is that "one obscure exception"? My curiosity has been piqued.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/661996/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor796349"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 15, 2019 17:59 UTC (Thu)
                               by <b>pgoetz</b> (subscriber, #4931)
                              [<a href="/Articles/796349/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
An example is provided here:  <a href="https://tools.ietf.org/id/draft-ietf-nfsv4-acl-mapping-03.txt">https://tools.ietf.org/id/draft-ietf-nfsv4-acl-mapping-03...</a><br>
<p>
   There is one extremely minor inaccuracy in this mapping: if a<br>
   requester that is a member of more than one group listed in the ACL<br>
   requests multiple bits simultaneously, the POSIX algorithm requires<br>
   all of the bits to be granted simultaneously by one of the group<br>
   ACEs.  Thus a POSIX ACL such as<br>
<p>
        ACL_USER_OBJ: ---<br>
        ACL_GROUP_OBJ: ---<br>
        g1: r--<br>
        g2: -w-<br>
        ACL_MASK: rw-<br>
        ACL_OTHER: ---<br>
<p>
   will prevent a user that is a member of groups g1 and g2 from opening<br>
   a file for both read and write, even though read and write would be<br>
   individually permitted.<br>
<p>
   The NFSv4 ACL permission-checking algorithm has the property that it<br>
   permits a group of bits whenever it would permit each bit individu-<br>
   ally, so it is impossible to mimic this behaviour with an NFSv4 ACL.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/796349/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor796355"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 15, 2019 18:36 UTC (Thu)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/796355/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
A great example why RichACLs and ACLs in general are a bad idea and should just stay away from the kernel.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/796355/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor796777"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 20, 2019 16:43 UTC (Tue)
                               by <b>bfields</b> (subscriber, #19510)
                              [<a href="/Articles/796777/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>Eh, this is a pretty minor nit.

<p>If you want to complain about some flavor or ACLs being too complicated, I think there are better places to start.

<p>Here, honestly, I think we should probably just fix the Linux ACL implementation, and I doubt anyone would notice the change.

<p>I've been meaning to write a patch and just haven't gotten around to it.  It's not something people run across in practice so a little hard to prioritize.
      
          <div class="CommentReplyButton">
            <form action="/Articles/796777/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor796352"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Rich access control lists</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 15, 2019 18:02 UTC (Thu)
                               by <b>pgoetz</b> (subscriber, #4931)
                              [<a href="/Articles/796352/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It is so freaking depressing that Jon published this article in 2015 and we STILL don't have RichACLs in the linux kernel.  For people like myself who have to deal with real world security issues in a heterogeneous compute environment, this is a serious impediment to satisfying fairly reasonable security requests.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/796352/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2015, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
