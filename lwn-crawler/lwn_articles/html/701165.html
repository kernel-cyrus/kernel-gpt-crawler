        <!DOCTYPE html>
        <html lang="en">
        <head><title>BBR congestion control [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/701165/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/700786/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/701165/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>BBR congestion control</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>We're bad at marketing</b>
<p>
We can admit it, marketing is not our strong suit. Our strength is
writing the kind of articles that developers, administrators, and
free-software supporters depend on to know what is going on in the
Linux world. Please <a href="/Promo/nsn-bad/subscribe">subscribe today</a> to help us keep doing that, and so
we don’t have to get good at marketing.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>September 21, 2016</br>
           </div>
Congestion-control algorithms are unglamorous bits of code that allow
network protocols (usually TCP) to maximize the throughput of any given
connection while simultaneously sharing the available bandwidth equitably
with other users.  New algorithms tend not to generate a great deal of
excitement; the addition of <a
href="https://docs.google.com/document/d/1o-53jbO_xH-m9g2YCgjaf5bK8vePjWP6Mk0rYiRLK-U/edit">TCP
New Vegas</a> during the 4.8 merge window drew little fanfare, for example.
The BBR (Bottleneck Bandwidth and RTT)
algorithm just released by Google, though, is attracting rather more
attention; it moves away from the mechanisms traditionally used by these
algorithms in an attempt to get better results in a network characterized by
wireless links, meddling middleboxes, and bufferbloat.
<p>
The problem that any congestion-control algorithm must solve is that the
net has no mechanism for informing an endpoint of the bandwidth available
for a given connection.  So the algorithm must, somehow, come to its own
conclusions regarding just how much data it can send at any given time.
Since the available bandwidth will generally vary over time, that bandwidth
estimate must be revised occasionally.  In other words, a congestion control
algorithm
must maintain an ongoing estimate of how much data can be sent, derived
from the information that is available to it.
<p>
That information is somewhat
sparse.  These algorithms typically work by using one metric that they are
easily able to measure: the number of packets that do not make it to the
other end 
of the connection and must be retransmitted.  When the network is running
smoothly, dropped packets 
should be a rare occurrence.  Once a router's buffers begin to fill,
though, it will have no choice but to drop the packets it has no room for.
Packet drops are thus a fairly reliable signal that a connection is
overrunning the bandwidth available to it and should slow down.
<p>
The problem with this approach, on the network we have now, is that the
buffers between any pair of endpoints can be huge.  Oversized buffers <a
href="http://bufferbloat.net/">have 
been recognized</a> as a problem for some years now, and progress has been made
in mitigating the resulting bufferbloat issues.  But the world is still full
of bloated routers and some link-level technologies, such as WiFi, require
a certain amount of buffering for optimal performance.  By the time an
endpoint has sent enough data to overflow a buffer somewhere along the
connection, the amount of data buffered could be huge.  The packet-loss
signal, in other words, comes far too late; by the time it is received, an
endpoint could have been overdriving the connection for a long time.
<p>
Loss-based algorithms can also run into problems when short-lived
conditions cause a dropped packet.  They may slow down unnecessarily and,
as a result, fail to make use of the bandwidth that is available.
<p>
<h4>Bottleneck Bandwidth and RTT</h4>
<p>
The BBR algorithm differs from most of the
others in that it pays relatively little 
attention to packet loss.  Instead, its primary metric is the actual
bandwidth of data delivered to the far end.  Whenever an acknowledgment
packet is received, BBR updates its measurement of the amount of data
delivered.  The sum of data delivered over a period of time
is a reasonably good indicator of the bandwidth the connection is able to
provide, since the connection has demonstrably provided that bandwidth
recently. 
<p>
When a connection starts up, BBR will be in the "startup" state; in this
mode, it behaves like most traditional congestion-control algorithms in
that it starts slowly, but quickly ramps up the transmission speed in an
attempt to measure the available bandwidth.  Most algorithms will continue
to ramp up until they experience a dropped packet; BBR, instead, watches
the bandwidth measurement described above.  In particular, it looks at the
actual delivered bandwidth for the last three round-trip times to see if it
changes.  Once the bandwidth stops rising, BBR concludes that it has found
the effective bandwidth of the connection and can stop ramping up; this has
a good chance of happening well before packet loss would begin.
<p>
The measured bandwidth is then deemed to be the rate at which packets
should be sent over the connection.  But in measuring that rate, BBR
probably transmitted packets at a higher rate for a while; some of them
will be sitting in queues waiting to be delivered.  In an attempt to drain
those packets out of the buffers where they languish, BBR will go into a
"drain" state, during which it will transmit below the measured bandwidth
until it has made up for the excess packets sent before.
<p>
Once the drain phase is done, BBR goes into the steady-state mode where it
transmits at more-or-less the calculated bandwidth.  That is "more-or-less"
because the characteristics of a network connection will change over time,
so the actual delivered bandwidth must be continuously monitored.  Also, an
increase in effective bandwidth can only be detected by occasionally trying
to transmit at a higher rate, so BBR will scale the rate up by 25% about
1/8 of the time.  If the bandwidth has not increased (transmitting at a
higher rate does not result in data being delivered at a higher rate, in
other words), that probe will be
followed by a drain period to even things out again.
<p>
One interesting aspect of BBR is that, unlike most other algorithms, it
does not use the congestion window as the primary means of controlling
outgoing traffic.  The congestion window limits the maximum amount of data
that can be in flight at any given time; an increase in the window will
generally result in a burst of packets consuming the newly available
bandwidth.  BBR, instead, uses the <a
href="http://man7.org/linux/man-pages/man8/tc-fq.8.html">tc-fq</a> packet
scheduler to send out data at the proper rate.  The congestion window is
still set as a way of ensuring that there is never too much data in flight,
but it is no longer the main regulatory mechanism.
<p>
There is one last complication: many network connections are subject to
"policers", middleboxes that limit the maximum data rate any connection can
reach.  If such a box exists, there is little point in trying to exceed
the rate it will allow.  The BBR code looks for periods with a suspiciously
constant bandwidth (within 4Kb/sec) and a high packet loss rate; should
that happen, it concludes that there is a policer in the loop and limits
the bandwidth to a level that will not cause that policer to start dropping
packets. 
<p>
<a href="/Articles/701177/">The BBR patch set</a> was posted by Neal
Cardwell; the code itself carries signoffs from a number of people,
including Van Jacobson and Eric Dumazet.  Google has, they say, been using
BBR for some time, and is evidently happy with the results; BBR works fine
when only one side of the connection is using it, so each deployment
should, if it lives up to its promises, make the net that much better.
We shouldn't have to wait long to find out; networking maintainer David
Miller has <a href="/Articles/701360/">applied</a> the patches, meaning
that BBR should be available in the 4.9 kernel.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Networking-Congestion_control">Networking/Congestion control</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/701165/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor701391"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 21, 2016 18:47 UTC (Wed)
                               by <b>post-factum</b> (subscriber, #53836)
                              [<a href="/Articles/701391/">Link</a>] (10 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Another congestion control algorithm targeted to deprecate others? Even CoDel?<br>
<p>
How many of them are already in kernel? Which one to use?<br>
<p>
And, of course, this link should be here: <a href="https://xkcd.com/927/">https://xkcd.com/927/</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701391/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor701393"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 21, 2016 18:49 UTC (Wed)
                               by <b>post-factum</b> (subscriber, #53836)
                              [<a href="/Articles/701393/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
No, it seems I'm wrong about CoDel, sorry.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701393/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor701434"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 21, 2016 23:11 UTC (Wed)
                               by <b>pr1268</b> (subscriber, #24648)
                              [<a href="/Articles/701434/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <p>I'm unsure calling each of the congestion control algorithms a <em>standard</em> is appropriate (well, except for maybe Slow-Start).  It's more like having a wide variety of choices, and the user can choose whichever one he/she thinks works best.</p>

<p>Not that I disagree with you, though.  There are at least <a href="https://en.wikipedia.org/wiki/TCP_congestion_control">ten such algorithms</a> in the Linux Kernel&mdash;maybe more; I'm not at my Linux computer as I'm typing this.  So many choices.... :-\</p>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701434/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor701463"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 22, 2016 5:21 UTC (Thu)
                               by <b>josh</b> (subscriber, #17465)
                              [<a href="/Articles/701463/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I hope one day that one of them will get turned on by default, either by the upstream kernel or downstream in Linux distributions.<br>
<p>
Other than additional processing power, does BBR do any *harm* in any scenario?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701463/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor701470"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 22, 2016 6:04 UTC (Thu)
                               by <b>shemminger</b> (subscriber, #5739)
                              [<a href="/Articles/701470/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
In my limited testing BBR does not do as well in some of the network corner cases. Also it requires tc-fq which is not appropriate for use on routers. You may see some distro's enabling it, but not all.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701470/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor701474"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 22, 2016 7:33 UTC (Thu)
                               by <b>josh</b> (subscriber, #17465)
                              [<a href="/Articles/701474/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Does not do as well as other congestion control algorithms, or does not do as well as not enabling *any* congestion control algorithm?<br>
<p>
It makes sense that the various congestion control algorithms will have tradeoffs.  But if one of them works consistently better in every way than not enabling one at all, why not enable one?<br>
<p>
<font class="QuotedText">&gt; Also it requires tc-fq which is not appropriate for use on routers.</font><br>
<p>
Why not?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701474/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor701654"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 22, 2016 23:18 UTC (Thu)
                               by <b>shemminger</b> (subscriber, #5739)
                              [<a href="/Articles/701654/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
From Eric Dumazet:<br>
<p>
fq_codel is stochastic, so it wont work very well on hosts with 1,000,000 flows or more...<br>
<p>
fq_codel is aimed for routers, while sch_fq targets hosts, implementing pacing at a minimal cost (one high resolution timer per qdisc)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701654/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor701670"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 23, 2016 3:32 UTC (Fri)
                               by <b>gdt</b> (subscriber, #6284)
                              [<a href="/Articles/701670/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p><i>at least ten such algorithms in the Linux Kernel</i></p>

<p>Having all the congestion control algorithms available on a platform allows simple reasoning about the real-world performance of the algorithms: the only difference is the algorithm; the operating system, hardware and network are constant.[1] Stephen and others' implementation of plugable congestion control modules was by itself responsible for an appreciable advance in the state of the art, as it made in-the-field comparisons of algorithm performance easy to do: you didn't have to additionally have to reason about the comparative networking attributes of FreeBSD and Windows. This doesn't mean that all the algorithms provided by Linux are a good choice, far from it. However it is still useful to ship these algorithms as points of reference to identify regressions in newer algorithms.</p>

<p>As for user complexity, the default algorithm is a reasonable choice. There's no reason for a user to know other choices exist. If you wish to make a different choice then having all the alternatives available is a good thing, as often whichever alternative is "best" depends upon your circumstances. The default algorithm has been altered in the past, and I expect will be again. However given the possibility of a fault causing congestion collapse, all maintainers of widely-used operating systems take pains to ensure that algorithms and their implementations have proven themselves before they are used as a new default.</p>

<p>--------</p>

<p>[1] "all", as far as patent law allows.</p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/701670/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor701491"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 22, 2016 10:38 UTC (Thu)
                               by <b>Sesse</b> (subscriber, #53779)
                              [<a href="/Articles/701491/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
BBR isn't a traffic control algorithm (like CoDel is), it's a TCP congestion control algorithm (like CUBIC is).<br>
<p>
Think of it this way: BBR is for your endpoints. CoDel is for every router along the way. (The waters get slightly muddied if your server doubles as a router, though.)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701491/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor701641"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 22, 2016 20:43 UTC (Thu)
                               by <b>mtaht</b> (subscriber, #11087)
                              [<a href="/Articles/701641/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
sesse - *fq*-codel is for the routers along the way, IMHO. :)<br>
<p>
Given BBR's characteristics, the "FQ" portion helps most with legacy CC mechanisms, but I did just run a long string of tests showing the BBR + fq_codel is very good, much better than either alone.<br>
<p>
I'll try to write up those results in the next week or so, but the<br>
flent dataset is here: <a href="http://blog.cerowrt.org/flent/bbr-comprehensive.tgz">http://blog.cerowrt.org/flent/bbr-comprehensive.tgz</a> if you want to browse and compare.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701641/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor701659"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 22, 2016 23:46 UTC (Thu)
                               by <b>Sesse</b> (subscriber, #53779)
                              [<a href="/Articles/701659/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Sure, but the question was about codel, so I used that as an example.<br>
<p>
In a sense, it's a bit icky that sch_fq uses the qdisc hooks to do TCP pacing, but given how many failed attempts there were at implementing paced TCP in Linux before Eric Dumazet came along and just did it, and how amazingly well it works (even without BBR, it's a great win), I'll survive that it takes up the “slot” from fq_codel. (Also, it's a bit confusing that it's called sch_fq; it should really be called sch_packet_pacing, because I can't imagine another reason to run it.)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701659/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor701396"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 21, 2016 19:34 UTC (Wed)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/701396/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Here's some nice looking graphs: <a href="http://blog.cerowrt.org/post/bbrs_basic_beauty/">http://blog.cerowrt.org/post/bbrs_basic_beauty/</a><br>
<p>
I hope this is as easy to set up as the CDG &amp; fq-codel I've been using (to great effect). Tweaking one sysctl and a few kconfig options is fine, but every time I try to get into the tc manpages my eyes glaze over.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701396/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor701443"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 22, 2016 2:13 UTC (Thu)
                               by <b>mtaht</b> (subscriber, #11087)
                              [<a href="/Articles/701443/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I haven't had so much fun tearing something apart to see how it works in *years*.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701443/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor701828"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 24, 2016 21:23 UTC (Sat)
                               by <b>hechacker1</b> (guest, #82466)
                              [<a href="/Articles/701828/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Thanks,<br>
<p>
It was a good post. I hoping to see it in ubuntu server soon since I use a squid proxy for my own network.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701828/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor701511"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Where is one supposed to run this?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 22, 2016 12:39 UTC (Thu)
                               by <b>giggls</b> (subscriber, #48434)
                              [<a href="/Articles/701511/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Which machine should run this rather than Linux based Servers?<br>
<p>
My (Linux based) Router or Desktop?<br>
<p>
Sven<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701511/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor701542"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Where is one supposed to run this?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 22, 2016 15:17 UTC (Thu)
                               by <b>blitzkrieg3</b> (guest, #57873)
                              [<a href="/Articles/701542/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Based on developed by Google, and the fact that it's supposed to work better with wifi connected devices, I'm thinking Android handsets and Chromebooks.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701542/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor702043"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Where is one supposed to run this?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 28, 2016 0:22 UTC (Wed)
                               by <b>gdt</b> (subscriber, #6284)
                              [<a href="/Articles/702043/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <p>Recall that it is the transmitter that makes the decisions in TCP congestion control, the receiver simply Acks. Where the handset or Chromebook is predominately a consumer of data then its choice of TCP congestion control algorithm isn't going to make a difference.</p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/702043/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor702353"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Where is one supposed to run this?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 2, 2016 4:23 UTC (Sun)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/702353/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Video isn't just YouTube - it's also Skype, Hangouts etc. The latter are much more vulnerable than the former to network issues, espcially latency issues like bufferbloat. When reading the description of BBR above I felt like someone in the back kept screaming "adaptive video codecs".<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/702353/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor701544"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Where is one supposed to run this?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 22, 2016 15:28 UTC (Thu)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/701544/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>Any TCP endpoints - desktops, servers etc. Routers don't need to if they're just routing, but they'll benefit for things like SSH.
      
          <div class="CommentReplyButton">
            <form action="/Articles/701544/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor701668"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 23, 2016 2:03 UTC (Fri)
                               by <b>jcm</b> (subscriber, #18262)
                              [<a href="/Articles/701668/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
What is being done to solve the real problem (of providing estimated bandwidth information to end points on a network)? Sure, there's all kinds of things that could go wrong and all kinds of lies (equipment needs to propagate this, and provide updates in a timely fashion, etc.) but what is actually being done to try?<br>
<p>
Too often, I see problems in this world being solved by cleaver technical solutions because "utopia will never happen, so we'll just do this...". It might take a decade to provide a nicer solution that works at internet scale, which is all the more reason to get that moving now. And it's amazing how you can force people to use standards if you get big enough players pushing it through to help.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701668/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor701686"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 23, 2016 9:22 UTC (Fri)
                               by <b>diegor</b> (subscriber, #1967)
                              [<a href="/Articles/701686/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This is what they tried to do in the past, and they came with ATM. ATM before a connection is opened, verified that every router have enough bandwith for you connection, and that bandwidth is allocated to your connection.<br>
<p>
ATM was pushed by many big telecomunication company, but at the end failed. Without router pre allocating bandwith, there is no real improvements in estimate "bandwith information". <br>
<p>
Note that in a resiliant network, where every packet of a connection can be routed in a different way, it's just delusional to think that you can better track bandwith allocation for every connection on router, respect to what you can do on the endpoint.<br>
<p>
Every complex problem, have a nice solution, easy to understand, that doesn't work.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701686/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor701688"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 23, 2016 9:37 UTC (Fri)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/701688/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
ATM (and really, other synchronous networks) were the first step. The next one was RSVP ( <a href="https://en.wikipedia.org/wiki/Resource_Reservation_Protocol">https://en.wikipedia.org/wiki/Resource_Reservation_Protocol</a> ).<br>
<p>
I worked for a telecom that tried to deploy it. It actually looked awesome when it worked - you could get a channel across a network with guaranteed throughput and no jitter. And because telecoms usually build networks in rings, it could even survive individual fiber cuts without losing a single packet.<br>
<p>
The catch phrase, of course, "when it worked". RSVP-capable hardware cost a LOT more than regular one and when it breaks finding the cause often involved restarting large parts of the network.<br>
<p>
Eventually it was abandoned and they simply overprovisioned networks, segregating purely data flows into low-priority buckets.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701688/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor701822"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 24, 2016 17:13 UTC (Sat)
                               by <b>shemminger</b> (subscriber, #5739)
                              [<a href="/Articles/701822/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
End-to-End bandwidth information does not exist in the Internet. Circuit switch networks died years ago.<br>
Only in restricted research networks and closed networks has it ever been possible. Even then the dynamic nature of available bandwidth means that any data given to end points would be out of date.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701822/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor701839"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 25, 2016 1:59 UTC (Sun)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/701839/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Realistically though, the global network topology doesn't usually change drastically throughout the life of a typical TCP connection. It's not possible to obtain accurate guaranteed throughput number, but simple estimates might help.<br>
<p>
Something like ICMP "Packet Too Big" message, but for bandwidth. So if a router sees an "Advised Throughput Capacity" message with a value greater than it can sustain, it re-sends the message with a lower value. Kinda like extended ECN.<br>
<p>
Of course, endpoints will be free to ignore this hint.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701839/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor702145"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 29, 2016 5:10 UTC (Thu)
                               by <b>mtaht</b> (subscriber, #11087)
                              [<a href="/Articles/702145/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
see the history of icmp source quench<br>
<p>
<a href="https://tools.ietf.org/html/rfc6633">https://tools.ietf.org/html/rfc6633</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/702145/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor702153"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 29, 2016 9:13 UTC (Thu)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/702153/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Source quench was meant to be a request, not a hint. And it was deployed way back when the TCP stacks were exceedingly primitive.<br>
<p>
A semi-authenticated ICMP message that is treated as a hint might be a much better idea now.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/702153/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor702231"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 29, 2016 19:34 UTC (Thu)
                               by <b>mtaht</b> (subscriber, #11087)
                              [<a href="/Articles/702231/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I don't see how to get past this for a newer icmp message.<br>
<p>
"Widespread deployment of ICMP filtering makes it impossible to<br>
      rely on ICMP Source Quench messages for congestion control."<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/702231/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor702324"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 1, 2016 0:27 UTC (Sat)
                               by <b>simoncion</b> (guest, #41674)
                              [<a href="/Articles/702324/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
By relying on the fact that IPv6 requires admins to permit at least _some_ ICMP packets through their firewalls? (And maybe the -somewhat morbid- hope that sysadmins of the "Hackers can't be allowed to _ever_ see any of my ports, ever!!1" persuasion are leaving the field to enjoy their retirement?)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/702324/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor701693"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Out-competed by more aggressive algorithms? </h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 23, 2016 10:43 UTC (Fri)
                               by <b>runekock</b> (subscriber, #50229)
                              [<a href="/Articles/701693/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
From reading this, I would fear that sharing bandwidth with an older, more aggressive algorithm will result in the BBR flow getting squeezed out. Sort of a networking parallel to Gresham's law.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701693/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor701811"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Out-competed by more aggressive algorithms? </h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 24, 2016 12:51 UTC (Sat)
                               by <b>mtaht</b> (subscriber, #11087)
                              [<a href="/Articles/701811/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
No, BBR crushes cubic in its earlier phases, in my preliminary tests.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701811/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor701834"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Out-competed by more aggressive algorithms? </h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 25, 2016 0:44 UTC (Sun)
                               by <b>giraffedata</b> (guest, #1954)
                              [<a href="/Articles/701834/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>
No, BBR crushes cubic in its earlier phases, in my preliminary tests.
</blockquote>
<p>
I'm not sure what you mean by this.  Do you mean a node gets more bandwidth if it uses BBR than if it uses CUBIC, in a typical network?  Or that in a network in which one node uses BBR and another user CUBIC, the BBR gets more bandwidth?  Or something else?
<p>
The actual question is about a node using BBR in a network in which other nodes use an older, more aggressive policy.  That may be a moot question.  The older policies one finds in a network aren't more aggressive.  CUBIC in particular is not terribly aggressive.  Even older policies do things like cut their sending rate by half when they see the first dropped packet, which is not aggressive at all.

      
          <div class="CommentReplyButton">
            <form action="/Articles/701834/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor701836"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Out-competed by more aggressive algorithms? </h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 25, 2016 2:20 UTC (Sun)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/701836/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Let's see if I understand all this right... (mtaht will probably correct me if not :)<br>
<p>
Cubic is aggressive in the sense that it has permanent acceleration, and the only thing keeping its velocity in check is a simple negative feedback loop: always trying to stuff more data into the network, until *after* the network itself becomes congested and starts rejecting (or dropping) packets.<br>
<p>
Due to that design it spends most of its time significantly under maximum capacity, ramping up until a congestion spike hits. And due to *that* effect being in the wild for so long, network middleboxes have evolved to buffer tons of data even when they can't forward it right away, because a higher initial rate spike for a short-lived connection (e.g. HTTP) would be perceived as "faster".<br>
<p>
BBR uses a lot of cleverness to guess the network path's effective bandwidth based on ACK delays and then self-regulates slightly below that, updating its estimate over time. If a Cubic stream is sharing the same pipe, it'll still be oscillating between over- and under-loaded, but because it's mostly under, the BBR stream will see "spare" capacity and gradually eat the difference until it has significantly more than 50% of the total throughput.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701836/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor701842"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Out-competed by more aggressive algorithms? </h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 25, 2016 4:29 UTC (Sun)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/701842/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There's another effect here. Lots of routers try to share bandwidth fairly between various flows, so BBR and Cubic flows will get the same bandwidth if they both are 100% loaded. But in this case Cubic will oscillate back and forth while BBR will remain mostly stable.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701842/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor701856"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Out-competed by more aggressive algorithms? </h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 25, 2016 18:55 UTC (Sun)
                               by <b>mtaht</b> (subscriber, #11087)
                              [<a href="/Articles/701856/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That is a very good explanation. I will be writing more on my blog, after I run a few thousand more tests, and think about things more. I've already mildly mis-interpreted one dataset, publicly, and I'd like to "do it right" - and for that matter, wait for the paper.<br>
<p>
That said, BBR and cubic CAN co-habitate in a conventional drop tail system - this plot - showing a BBR, cubic, BBR, and cubic flow, starting 3 seconds apart, in sequence, shows that.<br>
<p>
<a href="http://blog.cerowrt.org/flent/bbr-comprehensive/latecomer_advantage.svg">http://blog.cerowrt.org/flent/bbr-comprehensive/latecomer...</a><br>
<p>
(interpretation, I welcome corrections!)<br>
<p>
The first BBR flow gets a reasonable RTT estimate, and when cubic hits the link, BBR falls off to what it thinks is a reasonably "fair share" of the link, while cubic grabs what it can, and then gets crushed by the second BBR flow entering the link (which does not get an accurate early RTT estimate) - BUT - eventually, it does, and all flows of both CCs eventually achieve something close to parity.<br>
<p>
There's a lot of carnage going on in the background to get to this point - and this is a nasty test, intentionally so! And I did most of the data collection in the wee hours of the morning (and in the interest of science made all my data public) <br>
<p>
I keep the blog and a goodly portion of the flent data (including, rarely, packet captures) on github. I track queue depth, emulate several RTTs, multiple kinds of devices (notably cable modems), and also put multiple AQM and fq technologies in the path as well. <br>
<p>
<a href="https://github.com/dtaht/blog-cerowrt">https://github.com/dtaht/blog-cerowrt</a><br>
<p>
I think - based on what I just seen - I need to go add conventional policers to the test matrix. Sigh. And then theres, you know, making wifi fast, which is what I should be finishing up instead of going gaga over BBR.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701856/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor701835"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">data rate, not bandwidth</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 25, 2016 0:57 UTC (Sun)
                               by <b>giraffedata</b> (guest, #1954)
                              [<a href="/Articles/701835/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <p>I had a hard time understanding this at first because of the incorrect use of the word "bandwidth."  Bandwidth is capacity, so phrases such as, "the actual bandwidth of data delivered to the far end" don't make sense.

<p>
It's supposed to say, "the actual rate of data delivered to the far end," and BBR is simply about comparing the rate of data delivered to the far end to the rate sent from the near end, and when you've raised the latter to the point that it's greater than the former, you've discovered the bandwidth of the connection.

<p>
To be even more clear, I would say "the actual rate of data arriving at the far end."

      
          <div class="CommentReplyButton">
            <form action="/Articles/701835/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor702356"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">data rate, not bandwidth</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 2, 2016 4:26 UTC (Sun)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/702356/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; It's supposed to say, "the actual rate of data...</font><br>
<p>
"Throughput" is the shorter word you're looking for.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/702356/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor702643"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">data rate, not bandwidth</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 5, 2016 18:03 UTC (Wed)
                               by <b>giraffedata</b> (guest, #1954)
                              [<a href="/Articles/702643/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <blockquote>
"Throughput" is the shorter word you're looking for.
</blockquote>
<p>
In this case, I think "throughput" would have been almost as confusing as bandwidth, because we're dealing with the special case that the data rate into the pipe is greater than the data rate out of it (because of that meddlesome buffering by routers).  I think of throughput as a steady state thing covering the whole pipe.

      
          <div class="CommentReplyButton">
            <form action="/Articles/702643/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor701877"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 26, 2016 12:20 UTC (Mon)
                               by <b>anton</b> (subscriber, #25547)
                              [<a href="/Articles/701877/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <a href="https://net2o.de/internet-2.0.html">Net2o</a> also estimates the available bandwidth through the round-trip time, as described in these <a href="https://net2o.de/net2o-tl2.pdf">Slides from 2012</a>.  It would be interesting to see a more detailed comparison between BBR and net2o flow control.
      
          <div class="CommentReplyButton">
            <form action="/Articles/701877/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor702226"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 29, 2016 18:45 UTC (Thu)
                               by <b>forthy</b> (guest, #1525)
                              [<a href="/Articles/702226/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Net2o doesn't use round trip delay for rate (it keeps measuring this, though), the sender is sending out bursts, and the receiver measures how fast these bursts arrive.  The way back is not included in the measurement, so the measured time is from first to last packet of a burst (and also the timestamp of the first packet in a burst, to measure delay).<br>
<p>
Note that net2o can do a lot of things TCP can't, because it is redesigned from scratch, and therefore the ack packets can contain more information than a TCP ack.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/702226/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor701971"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 27, 2016 9:45 UTC (Tue)
                               by <b>nnovoice</b> (guest, #111400)
                              [<a href="/Articles/701971/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Does BBR not care for tcp rmem and wmem values? I have been trying to set small values to the tcp rmem and wmem buffers so as to counter the bufferbloat issues on 3G and 4G links. Also trying to use fq_codel.<br>
Also, <a href="http://blog.cerowrt.org/post/bbrs_basic_beauty/">http://blog.cerowrt.org/post/bbrs_basic_beauty/</a> link says better bandwidth and sawtooth is also dead, which is really good if it happens. Itching to try BBR, but have to go from 4.1 to 4.9. Long way to go!<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/701971/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor702262"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 30, 2016 5:51 UTC (Fri)
                               by <b>pjardetzky</b> (guest, #111456)
                              [<a href="/Articles/702262/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Reminds me of this rate-based work from the early 90s. <a href="http://ccr.sigcomm.org/archive/1995/jan95/ccr-9501-keshav91.pdf">http://ccr.sigcomm.org/archive/1995/jan95/ccr-9501-keshav...</a><br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/702262/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor709529"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 17, 2016 0:04 UTC (Sat)
                               by <b>dps</b> (guest, #5725)
                              [<a href="/Articles/709529/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
A while ago I looked at *lot* of research about bandwidth, delay, etc measurement. Some of the results where impressive but none of the tools developed and much else is no longer accessible. The only major exception is nttcp, which debian has but is hard to find elsewhere.<br>
<p>
BBR seems to be using some similar techniques to tools whih measured rsponse tines for two back to back ICMP echo request packets, some which claimed good results. Very asymmetric links and 100:1 contention has made the problem harder.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/709529/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor731262"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 17, 2017 13:18 UTC (Thu)
                               by <b>plasma-tiger</b> (guest, #115599)
                              [<a href="/Articles/731262/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
With this algorithm in place, will a handheld mobile user see any difference in web working faster?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/731262/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor731447"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 19, 2017 16:30 UTC (Sat)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/731447/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
BBR is a sender-side change, so all end users get the benefit if a server upgrades. If it required client changes it'd be nearly worthless; Android vendors never keep their kernel up to date.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/731447/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor776090"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jan 6, 2019 21:26 UTC (Sun)
                               by <b>bircoph</b> (guest, #117170)
                              [<a href="/Articles/776090/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I gave BBR a try on 4.19.13 kernel, FQ traffic scheduler is enabled as well.<br>
Tests were made on two endpoints (desktop and laptop) connected via openvpn.<br>
<p>
With Cubic on sending side I have ~3 MB/s initiall which steadily rises to ~5 MB/s and holds there. 5 MB/s hits a CPU limit on laptop due to sophisticated encryption used.<br>
<p>
With BBR I have initial speed ~5MB/s which drops steadily to ~400 КB/s and holds there.<br>
<p>
So maybe BBR is good for specific datacenter setups or lab environment, but it is a failure for real life end-user hardware on common wired or wireless networks. At least for now. Maybe some bug in the kernel?<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/776090/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor776091"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jan 6, 2019 22:43 UTC (Sun)
                               by <b>zlynx</b> (guest, #2285)
                              [<a href="/Articles/776091/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You may be having a OpenVPN problem. I honestly haven't tried it that way.<br>
<p>
But today I needed to copy a disk image around anyway so I tried it from my laptop over WiFi to my NAS. Both are running Fedora 29, both with BBR enabled.<br>
<p>
Something you should know about FQ though. The WiFi system has dropped that. It no longer uses qdiscs at all. It's internal to the WiFi system and is a fq_codel variant designed for WiFi. It is supposed to work the same as FQ for BBR, however.<br>
<p>
Doing my transfer using rsync with --progress it averaged right around 20 MB/s aka just over 200 Mbps. The speed went up and down but never dropped to the floor as in your example.<br>
<p>
One thing I just thought of though. You are definitely not using OpenVPN in TCP mode, right? Using any VPN through a TCP tunnel is a horrible idea, and especially bad on WiFi. You get all of TCP's problems compounded as packet losses and delay cause both TCP sessions to react, overreact, and miserably fail.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/776091/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor776163"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jan 7, 2019 16:36 UTC (Mon)
                               by <b>bircoph</b> (guest, #117170)
                              [<a href="/Articles/776163/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; You may be having a OpenVPN problem.</font><br>
<p>
I tested OpenVPN in exactly the same environment with 4 different TCP congestion control algorithms on sender's side: RENO, BIC, CUBIC and BBR. (I also tested changing algo on receiver's side, but this changes almost nothing.) First three of them behave rather alike: RENO, BIC and CUBIC achieve 4.6-5.0 MB/s (with CUBIC being the best of three), but BBR provides a steady drop to ~400 KB/s. This is absolutely unacceptable. And this is unlikely to be an application problem, since it works well with other congestion control algorithms. So something is very wrong with BBR or its implementation.<br>
<p>
<font class="QuotedText">&gt; One thing I just thought of though. You are definitely not using OpenVPN in TCP mode, right?</font><br>
<p>
Of course I'm using TCP. It is pointless to test TCP congestion control with an UDP application. Why I'm using OpenVPN over TCP? Because that's how the server is configured and I can't change that: both endpoints are under my control, but the server is not. That's the reality I have to face and work with.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/776163/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor776164"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">BBR congestion control</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jan 7, 2019 16:54 UTC (Mon)
                               by <b>zlynx</b> (guest, #2285)
                              [<a href="/Articles/776164/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Sorry for the confusion there, but TCP does not work when tunneled inside TCP. It may appear to work but its feedback mechanisms are fundamentally broken.<br>
<p>
Use TCP sessions inside of a UDP OpenVPN tunnel.<br>
<p>
Proxy tunnels like SSH and SOCKS are different because they do not tunnel the actual TCP packets. Proxies unwrap the TCP sessions and build new ones.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/776164/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2016, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
