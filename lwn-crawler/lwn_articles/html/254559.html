        <!DOCTYPE html>
        <html lang="en">
        <head><title>Merged for 2.6.24 [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/254559/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/253978/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/254559/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>Merged for 2.6.24</h1>
</div>
<div class="ArticleText">
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>October 17, 2007</br>
           </div>
The 2.6.24 merge window is open and, as of this writing, some 5,600 patches
have found their way into the mainline.  As usual, the list of changes is
extensive.  Some of the highlights among user-visible changes are:

<p>
<ul>

<li> New drivers have been added for
     Toshiba TCM825x cameras (as found in the Nokia N800),
     Conexant cx23415 MPEG encoders (in framebuffer mode),
     Dual-DVB-T tuners,
     DiBcom DiB0070 tuners,
     Microtune MT2131 tuners,
     Samsung S5H1409 demodulators,
     Conexant CX23885/CX23887 PCIe bridge devices,
     Samsung LTV350QV LCD panel backlights,
     Kingsun KS-959 and "Dazzle" IrDA USB dongles,
     ADMtek ADM8211-based wireless network adapters,
     Marvell Libertas 8385 CF wireless adapters,
     Intel 82598-based 10GbE network cards,
     Intel PRO/Wireless 3945ABG/BG and Link AGN adapters (finally),
     IP1000 Gigabit Ethernet cards,
     ICH9 on-board Ethernet adapters,
     Tehuti Networks 10G Ethernet adapters,
     Sonics Silicon Backplane busses,
     several Ralink wireless adapters,
     "EMAC" built-in PowerPC ethernet controllers,
     Sun Neptune Ethernet adapters,
     Winchiphead CH341 USB-RS232 converters,
     Atmel AT32AP7000 USB device controllers,
     Blackfin bf548 ATAPI controllers,
     Atmel AVR32 parallel ATA controllers,
     National Semiconductor NS87415 parallel ATA controllers,
     Olympus MAUSB-10 and Fujifilm DPC-R1 flash card readers (which have
     the nice feature of allowing direct flash access without an
     intervening translation layer),
     TI DaVinci I2C controllers,
     Analog Devices ADT7470 temperature monitoring chips,
     IBM PowerExecutive power/temperature sensors,
     TI AR7 CPMAC Ethernet controllers,
     Siemens SX1 phones,
     Dallas Semiconductor DS1374 realtime clock chips,
     Atmel AT73C213 external sound devices,
     Cirrus Logic CS4270 codec devices,
     Gallant SC-6000 Audio Excel DSPs, and
     Atmel AT32AP and AT91 on-chip synchronous serial controllers.

<p>

<li> The Broadcom BCM43xx driver has been replaced by a new version which
     uses the mac80211 layer.  Actually, there's two drivers: "b43" for
     newer adapters, and "b43legacy" for older 802.11b and 802.11g
     devices. 
<p>
<li> The "dgrs" Digi RightSwitch driver has been removed from the kernel.
     This product, evidently, was never actually sold, so there should not
     be a whole lot of users inconvenienced by this change.
<p><blockquote class="ad">
<b><tt>$ sudo subscribe today</tt></b>
<p>
Subscribe today and elevate your LWN privileges. You’ll have
access to all of LWN’s high-quality articles as soon as they’re
published, and help support LWN in the process.  <a href="https://lwn.net/Promo/nst-sudo/claim">Act now</a> and you can start with a free trial subscription.
</blockquote>
<p>
<li> The kernel now has basic support for SDIO peripherals.  There is also
     now driver support for MMC/SD cards accessed via SPI controllers.
<p>
<li> The <a href="http://lwn.net/Articles/240474/">CFS group scheduling</a>
     code has been merged.   As of this writing, though, the feature cannot
     actually be turned on because the control groups code has not yet been
     merged.  There is also a per-UID fair scheduling option which does work now.
<p>
<li> There is now support for RPC-based RDMA and the ability to mount NFS
     filesystems using RDMA.
<p>
<li> The traffic shaper, which limits bandwidth usage on network links, has
     been marked obsolete and scheduled for removal in 2.6.25.  The much
     more flexible qdisc subsystem should be used instead.
<p>
<li> Allocation of UDP port numbers is now randomized.
<p>
<li> The netconsole code can now support multiple logging targets.
<p>
<li> Support for network namespaces has been added, enabling the
     virtualization of network-related resources in containers.  Also
     merged is a virtual Ethernet driver which can be used to create
     network tunnels into (and out of) containers.
<p>
<li> The <a href="http://tools.ietf.org/html/rfc4895">Authenticated chunks</a>
     protocol for the stream control transmission protocol (SCTP) is supported.
<p>

<li> A new "stateless NAT" implementation performs IPv4 network address
     translation in a much more resource-efficient manner.
<p>
<li> Support for the <a href="http://www.ietf.org/rfc/rfc4269.txt">SEED
     encryption algorithm</a> has been added.
<p>
<li> Dynamic tick and clockevent support for the x86_64 architecture (now
     the 64-bit version of the new x86 architecture, see below) has been merged.
<p>
<li> Support for serial ATA port multipliers has been added.
<p>
<li> LZO compression is now supported in the JFFS2 filesystem.
<p>
<li> The <a href="http://lwn.net/Articles/241980/">USB device
     authorization</a> code - a prerequisite to wireless USB support - has
     been merged.
<p>
<li> A new <tt>hidraw</tt> device provides access to a stream of
     unprocessed input device events for applications which have special
     needs in this area.
<p>
<li> The <a href="http://lwn.net/Articles/245600/">per-device write
     throttling patches</a> have been merged; these patches should help the
     system keep heavy traffic on one block device from starving other
     devices.  The <a href="http://lwn.net/Articles/245603/">floating
     proportions patch</a>, needed to support per-device throttling, has
     also gone in.
<p>
<li> There is a new sysctl flag for the out-of-memory killer
     (<tt>oom_kill_allocating_task</tt>).  If this flag is set, the OOM
     killer will simply kill the process whose allocation brings about the
     out-of-memory situation instead of scanning through the system looking
     for better targets.
<p>
<li> Disk quota messages can now be delivered via a netlink socket.  This
     should make it easier for graphical environments to inform the user
     when disk quota problems are encountered.
<p>
<li> The new <tt>F_DUPFD_CLOEXEC</tt> command causes <tt>fcntl()</tt> to
     duplicate a file descriptor and set the close-on-exec flag from the
     beginning.
<p>
<li> Block reservations have been added to the ext2 filesystem.
<p>
<li> The Linux security module interface is now <a
     href="http://lwn.net/Articles/239962/">a non-module interface</a>: the
     ability to load security modules on the fly has been removed.
<p>
<li> <a href="http://lwn.net/Articles/211883/">File-based capability
     masks</a> are now supported.
</ul>

<p>

Important changes visible to kernel developers include:
<p>
<ul>

<li> As expected, the <a href="http://lwn.net/Articles/243704/">i386/x86_64
     architecture merger</a> has happened.  The result is a single
     architecture, called "x86," which can be built for 32-bit and 64-bit
     processors.
<p>
<li> The Video4Linux layer has some new internal support for composite
     devices involving more than one driver (many V4L2 devices involve, at
     a minimum, separate drivers for the controller and the sensor).  
<p>
<li> Also in Video4Linux: the video-buf layer has been replaced with a more
     generic implementation which works with a wider range of devices
     (including USB devices and those which do not support scatter/gather
     DMA).
<p>
<li> The <a href="http://lwn.net/Articles/243949/">large receive offload
     (LRO)</a> support layer has been merged into the networking
     subsystem. 
<p>
<li> The NAPI interface used in network drivers <a
     href="http://lwn.net/Articles/244640/">has been reworked</a> to better
     support devices with multiple transmit queues.
<p>
<li> The networking layer has a new function for printing MAC addresses:
<p>
<pre>
    char *print_mac(char *buf, const u8 *addr);
</pre>
<p>
     The <tt>buf</tt> buffer should be declared with
     <tt>DECLARE_MAC_BUF()</tt>; the output is suitable for formatting in
     <tt>printk()</tt> with "<tt>%s</tt>".
<p>
<li> The <tt>NETIF_F_LLTX</tt> (lockless transmit) flag for network devices
     has been deprecated and should not be used in new code.
<p>
<li> The functions <tt>ktime_sub_us()</tt> and <tt>ktime_sub_ns()</tt> have
     been added; they subtract the given number of microseconds or
     nanoseconds from a <tt>ktime_t</tt> value.
<p>
<li> The <tt>hard_header()</tt> method has been removed from <tt>struct
     net_device</tt>; it has been replaced by a per-protocol
     <tt>header_ops</tt> structure pointer.
<p>
<li> The debugfs filesystem has some new functions
     (<tt>debugfs_create_x8()</tt>, <tt>debugfs_create_x16()</tt>,
     <tt>debugfs_create_x32()</tt>) which make it easy to export files
     containing hexadecimal numbers.
<p>
<li> Various small sysfs-related API changes have been made.  The
     <tt>name</tt> field has been removed from the <tt>kobject</tt>
     structure.  The prototypes of the user-event callbacks have been
     changed.  Many of the subsystem-related calls have been removed -
     subsystems never really did much of anything anyway;
     <tt>get_bus()</tt> and <tt>put_bus()</tt> are also gone.
<p>
<li> A new value <tt>DMA_MASK_NONE</tt> can be stored in the
     <tt>device</tt> structure <tt>dma_mask</tt> field to indicate that the
     device is incapable of performing DMA.
<p>
<li> The VFS has a couple of new address space operations
     (<tt>write_begin()</tt> and <tt>write_end()</tt>) aimed at fixing some
     deadlock scenarios; see <a href="/Articles/254856/">this article</a>
     for more information.
<p>
<li> The <a href="http://lwn.net/Articles/234617/">scatterlist chaining</a>
     patches have been merged and many parts of the kernel have been
     updated to use this feature.
<p>
<li> The <tt>CFLAGS=</tt> and <tt>CPPFLAGS=</tt> options now work with the
     kernel build system in the expected way: they add flags to be passed
     to the C compiler and preprocessor, respectively.
<p>
<li> The prototype for slab constructor callbacks has changed to:
<p>
<pre>
    void (*ctor)(struct kmem_cache *cache, void *object);
</pre>
<p>
     The unused <tt>flags</tt> argument has been removed and the order of
     the other two arguments has been reversed to match other slab
     functions. 
<p>
<li> The <tt>DECLARE_MUTEX_LOCKED()</tt> macro has been removed.
<p>
<li> The long-deprecated <tt>SA_*</tt> interrupt flags have been removed in
     favor of the <tt>IRQF_*</tt> equivalents.
<p>
<li> A number of block layer utilities have seen prototype changes.  The
     most evident change, perhaps, is <tt>bio_endio()</tt> and the
     associated <tt>bio_end_io_t</tt> callback:
<p>
<pre>
    void bio_endio(struct bio *bio, int error);
    typedef void (bio_end_io_t) (struct bio *, int);
</pre>
<p>
     These functions now always completes the entire BIO, so the <tt>size</tt>
     argument has been removed.

</ul>
<p>
As of this writing, the 2.6.24 merge window can be expected to remain open
for up to another week.  So expect more changes to go into the mainline
before this development cycle goes into the stabilization phase.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Releases-2.6.24">Releases/2.6.24</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/254559/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor254950"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 18, 2007 9:45 UTC (Thu)
                               by <b>mingo</b> (guest, #31122)
                              [<a href="/Articles/254950/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>
The CFS group scheduling  code has been merged. There is also a mechanism for per-UID group scheduling. As of this writing, though, the feature cannot actually be turned on because the control groups code has not yet been merged.
</blockquote>
<p>
Small correction: it can already be turned on via the CONFIG_FAIR_GROUP_SCHED=y config option - this is a feature that has been added recently.
<p>
With this feature enabled the kernel will schedule based on UIDs too: if one user runs 500 tasks and the other user runs only 2 tasks, the two users will still share the CPU(s) fairly, with both getting 50% of CPU time. (I have also tested this with fork bombs: if a user is running a fork bomb then other users are not affected at all [CPU scheduling wise], and the admin can log in and disable the user as well.)
<p>
The scheduling weight of each UID defaults to 100%, and it can be dynamically reconfigured via sysfs: /sys/kernel/uid/*/cpu_share - a value of 1024 means 100% weight. So by echoing 2048 into that file a user will get twice as much CPU time as a user who has 1024 cpu_share value.
<p>
An additional mechanism is that uevents can be used to configure UIDs as they get created. None of this needs the control groups / containers APIs. <p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/254950/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor254958"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 18, 2007 11:36 UTC (Thu)
                               by <b>mingo</b> (guest, #31122)
                              [<a href="/Articles/254958/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <blockquote>
/sys/kernel/uid/*/cpu_share
</blockquote>
<p>
Correcting myself: the right path is /sys/kernel/uids/*/cpu_share
<p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/254958/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor254970"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 18, 2007 11:56 UTC (Thu)
                               by <b>paravoid</b> (subscriber, #32869)
                              [<a href="/Articles/254970/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <pre class="FormattedComment">
While this sounds interesting, I wonder what it's implications going to be on systems that
have not designed with that in mind.

e.g. a random process run by a user getting 50% while N processes of apache take the other
50%...
</pre>

      
          <div class="CommentReplyButton">
            <form action="/Articles/254970/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor255007"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 18, 2007 15:33 UTC (Thu)
                               by <b>mingo</b> (guest, #31122)
                              [<a href="/Articles/255007/">Link</a>] 
      </p>
      
      </div>
      </summary>
      yes - anything that changes previous behavior can be "bad" for someone who expects exactly the same behavior as before.
<p>
that's why there is a config option for it that can be turned on or off. (and that's why the exact weight is configurable - often the benefits heavily outweigh the changed behavior and it's better to just adjust the defaults a bit - by for example giving the httpd user a higher weight.)

      
          <div class="CommentReplyButton">
            <form action="/Articles/255007/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor254973"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 18, 2007 12:51 UTC (Thu)
                               by <b>corbet</b> (editor, #1)
                              [<a href="/Articles/254973/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      It's the per-UID scheduling which can be turned on now, right?  When I added that sentence I obviously didn't take a proper look at how the paragraph reads as a whole...
      
          <div class="CommentReplyButton">
            <form action="/Articles/254973/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor255006"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 18, 2007 15:30 UTC (Thu)
                               by <b>mingo</b> (guest, #31122)
                              [<a href="/Articles/255006/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <blockquote><i>
It's the per-UID scheduling which can be turned on now, right?
</i></blockquote>
<p>
yeah.
<p>
<blockquote><i>
When I added that sentence I obviously didn't take a proper look at how the paragraph reads as a whole...
</i></blockquote>
<p>
Indeed - and you describe it all in more detail in the larger article about group scheduling. But i only saw that after writing this comment :-/
<p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/255006/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor254972"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Merged for 2.6.24</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 18, 2007 12:27 UTC (Thu)
                               by <b>cathectic</b> (subscriber, #40543)
                              [<a href="/Articles/254972/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <pre class="FormattedComment">
Second bullet point - s/b32legacy/b43legacy/
</pre>

      
          <div class="CommentReplyButton">
            <form action="/Articles/254972/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor266698"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Biggest set of changes since 2.6's initial release?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jan 27, 2008 17:12 UTC (Sun)
                               by <b>AnswerGuy</b> (guest, #1256)
                              [<a href="/Articles/266698/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment"><pre>

 Do you all think it would be fair to say that 2.6.24 represents the biggest set of changes
(at least user visible changes) since 2.6 was released?
 
 For the last few years I've been trapped in "RHEL Hell" (happily working, but at a company
which only supports RHEL, SLES and relatively old versions of those).  Most of my day-to-day
work has been focused in user space and on 2.4.21-*bleach!!!* kernels (with some
2.6.9-*almost_tolerable*).  So I haven't kept up on the newer releases much.

 However, I have glanced over each new release and this this one seems to be pretty extensive.

JimD
</pre></div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/266698/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2007, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
