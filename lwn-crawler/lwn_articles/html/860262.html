        <!DOCTYPE html>
        <html lang="en">
        <head><title>A stable bug fix bites proprietary modules [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/860262/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/860162/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/860262/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>A stable bug fix bites proprietary modules</h1>
</div>
<div class="ArticleText">
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>June 21, 2021</br>
           </div>
The kernel-development community has long had a tense relationship with
companies that create and ship proprietary loadable kernel modules.  In the
view of many developers, such modules are a violation of the GPL and should
simply be disallowed.  That has never happened, though; instead, the
community has pursued a policy of legal ambiguity and technical
inconvenience to discourage proprietary modules.  A
"technical-inconvenience" patch that was merged nearly one year ago has
begun to show up in stable kernel releases, leading at least one
developer to complain that things have gone a little too far.
<p>
Code that is directly linked into the kernel can access any symbol that is visible to it.
Loadable modules, instead, are restricted to a smaller (though still large)
set of symbols that are explicitly "exported" for that purpose.  Symbols
that are exported with <tt>EXPORT_SYMBOL()</tt> are available to all
loadable modules, while those exported with <tt>EXPORT_SYMBOL_GPL()</tt>
can only be used by modules that declare a GPL-compatible license.  A
non-GPL-compatible module that tries to use a GPL-only symbol will fail to
load.
<p>
The idea behind GPL-only exports is that the affected symbols are so deeply
situated within the kernel that any module using them must be a derived
product of the kernel and, thus, be subject to the requirements of the GPL.
In practice, that sort of analysis is rarely (if ever) done, and the
decision of whether to use a GPL-only export is left to individual
developers.  Many developers habitually use <tt>EXPORT_SYMBOL_GPL()</tt>
for every symbol they export out of a general distaste for proprietary
modules; some maintainers encourage this
practice for code that passes through their hands.
<p>
Over the years, purveyors of proprietary modules have engaged in a number
of tricks to get around GPL-only exports.  One of those was manually
looking up symbol addresses with <tt>kallsyms_lookup_name()</tt>; that
practice was <a href="/Articles/813350/">shut down</a> in early 2020.
Another is to split a module into two, one GPL-licensed and one
proprietary.  The GPL-licensed module interfaces directly with the kernel,
using GPL-only symbols where needed; it then calls into the proprietary
module, where all the real work gets done.
<p><blockquote class="ad">
<b><tt>$ sudo subscribe today</tt></b>
<p>
Subscribe today and elevate your LWN privileges. You’ll have
access to all of LWN’s high-quality articles as soon as they’re
published, and help support LWN in the process.  <a href="https://lwn.net/Promo/nst-sudo/claim">Act now</a> and you can start with a free trial subscription.
</blockquote>
<p>
In July 2020, the posting of this kind of shim module <a
href="/Articles/827596/">created a stir</a> on the mailing lists, leading
to the posting by Christoph Hellwig of <a
href="/ml/linux-kernel/20200730061027.29472-1-hch@lst.de/">a patch set</a>
making this trick harder to exploit.  Specifically, any module that uses
symbols exported by a proprietary module is itself marked proprietary,
regardless of the license it declares to the kernel.  Modules that hook
into proprietary modules, thus, will lose access to GPL-only symbols,
making it impossible to perform the shim function they were created for in
the first place.  This series was merged for the 5.9 kernel release in
October.
<p>
That was the end of that story — until May 2021, when that patch series found its
way into the large <a href="/Articles/855998/">5.4.118</a>, <a
href="/Articles/857000/">4.19.191</a>, and <a
href="/Articles/857001/">4.14.233</a> updates.  It seemingly took nearly
another month for 5.4.118 to find its way into at least one
distribution and create trouble for users, at which point Krzysztof Kozlowski 
<a
href="/ml/linux-kernel/8edc6f45-6c42-19c7-6f40-6f1a49cc685b@canonical.com/">asked</a>
why such a change was being included in a stable update:
<p>
<blockquote class="bq">
	How this is a stable material? What specific, real bug that bothers
	people, is being fixed here? Or maybe it fixes serious issue
	reported by a user of distribution kernel? IOW, how does this match
	stable kernel rules at all?
<p>
	For sure it breaks some out-of-tree modules already present and
	used by customers of downstream stable kernels. Therefore I wonder
	what is the bug fixed here, so the breakage and annoyance of stable
	users is justified.
</blockquote>
<p>
Stable-kernel maintainer Greg Kroah-Hartman <a
href="/ml/linux-kernel/YMxlP2EMTaG9+2y6@kroah.com/">responded</a>:
<p>
<blockquote class="bq">
	It fixes a reported bug in that somehow symbols are being exported
	to modules that should not have been.  This has been in mainline
	and newer stable releases for quite some time, it should not be a
	surprise that this was backported further as well.
</blockquote>
<p>
That pretty much ended the conversation; others may be unhappy about this
change making it into older kernels, but it is doubtful that anybody
realistically expects that it could be reverted.  It might be interesting,
though, to watch kernel updates from distributors to see whether this
additional restriction on proprietary modules is retained or quietly
removed.
<p>
This change does show where at least one limit to the kernel's "no
regressions" policy is to be found, though.  The core idea behind that
policy is that a kernel upgrade should never break a working system; kernel
developers want users to feel confident that they can move to newer kernels
without risking unpleasant surprises.  This change does indeed create such
a surprise for some users, according to Kozlowski.  But kernel modules have
never been included in the kernel's stability guarantees — not even the
GPL-licensed ones.  Kernel-developer tears are rarely shed when proprietary
modules break, and they are not in evidence this time either.
<p>
When Hellwig's patch series was first posted, LWN noted that it did not
close all of the loopholes.  Specifically, a GPL-licensed module that wraps
and re-exports symbols to a proprietary module will still work as designed
as long as no symbols are imported from that proprietary module;
this problem was <a
href="/ml/linux-kernel/5ac70bdf2c5b440c83f12e75ca42a107@AcuMS.aculab.com/">pointed
out</a> by David Laight in this discussion.  Kroah-Hartman responded with <a
href="/ml/linux-kernel/YMxlBCzztbWGvi/l@kroah.com/">a promise</a> to
"<q>work on fixing that up in a future patch series next week</q>",
so there may be more unpleasant surprises in store for the creators and
users of proprietary loadable kernel modules.
<p>
The kernel community's policy on loadable modules has, over the years,
drawn criticism from many sides.  Some see even a grudging tolerance of
proprietary modules as a weakening of the protections provided by the GPL
and a cover for vendors that don't want to play by the rules.  Others see
it as an impediment to the use of Linux in general that reduces available
hardware support and makes users jump
through unnecessary hoops.  The best way to judge this policy, though, is
to look at what its results have been over nearly three decades.
<p>

Proprietary modules still exist, but they are in the minority; most
hardware is supported with free drivers, and the situation seems to
continue to slowly improve.  Vendors that have clung to proprietary modules
in the past have found ways to change their approach; this might not have
happened if those vendors had been excluded from the Linux community
entirely.  So, perhaps, making life uncomfortable for distributors of such
modules while not trying to ban them outright may be the most productive
policy in the long run.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Development_model-Stable_tree">Development model/Stable tree</a></td></tr>
            <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Modules-Exported_symbols">Modules/Exported symbols</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/860262/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor860421"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 17:38 UTC (Mon)
                               by <b>rsidd</b> (subscriber, #2582)
                              [<a href="/Articles/860421/">Link</a>] (61 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Presumably if this is taken further, it would affect, not only proprietary modules, but free non-GPL modules (such as OpenZFS)? I&#x27;m currently using zfs with the 5.11 kernel; it&#x27;s the Ubuntu version but I ran the upstream 5.11 kernel for a while and it worked. But will that change? <br>
<p>
Linus was always known for pragmatism, at least compared to RMS. It seems a bit absurd to say that ZFS is a derived work of the linux kernel (even if, these days, most development is aimed at Linux). I realize this is controversial. Legally it may be right to block it. Pragmatically, it means blocking probably the best free software filesystem option for political reasons. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860421/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860426"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 18:01 UTC (Mon)
                               by <b>ceplm</b> (subscriber, #41334)
                              [<a href="/Articles/860426/">Link</a>] (56 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Meanwhile, other legally non-problematic filesystems matured (especially BTRFS, and XFS/w thin-provisioning of LVM), so using of ZFS on Linux is not necessary outside of rather small area of compatibility with Solaris servers.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860426/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860428"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 18:06 UTC (Mon)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/860428/">Link</a>] (48 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
LVM is not a replacement for snapshot functionality and fine-grained RAID configuration. BTRFS is a good alternative, but people are still losing data to it.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860428/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860439"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 19:14 UTC (Mon)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/860439/">Link</a>] (47 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;but people are still losing data to it.</font><br>
<p>
Is that still true?<br>
I run btrfs since lots of years on a couple of secondary external drives. No problems, ever.<br>
I will probably use btrfs on my next main laptop SSD soon.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860439/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860489"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 5:33 UTC (Tue)
                               by <b>ceplm</b> (subscriber, #41334)
                              [<a href="/Articles/860489/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Is that still true?</font><br>
<p>
It has been for years default FS for openSUSE and Fedora is now switching to it as well (or they have already switched).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860489/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor860492"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 6:07 UTC (Tue)
                               by <b>LtWorf</b> (subscriber, #124958)
                              [<a href="/Articles/860492/">Link</a>] (33 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; I run btrfs since lots of years on a couple of secondary external drives. No problems, ever.</font><br>
<p>
This is akin to saying that smoke doesn&#x27;t cause cancer because I didn&#x27;t get cancer in X years.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860492/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860502"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 8:23 UTC (Tue)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/860502/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Well, no. I did not say that. I just told my personal experience.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860502/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor860520"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 14:03 UTC (Tue)
                               by <b>nescafe</b> (subscriber, #45063)
                              [<a href="/Articles/860520/">Link</a>] (31 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That metaphor flat out doesn&#x27;t follow.  btrfs has improved to the point it is just as reliable as any other filesystem these days, as long as you avoid its built-in RAID5/6.  Cancer is not and cannot be fixed that way.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860520/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860603"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 0:26 UTC (Wed)
                               by <b>thwalker3</b> (subscriber, #89491)
                              [<a href="/Articles/860603/">Link</a>] (30 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
&quot;btrfs has improved to the point it is just as reliable as any other filesystem these days, as long as you avoid its built-in RAID5/6&quot;<br>
<p>
Which pretty much ends the comparison/equivalence to ZFS then and there.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860603/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860619"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 10:28 UTC (Wed)
                               by <b>Conan_Kudo</b> (subscriber, #103240)
                              [<a href="/Articles/860619/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <a href="https://lore.kernel.org/linux-btrfs/BL0PR04MB65144CAE288491C3FC6B0757E7489@BL0PR04MB6514.namprd04.prod.outlook.com/">The built-in RAID56 mode is being worked on and is expected to get a patch set to fix it sometime soon</a>.
      
          <div class="CommentReplyButton">
            <form action="/Articles/860619/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor860695"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 22:22 UTC (Wed)
                               by <b>ncm</b> (guest, #165)
                              [<a href="/Articles/860695/">Link</a>] (28 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
RAID5/RAID6 are nowadays pointless for almost any use. They have become a niche feature.<br>
<p>
So, I would not today consider the quality of its RAID5/RAID6 implementation when evaluating a filesystem for production use. It is very happy news to me that Btrfs seems now to be ready.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860695/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860906"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 25, 2021 8:01 UTC (Fri)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/860906/">Link</a>] (27 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Pointless for any use? Why?<br>
<p>
ALL things are tradeoffs. What would you use instead? Mirroring (raid-1)? What happens if you get data corruption? You need raid-6 to recover. What if you need the disk space? You need raid-5 to free it up,<br>
<p>
Parity raid isn&#x27;t a panacea, but it fixes a load of problems. Just sounds like YOU don&#x27;t have those particular problems.<br>
<p>
Which is why computing is such a mess today. &quot;Works for me&quot; seems to be the mantra for today&#x27;s developers, forgetting that computing is CAPABLE of a lot more than their blinkered minds can comprehend.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860906/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860917"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 25, 2021 10:05 UTC (Fri)
                               by <b>niner</b> (subscriber, #26151)
                              [<a href="/Articles/860917/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Why would you need RAID-6 to recover from data corruption? Btrfs has checksums for both metadata and the actual data. So it&#x27;s perfectly possible to recover from corruption with a plain mirror.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860917/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861011"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 25, 2021 20:38 UTC (Fri)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/861011/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
So as far as you&#x27;re concerned - &quot;works for me&quot;. Provided you&#x27;ve configured btrfs to mirror your data, which the default mirror setting doesn&#x27;t I gather ...<br>
<p>
Still, if you&#x27;re happy to spend hundreds on huge disks so you can mirror everything, if it works for you then fine. Just don&#x27;t expect it to work for everyone else.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861011/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor861051"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 26, 2021 9:32 UTC (Sat)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/861051/">Link</a>] (24 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Putting modern 10+TB drives in a parity RAID is a good way to ensure one failure pegs the rest of the array at 100% I/O for a week straight with no safety net. The design doesn&#x27;t scale any more.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861051/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861062"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 26, 2021 11:08 UTC (Sat)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/861062/">Link</a>] (23 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
And using btrfs in mirrored mode doesn&#x27;t do something similar?<br>
<p>
I&#x27;m not trying to argue for or against any particular setup. It&#x27;s all trade-offs. What I&#x27;m arguing against is people assuming that their use case fits everyone.<br>
<p>
(For example, I&#x27;ve got a mix of 3TB and 4TB drives. I intend to raid-5 or raid-6 them because I want the disk space, with the cheapest 8 or 10TB drive I can get my hands on as a backup. The resulting system will have a high degree of resilience, and fast response, that will suit me.)<br>
<p>
(Oh, and md-raid is quite capable of throttling rebuild i/o so you shouldn&#x27;t notice it happening. You may be right about losing redundancy, but surely doing a backup is going to hammer your array just the same ...)<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861062/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861072"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 26, 2021 16:05 UTC (Sat)
                               by <b>zlynx</b> (guest, #2285)
                              [<a href="/Articles/861072/">Link</a>] (22 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That depends on your choices.<br>
<p>
With RAID-1 or RAID-10 settings btrfs keeps two copies of the data. When a drive fails and is replaced, only two drives (in RAID-1) are involved during reconstruction. In RAID-10, all the drives are involved in recreating the damaged RAID-0.<br>
<p>
I have expanded a btrfs NAS system from two 2 TB WD Red drives to my current six drives. I had to replace both of the 2 TB drives over time so I have seen this play out.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861072/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861077"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 26, 2021 21:14 UTC (Sat)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/861077/">Link</a>] (21 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The point is, whether you&#x27;re using btrfs or md-raid, at the end of the day it&#x27;s the speed of your hard drives that is the limiting factor. If you lose a drive, btrfs WON&#x27;T reduce your vulnerability window compared to md-raid, because until you&#x27;ve written that new drive, you&#x27;ve got no redundancy.<br>
<p>
And while I don&#x27;t have a clue about btrfs, with md-raid you can throttle the resync. That reduces the likelihood of failure by reducing the stress, although it increases the vulnerable time. It can mean you can carry on using the system with little impact, because you can prioritise user i/o over sync&#x27;ing. And I believe the parity code is single-threaded so even if you allow it to run flat-out, it&#x27;ll only lock up one core.<br>
<p>
As I say, life is a trade-off. What matters to you?<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861077/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861135"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 27, 2021 20:28 UTC (Sun)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/861135/">Link</a>] (12 responses)
      </p>
      
      </div>
      </summary>
      <p>btrfs (and ZFS for similar reasons) do reduce your vulnerability window as compared to md-raid.
<p>md-raid does not know which bits of the disk are unallocated space awaiting a write, and which bits are in use. It has to write the entirety of the new disk in order to restore redundancy.
<p>btrfs and ZFS both track which bits of disk are allocated and in-use, and which bits are unallocated; when doing a resync, they only need to copy the data that's still valid.
<p>Thus, the two take the same time on a 100% full filesystem; but on a 50% full filesystem, btrfs and ZFS have both finished resyncing at 50% written to the new disk, while md-raid is still vulnerable until you have a 100% write to the new disk.
      
          <div class="CommentReplyButton">
            <form action="/Articles/861135/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861137"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 27, 2021 21:01 UTC (Sun)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/861137/">Link</a>] (11 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; md-raid does not know which bits of the disk are unallocated space awaiting a write, and which bits are in use. It has to write the entirety of the new disk in order to restore redundancy. </font><br>
<p>
Which is (in theory :-) easy to fix. I don&#x27;t think the dm layer currently supports fstrim, but if it does / is updated, then that layer won&#x27;t actually write to the disk. Seeing as I&#x27;m using dm-integrity, which stores a checksum, that would seem an obvious place to implement fstrim.<br>
<p>
Actually, I get the feeling something like that is there already, I just don&#x27;t know what or where.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861137/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861161"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 8:51 UTC (Mon)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/861161/">Link</a>] (10 responses)
      </p>
      
      </div>
      </summary>
      <p>Even with fstrim, on a rebuild md-raid needs you to write the whole disk - otherwise, on the next failure, it cannot distinguish "cannot rebuild because this space was never written" from "cannot rebuild because there has been one disk failure too many". Obviously, this doesn't apply in the two-disk case, but md-raid supports more than 2 drives.
<p>To fix this, you'd need to track which bits of every drive in the RAID have been written to, in some sort of filesystem-like extent or allocation bitmap structure. This is then overhead, making md-raid slower, and duplication of what the FS on top does. It's "free" for btrfs and ZFS because they have to track what space is free and what's allocated to files anyway, but md-raid does not (even with a write-intent bitmap) do that tracking, and to persist that tracking to disk would cost you both storage space and performance (since it has to be updated on every write to the RAID until it's useless).
      
          <div class="CommentReplyButton">
            <form action="/Articles/861161/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861170"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 13:10 UTC (Mon)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/861170/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Which is why I was talking about the dm layer, and dm-integrity. If we can implement this in that layer, then it will also come &quot;for free&quot;, as dm-integrity needs this information.<br>
<p>
md-raid already has a bad-blocks facility - that also could presumably be re-purposed to fs-trim.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861170/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861173"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 13:14 UTC (Mon)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/861173/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <p>If it's implemented in dm-integrity, then something has to pass the information down to md-raid, so that it knows which bits will never be read, and which bits will be read after a rebuild.
<p>It needs to be in the RAID layer (as it is in btrfs and ZFS) to save time - and that's a challenge to get right.
      
          <div class="CommentReplyButton">
            <form action="/Articles/861173/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861178"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 13:58 UTC (Mon)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/861178/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Not if dm-integrity handles the &quot;block is all zeroes&quot; scenario.<br>
<p>
Raid reads the block. dm-integrity spots it&#x27;s been trimmed and returns zeroes without bothering to actually read the disk.<br>
<p>
Raid writes the block. dm-integrity calculates the checksum, spots it&#x27;s all zeroes, and doesn&#x27;t bother to write the block.<br>
<p>
Which is how I gather fstrim tends to work anyway - the contents of the storage are garbage because the fstrim layer records that they are garbage and doesn&#x27;t bother reading them. It also doesn&#x27;t bother wiping them.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861178/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861181"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 14:01 UTC (Mon)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/861181/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <p>How is dm-integrity involved at all in a RAID resync? That's entirely performed at the md-raid layer, with no reference to higher layers like dm-integrity.
<p>It's the resync that's much faster for btrfs and ZFS, because the RAID layer knows which blocks are allocated and acts on that knowledge - whereas md-raid doesn't know which bits of the filesystem are trimmed, and which bits aren't, and needs some sort of help identifying them.
      
          <div class="CommentReplyButton">
            <form action="/Articles/861181/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861241"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 18:56 UTC (Mon)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/861241/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Why does raid need to know about it?<br>
<p>
As I understand it, when you trim an SSD, the management layer simply marks the block as empty, it makes no attempt to delete the contents. Reading such a block just returns nulls.<br>
<p>
If dm-integrity does the same, marking blocks as empty, then a resync will run much faster because the i/o will not hit the backing device. Yes - mdraid will read and write the data, but most of it will be null blocks both ways.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861241/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861247"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 21:35 UTC (Mon)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/861247/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <p>Trim just tells the next layer down that this space is unallocated - it's up to that next layer down to do something useful with that information.
<p>md-raid can only pass a trim through - it does no special processing of the trim command. If you suffer a drive failure, and have to resync, you have to write the entire drive before the RAID vulnerability window is closed - until the resync has written one full disk of data, another failure can cause data loss.
<p>Because md-raid does not track which parts of the RAID contain data, and which ones don't, when you lose a drive, it has to write the entirety of the new drive before the data loss window is closed; until then, it is possible that critical data is in the bit of the RAID that hasn't been resynced yet, and thus if another drive fails in this window, you've lost data.
<p>In contrast, btrfs and ZFS both are aware of which blocks are allocated. If you have a 10% full filesystem, then they only need to write 10% of your replacement drive, at which point data loss is not possible, because all data (and associated metadata) has been written to the new drive, and the remaining part of the drive is unallocated.
<p>Put in concrete terms; if I lose a drive in my md-raid RAID-1, I have to write 1 TiB of data to the replacement drive before I can be confident that all my data is safe against a single disk failure, despite the fact that my filesystems take up around 150 GiB. If I'd used btrfs instead when building this RAID, I would only have to write 150 GiB to the replacement drive before I had finished the resync completely and had a full copy of all my data on both drives.
      
          <div class="CommentReplyButton">
            <form action="/Articles/861247/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861258"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 23:37 UTC (Mon)
                               by <b>gdiscry</b> (subscriber, #91125)
                              [<a href="/Articles/861258/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I have a feeling that you and Wol are not talking about the same layout for md-raid and dm-integrity, and thus are talking past each others.<br>
<p>
It looks like you&#x27;re thinking of using dm-integrity above md-raid, while Wol is using dm-integrity under md-raid and above each block device.<br>
<p>
I&#x27;ve read about using dm-integrity under md-raid in the stratis design [1] and it&#x27;s the one that makes the most sense to me (because dm-integrity transforms silent corruptions as I/O errors that md-raid can recover).<br>
<p>
<font class="QuotedText">&gt; md-raid can only pass a trim through - it does no special processing of the trim command.</font><br>
<p>
dm-integrity could be the layer below that does something with trim and tracks which sectors are allocated or not, optimizing away accesses to unallocated sectors.<br>
<p>
Anyway, I&#x27;m really looking forward btrfs tackling the remaining issues in its raid code. I also hope that stratis will add integrity and raid support.<br>
<p>
[1] https://stratis-storage.github.io/<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861258/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861263"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 29, 2021 9:27 UTC (Tue)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/861263/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <p>If dm-integrity is underneath md-raid, you still have an issue. A disk fails, and is removed; md-raid now reads the entire remaining RAID, and writes it out to the replacement drive. Somehow, the dm-integrity setup for the new drive has to know that it's the twin of the other RAID in order to optimise out the writes; again, how does this information get sent across, given that md-raid hasn't tracked the state of the drives?
<p>Now, in this case, you optimise out a large number of reads, because dm-integrity on the old drives can know it's trimmed, but the new drive's dm-integrity cannot optimise out the writes, because it does not know that there were trim commands issued before this drive existed.
      
          <div class="CommentReplyButton">
            <form action="/Articles/861263/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861265"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 29, 2021 10:11 UTC (Tue)
                               by <b>gdiscry</b> (subscriber, #91125)
                              [<a href="/Articles/861265/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The new disk would start with dm-integrity in a fully trimmed state, and Wol already presented a possible optimization [1] for that case:<br>
<p>
<font class="QuotedText">&gt; Not if dm-integrity handles the &quot;block is all zeroes&quot; scenario.</font><br>
<font class="QuotedText">&gt; </font><br>
<font class="QuotedText">&gt; Raid reads the block. dm-integrity spots it&#x27;s been trimmed and returns zeroes without bothering to actually read the disk.</font><br>
<font class="QuotedText">&gt; </font><br>
<font class="QuotedText">&gt; Raid writes the block. dm-integrity calculates the checksum, spots it&#x27;s all zeroes, and doesn&#x27;t bother to write the block.</font><br>
<p>
[1] <a href="https://lwn.net/Articles/861178/">https://lwn.net/Articles/861178/</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861265/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor861313"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 29, 2021 18:22 UTC (Tue)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/861313/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; If dm-integrity is underneath md-raid, you still have an issue</font><br>
<p>
Actually, if dm-integrity is above md-raid, you have a MAJOR issue. I&#x27;m trying to work out how that will work, but you&#x27;ve promptly ruined a mirror&#x27;s ability to work out which copy is correct, which is the whole point of using dm-integrity for raid-1.<br>
<p>
Note that reading a raid-1 will return data read from either disk &quot;at random&quot; (it&#x27;s not, but from the user&#x27;s point of view it is).<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861313/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor861144"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Hard drive stress</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 27, 2021 22:41 UTC (Sun)
                               by <b>zlynx</b> (guest, #2285)
                              [<a href="/Articles/861144/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Hard drive &quot;stress&quot; is a myth. I have never been convinced by arguments otherwise.<br>
<p>
Hard drives can overheat. If that&#x27;s the case then the hard drive has been doomed from the start. Use some cooling fans, for crying out loud.<br>
<p>
But otherwise what stress? The disks are spinning. The heads are moving. The heads don&#x27;t touch the platter. The heads use magnetic drive coils to move their head around. It isn&#x27;t some kind of screw.<br>
<p>
You can wiggle that drive head around as much as you want and it isn&#x27;t going to increase the failure chances.<br>
<p>
I have seen hard drives in database servers that ran heavy seek operations 24x7. And there are the ones that spin in a SAN assigned to a virtual machine that are hardly ever touched. Failure rates did not seem very different.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861144/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861151"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Hard drive stress</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 27, 2021 23:43 UTC (Sun)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/861151/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Why do you wait ages for a bus then three come along at once?<br>
<p>
Statistics really does say unusual events come in threes. Do you want that &quot;unusual event&quot; to be a disk failure?<br>
<p>
At the end of the day, it&#x27;s a risk. If all your drives come from the same batch, they are likely to share the same flaws. If they&#x27;ve shared the same disk cabinet and stress patterns, then the chances of them failing together are highER than normal. Doesn&#x27;t mean they&#x27;re high, but is it worth the risk? If you can avoid it, then no it&#x27;s not.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861151/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861168"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Hard drive stress</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 13:01 UTC (Mon)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/861168/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Statistics really does say unusual events come in threes.</font><br>
<p>
Do you have a reference?<br>
<p>
My recollection for bus bunching is that buses end up delayed due to more people getting on and off at a stop which delays it a bit more. This makes more people, on average, available at future stops when the bus does get there, causing more delays. The next bus has fewer delays because it is picking up fewer people. This continues until a bus uses up all of the delay between two runs and they&#x27;re &quot;stuck&quot; together. I imagine for high enough traffic, two buses could also be overwhelmed, but I&#x27;ve only ever seen two myself.<br>
<p>
Wikipedia seems to bear this out: <a href="https://en.wikipedia.org/wiki/Bus_bunching">https://en.wikipedia.org/wiki/Bus_bunching</a><br>
<p>
Some planning can fix this to allow the first bus to skip some of its route to &quot;catch up&quot; on lost time while the second bus takes the load for the skipped section, but I imagine that coordinating this in any kind of time frame that actually saves time in real life is a logistical nightmare.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861168/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861229"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Hard drive stress</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 17:15 UTC (Mon)
                               by <b>mpr22</b> (subscriber, #60784)
                              [<a href="/Articles/861229/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The official spacing between buses on certain numbered routes in London gets as low as... I think it&#x27;s about seven minutes, depending on day of week and time of day.<br>
<p>
An individual bus suffering fourteen minutes of delay (enough to back it up into not only the one after it, but the one after that) due to high passenger volumes over the length of a London bus route is not exactly remarkable.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861229/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861233"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Hard drive stress</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 17:26 UTC (Mon)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/861233/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Ah. With such times, it seems that buses leaving even without everyone getting on[1] would help (the next one is &quot;only&quot; 7 minutes behind) would work, but I&#x27;m sure that would just frustrate riders and drivers are going to be more human and feel that letting &quot;just one more person on&quot; is worth the hidden effect of delaying everyone by much more than that 7 minutes overall.<br>
<p>
[1] Getting off at the right stop sounds way more useful than delaying boarding.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861233/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861240"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Hard drive stress</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 18:24 UTC (Mon)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/861240/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Okay, I was using the commuter coaches, and they had a strict timetable, but the only time I remember a driver waiting &quot;to let one more person on&quot;, I think the coach company had a storm of complaints.<br>
<p>
There was a 10-minute gap between coaches leaving - in the rush hour that translates to 20, 30 minutes between arrivals. (For non-Londoners, coaches will drive round a town 20, 50 miles away, and then travel non-stop to the city centre.) This driver kept waiting until we began to get people running for us because they thought we were the coach behind. And everybody who *wanted* our coach was late for work ...<br>
<p>
If, for whatever reason, buses CAN &quot;run on time&quot; as a matter of course, passengers can be expected to get *very* upset if the driver doesn&#x27;t bother ...<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861240/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor861239"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Hard drive stress</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 18:14 UTC (Mon)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/861239/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; An individual bus suffering fourteen minutes of delay (enough to back it up into not only the one after it, but the one after that)</font><br>
<p>
Except that&#x27;s not what happens. Common Sense is NOT very common.<br>
<p>
AS SOON as ANY bus starts suffering delays, the bus behind will start catching it up (unless the second driver actively tries to keep to time, most don&#x27;t). As any gap gets bigger, the first bus behind the gap will suffer more and more delays due to the fact it&#x27;s picking up 8 - 10 - 15 minutes worth of passengers, while the bus behind is picking up 7 - 5 - 3 minutes worth so will catch it up. So bunching is just the nature of the beast ...<br>
<p>
Common sense is a VERY bad guide. If you don&#x27;t need to take the risk with your data, don&#x27;t take it.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861239/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor861548"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Hard drive stress</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 1, 2021 14:17 UTC (Thu)
                               by <b>Klavs</b> (guest, #10563)
                              [<a href="/Articles/861548/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Some planning can fix this to allow the first bus to skip some of its route to &quot;catch up&quot; on lost time while the second bus takes the load</font><br>
<font class="QuotedText">&gt; for the skipped section, but I imagine that coordinating this in any kind of time frame that actually saves time in real life is a logistical</font><br>
<font class="QuotedText">&gt; nightmare.</font><br>
<p>
In Denmark I see the second bus simply just skip a stop, if  driver sees same route is already parked there (and no one has told him to stop).. This way the second bus becomes the first one for the next few stops.. if they&#x27;re full - he&#x27;ll probably be overtaken again by the bus thats now behind him :)<br>
<p>
It seems to work rather well - especially on the routes with 5-min intervals.. for trains.. not so much :)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861548/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor860494"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 6:42 UTC (Tue)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/860494/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yes, it&#x27;s still true. RAID code in btrfs is brittle. I personally had btrfs corrupted beyond repair when I had a series of power failures during btrfs rebuild. There are plenty of other users on the web that have similar issues.<br>
<p>
I&#x27;m still using btrfs for snapshots, but I run it over a standard md-based RAID.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860494/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860504"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 8:30 UTC (Tue)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/860504/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Thanks for the additional info. My experience is only based on non-RAID.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860504/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860703"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 24, 2021 0:13 UTC (Thu)
                               by <b>Baughn</b> (subscriber, #124425)
                              [<a href="/Articles/860703/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It works fine on non-RAID, so long as you don&#x27;t use too many snapshots.<br>
<p>
This is a problem. To keep my data safe, I&#x27;m using a four-way mirror and I usually have anywhere from fifteen to twenty thousand snapshots across various datasets. ZFS handles this without a murmur, but if I try the same thing on Btrfs, it...<br>
<p>
Well, if I&#x27;m lucky it just gets really slow. Twice, now, I&#x27;ve had filesystems corrupted beyond recovery during simulated double disk failures.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860703/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor860760"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 24, 2021 10:40 UTC (Thu)
                               by <b>cyphar</b> (subscriber, #110703)
                              [<a href="/Articles/860760/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Unfortunately because btrfs doesn&#x27;t know about the on-disk layout in such a configuration, if one of your md-raid&#x27;d drives has silent corruption, btrfs wouldn&#x27;t be able to correct it in the same way ZFS would be able to with RAID-Z (or btrfs RAID for that matter). I don&#x27;t know if md-raid will try to correct the parity if it doesn&#x27;t match the data you read during reads, but because it doesn&#x27;t know about the checksum, it will act sub-optimally regardless of whether it tries to correct the mismatch (if it tries to correct it, you&#x27;ll get unrecoverable corruption if the corruption was in a data chunk; if it doesn&#x27;t try to correct it, then that&#x27;s another source of silent corruption if the parity was corrupted which will make your pool unrecoverable if a different disk fails).<br>
<p>
Now, maybe silent data corruption is a rarity these days and louder forms of disk failure are more common (on my home server all of the disk failures were loud -- I&#x27;ve not had any actual checksum errors on real disks). But it is a level of safety you&#x27;re losing by not having RAID be integrated into the filesystem.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860760/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860907"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 25, 2021 8:08 UTC (Fri)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/860907/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Now, maybe silent data corruption is a rarity these days and louder forms of disk failure are more common (on my home server all of the disk failures were loud -- I&#x27;ve not had any actual checksum errors on real disks). But it is a level of safety you&#x27;re losing by not having RAID be integrated into the filesystem.</font><br>
<p>
My new home system is set up as ext over lvm over md-raid over dm-integrity. FIXED. Silent corruption is not a possibility and will trigger loud corruption at the md-raid level, which will fix it because it appears as a failed read, enabling raid-1/5/6 to just recompute and rewrite.<br>
<p>
Yes it&#x27;s not currently mainstream, but trying to get that mainlined will probably be my first real kernel contribution.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860907/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860924"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 25, 2021 11:46 UTC (Fri)
                               by <b>cyphar</b> (subscriber, #110703)
                              [<a href="/Articles/860924/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That does sound useful though I&#x27;m not familiar with how dm-integrity works -- does it store the checksums with the block? If so, it would be vulnerable to misdirected reads and writes (where the wrong block is written to or read from, so a checksum within the block would appear consistent but a block-pointer-like checksum would fail to validate). Again, I don&#x27;t know how common of an issue it is these days but it was apparently somewhat common in the early 2000s since it was discussed as being quite an important feature of ZFS&#x27;s design at the time.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860924/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860939"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 25, 2021 14:00 UTC (Fri)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/860939/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; I&#x27;m not familiar with how dm-integrity works -- does it store the checksums with the block?</font><br>
<p>
By default, yes, but if you specify meta_device, an entirely separate device can be used for integrity data.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860939/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor860540"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 14:54 UTC (Tue)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/860540/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; &gt;but people are still losing data to it.</font><br>
<p>
<font class="QuotedText">&gt; Is that still true?</font><br>
<p>
As far as I can make out, ONLY MIRROR RAID WORKS.<br>
<p>
If you enable parity raid (as another poster pointed out, and as I believe SUSE *disables*), then btrfs has earned its &quot;experimental&quot; status in spades.<br>
<p>
Plus by default it only mirrors metadata ... (which could bite people who haven&#x27;t rtfm)<br>
<p>
To fix the parity problem apparently requires a major re-write, which may well never happen ...<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860540/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860621"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 10:31 UTC (Wed)
                               by <b>Conan_Kudo</b> (subscriber, #103240)
                              [<a href="/Articles/860621/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      Actually, it looks like <a href="https://lore.kernel.org/linux-btrfs/BL0PR04MB65144CAE288491C3FC6B0757E7489@BL0PR04MB6514.namprd04.prod.outlook.com/">we'll see RAID56 fixed sometime soon</a>.
      
          <div class="CommentReplyButton">
            <form action="/Articles/860621/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860714"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 24, 2021 2:38 UTC (Thu)
                               by <b>cyphar</b> (subscriber, #110703)
                              [<a href="/Articles/860714/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Meanwhile, ZFS&#x27;s RAID-Z has worked for more than 15 years, while your link is to a message saying that &quot;it will take a while&quot; to send a patch series which may fix btrfs&#x27;s RAID 5/6 support. I&#x27;m also not sure if someone has done a comparison between btrfs&#x27;s RAID and RAID-Z -- RAID-Z is different to classical md-style RAID in quite a few ways. And as far as I know, btrfs has nothing analogous to dRAID.<br>
<p>
I understand that some folks don&#x27;t want to use ZFS, and that&#x27;s fine -- but every time ZFS comes up on Linux message boards, a large number of people say that ZFS is not needed because btrfs is good enough (and then start saying that ZoL is bad because it&#x27;s not in mainline, with a whole list of IMHO bad-faith arguments -- conveniently ignoring that it wasn&#x27;t the ZFS developers&#x27; decision for ZFS to not be mainlined). That line of argument simply ignores ZFS&#x27;s track record (which btrfs categorically cannot match up to) and the fact that ZFS&#x27;s administrative design is simply different than that of btrfs (I would argue it&#x27;s better, but others may disagree). So even if btrfs had no known issues today (which isn&#x27;t the case) there still would be reasons why someone would pick ZFS. Not to mention that ZoL allows people to switch to Linux while keeping their ZFS pools.<br>
<p>
Personally while I don&#x27;t use RAID-Z, I do use ZFS for my homeserver because it has a much better track history and I like it&#x27;s administration model. And on the anecdotal side, I had btrfs corrupt my main disk (single disk configuration, nothing fancy -- and no swap file so it wasn&#x27;t that corruption issue) while doing a kernel build (though in fairness I was running net-next, testing a BPF patch, so it wasn&#x27;t a mainline kernel).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860714/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860918"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 25, 2021 10:44 UTC (Fri)
                               by <b>niner</b> (subscriber, #26151)
                              [<a href="/Articles/860918/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It may not have been the ZFS developers&#x27; decision to not mainline ZFS into the Linux kernel, but it certainly was their employer&#x27;s to choose a license that&#x27;s deliberately incompatible with the GPL and thus prevents mainlining.<br>
<p>
To quote Claire Giordano, CDDL Team, Sun Microsystems: &quot;Like the MPL, the CDDL is not expected to be compatible with the GPL, [...]&quot; and &quot;Thus, it is likely that files released under the CDDL will not be able to be combined with files released under the GPL to create a larger program.&quot;<br>
<a href="https://lwn.net/Articles/114840/">https://lwn.net/Articles/114840/</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860918/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860926"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 25, 2021 12:03 UTC (Fri)
                               by <b>rahulsundaram</b> (subscriber, #21946)
                              [<a href="/Articles/860926/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
For the record, the MPL referred to in this quote is v1.x,  v2 is compatible with GPL<br>
<p>
<a href="https://www.mozilla.org/en-US/MPL/2.0/FAQ/">https://www.mozilla.org/en-US/MPL/2.0/FAQ/</a><br>
<p>
CDDL (based on MPL v1.x) remains incompatible.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860926/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor860431"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 18:36 UTC (Mon)
                               by <b>atnot</b> (subscriber, #124910)
                              [<a href="/Articles/860431/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I wish this was true. There&#x27;s a few things missing in btrfs, most obviously the lack of a production-ready RAID-Z alternative. (Plus the non-technical matter of still needing to overcome the bad reputation of it&#x27;s early releases)<br>
<p>
But in line with the topic of the article, I feel like the annoyances of running ZFS as an out-of-tree are definitely still a strong factor in driving the development of these more linux-native solutions.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860431/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860490"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 5:36 UTC (Tue)
                               by <b>ceplm</b> (subscriber, #41334)
                              [<a href="/Articles/860490/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Just curious: is RAID-Z so universally welcome? One search for &quot;BTRFS RAID-Z&quot; gives me on the first page plenty of very unhappy users of RAID-Z.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860490/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860491"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 5:44 UTC (Tue)
                               by <b>rincebrain</b> (subscriber, #69638)
                              [<a href="/Articles/860491/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
RAIDZ has limitations, to be sure.<br>
<p>
One problem it does not have, though, is eating your data, which, from my understanding, the btrfs parity RAID code still does - it&#x27;s the only thing labeled Unstable still on the wiki, and the actual page says, among many other things, &quot;it should be fine for non-metadata as long as you always scrub immediately after unclean shutdowns (plus the standard parity raid write hole problem)&quot;, which is quite the set of caveats (IMO).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860491/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860684"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 20:25 UTC (Wed)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/860684/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Note that md-raid now has a fix for the parity write hole. Like most things it uses a journal ...<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860684/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor860563"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 16:14 UTC (Tue)
                               by <b>Baughn</b> (subscriber, #124425)
                              [<a href="/Articles/860563/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
RAID-Z is low performance, and is known to be low performance, but having it available is still useful. There are a lot of use cases -- a large, mostly untouched media library, for instance.<br>
<p>
As a rule of thumb, if a single HDD is fast enough then RAID-Z will also be fast enough. It just won&#x27;t be any faster.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860563/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor860564"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 16:27 UTC (Tue)
                               by <b>pcwizz</b> (guest, #145032)
                              [<a href="/Articles/860564/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Raid-Z isn&#x27;t broken in the way btrfs raid 5/6 is. The main unhappiness with Raid-Z is inappropriate usage which as a layer 8 problem is rather hard to solve with code.<br>
<p>
Only if you really need the storage density and are willing to trade performance and upgrade costs to get it should you embark on Raid-Z or raid 5/6 for that matter. Most users actually want a pool of mirror vdevs as it is cheaper to expand and you get more iops. Raid-Z expansion will partially improve the economics of Raid-Z but it should still be used with caution.<br>
<p>
I run plenty of btrfs on new systems, but the zfs muscle memory isn&#x27;t going away any time soon.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860564/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor860723"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 24, 2021 6:32 UTC (Thu)
                               by <b>cyphar</b> (subscriber, #110703)
                              [<a href="/Articles/860723/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>The main complains with RAID-Z were that you couldn't easily expand or remove devices from a zvol (in other words, you couldn't turn a 5-disk raidz2 zvol into a 3-disk or 6-disk raidz2). However, today removing devices from a RAID-Z zvol is fully supported (and has been for a year or two now) and there is <a href="https://github.com/openzfs/zfs/pull/12225">an open PR</a> to add support for expanding a RAID-Z zvol.</p>

<p>So it is fair to say that RAID-Z did have these deficiencies in the past, and md-raid didn't have them (though it didn't have the benefits of RAID-Z). But one of the two main complains has been fixed for a while now, and the other main complaint is being actively worked and is ready enough to be a proper PR (Matt Ahrens has been working on it for several years now). I'm not aware of any other common complaints about RAID-Z.</p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/860723/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor860433"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 18:29 UTC (Mon)
                               by <b>JoeBuck</b> (subscriber, #2330)
                              [<a href="/Articles/860433/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Does OpenZFS access any EXPORT_SYMBOL_GPL  symbol?  If not, it isn&#x27;t affected.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860433/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860450"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 19:33 UTC (Mon)
                               by <b>ericonr</b> (guest, #151527)
                              [<a href="/Articles/860450/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It can, because the kernel is *really* &quot;inline-happy&quot;: <a href="https://github.com/openzfs/zfs/issues/11172">https://github.com/openzfs/zfs/issues/11172</a><br>
<p>
Happened a while ago too with the commit that made <a href="https://github.com/openzfs/zfs/commit/e5db31349484e5e859c7a942eb15b98d68ce5b4d">https://github.com/openzfs/zfs/commit/e5db31349484e5e859c...</a> necessary, where a symbol was made GPL for reasons.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860450/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860575"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 18:01 UTC (Tue)
                               by <b>scientes</b> (guest, #83068)
                              [<a href="/Articles/860575/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think I saw this before. Claiming that proprietary modules cannot use the FPU/SIMD registers is a very arrogant move, and I think I saw the patch on the list. Linux certainly cannot claim that they own the CPU, and that use of the CPU from the ISA manual is a derivative work of Linux. They should just admit that their multi-tasking does not support proper locking for it to be done safely, if that is the case.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860575/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860669"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 18:06 UTC (Wed)
                               by <b>billypilgrim</b> (subscriber, #143835)
                              [<a href="/Articles/860669/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Use of the CPU from the ISA manual would *not* be a derivative work of Linux, obviously. That&#x27;s not the issue at all. The kernel is totally at liberty to manage FPU registers in the same way it manages other resources. Presumably these helpers exist for a technical reason other than to merely antagonise NVIDIA.<br>
<p>
If someone wants to write a kernel module which accesses the relevant kernel symbols then all they have to do is meet their legal obligation by following the GPL and making their code available under a compatible licence. That&#x27;s all there is to it.<br>
<p>
The kernel&#x27;s multitasking is totally fine. Why on earth would you expect that drivers should be able to muck about with FPU registers directly without breaking things?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860669/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor860434"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 18:53 UTC (Mon)
                               by <b>nybble41</b> (subscriber, #55106)
                              [<a href="/Articles/860434/">Link</a>] (26 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
At some point developers of proprietary modules are simply going to mark their modules as &quot;GPL&quot;—in the binaries, not the accompanying documentation—to avoid the extra-legal technological restrictions imposed on non-GPL modules. There is plenty of precedent saying that copyrights and trademarks cannot be used to enforce technical restrictions. For example, certain early game consoles required games to embed a copy of their copyrighted and trademarked logo image in a bid to block third-party games. The courts took a dim view of this and basically ruled that copyright and trademark rules did not apply to the specific actions required for technical interoperability. More recently we have printer manufacturers embedding copyrighted code in their ink cartridges to prevent third-party refills, which was once again thwarted by the courts.<br>
<p>
As for the modules themselves, the term &quot;derivative work&quot; does not refer to *functional* dependencies. The functional elements described by the software and the runtime behavior of the computer executing it are outside the domain of copyright. The essence of a derivative work is that it incorporates either a direct copy or a transformed version of some other work into the derivative work. &quot;Dynamic linking&quot;, in the software sense, is akin to a bibliography identifying external materials with further information which are *not* part of the module itself. Merely referencing another work without incorporating any of its creative elements does not make the referring document a derivative work.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860434/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860441"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 19:19 UTC (Mon)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/860441/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;At some point developers of proprietary modules are simply going to mark their modules as &quot;GPL&quot;—in the binaries</font><br>
<p>
Been there, done that.<br>
I think it was nvidia, if I remember correctly, who did a trick like this: &quot;GPL\0proprietary license&quot; in their license string.<br>
They removed it again.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860441/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860486"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 4:31 UTC (Tue)
                               by <b>rincebrain</b> (subscriber, #69638)
                              [<a href="/Articles/860486/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That one was Conexant - <a href="https://lwn.net/Articles/82305/">https://lwn.net/Articles/82305/</a> .<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860486/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860503"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 8:26 UTC (Tue)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/860503/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Thanks a lot for the correction. I&#x27;m sorry to have blamed the wrong one.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860503/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor860465"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 21:20 UTC (Mon)
                               by <b>k3ninho</b> (subscriber, #50375)
                              [<a href="/Articles/860465/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Can you explain if this is a technical. protection measure against copyright infringement? The sort of thing you might be criminal for circumventing in the DMCA?<br>
<p>
K3n.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860465/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860542"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 15:09 UTC (Tue)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/860542/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If we were talking about GPLv3, then this would be wholly irrelevant, as section 3 specifically excludes GPL&#x27;d software from being considered an &quot;effective technological protection measure.&quot; Therefore, in the more general case, GPLv3&#x27;d software should not assume that it can pull this kind of chicanery and have it automatically be legally enforceable.<br>
<p>
But the kernel is under GPLv2, so maybe?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860542/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor861230"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 17:29 UTC (Mon)
                               by <b>gdt</b> (subscriber, #6284)
                              [<a href="/Articles/861230/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The &quot;offer to treat&quot; contains a &quot;misleading representation&quot; about the offer, namely the terms of the copyright license. See the basic contact and consumer law for your jurisdiction.<br>
<p>
It doesn&#x27;t matter if EXPORT_SYMBOL_GPL() is a technical protection measure or not. Either way the misrepresentation is present.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861230/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861446"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 30, 2021 18:17 UTC (Wed)
                               by <b>nybble41</b> (subscriber, #55106)
                              [<a href="/Articles/861446/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This &quot;misrepresentation&quot; is a required part of the kernel interface. The communication is thus software-to-software, not author-to-user. Contract misrepresentation is all about what is communicated to the buyer, and the embedded license field is not the sole or primary source of information about the license. In most cases involving a proprietary module you would not even have this data until *after* making the purchase and/or agreeing to the actual license terms. If the field were purely informative and not used to enforce any technical restrictions then one might reasonably expect it to represent the actual license, but so long as only modules which embed the &quot;license=GPL&quot; string have access to certain symbols IMHO this would be considered similar to prior cases where game console manufacturers required programs to embed copies of the console&#x27;s copyrighted &amp; trademarked logo—which was eventually deemed to *not* violate copyright &amp; trademark laws when done by third-party game designers without a license specifically *because* the console makers turned it into a technical requirement for interoperability. Module authors would just need to carefully and clearly document the actual license in their marketing materials and explain that the embedded license field is an unreliable source due to kernel restrictions.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861446/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor860467"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 21:43 UTC (Mon)
                               by <b>SLi</b> (subscriber, #53131)
                              [<a href="/Articles/860467/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Couldn&#x27;t that same argument be used to claim that no .c source code file ever can be a derived work, because anything it ever does is refer other files and symbols defined elsewhere (it may refer to header files, and further refer to symbols and macros defined in those)?<br>
<p>
I think you are looking too much into individual files. Generally, or so the hypothesis goes, courts are likely to analyze derivedness in software context by how intertwined the two pieces of software are.<br>
<p>
Dynamic linking is not much different from static linking in this sense—the end result, the binary image in memory, is still a copy among others, and if it is a derived work, then you need the copyright holder&#x27;s permission to create it. I think a fair argument can be made that anything that tracks the constantly moving internal kernel API, makes calls to deeply internal kernel symbols and accesses internal data structures, when linked in memory to the rest of the kernel most likely is intertwined enough with it to be a derived work. It would be different if the kernel provided a stable binary API (and, for the same reason the case is different for userspace software using the system call API).<br>
<p>
Apart from the possible direct violations, the creator of software that essentially can only be used by the end user by infringing a third party license quite certainly would be contributorily liable for those infringements.<br>
<p>
You are right, though, that the GPL markings themselves in principle do not have an effect of making something infringing or non-infringing (except that I think the usage of non-GPL symbols only might be more easily defended in the presence of GPL-only symbols). They are only the kernel community&#x27;s assertion that by using these symbols from a proprietary module we believe that, and you are hereby put on notice of this, you are very likely doing something that infringes our copyrights. It removes any possibility of claiming that it was unintentional.<br>
<p>
Of course, how the courts will eventually rule is anybody&#x27;s guess; it&#x27;s unlikely that, if the courts will ever face these questions, the legal doctrines that emerge from that are exactly like anybody would have predicted.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860467/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860475"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 0:38 UTC (Tue)
                               by <b>pbonzini</b> (subscriber, #60935)
                              [<a href="/Articles/860475/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; software that essentially can only be used by the end user by infringing a third party license</font><br>
<p>
The end user does not infringe the GPL if it combines GPL&#x27;d code with proprietary modules, *as long as it does not distribute the combination*. This is the principle on which DKMS is based.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860475/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861527"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 1, 2021 14:49 UTC (Thu)
                               by <b>mrugiero</b> (guest, #153040)
                              [<a href="/Articles/861527/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I&#x27;m not entirely sure this is true. If you use software infringing its license (which it is, because the author of the derivative work *did* distribute it), aren&#x27;t you yourself using software you acquired without regards of its proper license? If you are not a licensee and you use it, then you are by definition infringing copyright.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861527/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor860685"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 20:37 UTC (Wed)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/860685/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Couldn&#x27;t that same argument be used to claim that no .c source code file ever can be a derived work, because anything it ever does is refer other files and symbols defined elsewhere (it may refer to header files, and further refer to symbols and macros defined in those)?</font><br>
<p>
CORRECT (within limits).<br>
<p>
Which means I can write a program that is a mix of proprietary and GPL code and, provided I only distribute it as source and I don&#x27;t mix licences in any individual file, THERE IS NO COPYRIGHT VIOLATION. Because it&#x27;s &quot;mere aggregation&quot;. I could even package and distribute it for my distro (gentoo) because it&#x27;s a source distro. But if anybody distributes a binary that IS a copyright violation.<br>
<p>
(That&#x27;s why I said &quot;within limits&quot;. If you cut-n-paste, the destination file is a derived work, because it contains mixed copyrights.)<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860685/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860686"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 20:47 UTC (Wed)
                               by <b>SLi</b> (subscriber, #53131)
                              [<a href="/Articles/860686/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Why do you believe that what is in a single file is of such great importance? The law does not say anything about files.<br>
<p>
If we take this even further, it might be possible to break some largeish programs into small and trivial enough source code modules that none or few of them alone merit copyright protection.<br>
<p>
But I do not believe the level of a file is particularly important for this analysis. Granted, courts don&#x27;t understand technology well and may for such reasons give some significance to things being in a different file (ie. some metadata in the filesystem differs wrt those blocks).<br>
<p>
There&#x27;s even nothing inherently filey about source code. Depending on a language you could consider it an unordered collection of functions and variables. I am fairly certain that a court would not only look at individual functions, and there is even less good reason to limit the analysis at individual source code files. I&#x27;d think the court would try to analyze what the work as a whole, ie. probably the kernel, is, and how independent the module in question would be from it, to determine whether it is derived or mere aggregation (well, given that the case is argued by competent lawyers).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860686/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860689"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 21:05 UTC (Wed)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/860689/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Why do you believe that what is in a single file is of such great importance? The law does not say anything about files.</font><br>
<p>
Because each file is a small self-contained work?<br>
<p>
Because if you&#x27;re programming PROPERLY, each file is a functional stand-alone unit?<br>
<p>
Because if I keep my work in separate files from the work I&#x27;m modifiying, then each file has its own *unique* copyright?<br>
<p>
I can write a bunch of poems and publish them as &quot;an anthology of all my own work&quot;. Same sort of thing applies here.<br>
<p>
And if you actually READ the GPL, it&#x27;s pretty clear that it has no fundamental problem with this.<br>
<p>
But as soon as you compile it into binaries and executables, you have derived works and the GPL bites.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860689/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861226"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 17:09 UTC (Mon)
                               by <b>rgmoore</b> (<b>&#x272D; supporter &#x272D;</b>, #75)
                              [<a href="/Articles/861226/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <blockquote>Because each file is a small self-contained work?</blockquote>

<p>Is it self-contained, though?  A file is only self-contained if it doesn't depend on external functions or definitions.  If it depends on something defined in a separate file, it is not self contained.  Whether that makes it a derived work of the other files it needs in order to work is a question that would probably have to be litigated.  If it calls on a fairly generic API that has multiple independent implementations, like the C standard library or POSIX, it may be a derivative of that standard but not the specific library it links to.  If it's calling functions that are only provided by one library, it is very likely to be a derivative of that library.

<p>This is exactly why the FSF created a separate GPL and LGPL.  They knew works that depended heavily on a specific library would likely be derivative works, which in the case of the GPL would require them to be licensed under the GPL unless the library fell under the "major components of the operating system" exception.  In cases where they thought that would be counterproductive, they had the LGPL, which specifically exempted programs that just linked to the library.
      
          <div class="CommentReplyButton">
            <form action="/Articles/861226/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor860690"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 21:09 UTC (Wed)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/860690/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; If we take this even further, it might be possible to break some largeish programs into small and trivial enough source code modules that none or few of them alone merit copyright protection.</font><br>
<p>
First of all, breaking it up *could* be a copyright violation in itself.<br>
<p>
And secondly, if you did break it up enough so it&#x27;s that trivial, it&#x27;s going to be trivial because it doesn&#x27;t work any more.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860690/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor861165"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 11:44 UTC (Mon)
                               by <b>immibis</b> (subscriber, #105511)
                              [<a href="/Articles/861165/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Taking the &quot;files are separate works&quot; idea to its logical absurd conclusion, we may try to claim that every line of code - or every character - is a separate work, some of which are GPL, and some of which are proprietary, and the GPL characters are merely aggregated with the proprietary characters.<br>
<p>
It won&#x27;t work, of course.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861165/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861172"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 13:12 UTC (Mon)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/861172/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Well, if you&#x27;re a malicious actor, of course it won&#x27;t work. Judges DO have common sense, after all ...<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861172/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor860470"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 23:03 UTC (Mon)
                               by <b>willy</b> (subscriber, #9762)
                              [<a href="/Articles/860470/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You are not a lawyer and should probably refrain from opining on what you think the law is.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860470/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860560"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 15:51 UTC (Tue)
                               by <b>nybble41</b> (subscriber, #55106)
                              [<a href="/Articles/860560/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You have no idea whether I am a lawyer or not. Certainly I never claimed to be one in *your* jurisdiction, and even if I did happen to be a fully licensed and certified lawyer in some other jurisdiction that would have no bearing on this conversation. So far as that goes, even if I were a practicing lawyer in your jurisdiction that fact would be irrelevant here as *you are not my client*. Discussing and having opinions on the purpose, history, and probably interpretation of the law is hardly the exclusive domain of lawyers. Everyone affected by the law has a stake in this discussion and the right to share information and express their opinion. If you&#x27;re looking for legal advice from strangers in a public forum you&#x27;re looking in the wrong place.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860560/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860572"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 18:17 UTC (Tue)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/860572/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Everyone affected by the law has a stake in this discussion and the right to share information and express their opinion. If you&#x27;re looking for legal advice from strangers in a public forum you&#x27;re looking in the wrong place.</font><br>
<p>
Well put.<br>
<p>
I would add that the biggest legal problem is that &quot;Ignorance of the Law Is Not an Excuse&quot; yet it&#x27;s so complicated and messy that it requires incredibly expensive services out of reach for mere mortals. So informal and semi-accurate discussions in forums like this one are IMHO better than no legal information at all and they provide good starting points for further research.<br>
<p>
I know we&#x27;re getting carpet-bombed by fake news and professional trolls trying to steal our available brain time nowadays but that shouldn&#x27;t hopefully not stop us from hearing everyone&#x27;s wrong opinion as long as it&#x27;s expressed clearly, logically and respectfully, on topic and not falsely labelled as professional and expert advice. If you&#x27;re not interested in amateur legal opinions they don&#x27;t read the comments section under an article about the GPL, it is really that simple. People who confuse &quot;free&quot; information on the Internet with professional advice or The Truth have &quot;a bigger problem&quot; that will require educating at least a couple generations to fix. Should we all censor ourselves in the mean time to &quot;protect&quot; all these naive people?  I don&#x27;t think so.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860572/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860580"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 18:25 UTC (Tue)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/860580/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; I would add that the biggest legal problem is that &quot;Ignorance of the Law Is Not an Excuse&quot;</font><br>
<p>
Eh, the (US) laws that are likely to affect those that write the laws are more likely to have a &quot;state of mind&quot; requirement. For example, many tax law problems require one to know that they&#x27;re breaking the law. Proving that is…difficult. But, since the law writers are afraid of this specific law applying to them, they put this kind of stuff in there.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860580/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860591"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 19:57 UTC (Tue)
                               by <b>mpr22</b> (subscriber, #60784)
                              [<a href="/Articles/860591/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Not knowing you&#x27;re breaking the law doesn&#x27;t get you out of paying your taxes.<br>
<p>
It just gets you out of being fined/jailed for noncompilance with process.<br>
<p>
Once.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860591/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860605"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 0:57 UTC (Wed)
                               by <b>rgmoore</b> (<b>&#x272D; supporter &#x272D;</b>, #75)
                              [<a href="/Articles/860605/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <p>The problem is that the "once" is really "once per tax dodge", not "once per person".  So there's very little reason for a very rich person not to try to avoid taxes through any means they can get an accountant to tell them is legal.  If the accountant is right, they pay less in taxes.  If the accountant is wrong and they're lucky, they don't get caught and still pay less in taxes.  If the accountant is wrong and they're unlucky, they have to pay what they should have paid all along.  The worst thing that happens to them is they pay some legal fees and interest on their unpaid taxes.  They don't pay a large penalty for trying to cheat, and they don't wind up in prison.  And when that has happened, they just have to find a new allegedly legal way of avoiding their taxes.  As long as it isn't the same one they tried before, they can once again plead they didn't know what they were doing was illegal.

<p>Of course the real solution is tax simplification.  Our tax laws shouldn't be so complicated people with an army of accountants can plausibly claim they didn't understand how the law works.
      
          <div class="CommentReplyButton">
            <form action="/Articles/860605/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861333"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 30, 2021 3:08 UTC (Wed)
                               by <b>calumapplepie</b> (guest, #143655)
                              [<a href="/Articles/861333/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The accountant, however, DOESN&#x27;T get out of jail free.  Their profession means they are expected to know the law: so if they do something that is definitely illegal, for instance because there was a court case on it in the past, then they can be found to have intentionally violated the law.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861333/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor861528"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 1, 2021 14:49 UTC (Thu)
                               by <b>mrugiero</b> (guest, #153040)
                              [<a href="/Articles/861528/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Doesn&#x27;t that depend on whether or not you get trialed for it? If you do, there&#x27;s the &quot;beyond reasonable doubt&quot; stuff in most Western countries. And if something is systematic, then the reasonable doubt shrinks with every episode.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861528/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor860687"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 20:44 UTC (Wed)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/860687/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Everyone affected by the law has a stake in this discussion and the right to share information and express their opinion. If you&#x27;re looking for legal advice from strangers in a public forum you&#x27;re looking in the wrong place.</font><br>
<p>
Given that I&#x27;m NOT a lawyer, pretty much every time I&#x27;ve used one (not often), I&#x27;ve had to proof their work for (sometimes serious) mistakes.<br>
<p>
About the only reason I use them is because they have legal indemnity insurance. Plus they know legal jargom, which I don&#x27;t always know.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860687/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor860440"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 19:16 UTC (Mon)
                               by <b>snajpa</b> (subscriber, #73467)
                              [<a href="/Articles/860440/">Link</a>] (47 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
What exactly is stopping anyone from creating a tracking fork of Linux, which will exclude any such code/macros and just alias EXPORT_SYMBOL_GPL straight to EXPORT_SYMBOL, etc.?<br>
<p>
I mean, I know there are trademarks, but it&#x27;s not that hard to think of a new name &amp; logo, etc., for such a fork.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860440/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860442"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 19:20 UTC (Mon)
                               by <b>rahulsundaram</b> (subscriber, #21946)
                              [<a href="/Articles/860442/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; What exactly is stopping anyone from creating a tracking fork of Linux, which will exclude any such code/macros and just alias EXPORT_SYMBOL_GPL straight to EXPORT_SYMBOL, etc.?</font><br>
<p>
Most users use the kernel supplied by their distribution.  For enterprise customers relying on their vendor for support, alternative kernels are an additional problem and many more issues with using forks that generally leads to people sticking with the mainline version. You might also face legal issues. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860442/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor860443"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 19:21 UTC (Mon)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/860443/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;What exactly is stopping anyone from creating a tracking fork of Linux, which will exclude any such code/macros and just alias EXPORT_SYMBOL_GPL straight to EXPORT_SYMBOL, etc.?</font><br>
<p>
Nothing.<br>
But why would distributions use that kernel?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860443/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860543"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 15:17 UTC (Tue)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/860543/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Canonical has, for several years, been distributing ZFS binaries as an Ubuntu package. This is allegedly[1] a copyright violation, but nobody has sued them. If ZFS suddenly said &quot;you need to patch your kernel here, here, and here,&quot; I could imagine Canonical just doing it.<br>
<p>
[1]: SFC says it is, Canonical says it&#x27;s not, SFLC says &quot;it&#x27;s complicated.&quot; See <a href="https://softwarefreedom.org/resources/2016/linux-kernel-cddl.html">https://softwarefreedom.org/resources/2016/linux-kernel-c...</a> for the latter take.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860543/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860594"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 20:59 UTC (Tue)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/860594/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;I could imagine Canonical just doing it.</font><br>
<p>
So they didn&#x27;t. That&#x27;s my point.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860594/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860599"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 21:44 UTC (Tue)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/860599/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
In English, the word &quot;if&quot; signifies a hypothetical, not something which has actually happened.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860599/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor860452"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 19:39 UTC (Mon)
                               by <b>brchrisman</b> (subscriber, #71769)
                              [<a href="/Articles/860452/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think that&#x27;s referenced in the article as: &quot;It might be interesting, though, to watch kernel updates from distributors to see whether this additional restriction on proprietary modules is retained or quietly removed.&quot;<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860452/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor860454"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 20:08 UTC (Mon)
                               by <b>josh</b> (subscriber, #17465)
                              [<a href="/Articles/860454/">Link</a>] (34 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>What exactly is stopping anyone from creating a tracking fork of Linux, which will exclude any such code/macros and just alias EXPORT_SYMBOL_GPL straight to EXPORT_SYMBOL, etc.?</blockquote>

<p>Nothing would technically prevent that, but someone doing that would be very blatantly circumventing mechanisms Linux put in place to say "if you're breaking this you're probably violating the license".

<p>Nothing prevents a module from saying

<pre>MODULE_LICENSE("GPL"); // not really, but this lets us use various symbols we want</pre>

<p>but that would similarly be circumventing the mechanism designed to tell you that you're constructing a license violation.
      
          <div class="CommentReplyButton">
            <form action="/Articles/860454/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860457"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 20:25 UTC (Mon)
                               by <b>shemminger</b> (subscriber, #5739)
                              [<a href="/Articles/860457/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I have seen several embedded distros call their proprietary modules as GPL to get around the symbol blockade.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860457/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860458"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 20:28 UTC (Mon)
                               by <b>josh</b> (subscriber, #17465)
                              [<a href="/Articles/860458/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Got any links to such distributions?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860458/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860663"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 15:55 UTC (Wed)
                               by <b>mebrown</b> (subscriber, #7960)
                              [<a href="/Articles/860663/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
HP bought 3PAR in 2010. The 3PAR storage device consisted of an embedded x86 driving storage and their linux kernel was built of GPL violations. The company developers that I talked to were pretty adamant that they werent going to release source even after pointing out the blatant violation. (They are *distributing* a combined work with their drivers compiled into the kernel. Their defense that they were &quot;just doing what NVIDIA was doing&quot; didnt hold water because nvidia wasnt (at the time) distributing full kernels with their stuff embedded.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860663/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor860515"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 11:47 UTC (Tue)
                               by <b>mchehab</b> (subscriber, #41156)
                              [<a href="/Articles/860515/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; I have seen several embedded distros call their proprietary modules as GPL to get around the symbol blockade.</font><br>
<p>
If the source code of the module identifies itself as GPL at the MODULE_LICENSE(), the module license was re-licensed to GPL. <br>
<p>
Now, either the embedded distro is re-licensing it as GPL without author&#x27;s permission (thus violating the proprietary license) - or, if the author authorized, the module is now dual licensed (proprietary + GPL).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860515/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860544"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 15:24 UTC (Tue)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/860544/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; If the source code of the module identifies itself as GPL at the MODULE_LICENSE(), the module license was re-licensed to GPL.</font><br>
<p>
No, it does not work that way.<br>
<p>
You can&#x27;t place a file under a license just by saying the word &quot;GPL&quot; in the wrong context. If the source code says &#x27;MODULE_LICENSE(&quot;GPL&quot;) // Actually, see LICENSING.TXT for the real license&#x27;, then no judge in the world is going to take that as a binding license statement that overrides your README or LICENSING files. The module might, as a result, infringe the copyright of the Linux kernel, but that doesn&#x27;t give rise to a license either, it gives rise to an infringement action (if the Linux kernel developers choose to pursue it in court). The module would still be proprietary, although a judge might order the defendant to either relicense it to GPL or cease distribution. At that time, it would indeed be GPL, but only if the defendant chose to comply by relicensing the code. They could instead destroy all extant copies (to the best of their ability) and cease making new ones.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860544/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860571"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 18:01 UTC (Tue)
                               by <b>mchehab</b> (subscriber, #41156)
                              [<a href="/Articles/860571/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; No, it does not work that way.</font><br>
<font class="QuotedText">&gt;</font><br>
<font class="QuotedText">&gt; You can&#x27;t place a file under a license just by saying the word &quot;GPL&quot; in the wrong context. If the source code says &#x27;MODULE_LICENSE(&quot;GPL&quot;) // Actually, see LICENSING.TXT for the real license&#x27;, then no judge in the world is going to take that as a binding license statement that overrides your README or LICENSING files. The module might, as a result, infringe the copyright of the Linux kernel, but that doesn&#x27;t give rise to a license either, it gives rise to an infringement action (if the Linux kernel developers choose to pursue it in court). The module would still be proprietary, although a judge might order the defendant to either relicense it to GPL or cease distribution. At that time, it would indeed be GPL, but only if the defendant chose to comply by relicensing the code. They could instead destroy all extant copies (to the best of their ability) and cease making new ones.</font><br>
<p>
It is not that simple. See, if someone adds a Linux Kernel module, the Kernel license applies. On its current way, it explicitly mentions that the loadable Kernel modules require a MODULE_LICENSE() tag and the licensing text explicitly says that  &quot;GPL&quot; means that the &quot;Module is licensed under GPL version 2&quot;. <br>
<p>
On other words, it sounds easy to argue on a court that someone using MODULE_LICENSE(&quot;GPL&quot;) are either (dual-)licensing the code under GPL or is trying to trick the Kernel to run some code which violates the Kernel&#x27;s license.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860571/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860592"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 20:51 UTC (Tue)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/860592/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; On other words, it sounds easy to argue on a court that someone using MODULE_LICENSE(&quot;GPL&quot;) are either (dual-)licensing the code under GPL or is trying to trick the Kernel to run some code which violates the Kernel&#x27;s license.</font><br>
<p>
Licensing has to be explicit and unambiguous. If the module&#x27;s source code includes a comment which explicitly says &quot;not actually GPL, we&#x27;re just lying to the kernel,&quot; then that is how the court is going to interpret it. Note that &quot;lying to the kernel&quot; is probably* not illegal (by itself). The question is whether the module forms a derivative work of the kernel under copyright law, notwithstanding whatever the kernel&#x27;s documentation/symbol exports/etc. have to say about the matter.<br>
<p>
* Maybe a DMCA anti-circumvention violation. But do you really want to try to convince a court that the Linux kernel is DRM? This would curtail legitimate GPL&#x27;d alterations to the kernel, which IMHO would be a Bad Thing on net.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860592/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861381"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 30, 2021 14:49 UTC (Wed)
                               by <b>JanC_</b> (guest, #34940)
                              [<a href="/Articles/861381/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Lying to the kernel could be considered evidence that you knew you are violating copyright though, which could increase damages/penalties.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861381/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861449"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 30, 2021 18:21 UTC (Wed)
                               by <b>nybble41</b> (subscriber, #55106)
                              [<a href="/Articles/861449/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That&#x27;s only a concern if you were actually violating the copyright, however, and anyone doing this would already have concluded that merely using these symbols is not a violation. It might raise the stakes somewhat, though the present of a reasonable argument that what they were doing was not a violation of the kernel&#x27;s copyright (even if ultimately unsuccessful) might be sufficient to ward off any accusation that the violation was in fact willful.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861449/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861529"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 1, 2021 14:49 UTC (Thu)
                               by <b>mrugiero</b> (guest, #153040)
                              [<a href="/Articles/861529/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Not really. It just means they concluded they would get away with it, regardless of it being a copyright violation or not. Those are two very different things.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861529/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor860460"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 20:54 UTC (Mon)
                               by <b>snajpa</b> (subscriber, #73467)
                              [<a href="/Articles/860460/">Link</a>] (23 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Nothing would technically prevent that, but someone doing that would be very blatantly circumventing mechanisms Linux put in place to say &quot;if you&#x27;re breaking this you&#x27;re probably violating the license&quot;.</font><br>
<p>
Well if that someone took some code, which licensed under GPLv2 (happens to be Linux in this case), modified it (basically deleting a few functionally unimportant parts) and released it under the same license, but out of caution under a different name and logo... I can&#x27;t see how can that be a license violation.<br>
<p>
That is actually the core of why I&#x27;m asking that - more as a rhetorical question than anything - either the code is under GPLv2 or it isn&#x27;t, right? So I&#x27;d argue denying anyone the right to create such an &quot;inconvenient&quot; fork actually is incompatible with the license and that creates whole lot more of legal uncertainty...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860460/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860466"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 21:25 UTC (Mon)
                               by <b>josh</b> (subscriber, #17465)
                              [<a href="/Articles/860466/">Link</a>] (22 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Defining EXPORT_SYMBOL_GPL to EXPORT_SYMBOL wouldn&#x27;t be a license violation (though it might theoretically be contributory infringement). However, anything building atop that change and depending on that change (in other words, anything using such symbols from a proprietary module) likely *would* be a license violation.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860466/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860473"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 23:46 UTC (Mon)
                               by <b>JanC_</b> (guest, #34940)
                              [<a href="/Articles/860473/">Link</a>] (21 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Probably best to describe EXPORT_SYMBOL_GPL as a warning that using that symbol (and the code related to it) from within a non-GPL-compatible module is considered a copyright violation. And removing the warning is not going to remove the copyright violation.<br>
<p>
If some movie DVD has an “FBI warning” screen before the movie, explaining that selling copies of the DVD is illegal, then that doesn’t mean it becomes legal to sell copies after you removed that “FBI warning”.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860473/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860500"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 8:13 UTC (Tue)
                               by <b>intelfx</b> (subscriber, #130118)
                              [<a href="/Articles/860500/">Link</a>] (20 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Probably best to describe EXPORT_SYMBOL_GPL as a warning that using that symbol (and the code related to it) from within a non-GPL-compatible module is considered a copyright violation. And removing the warning is not going to remove the copyright violation.</font><br>
<p>
It&#x27;s the same comment I just left below. Either using _any_ symbol from a non-GPL-module creates a derived work (and thus is a violation), or none at all. As far as I know, this is yet to be decided in courts. Individual developers have no say in this matter.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860500/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860517"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 11:55 UTC (Tue)
                               by <b>Gaelan</b> (guest, #145108)
                              [<a href="/Articles/860517/">Link</a>] (14 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I believe the argument goes that code using a well-defined API isn&#x27;t a derived work, but code mucking with internals is; EXPORT_SYMBOL_GPL is supposed to be a hint that, if you&#x27;re calling that function, you&#x27;ve probably reached the point of mucking with internals. So changing EXPORT_SYMBOL_GPL to EXPORT_SYMBOL (or vice versa) has no legal effect, but (in theory) reflects the underlying legal status.<br>
<p>
Not a lawyer, no idea if the distinction they&#x27;re making makes any sense.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860517/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860566"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 17:45 UTC (Tue)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/860566/">Link</a>] (13 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
To the best of my knowledge, this has never been litigated all the way to trial before. But it&#x27;s important to understand that there are really three separate works that each might, or might not, be infringing:<br>
<p>
1. The source code of the offending module.<br>
2. A compiled version of (1).<br>
3. A complete kernel including a copy of (2).<br>
<p>
The reason this is complicated:<br>
<p>
1. This only includes the actual source files themselves, exactly as distributed. It does not include any file which is not literally distributed as part of the tarball (e.g. if you #include someone else&#x27;s header file, that&#x27;s not part of &quot;the source code&quot; unless you also distribute that header file). It is difficult to argue that this source code is a derivative work of the kernel, when the module&#x27;s source code does not contain a verbatim or modified copy of any part of the kernel&#x27;s source code. A court might read this sort of thing as being akin to an &quot;extra chapter&quot; to a book (i.e. infringing because it shares data structures and logic with the parent binary), but it&#x27;s difficult to prognosticate on exactly how that would turn out. It would likely be very fact-specific, and I&#x27;m skeptical that we would get a simple bright-line rule such as &quot;linking is always infringing.&quot;<br>
2. A compiled module will incorporate enough information to be dynamically linked at runtime, but this dynamic linking happens on the end user&#x27;s computer, after distribution has already occurred. GPL obligations attach at time of distribution, so you need to argue that the module is already infringing before it is actually linked into the kernel&#x27;s address space, just because it references some symbols etc. This is a very murky gray area and I&#x27;m not sure there&#x27;s much precedent one way or the other. OTOH, this will include headers, unlike (1), but it&#x27;s not even clear if headers are copyrightable in the first place (because they&#x27;re ultimately &quot;just&quot; APIs).<br>
3. A clever lawyer will argue that this is &quot;mere aggregation&quot; under the GPL. I have no idea if a court would buy that argument.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860566/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860574"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 17:57 UTC (Tue)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/860574/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
For 2, I believe Nvidia gets round this by producing the module for both Windows and Linux. That way they get to claim that it&#x27;s not a derivative work, and they ship a shim - which is Open Source - that calls the Nvidia binary.<br>
<p>
I believe distros DON&#x27;T ship the Nvidia module, they leave it to the user to download it, which many installers will do for you, so seeing as the end user is doing it that bit at least is not a problem.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860574/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860588"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 19:40 UTC (Tue)
                               by <b>mjg59</b> (subscriber, #23239)
                              [<a href="/Articles/860588/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
No, the binaries in the Linux driver contain lots of code that&#x27;s not in Windows. They /are/ pretty close to the FreeBSD drivers, though.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860588/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor860585"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 19:18 UTC (Tue)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/860585/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; It is difficult to argue that this source code is a derivative work of the kernel, when the module&#x27;s source code does not contain a verbatim or modified copy of any part of the kernel&#x27;s source code. A court might read this sort of thing as being akin to an &quot;extra chapter&quot; to a book (i.e. infringing because it shares data structures and logic with the parent binary), but it&#x27;s difficult to prognosticate on exactly how that would turn out.</font><br>
<p>
Funny that you mentioned that &quot;extra chapter&quot; analogy...<br>
<p>
<a href="https://uclawreview.org/2020/11/18/sherlock-holmes-to-what-extent-can-a-characters-feelings-be-copyrighted/">https://uclawreview.org/2020/11/18/sherlock-holmes-to-wha...</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860585/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor860584"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 19:28 UTC (Tue)
                               by <b>jhhaller</b> (guest, #56103)
                              [<a href="/Articles/860584/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The closest case which reached the US Supreme Court was Google&#x27;s use of the Oracle Java namespaces for Android. This makes a pretty good case that symbol namespaces reuse are not considered infringement under US law. It&#x27;s not an exact match, but probably enough of one that lower courts are not likely to waste time trying to wordsmith themselves away from the Supreme Court&#x27;s ruling. That doesn&#x27;t mean this won&#x27;t be a problem in other jurisdictions. Defining a Generic Proprietary License in the licensing.txt of the module would make the module license explicit. Using this would not make friends in the Linux kernel community, so this is likely a self-limiting solution. Social pressure can sometimes be stronger than legal pressure, as it&#x27;s hard to buy social engineers, while it&#x27;s not hard to hire good lawyers. But if major distributors like Red Hat, SuSE or Ubuntu elected not to pick up the changes to module symbol usage, while picking up other changes, that might be something entirely different.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860584/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860596"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 21:26 UTC (Tue)
                               by <b>khim</b> (subscriber, #9252)
                              [<a href="/Articles/860596/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <font class="QuotedText">&gt; This makes a pretty good case that symbol namespaces reuse are not considered infringement under US law.</font>

<p>True. And this, pretty much, makes what nVidia does (distributes module which uses such symbols, but <b>don't</b> distribute kernel with them) legal.</p>

<p>AFAIK these embedded companies are distributing kernel, too — this means Google's case is not applicable for them.</p>

<p>GPL covers the distribution then and GPL only allows distribution of something proprietary on the same medium if it's <i>mere aggregation of another work not based on the Program</i></p>

<p>Linus added a note eons ago which covers userspace programs: <i>This copyright does *not* cover user programs that use kernel  services by normal system calls - this is merely considered normal use of the kernel, and does *not* fall under the heading of "derived work"</i>.</p>

<p>But note that it <b>doesn't</b> cover debugfs, it <b>doesn't</b> cover sysfs, it <b>doesn't</b> cover kernel modules, etc.</p>

<p>So userspace programs which just use “normal system calls” can be under any license for sure… for everything else you have to <b>prove</b> that what you are doing is <i>mere aggregation of another work not based on the Program</i>.</p>

<p>Calling symbols which kernel developers very explicitly asked you not to call wouldn't win any sympathy among judges, I'm afraid.</p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/860596/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860608"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 3:15 UTC (Wed)
                               by <b>pabs</b> (subscriber, #43278)
                              [<a href="/Articles/860608/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Aren&#x27;t debugfs and sysfs accessed via normal system calls?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860608/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860617"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 8:12 UTC (Wed)
                               by <b>khim</b> (subscriber, #9252)
                              [<a href="/Articles/860617/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <p>Yes and no. Kernel module loaded using a simple syscall too, you know.</p>

<p>But for that to work it needs to deal with large and undocumented information about kernel.</p>

<p>Same with sysfs: if you would just write a program which opens up and dumps the whole content of sysfs mount without knowing it's structure then you can easily claim it's independent work from kernel, mere aggregation.</p>

<p>But most debugfs or sysfs-using programs are not like that. They usually have precise knowledge about what they need to look at. And <b>that</b> knowledge is not covered by that promise.</p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/860617/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860625"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 14:39 UTC (Wed)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/860625/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; But most debugfs or sysfs-using programs are not like that. They usually have precise knowledge about what they need to look at. And that knowledge is not covered by that promise.</font><br>
<p>
But that knowledge is not covered by copyright.<br>
<p>
If I open sysfs, and access it using *normal* file open and read calls, then that&#x27;s covered by Linus&#x27; user space promise. The fact I know exactly what I&#x27;m looking for is irrelevant, as I say copyright does not cover *knowledge*.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860625/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860660"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 15:37 UTC (Wed)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/860660/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; The fact I know exactly what I&#x27;m looking for is irrelevant, as I say copyright does not cover *knowledge*.</font><br>
<p>
Interesting. So opening a library (even if by the runtime loader) to look for functions of a given name and call them (using normal call semantics for the platform) is very similar. I know what functions to call in the right order, that&#x27;s just knowledge and therefore how could it possibly be that I am deriving from the library I happened to load.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860660/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860671"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 18:11 UTC (Wed)
                               by <b>khim</b> (subscriber, #9252)
                              [<a href="/Articles/860671/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <p>Yup. Exact same thing. Library can offer a very simple interface (like: malloc/realloc/free) and then there are usually dozen of such interchangeable libraries.</p>

<p>Or it may offer elaborate baroque API which is basically impossible to use without creating derived work.</p>

<p>That's <b>precisely</b> what Google vs Oracle <b>haven't clarified</b>. Judge said that API is probably copyrightable, but then, since Google never shipped Sun-produced code that question was pushed aside and it was decided that you can use that API (independently from an actual implementation!) because of “fair use” doctrine.</p>

<p>Like you can use pictures from a movie when you write an article about said movie.</p>

<p>Whether API is actually copyrightable or not was never clarified.</p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/860671/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860682"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 19:46 UTC (Wed)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/860682/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Judge said that API is probably copyrightable</font><br>
<p>
To clarify: The Court of Appeals for the Federal Circuit* said that APIs are copyrightable, but SCOTUS deliberately avoided answering this question, and the wording of their ruling IMHO casts serious doubt on the CAFC&#x27;s reasoning.** Since the CAFC does not normally hear copyright cases, their ruling will in most cases only be useful as persuasive authority (meaning, if you want another circuit court to rule that APIs are copyrightable, you can&#x27;t just cite the CAFC ruling, but you also have to convince the other circuit that the CAFC got it right).<br>
<p>
Of course, none of this matters at all if you live outside the US. To the best of my knowledge, this is very much unsettled in e.g. Europe.<br>
<p>
Disclaimer: I work for Google, but not on Android.<br>
<p>
* Which usually only deals with patent cases, but took this particular copyright case because reasons.<br>
** Breyer strongly emphasizes the functional, utilitarian nature of APIs, compares them to the design of the QWERTY keyboard, etc., all of which are highly relevant to copyrightability.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860682/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860691"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 21:44 UTC (Wed)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/860691/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; * Which usually only deals with patent cases, but took this particular copyright case because reasons.</font><br>
<p>
The case originally had patent terms which made it eligible for CAFC. Those were eventually dropped, but the eligibility stuck around.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860691/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor860668"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 18:05 UTC (Wed)
                               by <b>khim</b> (subscriber, #9252)
                              [<a href="/Articles/860668/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <font class="QuotedText">&gt;  But that knowledge is not covered by copyright.</font>

<p>Whether that's <b>knowledge</b> or <b>expression</b> is something court would have to decide.</p>

<font class="QuotedText">&gt;  The fact I know exactly what I'm looking for is irrelevant, as I say copyright does not cover *knowledge*.</font>

<p>Copyright doesn't cover <b>knowledge</b>, but it does cover <b>expression</b>. Some parts of sysfs may well be simple enough and functional enough that they can't be covered by copyright. But some are complex enough that may easily warrant copyright protection.</p>

<p>Especially parts which cover not something external to kernel, but some inner kernel counters and other such things.</p>

<p>Whether you may use them usefully or not without copying some expression from an actual kernel is not an easy question to answer.</p>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860668/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor860541"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 15:02 UTC (Tue)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/860541/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; It&#x27;s the same comment I just left below. Either using _any_ symbol from a non-GPL-module creates a derived work (and thus is a violation), or none at all. As far as I know, this is yet to be decided in courts. Individual developers have no say in this matter.</font><br>
<p>
Actually, NO!!!<br>
<p>
I think this has happened ... a developer has written code and marked it EXPORT_SYMBOL. A different developer has written a patch to change it to EXPORT_SYMBOL_GPL.<br>
<p>
Individual developers have EVERY say in the matter, because not all code in the kernel is GPL. It may be BSD, MIT, or various other GPL2-compatible licences (or it may be dual licenced).<br>
<p>
The argument of the second developer was that the first developer&#x27;s code was calling GPL stuff, and therefore needed itself to be EXPORT_SYMBOL_GPL because it itself was a derivative work, but that&#x27;s not necessarily the case ... the second developer&#x27;s actions were advisory, not necessarily legally correct, and if they did that to MY code I would be distinctly upset ...<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860541/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor860595"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 21:14 UTC (Tue)
                               by <b>khim</b> (subscriber, #9252)
                              [<a href="/Articles/860595/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <font class="QuotedText">&gt; Either using _any_ symbol from a non-GPL-module creates a derived work (and thus is a violation), or none at all.</font>

<p>Why would you think so? Typically embedded proprietary modules are distributed together with kernel as part of one device. That whole combo is most definitely a composite work thus you need a permission from both copyright holders to distribute it. It's perfectly valid for Alice to request that her works should never be on the same medium as Bob's (e.g. if they had a messy divorse) and similarly GPL may demand that if anyone would distribute this work then there should be no binary, proprietary, blobs at all.</p>

<p>GPL doesn't go that far, though. What is does, instead, is this: <i>mere aggregation of another work not based on the Program with the Program (or with a work based on the Program) on a volume of a storage or distribution medium does not bring the other work under the scope of this License</i>.</p>

<p>That's it, there are no more clarifications. Linux developers have drawn a line: if your module uses EXPORT_SYMBOL_GPL — that's not “mere aggregation” for sure.</p>

<p>Now, with shim modules it's not so simple: think <a href="https://en.wikipedia.org/wiki/NDISwrapper">NDISwrapper</a>. It uses certain GPL symbols and is, most likely, a derived work… but Windows XP modules which are loaded into kernel with it's use are, most definitely, <b>not</b> a derived work of Linux kernel and if they, modules written for entirely different OS, don't fall into “mere aggregation” loophole of GPL then I don't know what will.</p>

<p>But if module directly uses these symbols which kernel developers quite explicitly made to make sure something wouldn't be called “independent work, mere aggregation” then it would be <b>really</b> hard to that excuse.</p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/860595/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860624"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 14:35 UTC (Wed)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/860624/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; That&#x27;s it, there are no more clarifications. Linux developers have drawn a line: if your module uses EXPORT_SYMBOL_GPL — that&#x27;s not “mere aggregation” for sure.</font><br>
<p>
NO IT&#x27;S NOT.<br>
<p>
Not all developers have drawn the line. Not all developers use EXPORT_SYMBOL_GPL. And some developers apply EXPORT_SYMBOL_GPL to *other* developers&#x27; work.<br>
<p>
So if the guy who wrote the module is the guy who used EXPORT_SYMBOL_GPL, then yes what you say is probably right.<br>
<p>
But if the guy who wrote the module is NOT the guy who used EXPORT_SYMBOL_GPL, then things get murky ...<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860624/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861531"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 1, 2021 14:50 UTC (Thu)
                               by <b>mrugiero</b> (guest, #153040)
                              [<a href="/Articles/861531/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
And if that&#x27;s OK depends on the license the original developer used and whether or not the person changing how the symbol is exported did add something to it, right? In that sense, liberal licenses allow you to distribute derivatives under a different license. If I made significant changes to your BSD licensed code I have the right to make those under GPL. You are free to distribute your original work as an alternative version tho, as you are still its sole owner.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861531/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor861530"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 1, 2021 14:49 UTC (Thu)
                               by <b>mrugiero</b> (guest, #153040)
                              [<a href="/Articles/861530/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Specifically modifying the kernel by changing the definition of the modules make it a derivative tho. So, maybe using GPL exported symbols is not itself a violation, but you legally need to distribute the source code of your modified kernel, which means that at the very least it becomes obvious you did that. Which in turn means *if* that&#x27;s a violation, it&#x27;s easy to prove intent.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861530/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor860479"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 2:06 UTC (Tue)
                               by <b>ndesaulniers</b> (subscriber, #110768)
                              [<a href="/Articles/860479/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Good luck keeping that fork up to date! The kernel moves faster than most distros can keep up with.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860479/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860483"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 3:34 UTC (Tue)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/860483/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The &quot;fork&quot; can just contain a 2-line patch on top of the mainline kernel.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860483/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor860485"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 3:50 UTC (Tue)
                               by <b>zeekec</b> (subscriber, #2414)
                              [<a href="/Articles/860485/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      This wouldn't change the fact that the copyright owners (the developers) have indicated that using the GPL only symbols make the module derived from the kernel. Such a change would be tantamount to re-licencing the code under a more permissive licence and only the copyright owners can do that.
      
          <div class="CommentReplyButton">
            <form action="/Articles/860485/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860497"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 8:12 UTC (Tue)
                               by <b>intelfx</b> (subscriber, #130118)
                              [<a href="/Articles/860497/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; This wouldn&#x27;t change the fact that the copyright owners (the developers) have indicated that using the GPL only symbols make the module derived from the kernel.</font><br>
<p>
Copyright owners (the developers) cannot indicate this or that at will.<br>
<p>
A module using symbols from the kernel is either a derived work, or not. In first case _any_ non-GPL-compatible module is illegal, in second case it does not matter that the developers have stomped their foot and said &quot;no, these symbols are somehow magically different from the others&quot;.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860497/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860590"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 19:54 UTC (Tue)
                               by <b>mpr22</b> (subscriber, #60784)
                              [<a href="/Articles/860590/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I am not a lawyer, and even if I was a lawyer I am not your lawyer, and this is not legal advice.<br>
<p>
It can be read the other way:<br>
<p>
Using EXPORT_SYMBOL_GPL can be taken to express a position that unless the law says otherwise, using that interface is derivation.<br>
<p>
Using EXPORT_SYMBOL can be taken to express a position that even if the law would allow them to do so, the developer will not treat use of that interface as derivation, which it seems to my untrained eye might reasonably be interpreted as promissory estoppel.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860590/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860623"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 13:30 UTC (Wed)
                               by <b>cesarb</b> (subscriber, #6266)
                              [<a href="/Articles/860623/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Using EXPORT_SYMBOL can be taken to express a position that even if the law would allow them to do so, the developer will not treat use of that interface as derivation, which it seems to my untrained eye might reasonably be interpreted as promissory estoppel.</font><br>
<p>
I don&#x27;t think so. EXPORT_SYMBOL is older, and was used for everything, including many of the symbols now marked as EXPORT_SYMBOL_GPL. That is, EXPORT_SYMBOL conveys no opinion, while EXPORT_SYMBOL_GPL conveys the opinion &quot;code which uses this symbol depends too much on the kernel implementation details to not be a derived work of the kernel&quot;.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860623/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor860463"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 21, 2021 21:13 UTC (Mon)
                               by <b>pomac</b> (subscriber, #94901)
                              [<a href="/Articles/860463/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think AMD had the best approach and I really think that Nvidia should follow suit....<br>
<p>
OpenZFS is another can of beans since it&#x27;s explicitly licenced In a incompatible way...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860463/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860579"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 18:19 UTC (Tue)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/860579/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; OpenZFS is another can of beans since it&#x27;s explicitly licenced In a incompatible way...</font><br>
<p>
Reference?<br>
<p>
<a href="https://en.wikipedia.org/wiki/Illusory_truth_effect">https://en.wikipedia.org/wiki/Illusory_truth_effect</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860579/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860941"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 25, 2021 14:18 UTC (Fri)
                               by <b>niner</b> (subscriber, #26151)
                              [<a href="/Articles/860941/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Maybe not the reference the original poster thought of, but at least a reference:<br>
<p>
To quote Claire Giordano, CDDL Team, Sun Microsystems: &quot;Like the MPL, the CDDL is not expected to be compatible with the GPL, [...]&quot; and &quot;Thus, it is likely that files released under the CDDL will not be able to be combined with files released under the GPL to create a larger program.&quot;<br>
<a href="https://lwn.net/Articles/114840/">https://lwn.net/Articles/114840/</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860941/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860987"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 25, 2021 15:36 UTC (Fri)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/860987/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
&quot;It it likely that...&quot; does not demonstrate intention but rather the lack of it if anything.<br>
<p>
There&#x27;s a video of Bryan Cantrill claiming this _intention_ is a myth.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860987/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor860545"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 15:24 UTC (Tue)
                               by <b>fratti</b> (guest, #105722)
                              [<a href="/Articles/860545/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Kroah-Hartman responded with a promise to &quot;work on fixing that up in a future patch series next week&quot;, so there may be more unpleasant surprises in store for the creators and users of proprietary loadable kernel modules. </font><br>
<p>
Now I&#x27;m all excited. Partly because of Schadenfreude at nvidia&#x27;s expense, but also partly because I&#x27;m genuinely interested in the technical implementation.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860545/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor860561"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 22, 2021 15:53 UTC (Tue)
                               by <b>IanKelling</b> (subscriber, #89418)
                              [<a href="/Articles/860561/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Thank you to GregKH, Hellwig, and I assume Linus for this patch.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860561/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor860666"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2021 16:57 UTC (Wed)
                               by <b>jezuch</b> (subscriber, #52988)
                              [<a href="/Articles/860666/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I struggle to imagine a symbol that is not &quot;so deeply situated within the kernel that any module using them must be a derived product of the kernel&quot;, though.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860666/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861167"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 12:33 UTC (Mon)
                               by <b>immibis</b> (subscriber, #105511)
                              [<a href="/Articles/861167/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
How about kmalloc? You may have a program which happens to allocate memory; porting such a program to run in the Linux kernel (and therefore use its memory allocation functions) might not be sufficient to qualify it as a derivative work of Linux. IANAL.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861167/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor861442"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 30, 2021 18:00 UTC (Wed)
                               by <b>nybble41</b> (subscriber, #55106)
                              [<a href="/Articles/861442/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
And I struggle to imagine a symbol that *is* &quot;so deeply situated within the kernel that any module using them must be a derived product of the kernel&quot;.<br>
<p>
The consensus at the moment seems to be that independently reimplementing an API does not violate the copyright on the original implementation. Various open source projects depend on this (e.g. Lesstif, Wine). A module which uses an API depends (functionally, at runtime, and not in the &quot;derivative work&quot; sense) on *some* implementation of that API—but not any *particular* implementation. If a reimplementation is not a derivative work then it seems like a stretch to say that a *user* of the API is a derivative work merely because it references those same APIs. The module (either the same source code or the same binary) could in principle be compiled, loaded and executed under a completely distinct and independent implementation in a system uncontaminated by the original work. At that point the only real question would be whether any original creative elements from the kernel were incorporated into module&#x27;s source code. Which should be considered the standard for derivative works in general, software or otherwise.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861442/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861456"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 30, 2021 19:07 UTC (Wed)
                               by <b>jezuch</b> (subscriber, #52988)
                              [<a href="/Articles/861456/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Then I guess the question is whether the set of functions exposed to modules is an &quot;API&quot; as in a formal and documented (and hopefully consistent) system, or just a bunch of code lying about for one&#x27;s convenience. I, as an application programmer, would not consider something that&#x27;s explicitly unstable (like the thing exposed to modules) an API. But maybe I&#x27;m biased :)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861456/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor860858"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 24, 2021 19:36 UTC (Thu)
                               by <b>agrawal-d</b> (guest, #141386)
                              [<a href="/Articles/860858/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I don&#x27;t understand how the Kernel is able to detect if a module is GPL or not... It&#x27;s just code right? How can the kernel tell if it has a GPL licence or MIT license or a proprietary license?<br>
<p>
Is there anything I can read up to understand this? Thanks!<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860858/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor860865"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 24, 2021 19:57 UTC (Thu)
                               by <b>mjg59</b> (subscriber, #23239)
                              [<a href="/Articles/860865/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There&#x27;s a .modinfo section in all modules, which contains a set of strings containing information about the module and which can be extracted by either userland tooling or the kernel. One of these is &quot;license=(whatever)&quot;, the addition of which is triggered by the module source code having a &quot;MODULE_LICENSE(&quot;whatever&quot;) line in its source code. The kernel can then check whether a module claims to be GPL or a GPL compatible license and make a policy decision based on that.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/860865/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861042"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 26, 2021 5:23 UTC (Sat)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/861042/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
IMHO this fact pattern bears some similarity to Lexmark v. Static Control Components, which would tend to suggest that sticking a fake value in the license= field is not inherently illegal. In that case, the Sixth Circuit reasoned that, if anyone can read the allegedly protected work out of their computer memory &quot;with or without the benefit of the authentication sequence,&quot; then said sequence does not effectively control access to the allegedly protected work.<br>
<p>
In other words, the Linux kernel is not DRM-protected, and therefore not shielded by the DMCA, if you allow the sysadmin to just read the whole thing out of /proc/kcore whenever they want.<br>
<p>
Obviously, you might still violate copyright the old-fashioned way, if your module is legally considered a derivative work of the kernel. But that is a complicated legal question which has to be answered by a judge. The kernel contributors don&#x27;t have the right to unilaterally decide the scope of their own copyright.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861042/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor861236"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 17:46 UTC (Mon)
                               by <b>rgmoore</b> (<b>&#x272D; supporter &#x272D;</b>, #75)
                              [<a href="/Articles/861236/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <blockquote>Obviously, you might still violate copyright the old-fashioned way, if your module is legally considered a derivative work of the kernel.</blockquote>

<p>Yes, and I would expect that if you were found to have violated the kernel's copyright, lying about your license in the module information would be evidence of willful infringement.
      
          <div class="CommentReplyButton">
            <form action="/Articles/861236/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor861225"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A stable bug fix bites proprietary modules</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 28, 2021 18:45 UTC (Mon)
                               by <b>bfields</b> (subscriber, #19510)
                              [<a href="/Articles/861225/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Also raised above:<br>
<p>
  <a href="https://lwn.net/Articles/860434/">https://lwn.net/Articles/860434/</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/861225/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2021, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
