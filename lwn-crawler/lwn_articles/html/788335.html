        <!DOCTYPE html>
        <html lang="en">
        <head><title>Common needs for Samba and NFS [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/788335/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/787960/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/788335/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>Common needs for Samba and NFS</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Did you know...?</b>
<p>
LWN.net is a subscriber-supported publication; we rely on subscribers
       to keep the entire operation going.  Please help out by <a
       href="/Promo/nst-nag4/subscribe">buying a subscription</a> and keeping LWN on the
       net.
</blockquote>
<div class="FeatureByline">
           By <b>Jake Edge</b><br>May 15, 2019</br>
           <hr>
<a href="/Articles/lsfmm2019/">LSFMM</a>
</div>
<p>
Amir Goldstein led a discussion on things that the two major network
filesystems for Linux, Samba and NFS, could cooperate on at the end of day
one of the 2019 Linux Storage, Filesystem, and Memory-Management Summit. In
particular, are there needs that both filesystems have that the kernel is
not currently providing?  He had some ideas of areas that might be tackled,
but was looking for feedback from the assembled filesystem developers.
</p>

<p>
He has recently just started looking at the kernel NFS daemon (knfsd) as it
is a lesser use case for the customers of his company's NAS device.  Most
use Samba (i.e. SMB).  He would like to see both interoperate better with
other operating systems, though.
</p>

<a href="/Articles/788339/">
<img src="https://static.lwn.net/images/2019/lsf-goldstein-sm.jpg" border=0 hspace=5 align="right"
alt="[Amir Goldstein]" title="Amir Goldstein" width=210 height=300>
</a>

<p>
He noted that he had asked some Samba developers why it has been hard to get the
features they need into the kernel.  The "vibe" he got is that they were
rather intimidated by the kernel community. But he believes that the
last time they tried, "they did it wrong".  They wanted Samba-specific
features, such as preventing writes or reads to a specific file, to be
enforced by the VFS.  Those kinds of changes were not acceptable to the VFS
maintainers, however. 
</p>

<p>
In talking with some NFS developers, it was agreed that Samba and NFS
should "talk amongst themselves" to find areas where both needed kernel
support.  There are likely things that either can only be done in the
kernel or are far better done in the kernel.  If there is a minimal set of
infrastructure that the kernel could provide to help solve those problems,
it may be possible to get it added.
</p>

<p>
He started with <a
href="https://docs.microsoft.com/en-us/windows/desktop/fileio/opportunistic-locks">opportunistic
locks</a> (OpLocks).  In SMB, these locks can be requested when the client
takes a lease on a file.  If granted, that means the client does not need
to flush its changes to the server as long as it holds the lock.  If
another client is accessing the file, the server can revoke the OpLock.
There are large performance gains that OpLocks provide, so it is important
to be able to fully support them.
</p>

<p>
Samba will use OpLocks, but only if it is
configured in the mode that it will be the only user of the filesystem it
is serving.  If, say, an NFS server could also be touching the filesystem,
Samba does not use OpLocks at all.  There are also <a
href="https://docs.microsoft.com/en-us/windows/desktop/fileio/types-of-opportunistic-locks">two
levels of OpLocks</a>; 
Samba uses both when it is configured as the only thing touching the filesystem.
</p>

<p>
Steve French said there is more to it than that. OpLocks are identified
with a key, which would allow level-1 locks to be upgraded to level&nbsp;2, but
doing an upgrade 
is not implemented for Linux.  He was not sure whether NFS could upgrade
its locks or 
not.  Trond Myklebust said that the NFS protocol allows upgrading, but that
it is not implemented for Linux.
</p>

<p>
So Goldstein wondered what Samba and NFS need in order to be able to
implement level&nbsp;2.  He plans to go to the Samba conference (<a
href="https://sambaxp.org/">sambaXP</a>) in June and will gather more
information there.  One thing he knows needs to be done is to be able to
track 
clients through the filesystem operations in order to manage their leases,
which is similar to what Bruce 
Fields described for NFS in an <a href="/Articles/788292/">earlier
talk</a>.  That would take care of file leases.
</p>

<p>
For directory leases, Goldstein has been working on a way to get
notifications of 
directory changes.  He has hooks for doing synchronous notifications, but
there are sensible concerns about exporting those, he said.  He thinks that
perhaps exposing them in a way similar to leases, with a timeout in case
there is no reply, might be possible.
</p>

<p>
One of the problems that NFS has with leases, Myklebust said, is that it
doesn't detect that they have timed out.  If you miss your notification
window, ideally the file descriptor would be closed or something else would
"fence off" access to the file.  That would be an 
indication that some kind of recovery action needs to be taken.
Goldstein said 
that he is not tied to any specific solution; he is just bringing up areas
that might need to be addressed.
</p>

<p>
Next up was <a
href="https://docs.microsoft.com/en-us/rest/api/storageservices/managing-file-locks">share
modes</a> that can be specified when a file is opened.  Those modes can
request that any other opens of the file, for say read, write, or both,
will fail.  There is a patch set from five years ago that implemented a
flavor of mandatory lock to support these modes, but it took the approach
of enforcing the modes in the VFS.
</p>

<p>
Goldstein thinks that Samba and NFS could cooperate on a new flavor of lock
that only they would use.  It would be sort of similar to the BSD <a
href="https://www.freebsd.org/cgi/man.cgi?query=flock&sektion=2&manpath=freebsd-release-ports"><tt>flock()</tt></a>
system call, he said.  New <tt>open()</tt> flags would be added to request
this exclusive access (e.g. <tt>O_DENYWRITE</tt> and <tt>O_DENYREAD</tt>),
but they would only be implemented for filesystems that want to enforce that.
</p>

<p>
Ted Ts'o said that some kind of document outlining the various
problems is going to be needed.  He suggested that it would be helpful to
explain what the downsides to not implementing those features would be.
Samba works pretty well, so explaining why kernel developers should care
about these additional features may help smooth their path.
</p>

<p>
Goldstein said that he was mostly just trying to inform the other
filesystem developers of his plans.  Overall, he does not expect all that
much to come of this effort, but "maybe we can move the needle".  His list
is not comprehensive by any means; he does not know if such a thing
exists.  Mainly, he wants to start the conversation about these network
filesystem needs.
</p><br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Filesystems-NFS">Filesystems/NFS</a></td></tr>
            <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Samba">Samba</a></td></tr>
            <tr><td><a href="/Archives/ConferenceIndex/">Conference</a></td><td><a href="/Archives/ConferenceIndex/#Storage_Filesystem_and_Memory-Management_Summit-2019">Storage, Filesystem, and Memory-Management Summit/2019</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/788335/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor788528"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 15, 2019 17:33 UTC (Wed)
                               by <b>asn</b> (subscriber, #62311)
                              [<a href="/Articles/788528/">Link</a>] (40 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The last thing Samba developers requested was the inclusion of RichACLs in the Kernel. However our voices are not heard ...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788528/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor788531"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 15, 2019 17:45 UTC (Wed)
                               by <b>jra</b> (subscriber, #55261)
                              [<a href="/Articles/788531/">Link</a>] (39 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
+1 on this. RichACLs are the single most important feature needed to allow users to migrate their Windows storage to Linux.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788531/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor788541"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 15, 2019 18:42 UTC (Wed)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/788541/">Link</a>] (38 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'm really glad that RichACLs died. It's just crap.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788541/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor788545"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 15, 2019 19:03 UTC (Wed)
                               by <b>jra</b> (subscriber, #55261)
                              [<a href="/Articles/788545/">Link</a>] (37 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Windows shops depend on them. I don't care if you personally like them or not, they're a required feature for enterprise-level storage for Windows clients.<br>
<p>
It's the kind of attitude expressed above that gives Linux devs a bad name, unfortunately.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788545/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor788546"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 15, 2019 19:16 UTC (Wed)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/788546/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Windows shops depend on them. I don't care if you personally like them or not, they're a required feature for enterprise-level storage for Windows clients.</font><br>
Well, they should just remain on Windows then. Why should Linux get all the braindeadness of other OSes for the sake of a handful of mastodon companies?<br>
<p>
Besides, there are things that really require kernel-level support like case insensitivity. ACLs do not, they can be done completely in user space. Even if you need NFS interoperability, you can still use user-level NFS servers and patch in support there.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788546/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor788557"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 15, 2019 20:47 UTC (Wed)
                               by <b>smfrench</b> (subscriber, #124116)
                              [<a href="/Articles/788557/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Common libraries for ACL integration between NFS (e.g. Ganesha server) and SMB3 servers (e.g. Samba) can be done, but given that the NFS kernel server is still commonly used, RichACL (or something similar) is probably  still easier.<br>
<p>
The NFS and SMB3 ACL models are reasonably similar so getting NFS and Samba server to agree on enforcement would help some of the cases, but note that this isn't just Windows clients that use (and expect to report to users and admins and tools) the 'RichACL' like format, Macs do as well, and presumably as government requirements get stricter (whether we like it or not), the presence of more complex ACLs with deny entries (one of the key differences between RichACL and the draft POSIX ACLs that Linux implements) is going to be hard to avoid, especially for systems accessed over the network.   <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788557/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor788563"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 15, 2019 21:20 UTC (Wed)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/788563/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; RichACL (or something similar) is probably still easier.</font><br>
Yet this will require pretty much indefinite support of it in the mainline Linux, and deep inside VFS at that.<br>
<p>
<font class="QuotedText">&gt; the presence of more complex ACLs with deny entries (one of the key differences between RichACL and the draft POSIX ACLs that Linux implements) is going to be hard to avoid, especially for systems accessed over the network. </font><br>
Oh, please. Naked file servers are pretty much a corner case right now.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788563/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor789198"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 23, 2019 3:35 UTC (Thu)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/789198/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; the presence of more complex ACLs with deny entries (one of the key differences between RichACL and the draft POSIX ACLs that Linux implements) is going to be hard to avoid, especially for systems accessed over the network. </font><br>
<p>
Please NO NO NO.<br>
<p>
Deny ACLs are something I've never understood. Less complexity == better security.<br>
<p>
Just don't mix and match user and group ACLs. If the user ACL over-rides the group ACL, why do you need a deny? If someone has permissions via one group, and denies via another, surely there's something wrong somewhere? And, looked at logically, why should deny over-ride permit?<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/789198/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor790112"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 3, 2019 11:27 UTC (Mon)
                               by <b>pgoetz</b> (subscriber, #4931)
                              [<a href="/Articles/790112/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Well, they should just remain on Windows then. Why should Linux get all the braindeadness of other OSes for the sake of a handful of mastodon companies?</font><br>
<p>
I work with scientists at a university and have a real need for various RichACL features (so not just of importance to a handful of mastodon companies).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/790112/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor788581"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 15, 2019 22:58 UTC (Wed)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/788581/">Link</a>] (28 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The total lack of reason given for RichACLs being 'crap' is notable, too, though it is probably pointless to note that argument by assertion will not convince anyone. I mean it's not as if POSIX-draft ACLs are exactly a model of clarity and wonderfulness, either -- at least RichACLs model an ACL variant that is actually in wide use by real people, even if on Windows (duh: obviously, since Windows is the OS that has an ACL model closest to RichACLs). POSIX ACLs, despite being long-supported on Linux are... not used so much at all.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788581/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor788582"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 15, 2019 23:05 UTC (Wed)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/788582/">Link</a>] (16 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
POSIX ACLs are also not very well designed, but they're here so we have to live with them.<br>
<p>
The problem with RichACLs is exactly that - they are way too rich and complicated. In particular, inheritance is a whole flaming garbage can.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788582/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor788681"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 16, 2019 13:52 UTC (Thu)
                               by <b>bfields</b> (subscriber, #19510)
                              [<a href="/Articles/788681/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      What don't you like about inheritance?
      
          <div class="CommentReplyButton">
            <form action="/Articles/788681/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor789053"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 21, 2019 23:14 UTC (Tue)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/789053/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The implementation is probably painful to do in an efficient fashion. I can hear this eerie sound which I think is Al Viro screaming :)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/789053/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor789148"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 22, 2019 16:18 UTC (Wed)
                               by <b>bfields</b> (subscriber, #19510)
                              [<a href="/Articles/789148/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
"The implementation is probably painful to do in an efficient fashion."<br>
<p>
If Cyberax is thinking about the automatic inheritance stuff, that's described here: <a href="https://tools.ietf.org/html/rfc5661#section-6.4.3.2">https://tools.ietf.org/html/rfc5661#section-6.4.3.2</a>.<br>
<p>
It's not really "automatic".  It just provides a few extra flags that userspace could use to do a sort of inherited-ACL equivalent to chmod -R.<br>
<p>
Basically the problem is that somebody creates a new directory, sets an inheritable ACL on the root, populates it, then realizes a month later, oops, we should have given the "sales" group read access.  And they'd like to not only fix the inheritable ACL on the root, but also have the change propagate to the whole tree.  And, yes, people that implement filesystems tend to run away screaming from that problem.<br>
<p>
The easier solution is to teach user utilities to do the recursive traversal and fix up the tree.  Stuff like "chmod -R" already does that.<br>
<p>
But, one annoyance is that in the intervening month further ACLs may have been set on subtrees, and you may not want to clobber all those.<br>
<p>
So all the "automatic inheritance" stuff does is add flags that userspace can use to determine which ACEs in a given ACL were inherited from somewhere else, so they can (if they want) use that information to decide how to modify the ACL while doing a recursive traversal.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/789148/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor789170"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 22, 2019 18:07 UTC (Wed)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/789170/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Exactly that. Inherited ACLs are basically a bad idea, they are impossible to implement efficiently. <br>
<p>
And a formerly fast atomic rename operations can take many minutes, and a crash in the middle of a re-ACL-ing can leave them in an indeterminate state.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/789170/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor789172"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 22, 2019 18:22 UTC (Wed)
                               by <b>jra</b> (subscriber, #55261)
                              [<a href="/Articles/789172/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
POSIX ACLS have inheritance on directory ACLS already. bfields is correct, "automatic" inheritance only means propagating some bits to a child object, which is never changed by the kernel after creation, via rename or otherwise.<br>
<p>
Only userspace tools change "automatic" inheritance bits on modification, not the kernel. So the comment about filesystems being left in an inconsistent state on rename makes no sense whatsoever.<br>
<p>
I'm starting to understand that the objections here are coming from the fact the objectors don't actually understand RichACLs *at all*, or understand what is required.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/789172/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor789654"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 29, 2019 0:03 UTC (Wed)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/789654/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;  Exactly that. Inherited ACLs are basically a bad idea, they are impossible to implement efficiently. </font><br>
<p>
Simple, reasonably efficient mechanism ...<br>
<p>
First of all, don't "mix and match" ACLs - the rule should be "the first hit is the only hit". Which yes it means a not particularly efficient traversal up the path looking for an ACL, but you don't get things like wrongly updated trees because the tree isn't updated. Update the root ACL, all new accesses will find it straight away. How fast is an upwards traversal reading the ".." entry in the directory?<br>
<p>
Everything I find a pain in Windows ACLs and others is all down to rules about how conflicting ACLs interact. Pr1me ACLs just worked on the basis of "the first hit applies". SOOO much simpler.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/789654/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor789713"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 29, 2019 15:10 UTC (Wed)
                               by <b>bfields</b> (subscriber, #19510)
                              [<a href="/Articles/789713/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Again, the "automatic" inheritance isn't really automatic.  It's something much simpler; see above for explanation.<br>
<p>
And, anyway, we're not really looking for a clever way to make automatic inheritance work, we're just trying to provide a little Windows compatibility.  And the Windows folks (quite sensibly, in my opinion) chose to do this much simpler thing.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/789713/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor789213"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 23, 2019 12:44 UTC (Thu)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/789213/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>
So all the "automatic inheritance" stuff does is add flags that userspace can use to determine which ACEs in a given ACL were inherited from somewhere else, so they can (if they want) use that information to decide how to modify the ACL while doing a recursive traversal.
</blockquote>
But doesn't that mean that there might be an arbitrarily long lag between your changing a root ACL and having the change propagate to children? That sort of thing seems... rather suboptimal for something with security implications (like permissions), though I suppose you could have synchronization mechanisms so you could wait until the userspace fixer-upper had propagated the change. (Heck, it's even suboptimal for something *without* security implications -- can you imagine if rename() worked that way? rename(a, b) and now we have to wait for a while before a vanishes and maybe longer before b appears?)
<p>
Unlike Cyberax, I like the idea of this -- it just seems... really hard to do well.
      
          <div class="CommentReplyButton">
            <form action="/Articles/789213/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor789450"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 26, 2019 20:17 UTC (Sun)
                               by <b>bfields</b> (subscriber, #19510)
                              [<a href="/Articles/789450/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
"But doesn't that mean that there might be an arbitrarily long lag between your changing a root ACL and having the change propagate to children?"<br>
<p>
Sure.  Just as for chmod -R.  You'd run setrichacl with a --recursive option, and you'd wait while setrichacl traversed the tree fixing things up.<br>
<p>
It's a bit annoying, but it's a simple idea and I think people understand it.  They know it'll take a while on a big tree, they know that the job's going to be left half-done if they interrupt it partway through, etc.<br>
<p>
(Disclaimer: I don't remember whether Andreas actually got around to writing that UI, or exactly how he did it if so.  And I don't know the Windows UI.  But my understanding is that, again, it doesn't try to hide the fact that there's a recursive operation when you ask it to propagate a new inherited ACL.)<br>
<p>
This is a really simple low-tech feature.  "Automatic inheritance" was probably a bad name for it, at least if you want to sell it to filesystem developers.  Filesystem people hear "automatic inheritance" and immediately jump to the assumption that you're trying to do something much more sophisticated, and start worrying about all the corner cases.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/789450/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor789533"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 27, 2019 17:48 UTC (Mon)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/789533/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <blockquote>
Filesystem people hear "automatic inheritance" and immediately jump to the assumption that you're trying to do something much more sophisticated, and start worrying about all the corner cases.
</blockquote>
Guilty as charged, though I haven't been a filesystem developer for a long time :)
      
          <div class="CommentReplyButton">
            <form action="/Articles/789533/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor788682"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 16, 2019 13:55 UTC (Thu)
                               by <b>bfields</b> (subscriber, #19510)
                              [<a href="/Articles/788682/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      And while we're at it, how would you design "POSIX" ACLs differently?
      
          <div class="CommentReplyButton">
            <form action="/Articles/788682/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor788695"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 16, 2019 16:03 UTC (Thu)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/788695/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I would personally just extend the user and group bit to multiple entries.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788695/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor788698"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 16, 2019 16:45 UTC (Thu)
                               by <b>bfields</b> (subscriber, #19510)
                              [<a href="/Articles/788698/">Link</a>] 
      </p>
      
      </div>
      </summary>
      I'm not sure what you mean, or what design problem you're solving.
      
          <div class="CommentReplyButton">
            <form action="/Articles/788698/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor789196"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 23, 2019 0:54 UTC (Thu)
                               by <b>neilbrown</b> (subscriber, #359)
                              [<a href="/Articles/789196/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; And while we're at it, how would you design "POSIX" ACLs differently? </font><br>
<p>
I would say that the whole idea of per-file permissions is fundamentally broken and not what people really want, and I wouldn't let "POSIX" ACLs get past "draft" stage - I would nip it in the bud and "just say no".<br>
<p>
There are two classes of permissions that cover most files: 0600 and 0644.<br>
(Having "execute" as a permission bit is a cheap-hack and should be deprecated.  Your $PATH defines which files are to be treated as executable, not the permission bits).<br>
Files that today have mode 0600 should appear in /home *only* for the owner.  Other users shouldn't be able to see them.<br>
Files that today have mode 0644 can appear in global namespace in a read-only part of the tree, and appear writable in /home/shared for the owner.<br>
<p>
The next most common scenario is a group that wants shared access to files.  People in group "foo" would see "/group/foo" as a read-write mount point.  People not in group "foo" wouldn't see this mount point.<br>
<p>
Note that this removes the current awkwardness with user and group quotas.  The quota doesn't apply to a "user" or a "group", but to a fileset, which might be /home or might be /group/foo.<br>
<p>
If you want any permissions more subtle than that, you have a daemon that mediates all accesses.  In some cases this might be a database server with it's own arbitrarily complex permission scheme (which might have field granularity within records).  In other cases it might be a more generic file server which uses access controls similar to those that Apache supports in .htaccess files, and which only allows whole-file reads and writes.<br>
<p>
ACLs?  Just Say NO!<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/789196/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor789542"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 27, 2019 23:12 UTC (Mon)
                               by <b>ssmith32</b> (subscriber, #72404)
                              [<a href="/Articles/789542/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
  &gt; but they're here so we have to live with them.<br>
<p>
Isn't this the same argument being made above about RichACLs..? Namely, they exist in large Enterprises so they should be supported. <br>
<p>
I suppose it all depends on where you "live".<br>
<p>
Granted, I mostly "live" on cloud providers &amp; home machines nowadays, so both posix &amp; whatever windows is doing is fairly irrelevant.<br>
<p>
It seems like, wherever I go, no one is happy with their auth scheme, but it's always better than whatever the other thing is. .. ¯\_(ツ)_/¯<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/789542/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor789547"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 28, 2019 1:13 UTC (Tue)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/789547/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Isn't this the same argument being made above about RichACLs..? Namely, they exist in large Enterprises so they should be supported.</font><br>
No. POSIX ACLs are already supported in Linux, with all of their mis-features. Adding more crap for the sake of a couple of large enterprises is not a good idea.<br>
<p>
These enterprises can very well carry these patches in a custom kernel build.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/789547/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor788584"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 15, 2019 23:16 UTC (Wed)
                               by <b>jra</b> (subscriber, #55261)
                              [<a href="/Articles/788584/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yes. It's opinion being asserted as fact. It's standing in the way of Linux progress in Enterprise file storage. The person asserting that clearly doesn't care, and that's their right of course. But what it does is promote fragmentation and closed source solutions, as they don't have to work with a standard Linux kernel to do what they want.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788584/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor788585"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 15, 2019 23:33 UTC (Wed)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/788585/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Enterprise file storage</font><br>
Not quite. It's "'enterprise' legacy storage for Windows clients".<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788585/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor788586"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 15, 2019 23:57 UTC (Wed)
                               by <b>rahvin</b> (guest, #16953)
                              [<a href="/Articles/788586/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The more people move their windows storage to Samba and Linux the better the world will be (at the very least my servers will stop getting spamed with all the windows server exploits). There's no reason not to support such a feature. If it accelerates the removal of windows servers all the better as it would give linux far more leverage over the small business market and do much to suppress Microsoft's tendency to fragment markets and create lockin, and that frankly is good for everyone. <br>
<p>
It's petty and silly to suggest the community shouldn't bother with it.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788586/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor788588"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 16, 2019 1:18 UTC (Thu)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/788588/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
These kinds of "enterprise" storage basically are almost never used in small businesses.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788588/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor788590"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 16, 2019 2:05 UTC (Thu)
                               by <b>areilly</b> (subscriber, #87829)
                              [<a href="/Articles/788590/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
As opposed to what alternative for networked file storage?  Samba is essentially the only game in town, now that macOS is a SMB client too.<br>
<p>
If your answer is some sort of WebDav HTTP-based synchronization thing, then sure, those exist, but they all work orders of magnitude more slowly and generally worse than either SMB or NFS.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788590/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor788591"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 16, 2019 2:10 UTC (Thu)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/788591/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
For real SMBs? Dropbox, Google Drive, Microsoft CloudDrive etc. I've worked with dozens of SMBs in various areas and not once have I seen SMB. The web-based solutions do work slower than SMB/NFS but at the same time they are reliable and work from anywhere.<br>
<p>
The only place I've seen SMB was a mid-size factory that was using it for industrial automation.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788591/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor788608"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 16, 2019 7:34 UTC (Thu)
                               by <b>smurf</b> (subscriber, #17840)
                              [<a href="/Articles/788608/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Totally different use cases. This is not about sharing PDFs between co-workers, or storing your movies. Nobody needs O_DENYREAD or -WRITE for that.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788608/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor789205"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 23, 2019 8:06 UTC (Thu)
                               by <b>HelloWorld</b> (guest, #56129)
                              [<a href="/Articles/789205/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
So what do you need SMB for then?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/789205/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor789442"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 26, 2019 6:48 UTC (Sun)
                               by <b>cpitrat</b> (subscriber, #116459)
                              [<a href="/Articles/789442/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
"I've worked with dozens of SMBs in various areas and not once have I seen SMB. "<br>
"The only place I've seen SMB ..."<br>
<p>
Wait, what?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/789442/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor789444"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 26, 2019 9:09 UTC (Sun)
                               by <b>zdzichu</b> (subscriber, #17118)
                              [<a href="/Articles/789444/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
“SMB” could both Small/Medium Business and Server Message Block (protocol). Mid-size factory is neither. Samba is a server for later.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/789444/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor789443"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 26, 2019 6:58 UTC (Sun)
                               by <b>cpitrat</b> (subscriber, #116459)
                              [<a href="/Articles/789443/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Exactly that. I know nothing about the topic but the discussion I see looks like:<br>
 - RichACLs are bad<br>
 - why?<br>
 - because I don't like them<br>
 - but why?<br>
 - because they are crap<br>
 - but why?<br>
 ...<br>
<p>
They are complex? Well, I don't know any area which is not / does not require complexity when you look carefully at it.<br>
<p>
They are more complex than POSIX ACLs? Well, I'd expect that, the main complain about POSIX ACLs is that they are too simple. Of course, in theory you can do whatever you want with them. In practice, having a different group per file is not manageable. I don't know what RichACL supports but it seems to me that being able to have multiple groups and users allowed a certain access to a file is a minimum to make users life easier.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/789443/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor788719"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 16, 2019 20:48 UTC (Thu)
                               by <b>neilbrown</b> (subscriber, #359)
                              [<a href="/Articles/788719/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Do RichACLs map PERFECTLY to Windows ACLs?<br>
If they do, then I can see a case being made for them.<br>
If not, then I think they are best avoided.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788719/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor788724"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 16, 2019 21:40 UTC (Thu)
                               by <b>jra</b> (subscriber, #55261)
                              [<a href="/Articles/788724/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
They're close enough that the minor differences can mostly be ignored by client apps (or hidden by server code). They would be *massively* useful for Windows -&gt; Samba data storage migrations, witness all the Samba Team members in this thread asking for them.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788724/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor788749"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Common needs for Samba and NFS</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 17, 2019 13:23 UTC (Fri)
                               by <b>bfields</b> (subscriber, #19510)
                              [<a href="/Articles/788749/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The main differences are:<br>
<p>
- identification of users and groups by UIDs and GIDs vs. SIDs: not sure if we can do much about this, and in any case it seems like a separate issue.<br>
- support for mode bits: we could simplify richacls if we just ignored mode bits, but that didn't seem like a good idea.<br>
<p>
In the end, I trust the Samba developers' judgement that richacls would solve a major problem for them.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788749/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2019, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
