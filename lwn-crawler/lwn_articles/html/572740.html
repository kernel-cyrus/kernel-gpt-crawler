        <!DOCTYPE html>
        <html lang="en">
        <head><title>The future of realtime Linux [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/572740/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/572507/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/572740/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>The future of realtime Linux</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>This article brought to you by LWN subscribers</b>
<p>
Subscribers to LWN.net made this article &mdash; and everything that
       surrounds it &mdash; possible.  If you appreciate our content, please
       <a href="/Promo/nst-nag3/subscribe">buy a subscription</a> and make the next
       set of articles possible.
</blockquote>
<div class="FeatureByline">
           By <b>Jake Edge</b><br>November 6, 2013</br>
           <hr>
<a href="/Archives/ConferenceByYear/#2013-Realtime_Linux_Workshop">Real Time Linux Workshop</a>
</div>
<p>
The future of the realtime (aka <tt>PREEMPT_RT</tt>) kernel patch set was
on the 
agenda for the Realtime Linux minisummit—as usual—but this year's edition
had a bit more urgency than in years past.  It is clear that Thomas
Gleixner, who is doing most of the development work on the patch set, is
concerned about the future of the remaining pieces.  There appears to be
minimal interest in furthering the development of realtime Linux outside of
its main sponsor, Red Hat, and that may not be a sustainable model, he
reported to both the minisummit and the concurrent <a
href="https://www.osadl.org/RTLWS-2013.rtlws-2013.0.html">15th Real Time Linux
Workshop</a> (RTLWS).   
</p>

<a href="/Articles/572949/">
<img src="https://static.lwn.net/images/2013/rtlws-minisummit-sm.jpg" border=0 hspace=5
align="right" alt="[Group photo]" width=250 height=155>
</a>

<p>
The RTLWS is a four-day gathering of those interested in using Linux for
realtime applications.
The minisummit was an all-day meeting on the first day of the workshop for
nine kernel developers who are 
involved in the <tt>PREEMPT_RT</tt> work:
Ingo Molnar, Sebastian Siewior, Frédéric Weisbecker, John Kacur, Paul McKenney, Steven Rostedt, Paul Gortmaker, Gleixner, and Darren Hart.
Gleixner also reported on the minisummit to the
participants of the workshop on its second day.  The conclusion was the
same in both cases: the <tt>PREEMPT_RT</tt> project will be done in 2014,
"one way or another". The first way would be to get most of the rest of the
code upstream, but that will require more of an effort, from a wider group
than is currently involved.  The alternative is to decide that the 95% of
the realtime work already upstream is good enough and to drop further
efforts.  
</p>

<h4>Status</h4>

<p>
Since <a href="/Articles/520704/">last year's minisummit</a>, not much has
changed for the realtime patch set, Gleixner said.  He spent three months
trying to clean up some of the last pieces to get them ready for mainline,
but that quickly ballooned into nine separate projects with circular
dependencies. That code was "stashed in the horror cabinet", he said, but
the work was not entirely wasted as he has a good idea of what needs to be
done, "but it's not pretty".  
</p>

<p>
In order to focus on the development side of things, Gleixner has handed
off doing the -rt releases to Siewior.  The "whole problem" over the last
couple of years has been the lack of developers, paid developers in
particular, Gleixner said.  Red Hat pays him to work half-time on realtime
development and it pays the <a
href="http://www.redhat.com/products/mrg/">messaging, realtime, and
grid</a> (MRG) team to test and productize the realtime patch set. Beyond
that, there are a few other contributors, including McKenney for
read-copy-update (RCU) development as well as Hart and Gortmaker. Both of
the latter two
indicated 
they would try to encourage their employers (Intel and Wind River,
respectively) to contribute more to realtime development moving forward.
</p>

<p>
Gleixner said that he spoke with Linus Torvalds and Andrew Morton at the
recently completed <a href="/Articles/KernelSummit2013/">Kernel Summit</a>
about the 
remaining realtime code.  Both were favorably disposed toward getting those
pieces upstream, but Gleixner is concerned that the lack of a
dedicated realtime development team to sustain the code may be an
impediment.  Torvalds worries less about drivers or filesystems that "can
bitrot away at the edge of the kernel" without affecting anything else,
Gleixner said, but core kernel code is different.  If Red Hat were to
decide that realtime was no longer of interest, that code might go largely
unmaintained. 
</p>

<p>
Part of the problem may be that it is smaller and smaller segments of the
user base that is being served with each addition of realtime code to the
mainline. 
McKenney said that he has seen that with RCU—the mainline version works
for a lot of people, which is a sign of maturity.  Newer features are just
for specialized situations, which means it is hard to get a groundswell of
support behind them.
</p>

<p>
Similarly, Hart said that there are customers who are talking about using
<tt>PREEMPT_RT</tt> with the Yocto project, but there would need to be a
whole lot more of them before he is likely to be able to convince his
management to have him work half-time on realtime.  The <a
href="https://www.osadl.org/Home.1.0.html">Open Source Automation
Development Lab</a> (OSADL)—sponsor of the RTLWS—was originally set up to
gather enough funds to support four or so full-time engineers working on
realtime Linux, Gleixner said.  Unfortunately, the number of members has
never risen to the point where that became a reality and the organization
is just able to support its <a
href="https://www.osadl.org/QA-Farm-Realtime.qa-farm-about.0.html">QA test
farm</a> alongside its other activities, he said. 
</p>

<p>
From statistics gathered by Gleixner while he was hosting the -rt patches
during the kernel.org outage, it is clear that there is interest in
realtime Linux.  Within five days of the announcement of a new -rt kernel,
he would see around 3000 downloads from addresses that read like a "who's
who" of the computer industry, he said.  In particular, Germany—where OSADL
is based—was well represented, with 45% or so of the downloads coming from
there. 
</p>

<p>
As Hart noted, this is a different kind of problem than the realtime
project has faced in the past. It is not a technical problem like those
that the project has tackled—largely successfully.  There may be
some help on the horizon, however, as there are plans to put the MRG
offering on top 
of the RHEL kernel (with the -rt patches, of course), Kacur said.  That may
free up some people who are currently working 
to test and stabilize the -rt kernels because much of the RHEL driver
testing and the like can be reused.
</p>

<p>
Gortmaker asked what the "end game" for realtime Linux looked like, was it
going to be like linux-tiny with some out-of-tree patches?  Gleixner
acknowledged that was likely to be the case; some "special case" pieces
would need to be maintained out of tree.
</p>

<p>
Something that might help realtime get the final push it needs to be
mainlined and to have enough maintenance support would be a contract that
required mainline realtime support, McKenney suggested.  The original
realtime patches came about due to a contract that IBM and Red Hat had with
the US Navy, so something like that might come along again.  

<p>
While the
financial industry was once a hotbed for interest in realtime, that seems
to have cooled somewhat.  The traders are more interested in throughput and
are willing to allow Linux to miss some latency deadlines in the interests
of throughput, Hart said.  The embedded use
cases for realtime seem to be where the "action" is today, Gleixner and
others said, but there has been little effort to fund realtime development
coming from that community.
</p>

<h4>Technical hurdles</h4>

<p>
After that, the conversation moved on to the remaining technical hurdles to
clear to "finish" the realtime work.  Gortmaker noted that Ted Ts'o was <a
href="http://www.spinics.net/lists/linux-rt-users/msg10138.html">not
opposed</a> to replacing the bit spinlocks (single bits used as spinlocks
to save space) in the ext4 filesystem with regular spinlocks if it could
be shown there were no performance impacts or, better still, that
performance increases offset the extra space used in buffer-heads.
Bit spinlocks are a problem for the realtime code because they cannot be
turned into sleeping spinlocks as is done with other mainline spinlocks.
Gortmaker said that he plans to pursue the conversion with
Ts'o as a possible step 
toward eliminating bit spinlocks.  
</p>

<p>
Gleixner suggested that a patch which converted bit spinlocks to regular
spinlocks when lockdep is enabled might be one approach to solving the bit
spinlock problem for realtime.  Right now, bit spinlocks are not tracked by
lockdep, so a cleanup that tracked them could be sold as a debug feature
and the realtime patches could enable that mode as well.  Molnar said that
doing so might well find locking bugs, which would demonstrate its
usefulness. 
</p>

<p>
Rostedt asked about getting rid of uses of the <tt>cpu_chill()</tt>, which
can lead to livelock situations.  Gleixner said that it is a replacement
for <tt>cpu_relax()</tt> that just does an <tt>msleep(1)</tt> to allow
"nasty trylock loops" to continue to work.  By delaying the looping task
for a tick, it allows a preempted task to make progress which will,
eventually, allow it to release a lock the looping task is waiting on.

<p>
Rostedt called <tt>cpu_chill()</tt> a "hail Mary" that just hopes whoever
has the lock will 
let go of it.  He suggested that the waiting task temporarily give its
priority to the lock holder, but others thought that fixing the directory
entry cache (dcache) code where <tt>cpu_chill()</tt> is used would be a
better approach.  For now, the <tt>msleep()</tt> is reasonable.
</p>

<p>
The bottleneck of turning reader-writer locks (rwlock) and semaphores
(rwsem) into a single 
spinlock was another issue that Rostedt raised.  He noted that there was
some ongoing work by Mathieu Desnoyers to turn the oft-contended mmap_sem
into something else. "Any heavily threaded application" works poorly on the
realtime kernel, Rostedt said, because of mmap_sem contention.  Either the
realtime kernel can do something realtime-specific to alleviate the problem
or there could be an effort to get rid of rwsems in the mainline kernel.
</p>

<p>
McKenney said that he had put Desnoyers and Peter Zijlstra together at the
Kernel Summit to discuss the effort to rework mmap_sem.  Zijlstra had made
an attempt at the rework earlier, based on a paper from MIT that
applied RCU 
in the page fault path to avoid the need for mmap_sem.  It used a different
kind of tree that required less rebalancing to track the mappings.  He
wasn't sure if anything came out of that conversation but that is one
possible approach.
</p>

<p>
Another approach, suggested by Molnar, is to just eliminate rwsem in the
realtime patch set and allow memory management to be non-deterministic.  If
an application cares about deterministic memory management behavior, it should be
using <tt>mlock()</tt>, Gleixner said.  Just removing rwsem and "see who
complains" is probably best, Molnar said.  If someone truly needs the
functionality in the realtime kernel, they can fund the development of a
realtime variant of rwsem, he said.
</p>

<p>
There was also discussion of restricting which softirqs are run when
softirqs are processed as a result of a call to
<tt>local_bh_enable()</tt>.  A mask value could be provided to the
<tt>local_bh_disable()</tt> call that would specify <i>which</i> types of
softirqs were being disabled.  Typically it would just be those for the
subsystem doing the disabling, but others could be added if they needed to
be held off.
</p>

<p>
Gortmaker plans to create an API to post as an RFC soon that would add the
mask, but hide it behind a higher-level interface (like
<tt>local_bh_disable_net()</tt> or similar).  It would also convert one
type of softirq (scheduler, RCU, or timer were suggested) to use the new
API.  That way, people can "scream" right away, Gleixner said, if they
don't like the idea and another way to handle softirq processing for
realtime can be found.
</p>

<h4>Where to next?</h4>

<p>
In summary, Gleixner said, much of the "low-hanging fruit" from last year's
to-do list 
has been dealt 
with.  Gortmaker picked up many of those and got them to the right
subsystem maintainer, Gleixner said.  What's left are the "nasty and
intrusive" pieces that he keeps trying to "wrap my brain around", but the
lack of developer time has really hurt that process.
</p>

<a href="/Articles/572952/">
<img src="https://static.lwn.net/images/2013/rtlws-gleixner-sm.jpg" border=0 hspace=5
align="right" alt="[Thomas Gleixner]" width=150 height=167>
</a>

<p>
Gleixner expanded on that problem some more in the report to the RTLWS.  He
believes a team of four or five full-time developers is needed to make
realtime Linux truly sustainable.  Without that kind of commitment, he is
concerned that Torvalds will be unwilling to take the kind of core changes
required by the remaining pieces of the realtime patch set.
</p>

<p>
The community contribution to the realtime patch set "amounts roughly to
zero", he said.  There is a fair amount of frustration on the team in
always chasing 
mainline and being unable to stop realtime-unfriendly mainline features
because the code is out of tree.  In his mind, that should not continue
past 2014; either a larger group steps up to work on the code or the
project can be declared "finished", he said. "I could live with either
outcome." 
</p>

<p>
Gleixner said that he was trying to scare the audience a little bit with
his proclamation, but it is clear he has nearly reached the end of his
rope.  While he would like to see the project continue—and prosper—he has
real concerns about making the kinds of changes to the kernel that are
required without a deeper and wider group to maintain it all.  It seems
that it is now up to those who use the realtime kernel to either step up or
prepare for a future where the mainline kernel will have to serve their needs.
</p><br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Realtime">Realtime</a></td></tr>
            <tr><td><a href="/Archives/ConferenceIndex/">Conference</a></td><td><a href="/Archives/ConferenceIndex/#Realtime_Linux_Workshop-2013">Realtime Linux Workshop/2013</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/572740/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor573093"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 6, 2013 19:49 UTC (Wed)
                               by <b>HIGHGuY</b> (subscriber, #62277)
                              [<a href="/Articles/573093/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There are a couple of companies shipping PREEMPT_RT as a product, even though I'm not seeing them contribute to the game much.<br>
I wouldn't be surprised that they start hiding PREEMPT_RT behind support contracts to fund either keeping the out-of-tree patches or aid in upstreaming the current effort.<br>
As a PREEMPT_RT user in the embedded world, I'd be sad to see the efforts come to a halt, although I wonder what parts of the remaining patchset we'd be missing out on... (At this moment we're on the ancient 2.6.32+rt patchset)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573093/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor573100"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 6, 2013 20:54 UTC (Wed)
                               by <b>karim</b> (subscriber, #114)
                              [<a href="/Articles/573100/">Link</a>] (10 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It might be worth entertaining the merge of the ipipe functionality that's at the root of Xenomai. It's been out there for 10+ years and provides deterministic hard-real-time capabilities. FWIW - a comparison of the two approaches: <a href="https://www.osadl.org/fileadmin/dam/rtlws/12/Brown.pdf">https://www.osadl.org/fileadmin/dam/rtlws/12/Brown.pdf</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573100/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor573124"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 6, 2013 22:59 UTC (Wed)
                               by <b>dashesy</b> (guest, #74652)
                              [<a href="/Articles/573124/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Last time I checked, newer Xenomai was a wrapper for linux-rt approach. A dual-kernel makes thing very simple from developer's perspective but its advantage to mainline would be minimal, I think that is the reason it will never be merged.<br>
<p>
Thanks for the interesting read.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573124/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor573125"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 6, 2013 23:03 UTC (Wed)
                               by <b>dashesy</b> (guest, #74652)
                              [<a href="/Articles/573125/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
"its benefit to mainline"<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573125/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor573147"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 7, 2013 6:16 UTC (Thu)
                               by <b>karim</b> (subscriber, #114)
                              [<a href="/Articles/573147/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'd like to think mainline's purpose is to serve its users, not its own self. But I do tend to be idealistic.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573147/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor573165"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 7, 2013 9:18 UTC (Thu)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/573165/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
if it can't be maintained and collapses, it won't be serving it's users.<br>
<p>
a lot of the core kernel folks have been doing this for a long while, they have learned things that you just don't get until you have been maintaining and improving the same thing for several generations. When you start looking at something and can't say "what was the idiot who wrote this thinking" because _you_ were that idiot, and you remember exactly what you were thinking, it starts to change how you approach new things. You become a bit more discriminating about what you implement and you think a lot more about the effort to maintain things. In the short term, you slow down, but by reducing the long-term maintenance burden you actually end up going faster over time.<br>
<p>
and while it's hard to tell users 'no' or 'not now' or 'fix it first', many projects who don't push back end up collapsing and burning out and providing nothing to their users.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573165/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor573167"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 7, 2013 9:52 UTC (Thu)
                               by <b>karim</b> (subscriber, #114)
                              [<a href="/Articles/573167/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I get all of that. But none of those arguments make any sense if the thing has been *actively* maintained for 10+ years.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573167/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor573291"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 8, 2013 6:57 UTC (Fri)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/573291/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
and I'll throw back that if it's no problem to maintain, they can continue to maintain it out of the kernel for another 10+ years<br>
<p>
but the reality is that it is a problem to maintain it separately, merging it with the mainstream kernel greatly reduces the work for those people who have been maintaining it so far, but that work doesn't all just go away, it goes out to the other kernel maintainers who now have to make sure that new changes don't break -rt, and they have to respond when the -rt people try to block other "important" features going in.<br>
<p>
so it makes sense for the kernel maintainers to be careful about major changes.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573291/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor573470"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 11, 2013 8:47 UTC (Mon)
                               by <b>karim</b> (subscriber, #114)
                              [<a href="/Articles/573470/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'm sorry, I must be confused. Why does the externally-maintained codebase all of a sudden stop being the responsibility of the external maintainers? In what ways are they less capable of maintaining their code in tree than they were out of tree? Why would they stop being capable of resolving the issues they had been resolving to smooth their code to continue working as a patch onto mainline once they actually become part of the official codebase?<br>
<p>
Initially I said: "I'd like to think mainline's purpose is to serve its users, not its own self. But I do tend to be idealistic." If indeed the kernel's purpose is to serve its users then there would be some recognition that those needing real-time actually do need real-time in the kernel. What we have now is people maintaining functionality that was aimed back in 2005 at providing hard real-time and that currently actually doesn't and might actual never do so. How that becomes the benchmark for admitting something that actually solved that same problem even before PREEMPT_RT came around is beyond my clearly limited intelligence.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573470/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor573473"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 11, 2013 9:47 UTC (Mon)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/573473/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Why does the externally-maintained codebase all of a sudden stop being the responsibility of the external maintainers? </font><br>
<p>
well, if the external maintainers are saying that they will be finished with it within a year by either getting it merged upstream or they will stop maintaining it, they must believe that getting it merged will result in others doing some of the work that they have been doing.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573473/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor573491"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 11, 2013 14:53 UTC (Mon)
                               by <b>raven667</b> (subscriber, #5198)
                              [<a href="/Articles/573491/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Well also, in the general case, once code is accepted into mainline then it's ultimately Linus responsibility and the subsystem coordinators for maintenance, they can't just point fingers if something needs to be fixed and the original developers aren't available for any reason, they are on the spot to fix it themselves which is why they've become conservative when it comes to big patch sets.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573491/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor573553"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 12, 2013 2:41 UTC (Tue)
                               by <b>nevets</b> (subscriber, #11875)
                              [<a href="/Articles/573553/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It's not that we'll stop maintaining it after it goes into mainline, but our work does become easier. Once it goes into mainline, than when another subsystem breaks PREEMPT_RT, we can ask that subsystem to do things differently to fix it. All kernel maintainers try not to break things that have been merged.<br>
<p>
Currently, if a subsystem breaks PREEMPT_RT, we need to figure out a work around for that breakage. Sometimes we send patches to upstream, and they get fixed. Other times, it requires a bit of design change that upstream doesn't care about and that work goes into the -rt patch. Now the -rt maintainers need to maintain every subsystem in the kernel that breaks PREEMPT_RT, and that just does not scale.<br>
<p>
Thus the comment about it either going into mainline or we are done is not saying we are done if it goes into mainline. But our work will be a lot easier if it is, as we don't need to maintain the entire kernel for PREEMPT_RT anymore. We just need to educate other maintainers on how to play nice with PREEMPT_RT.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573553/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor573135"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 7, 2013 0:55 UTC (Thu)
                               by <b>ppisa</b> (subscriber, #67307)
                              [<a href="/Articles/573135/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
As I know, the mainline kernel has no latency guarantees and the case with very long time can be constructed. This means that mainline is not suitable for use in any control system with deadlines below 10 or 100 ms and its use in such situation calls for disaster. On the other hand, RT kernel core (not speaking about networking) behaves quite well for years even on not so powerful hardware.<br>
<p>
If RT variant is dead then there will be significant problem to use Linux for live/interactive audio applications/pass through processing as well. So even audio community should provide some interest there.<br>
<p>
In each case, I want to express my thanks to Thomas to make mainline kernel much better and modern and to show that Linux can/could be changed to system usable for real world applications - automotive, robotic, industrial control and that is is not only OS for toy boxes and backbone system for advertisement driven servers.<br>
<p>
Unfortunately, development of the things which save real lives is horrible underpaid - at least as I know from our own work on other systems and as seem on Linux RT project.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573135/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor573141"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 7, 2013 4:19 UTC (Thu)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/573141/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
guarantee is a very strong word, and even with the -rt patches it requires specific hardware (or at least specific hardware be avoided), and since there is no list of problem hardware to reference and any list of 'safe' hardware will be worthless in a short time (because you won't be able to buy it anymore), it all boils down to testing with your specific setup in any case.<br>
<p>
and you could argue that something is 'real time' if it was 'guaranteed' not to have latency more than 1 second, but something not being real-time if it had latencies &lt; 1ms 99.9999% of the time, but most people would be far happier with the second system than the first.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573141/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor573303"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 8, 2013 13:45 UTC (Fri)
                               by <b>armijn</b> (subscriber, #3653)
                              [<a href="/Articles/573303/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
At RTLWS Steven Rostedt actually mentioned that the main thing about "real time" is not about speed, but about predictability which for some use cases is a lot more important than being really fast.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573303/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor573341"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 8, 2013 18:08 UTC (Fri)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/573341/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I agree that "real time" is really about predictability, not speed.<br>
<p>
However, the vast majority of cases where people start throwing around the term, they are really thinking speed, and a (very rare) missed deadline is less of a problem than most people think.<br>
<p>
at some point you will miss your deadline because the hardware fails (or if you are a networked function, because the network drops a packet)<br>
<p>
as noted in the article, the prior poster child of -rt scheduling (stock trades) is moving away from -rt as the probability of missing their deadlines gets to an acceptably low level and they started noticing that their overall throughput was improved by moving away from -rt<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573341/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor574398"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 20, 2013 18:18 UTC (Wed)
                               by <b>k8to</b> (guest, #15413)
                              [<a href="/Articles/574398/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Such users are either<br>
 * Not real time users<br>
 * Wrong.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/574398/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor574399"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 20, 2013 18:24 UTC (Wed)
                               by <b>hummassa</b> (guest, #307)
                              [<a href="/Articles/574399/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; as noted in the article, the prior poster child of -rt scheduling (stock trades) is moving away from -rt as the probability of missing their deadlines gets to an acceptably low level and they started noticing that their overall throughput was improved by moving away from -rt</font><br>
<p>
Yeah, that will happen until the next flash-crash caused by some specific circumstance making a node miss its deadlines. :D<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/574399/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor574463"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2013 2:06 UTC (Thu)
                               by <b>mmorrow</b> (guest, #83845)
                              [<a href="/Articles/574463/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
musical chairs all the way to the bank.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/574463/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor573171"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 7, 2013 11:17 UTC (Thu)
                               by <b>jkacur</b> (subscriber, #63)
                              [<a href="/Articles/573171/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There is more than one way for the community to contribute. While not everyone is able to help with kernel development, there is a community of users developing applications with the rt-kernel.<br>
<p>
We have an rt-wiki hosted on kernel.org, that never seemed to fully recover from the period in which kernel.org was down.<br>
<p>
I would love to see it become more active again.<br>
<p>
We welcome contributions. How-Tos, uses, etc,<br>
<p>
<a href="https://rt.wiki.kernel.org/index.php/Main_Page">https://rt.wiki.kernel.org/index.php/Main_Page</a><br>
<p>
In addition, you can join the relatively low volume mailing list<br>
linux-rt-users<br>
<p>
Send a message to majordomo@vger.kernel.org with the only content being<br>
subscribe linux-rt-users<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573171/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor573174"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 7, 2013 11:53 UTC (Thu)
                               by <b>karim</b> (subscriber, #114)
                              [<a href="/Articles/573174/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Hi John, thanks for pointing this wiki out. FWIW, it's the first time I see it. BTW, do you have pointers to use-cases/case-studies/etc.? Maybe it's in the wiki but I didn't see it as first. Thanks.<br>
<p>
P.S.: long-time no see, btw. OLS 200X I think.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573174/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor573395"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 9, 2013 22:15 UTC (Sat)
                               by <b>liam</b> (guest, #84133)
                              [<a href="/Articles/573395/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Also checkout osadl.org.<br>
They've been running a rack of fairly diverse hardware for years on the -rt kernel.<br>
Also free-electrons.com. That's more general embedded than realtime but it does cover that as well.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573395/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor573391"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 9, 2013 16:39 UTC (Sat)
                               by <b>peterzzz</b> (guest, #70147)
                              [<a href="/Articles/573391/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
"Zijlstra had made an attempt at the rework earlier, based on a paper from MIT that applied RCU in the page fault path to avoid the need for mmap_sem."<br>
<p>
I don't think I saw that paper until after I did that work.<br>
<p>
That said, faults shouldn't really be a problem for RT as you should lock and prefault all your memory anyway (well aware of the mlock() limitations etc..).<br>
<p>
The basic premises of the idea is simple; (S)RCU lookup the VMA, speculative call the read_page() method if required and once you hold the page table lock validate the VMA you did your work against is still the same (or at the very least is still covering the page you faulted on) and proceed to install the page you found, if not bail and retake the fault.<br>
<p>
Back then the problem was that due to the (S)RCU lookup we could keep file backed VMAs alive past their final iput() which becomes tricky way fast, as you'd have to delay the iput until call_rcu() time, which at the time wasn't possible.<br>
<p>
However, since then Al Viro and Oleg Nesterov added the delayed_fput() which makes all of that quite possible.<br>
<p>
There's a few other left overs after that but it should mostly be a matter of being careful.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573391/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor584279"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 5, 2014 19:39 UTC (Wed)
                               by <b>solanum</b> (guest, #95359)
                              [<a href="/Articles/584279/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I am not that familiar with the -rt project. There is a -ton- of interest in RaspberryPi for robotics. While the Raspi is not a -great- contoller out of the box, 99% of those users are people who copy other people. That is the same for arduino. <br>
<p>
What you get from them IS a larger community, a bug reports, potential help further with documentation, bug fixes, driver support and possibly kernel help. Essentially the whole point of the project is to get people to learn, about computers. Yeah you see everyone from newbies to kernel maintainers. <br>
<p>
It has a direct relation to market penetration, documentation and project viability. <br>
<p>
Getting easy to use documentation and a list of supported devices with "sample projects" out in the public, and helping people get started is the key to an overall successful project. <br>
<p>
I have seen it quite a few times, in open source projects, where the lead developer group, chases off people trying to help. Because they seem like idiots, which they are newbies, so they do seem -stupid- to you, but that educational gap is the lack of easily obtainable knowledge. They don't stay stupid forever, and sometimes they end up contributing, even if it is merely answering the same stupid question they asked or adding the documentation to the FAQ. <br>
<p>
I am not saying that this is the case in this instance. It is just a general comment. <br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/584279/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor617563"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of realtime Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 22, 2014 8:23 UTC (Wed)
                               by <b>ortalo</b> (guest, #4654)
                              [<a href="/Articles/617563/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I am not really a user of RT, however, IMHO, it seems that the aerospace industry should be the area where funding should be available. Extensive funding in fact given what they can currently spend on 20th-century solutions... <br>
However, if the classical western players are too frozen in their current technology maybe it would be the time to have a look at the new players in asia who are certainly much more interested in alternatives than their entrenched competitors (esp. in aeronautics - space may be a little more innovative in the US currently, cf. SpaceX presentation a couple years ago).<br>
As a bonus, I've read a few times in these columns that contributors from asia are under-represented in the kernel community.<br>
Maybe the realtime patches could turn from a burden to an opportunity given different perspectives?<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/617563/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2013, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
