        <!DOCTYPE html>
        <html lang="en">
        <head><title>Known-exploit detection for the kernel [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/577432/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/576768/">Return to the Security page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/577432/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>Known-exploit detection for the kernel</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Ready to give LWN a try?</b>
<p>
With a subscription to LWN, you can stay current with what is happening in the Linux and free-software community and take advantage of subscriber-only site features.  We are pleased to offer you <b><a href="https://lwn.net/Promo/nst-trial/claim">a free trial subscription</a></b>, no credit card required, so that you can see for yourself.  Please, join us!
</blockquote>
<div class="FeatureByline">
           By <b>Jake Edge</b><br>December 18, 2013</br>
           </div>
<p>
An attacker might try a number of different kernel exploits before actually
getting one that works with a specific running kernel.  If the kernel were
instrumented to detect the failed attempts, it could alert system
administrators about an in-progress attack in addition to returning an
error code to the attacker.  That's the idea 
behind a <a href="/Articles/576785/">patch set</a> proposed by Vegard Nossum: complain loudly when someone
attempts to exploit a closed security hole.
</p>

<p>
Any given kernel will have both patched and unpatched vulnerabilities; hopefully
the latter are far fewer than the former.  When targeting a system,
attackers can either figure 
out which kernel version is running and what vulnerabilities it is likely
to have, 
or they can just try to exploit a bunch of recent vulnerabilities.  Many
attacks seem to be of this untargeted, mass-attack style, so recognizing
and flagging failed attempts may help administrators put a stop to the attacks.
</p>

<p>
Nossum suggested adding an <tt>exploit()</tt> annotation to the fixes for
specific kinds 
of now-closed security holes. 
For example, in <tt>sock_alloc_send_pskb()</tt> from
<tt>net/core/sock.c</tt>:
<pre>
    if (npages &gt; MAX_SKB_FRAGS) {
        exploit("CVE-2012-2136");
        goto failure;
    }
</pre>
<p>
 In suitably configured kernels, that would put
out a rate-limited message to the system logs noting a "possible exploit
attempt". But, he said, the annotations should not be for all bugs, nor
should they have an unlimited lifespan:
<div class="BigQuote">
I propose limiting the annotation of known exploits to the most serious
type of exploit, namely where the attacker otherwise silently gains
root/elevated capabilities. For sure, there is little point in calling
exploit() where an older kernel would just panic or OOM.
<p>
I also propose to keep each exploit() annotation around for only ~5 years
after the bug was discovered/fixed. This will allow us to catch most of the
intrusion attempts while still not littering the kernel code forever.
</div>
</p>

<p>
The reaction has largely been positive, though there were some concerns and
quibbles. 
Ted Ts'o <a href="/Articles/577478/">wondered</a> if malware writers would
just start checking kernel versions more carefully to avoid setting off the
alarms.  But Kees Cook is <a href="/Articles/577480/">not convinced</a>
that testing for kernel versions will be all that effective:
<div class="BigQuote">
 The reality of the situation is that the kernels running on an
end-user's system is rarely a stock upstream kernel. As a result, they
usually have organization-specific versioning, which makes
version-only autodetection useless to an attacker. While it is
possible to keep track of all distro versions in a massive table, even
the public exploits rarely do this, instead focusing on maybe one or
two distros. But when attacking systems with kernels built custom by
various organizations that don't publish their kernel trees, it
becomes impossible to rely on just the version. Given all the forks,
and stable vs mainline, and backported patches vs not, the version
tends to only give a gross ball-park idea. Probing is still useful to
an attacker, and this proposes reporting those probes.
</div>
</p>

<p>
Ts'o <a href="/Articles/577492/">disagreed</a>, as he believes the
landscape mostly consists of distribution kernels: "<q>testing for various distribution kernel
versions, as well as specific ChromeOS and Android kernel versions,
wouldn't be that difficult for an attacker, and would probably allow
them to avoid detection for 99% of the Linux systems found in the
wild</q>". 
Cook <a href="/Articles/577497/">noted</a> that careful attackers aren't
really the focus of this work.  He believes that there are a lot more custom
kernels installed than Ts'o does, but recognizes there is no real way to
know.  There are "<q>sloppy attackers</q>", though, who will probe
all kinds of kernels without doing any checks firstâ€”Nossum's patches would
potentially catch some of those.

<p>
Furthermore, Ts'o is skeptical that the enterprise
distributions will even build with the <tt>CONFIG_EXPLOIT_DETECTION</tt>
flag turned on.  The support burden for explaining false positives (and actual
attacks for that matter) might be rather high. While not speaking in any
official capacity, Jiri Kosina <a href="/Articles/577495/">said</a> that he
suspected SUSE would indeed turn off exploit detection to try to
"<q>maintain sanity of our support engineers</q>". 

<p>
Ryan Mallon is <a href="/Articles/577486/">worried</a> that attackers will
just clean out the logs as soon as they hit upon a successful attack. But Ingo
Molnar <a href="/Articles/577487/">pointed out</a> that many sites do not
rely on log files on the local disk, but instead use the network or
append-only media to protect their logs.
</p>

<p>
The logistics of adding the annotations as well as maintaining them going
forward was another area of concern.  Cook volunteered to help add
annotations, but wanted to make sure that he wasn't the only one doing so.
Dave Jones <a href="/Articles/577504/">wondered</a> about tests to ensure
the triggers are still firing correctly when code around them changes.
James Morris is also <a href="/Articles/577505/">concerned</a> about the
long-term maintenance of the triggers.  He is not at all sure that the feature
belongs in the mainline "<q>without at least first being proven in the 
field</q>". 
</p>

<p>
Adding tests could also help ensure that a vulnerability doesn't get
reintroduced, which is something that has happened several times in the
past, as  Molnar <a href="/Articles/577594/">pointed out</a>.  In addition,
he said, annotating earlier bugs will help alert kernel developers to "<q>'hotspot' areas in the
   kernel that tend to attract more bugs than others</q>".  The
   annotations will also help point out dangerous patterns in the code. 

<p>
Nossum has been <a href="/Articles/577547/">maintaining</a> the patch set
for around six months at this point.  It consists of two base patches, one
that adds 
the <tt>exploit()</tt> call and another to hook it into the audit
subsystem, and then seven patches to add annotations for CVEs from the past
two years.  The latter patches are largely "<q>one-liners in the error
path of a specific input validation check</q>". He doesn't believe there
is much of a maintenance burden for the triggers and plans to maintain a public
git repository with the patches going forward.
</p>

<p>
Linus Torvalds was <a href="/Articles/577551/">generally in favor</a> of
the idea: "<q>I think that it's a good idea to at least have
the option to complain about certain errors, and leave markers in the
logs about things that look suspicious.</q>"  But he doesn't want to see
annotations added for random CVEs, just those that are actually being used
by rootkits or other malware.  Cook and Nossum both seem to be on the same
page with Torvalds; that only "<q>serious privilege escalation
issues</q>" (in Cook's <a href="/Articles/577557/">words</a>) get annotated.
</p>

<p>
While it may not catch that many attackers, catching even one is clearly
better than none.  Given that the patch is lightweight, and has a low
maintenance burden, it wouldn't be a surprise to see it get added to the
mainline before too long.  As Molnar suggested, for more security-sensitive
installations, 
<tt>exploit()</tt> could be turned 
into a more active 
deterrent that freezes all tasks being run by the suspected UID.  It could
certainly be a useful tool in the ever-escalating battle between
administrators and 
attackers. 
</p><br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Security-Security_technologies">Security/Security technologies</a></td></tr>
            <tr><td><a href="/Security/Index/">Security</a></td><td><a href="/Security/Index/#Linux_kernel">Linux kernel</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/577432/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor577624"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 18, 2013 23:56 UTC (Wed)
                               by <b>spender</b> (guest, #23067)
                              [<a href="/Articles/577624/">Link</a>] (19 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There's a 100% chance that if this were merged, some distro will compile in support for it despite it being useless.  Yet another in a line of features designed to provide the illusion of security.<br>
<p>
It is already trivially circumvented via a single function usable by any other exploit, present in enlightenment:<br>
<a href="http://grsecurity.net/~spender/exploits/enlightenment.tgz">http://grsecurity.net/~spender/exploits/enlightenment.tgz</a><br>
<p>
But it's cute that discussion continues while those involved are completely oblivious to its futility.<br>
<p>
-Brad<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577624/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577630"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 0:49 UTC (Thu)
                               by <b>ncm</b> (guest, #165)
                              [<a href="/Articles/577630/">Link</a>] (14 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Boldly demonstrating my ignorance... is this comment meant to suggest that there is no need for an attacker to risk possibly-fixed security holes when a variety of holes known not to be fixed is available in a convenient tarball from Brad?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577630/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577632"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 0:58 UTC (Thu)
                               by <b>spender</b> (guest, #23067)
                              [<a href="/Articles/577632/">Link</a>] (13 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Not at all correct -- that would be completely irrelevant to the topic at hand since it has nothing to do with 0-days (nevermind that some involved in the discussion threw the term around incorrectly).<br>
<p>
Reading the code would be more instructive: cve_chicken_out() in exploit.c<br>
<p>
-Brad<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577632/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577635"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 1:27 UTC (Thu)
                               by <b>ncm</b> (guest, #165)
                              [<a href="/Articles/577635/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Demonstrating again my ignorance, this seems easily defeated by "chmod 0 /boot/vmlinuz*", perhaps along with similar work in /lib/modules.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577635/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577638"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 1:34 UTC (Thu)
                               by <b>spender</b> (guest, #23067)
                              [<a href="/Articles/577638/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
For distro kernels that are easily available on the Internet? (this is why it allows fallback to a vmlinuz in the current directory)<br>
<p>
-Brad<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577638/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577664"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 8:10 UTC (Thu)
                               by <b>ncm</b> (guest, #165)
                              [<a href="/Articles/577664/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
So the real workaround you propose is to determine the distro and kernel version and then check the intended exploits against it before attacking the real kernel.  Maybe you use a table of all the likely kernel versions and their well-documented (in-)vulnerabilities.<br>
<p>
Suppose, then, that in addition to making /boot and /lib/modules inaccessible, uname() is made to lie or be otherwise uninformative.  Are you left with any alternative than to try out your catalog of exploits?  If you try the newest one first, the kernel under attack might not have that fault inserted yet.  If it fails, you have not exposed yourself, but you still have to try the older ones, and risk exposure.  Or maybe any EINVALID return is logged, with the PC where it was noted, so the first try exposes you anyway.<br>
<p>
Maybe you restrict yourself to faults that have always been there, and only recently patched, if at all.  Then, either you get in silently, or you trip the alarm.  This still seems better than being able to try out your whole catalog without worry of being noticed.  No doubt I'm still missing something crucial.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577664/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577706"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 12:35 UTC (Thu)
                               by <b>spender</b> (guest, #23067)
                              [<a href="/Articles/577706/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I gave you the exact file and function to look at, and it's clear you haven't even done that, so this will be my last post in this thread.  You don't want to learn, you want validation that you could somehow wrap this turd of a feature with the appropriate metal lining to make it useful.  It's just not going to happen.<br>
<p>
What you propose (which is also what Ingo proposed) will not prevent invisible detection of the vulnerable kernel.  I have *many* other methods I can use even in the event everything you mention is implemented.<br>
<p>
This is my promise: if any form of this security theater makes its way upstream and into any distro, I will write any code necessary to expose it for what it is.<br>
<p>
-Brad<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577706/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor577741"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 16:06 UTC (Thu)
                               by <b>dgm</b> (subscriber, #49227)
                              [<a href="/Articles/577741/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; So the real workaround you propose is to determine the distro and kernel version and then check the intended exploits against it</font><br>
<p>
Spender's code shows that it's actually easy to look for signs of fixes in the kernel image before trying any exploit, thus defeating the detection scheme. <br>
<p>
This could be prevented by making the kernel image unreadable except for root, and in case of using SELinux, only for the bootloader tools.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577741/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577803"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 20, 2013 4:03 UTC (Fri)
                               by <b>shmget</b> (guest, #58347)
                              [<a href="/Articles/577803/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
or the good old gentoo way of not leaving /boot mounted. ?<br>
to mount /boot you need to be root.. and if you are root already what's the point....<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577803/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor578046"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 24, 2013 6:18 UTC (Tue)
                               by <b>drag</b> (guest, #31333)
                              [<a href="/Articles/578046/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I am sure that there are other ways to determine what version of he Linux kernel that is running. <br>
<p>
'uname -a' comes to mind. <br>
<p>
This 'threat detection' is just one of those things that, if you are lucky, can be used to detect some old hack a script kiddie may try on your computer as they just randomly try different things. But any threat beyond the most trivial it would quickly become completely worthless.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/578046/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor578049"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 24, 2013 9:22 UTC (Tue)
                               by <b>dgm</b> (subscriber, #49227)
                              [<a href="/Articles/578049/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The question is what percentage of the threats a Real World box is exposed to is "trivial". This is not a tool to make the OS invulnerable, but to improve the bottom-line.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/578049/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor577662"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 7:17 UTC (Thu)
                               by <b>josh</b> (subscriber, #17465)
                              [<a href="/Articles/577662/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You might want to add support for non-gzipped kernels, but yeah, it does look about that simple.<br>
<p>
The obvious workaround would be to not put the CVE number in the kernel, but to instead just print "exploit attempt detected at $file:$line" and let it be decoded later.  Still easily worked around if you're targeting a particular distro kernel, but if you're targeting a *particular* distro kernel anyway then you could just know which exploits to run against it.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577662/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577704"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 12:19 UTC (Thu)
                               by <b>spender</b> (guest, #23067)
                              [<a href="/Articles/577704/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Some trivial static analysis (the likes of which I already do in enlightenment for other purposes) will defeat that "workaround" easily.  Obviously I'm not going to waste time writing code for every possible change that could be made to the "feature" but the fact remains that there's no asymmetry of information here.  Whatever eventually gets merged will be known to all and defeated.  I guarantee it.<br>
<p>
It's clear to me many people want more than anything to believe that this feature will work, regardless of any facts.<br>
<p>
-Brad<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577704/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577721"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 14:32 UTC (Thu)
                               by <b>josh</b> (subscriber, #17465)
                              [<a href="/Articles/577721/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Some trivial static analysis (the likes of which I already do in enlightenment for other purposes) will defeat that "workaround" easily.</font><br>
<p>
I'd be curious what kind of static analysis you have in mind.<br>
<p>
<font class="QuotedText">&gt; It's clear to me many people want more than anything to believe that this feature will work</font><br>
<p>
I don't think anyone believes this mechanism will stop or detect sophisticated attacks.  The question remains: will it detect some subset of unsophisticated attacks, enough to make it worth including, or not?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577721/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor578047"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 24, 2013 6:30 UTC (Tue)
                               by <b>drag</b> (guest, #31333)
                              [<a href="/Articles/578047/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;  The question remains: will it detect some subset of unsophisticated attacks, enough to make it worth including, or not?</font><br>
<p>
The social aspect of it is the problem. <br>
<p>
Sure the kernel implementing features like this may succeed at detecting ham-fisted attacks, but the problem you run into is that people will naturally assume that this security feature has merit and will unfortunately actually try to depend on it.<br>
<p>
People will write blog posts on how critically important it is to make sure you use a kernel version with this detection enabled in it and so on and so forth. It'll end up in Google's cache when people search 'make sure Linux is secure' or such things and then it'll just get increasingly stupid and self-defeating from then on.<br>
<p>
You can see the same thing happen all over the place with various 'linux security features'. <br>
<p>
A perfect example of this is things like 'chkrootkit'. People may end up with a hacked website and then install chkrootkit and run it thinking that somehow it will actually be effective at detecting root kits, which it is not.  Or schemes that involve checking file checksums using 'rpm' utility. Or things like 'fail2ban' being used to 'secure' ssh, or port knocking, or any other number of silly and hokum things that people try to do to 'improve' their security. <br>
<p>
Like anti-virus in Windows there is a actual limited useful application for some of this stuff, but most people are not able to know what that is. <br>
<p>
Software security is already hard enough without creating features that add to the confusion with no real benefit.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/578047/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor577722"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 14:39 UTC (Thu)
                               by <b>vegard</b> (subscriber, #52330)
                              [<a href="/Articles/577722/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Hi Brad,<br>
<p>
I'm really grateful that we have people like yourself who are both competent and view security with a critical eye. Your feedback is appreciated. Keep up the good work!<br>
<p>
<p>
Vegard<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577722/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor577795"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 20, 2013 0:57 UTC (Fri)
                               by <b>tialaramex</b> (subscriber, #21167)
                              [<a href="/Articles/577795/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
"despite it being useless"<br>
<p>
Like dusting for prints is useless, because criminals all wear gloves, right? Like it's pointless to own a burglar alarm because any "real" burglar would know how to disable it, right? You're actually making the same mistake the people you don't like usually make, assuming perfection where it's unwarranted.<br>
<p>
Ordinarily it's the good guys who have to be perfect. One missed special case and you're exploitable. But in this sort of situation the roles are reversed, one slip by the bad guys and the alarms go off. _Everything_ they try has to be properly insulated so that it can't trigger this sort of alarm, because if just one thing isn't, and the relevant alarm is installed, game over.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577795/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577796"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 20, 2013 1:54 UTC (Fri)
                               by <b>PaXTeam</b> (guest, #24616)
                              [<a href="/Articles/577796/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
i'm not entirely sure whether you grasped the proposed feature and spender's criticism (the perfection strawman and silly real life non-examples indicate otherwise) but here it is in a nutshell:<br>
<p>
detecting and reacting to incidents is a useful thing (grsec has been probably doing it for longer and more efficiently than most) but this feature will not achieve anything, not just because there're so many ways to know when a kernel is equipped with it or because the potential for false positives, but also because in real life nobody reacts to logs on systems where script kiddies are considered an actual threat (these are the lowest value systems, cf. the kernel.org compromise whose dmesg with the sign of a backdoor laid in public for weeks before anyone figured out that something wasn't right with it). and where they're not a threat, the remaining attackers are sophisticated enough to use 0-day to begin with (many of which the mechanisms in grsec will handle unlike the proposed feature).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577796/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577818"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 20, 2013 10:52 UTC (Fri)
                               by <b>tialaramex</b> (subscriber, #21167)
                              [<a href="/Articles/577818/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The issue of ignoring alarms is a far more widespread one than can be covered in this thread, or indeed LWN at all.<br>
<p>
In the maritime industry almost every other accident report will involve alarms that were disabled, non-functional, or ignored. In other transport industries it's less bad, but e.g. a London Underground driver overrode or disabled all the safety alarms in his train and was only alerted to the fact that he'd driven out of a station with the doors still open by the screaming of passengers. They couldn't alert him using the provided passenger alarm because he'd switched that off too.<br>
<p>
Teaching people to investigate alarms rather than ignore them, and to test and maintain alarm systems so that they have confidence that the alarms reported are real is a bunch of work, but it's not impossible.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577818/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor578048"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 24, 2013 6:34 UTC (Tue)
                               by <b>drag</b> (guest, #31333)
                              [<a href="/Articles/578048/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The most critical step in that is to have alarms that are actually meaningful and functional.<br>
<p>
In most of those cases you mentioned you'd find that those alarms were disabled because they had so many false positives.  A alarm that goes off once because a train left it's doors open is useless when it also goes off a thousand times when the doors are actually closed.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/578048/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor577629"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 1:07 UTC (Thu)
                               by <b>gerdesj</b> (subscriber, #5446)
                              [<a href="/Articles/577629/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This is very well intentioned (and I'm thankful that someone is thinking laterally) but I think it is not the right way.<br>
<p>
The kernel should restrict itself with doing kernel related stuff - doing complicated things to and with my hardware.  It should not try and be an IDS.  <br>
<p>
For IDS I would like my perfect kernel to provide access, in a reasonably safe way, to a wealth of information about what is happening in there.<br>
<p>
As far as I can tell (as a non KDev) it does that rather well already and getting better as are the u/s tools. <br>
<p>
If I want to somehow attach a form of Ksnort/KclamAV or whatever to the kernel then I will (I wont - it's daft) but I'm not convinced that you will do it better (but your's will be far cooler and bloody quick).<br>
<p>
KDevs - please continue doing what you do remarkably well - we sysadmins will err... try and keep up.<br>
<p>
I keep re-reading the article and also note the list of names of people I respect in there but I can't help but think that this is not a good approach to securing the Linux kernel - what am I missing?<br>
<p>
Cheers<br>
Jon<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577629/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577634"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">ooo look ... me .. yes: me</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 1:27 UTC (Thu)
                               by <b>gerdesj</b> (subscriber, #5446)
                              [<a href="/Articles/577634/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Got it at last.<br>
<p>
Kernel devs: Do your best at making the bestest, fastest, safest and most featureful kernel you can.<br>
<p>
Me (sysadmin): Keep an eye out for vulnerabilities.  Notify the kernel devs accordingly.<br>
<p>
That'll do pig.<br>
<p>
Cheers<br>
Jon<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577634/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor577636"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 1:28 UTC (Thu)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/577636/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This isn't a way to secure the kernel as much as a way to have it act as a honypot if a problem that's been fixed gets triggered.<br>
<p>
There is currently no way to detect that this sort of thing is taking place, and short of logging every syscall, it's just not possible without explicit support like this.<br>
<p>
As long as the maintinance of this is not a burden, I don't see a problem with this (done sanely, rate limited with decent log messages)<br>
<p>
you already have the kernel logging a lot of things, this is just a little more to go into the logs that you can either ignore or take advantage of.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577636/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor577642"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 2:23 UTC (Thu)
                               by <b>PaulWay</b> (subscriber, #45600)
                              [<a href="/Articles/577642/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
As I see it, this makes sense for sysadmins who:<br>
<p>
 * use kernels with the CONFIG_EXPLOIT_DETECTION turned on (either rolling their own or using a distro's enabled kernel)<br>
 * have systems that are likely to be probed by script-kiddies<br>
 * want to know if they're being probed<br>
 * watch their logs<br>
<p>
Now, that isn't everyone - but it's a lot of people, including me.  Even if I discover the probing after the fact, there's a good chance that the script-kiddie won't clean the logs, so I can then shut the system down and restore from a good backup.<br>
<p>
So I for one think this a good idea.<br>
<p>
Have fun,<br>
<p>
Paul<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577642/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577659"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 6:14 UTC (Thu)
                               by <b>wahern</b> (subscriber, #37304)
                              [<a href="/Articles/577659/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Script kiddies, by definition, don't need to worry about cleaning the logs. That's what their scripts are for. If the scripts don't do it now, they will. Script kiddies do the minimum possible. If you raise the bar, there's no reason to believe that it slows them down one iota.<br>
<p>
Adding any security which can be easily circumvented is no security at all. All it takes is one person to write the circumvention code and to share it.<br>
<p>
There are people doing the thankless job of actually preemptively scanning the code for vulnerabilities and fixing them. Those guys are priceless. Why they keep doing it when all the fame and adulation goes to this kind of stuff, port knocking, and other crazy schemes.... well, I wish their commitment could spread the same way interest in these schemes do.<br>
<p>
These schemes only work as long as they're not widely adopted. Once they're widely adopted, they get added into the kiddie scripts. Then you're left with a bunch of useless code which only adds to your attack surface.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577659/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577661"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 7:11 UTC (Thu)
                               by <b>noxxi</b> (subscriber, #4994)
                              [<a href="/Articles/577661/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
From my understanding the code is not to fight new exploits, but to detect if a known and fixed exploit was tried. And because the exploit was fixed the script kiddie will have no way to clean the logs (unless it has another and better exploit). <br>
Thus the log entry can be used as a canary by the admin to detect if an account might be compromised and lock it down before worse exploits will be tried.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577661/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577668"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 7:50 UTC (Thu)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/577668/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
the better shops also ship their logs off of the local systems so that attempts to scrub the logs will fail.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577668/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577685"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 9:36 UTC (Thu)
                               by <b>zlynx</b> (guest, #2285)
                              [<a href="/Articles/577685/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
A really well informed attacker can try to jam the log server with nonsense UDP or TCP resets. He'd need access to the log server network of course.<br>
<p>
If he can DOS the log server, it won't record anything except a pile of junk. Once he gets root he can kill -9 the log service, clean the logs and restart it.<br>
<p>
Just another thing to watch out for.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577685/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577765"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 16:30 UTC (Thu)
                               by <b>Funcan</b> (subscriber, #44209)
                              [<a href="/Articles/577765/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
A sufficiently advanced attacked can also break in and steal the log server. I doubt most people are facing that level of APT most of the time though...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577765/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor577686"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 9:34 UTC (Thu)
                               by <b>Trou.fr</b> (subscriber, #26289)
                              [<a href="/Articles/577686/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This is so stupid. I rather wish the kernel developers spend the time lost on actually improving the kernel security.<br>
I find it baffling that even security-minded people like Kees Cook support the idea.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577686/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577705"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 12:44 UTC (Thu)
                               by <b>iq-0</b> (subscriber, #36655)
                              [<a href="/Articles/577705/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You seem to suggest that not doing this would change the focus of said kernel developers to do more kernel security improvements. That is rather wishful thinking, they would do something different but not necessarily that.<br>
<p>
The idea itself is also not bad. It's the equivalent of doing authentication attempt logging and detecting possible attacks. Does it increase security? No. Does it tell you there might be something going on? Yes. Can attackers circumvent those checks? Yes. Does that make them less valuable? No, the attackers have to take more precautions, take more actions which might be detected or risk tripping an alarm.<br>
<p>
An analogy would be to install a video cameras in your house. Any burglar could easily either circumvent them, disable them or ignore them and afterwards erase the tapes. But it makes live more difficult for them (even if slightly), might deter them to look for easier targets or increase the chance of detection because of all the steps involved. And there is a good chance some are not that diligent and get caught in the act.<br>
<p>
You can never assume to be secure, you can only try and hope that it's as uneconomically possible for others to abuse the weaknesses.<br>
But often it's just as important to just know somebody might have (tried) to do that, so you can take appropriate measures to minimize possible (indirect) damage.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577705/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577792"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 23:16 UTC (Thu)
                               by <b>Trou.fr</b> (subscriber, #26289)
                              [<a href="/Articles/577792/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I perfectly understand the reasoning. But I think this is quite representative of the current mindset of developpers regarding security : no consideration for effective measure and it sometimes seems no consideration for actual security.<br>
<p>
The single "recent" feature which led to actual security improvements in the kernel I can think of is seccomp-bpf, which is a brilliant and very efficient idea.<br>
<p>
As you said, developpers would probably turn their attention to something else entirely. If only some grsec features could be included in the kernel.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577792/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor578092"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 25, 2013 23:02 UTC (Wed)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/578092/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>
If only some grsec features could be included in the kernel.
</blockquote>
That seems unlikely to happen while the grsec people remain incapable of working with other people or taking criticism of any kind without blowing up like two-year-olds. (Apologies to my two-year-old niece, who blows up very rarely and is usually quite charming and sweet.)

      
          <div class="CommentReplyButton">
            <form action="/Articles/578092/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor578096"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 25, 2013 23:56 UTC (Wed)
                               by <b>PaXTeam</b> (guest, #24616)
                              [<a href="/Articles/578096/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
did you move to the southern hemisphere recently? i can't think of many other places where it's hayfever season. keep up the nonsense and spender and i wish you a merry christmas (try without the drugs though).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/578096/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor578111"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 26, 2013 22:22 UTC (Thu)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/578111/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
... aand my point is proved. I'd rather bite my own nose off than work with people this nasty.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/578111/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor577842"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 20, 2013 15:10 UTC (Fri)
                               by <b>roblucid</b> (guest, #48964)
                              [<a href="/Articles/577842/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I don't understand your objections, it's a fallacy to suppose that the guy who maintains this patch set, would necessary be capable of solving unknown kernel issues.<br>
<p>
Reading logs manually is way too slow, so good sysadmins generate alarms filtering for where action may be required.<br>
<p>
It might not be only Internet facing boxes, where for example remote or local root exploit attempts might be of interest.  Engineers &amp; other employees to get curious and try things, sometimes things they really are not supposed to.  Just because the most clueful and careful attacker won't trip something doesn't mean a measure is useless.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577842/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor577748"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 16:25 UTC (Thu)
                               by <b>tshow</b> (subscriber, #6411)
                              [<a href="/Articles/577748/">Link</a>] (11 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It seems to me that rather than just sending something to syslog, this would be more useful if it could feed into userspace hooks and things like firewall rules. If I could rig exploit() to:<br>
<p>
if(user is nonlocal)<br>
{<br>
  log them out &amp; lock the account<br>
  add their IP to the ban list<br>
  send the admin a "user tried exploit" message<br>
}<br>
<p>
I could see that being useful. Obviously there's potential pitfalls (people boobytrapping each other, or managing to get daemons kickbanned if the system isn't smart enough), but a tripwire hooked to a nuke can be a useful line in a layered defense.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577748/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577774"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 18:09 UTC (Thu)
                               by <b>RobSeace</b> (subscriber, #4435)
                              [<a href="/Articles/577774/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Sounds like something better suited to a userspace daemon parsing the kernel log messages and acting on them...  Sort of like "Denyhosts" does now with failed SSH logins...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577774/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577780"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 20:35 UTC (Thu)
                               by <b>tshow</b> (subscriber, #6411)
                              [<a href="/Articles/577780/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That's what I'm implying; it would be nice if this could export via some sort of file descriptor through which you could feed a userspace daemon, rather than shuffling stuff off to the logger. Logging is great, but if there's an exploit attempt I want to deal with it now, not after something gets done parsing the logs.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577780/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577781"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2013 20:45 UTC (Thu)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/577781/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
you can feed it to your userspace daemon through syslog pretty darn fast, how fast do you think it needs to be acted on? and are you talking about an automated action or a manual action? if it's a manual action, the time taken to get a human's attention is FAR longer than the delay that syslog will introduce.<br>
<p>
In addition, I'm not sure this is something you want to jump on every time (that the reason for rate limiting the alerts), you may just get flooded with alerts.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577781/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577844"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 20, 2013 16:21 UTC (Fri)
                               by <b>tshow</b> (subscriber, #6411)
                              [<a href="/Articles/577844/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'd want it for automated response, with a subsequent notification to the admin that the automated response has been made.<br>
<p>
If someone is script kiddying their way through a series of exploits to see what sticks, I want the userspace daemon to be able to log them out and ban their IP (and possibly lock their account) *now*, this microsecond, before they get a chance to try the next one. Yes, that does imply potential scheduling hackery to get the data out the exploit alert pipe to the userspace daemon before control is allowed to return to the offending process.<br>
<p>
In theory you'd only get flooded with alerts if the system was flooded with exploit attempts. You'd probably want to know if that was happening, but rate limiting could be done in the userspace daemon.<br>
<p>
I think you'd want to be able to differentiate between local and remote exploits; if someone logged in is trying an exploit it's a very different kettle of fish from someone trying a remote exploit against the external interface.<br>
<p>
Feeding the userspace daemon through syslog is kind of silly; a dedicated pipe the daemon could connect to would be better. Avoiding syslog as a transport means:<br>
<p>
- being able to specify a consistent communication protocol<br>
- possibly being able to avoid parsing entirely, but at the least the protocol can be designed to make the parsing trivial<br>
- not needing to worry about some other syslog output source being tricked into spoofing valid-looking but manufactured exploit logs<br>
- the daemon being able to sleep on data availability in the pipe rather than having to constantly chew on syslog and spit out the (1 - epsilon) it doesn't need, so the daemon will mostly just be asleep until its needed<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577844/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor577900"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 20, 2013 18:47 UTC (Fri)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/577900/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; I'd want it for automated response, with a subsequent notification to the admin that the automated response has been made.</font><br>
<p>
There are a whole lot more tools available to do the alerting based on syslog message than there are going to be if you invent a new protocol.<br>
<p>
<font class="QuotedText">&gt; If someone is script kiddying their way through a series of exploits to see what sticks, I want the userspace daemon to be able to log them out and ban their IP (and possibly lock their account) *now*, this microsecond, before they get a chance to try the next one. Yes, that does imply potential scheduling hackery to get the data out the exploit alert pipe to the userspace daemon before control is allowed to return to the offending process.</font><br>
<p>
This requires much more significant changes, and really is going to require that you put your response code into the kernel inside the detection routine.<br>
<p>
<font class="QuotedText">&gt; In theory you'd only get flooded with alerts if the system was flooded with exploit attempts. You'd probably want to know if that was happening, but rate limiting could be done in the userspace daemon.</font><br>
<p>
given that the effort involved in generating the log compared to the action that triggers the log, not having this be rate limited would result in a very good DOS vector.<br>
<p>
<font class="QuotedText">&gt; Feeding the userspace daemon through syslog is kind of silly; a dedicated pipe the daemon could connect to would be better. Avoiding syslog as a transport means:</font><br>
<p>
<font class="QuotedText">&gt; - being able to specify a consistent communication protocol</font><br>
<p>
why can't you use a consistent protocol in your syslog message?<br>
<p>
<font class="QuotedText">&gt; - possibly being able to avoid parsing entirely, but at the least the protocol can be designed to make the parsing trivial</font><br>
<p>
you can make the parsing trivial in syslog as well<br>
<p>
<font class="QuotedText">&gt; - not needing to worry about some other syslog output source being tricked into spoofing valid-looking but manufactured exploit logs</font><br>
<p>
you can do this inside syslog with filters today (only send to this output if the source is the kernel and the message contains blah)<br>
<p>
<font class="QuotedText">&gt; - the daemon being able to sleep on data availability in the pipe rather than having to constantly chew on syslog and spit out the (1 - epsilon) it doesn't need, so the daemon will mostly just be asleep until its needed</font><br>
<p>
again, with filtering in syslog, your userspace daemon can do this today.<br>
<p>
And as I noted up at the top, there are a lot more alerting engines around that understand syslog than ones that will understand your new protocol.<br>
<p>
Any significant company is already going to have an alerting tool in place, it's far better to integrate with that than to require a new tool be written.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/577900/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor578182"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 29, 2013 8:06 UTC (Sun)
                               by <b>lamawithonel</b> (subscriber, #86149)
                              [<a href="/Articles/578182/">Link</a>] 
      </p>
      
      </div>
      </summary>
      this patch set uses the audit framework without any rate limiting, and in the somewhat more structured audit format.  that sounds like what you want.

<pre>
+ audit_log_format(ab, "exploit id=%s pid=%u uid=%u auid=%u ses=%u comm=",
+                  id, pid, uid,
+                  from_kuid(&amp;init_user_ns, audit_get_loginuid(task)),
+                  audit_get_sessionid(task));
</pre>
      
          <div class="CommentReplyButton">
            <form action="/Articles/578182/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor578093"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 25, 2013 23:03 UTC (Wed)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/578093/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The problem with that sort of thing is that as soon as it becomes popular enough that attackers can speculate that you might be running it (which is not very popular at all), it suddenly becomes a wonderful DoS tool.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/578093/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor579257"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jan 6, 2014 3:03 UTC (Mon)
                               by <b>speedster1</b> (guest, #8143)
                              [<a href="/Articles/579257/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; The problem with that sort of thing is that as soon as it becomes popular enough that attackers can speculate that you might be running it (which is not very popular at all), it suddenly becomes a wonderful DoS tool.</font><br>
<p>
There shouldn't be much DoS potential for script kiddies to abuse if there were a reliable mechanism for automatic account-locking like tshow wanted. <br>
<p>
On the other hand, count me among those who predict this feature will quickly become worked-around by all the popular exploit kits -- at least on any systems lacking admins who are big enough on security to be running custom kernels with generic uname info. Those admins who do tweak their uname and hide /boot /lib/modules are probably not the ones who the kernel devs need to worry about protecting from script kiddies (their custom kernels probably include grsecurity...)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/579257/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor579283"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jan 6, 2014 13:22 UTC (Mon)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/579283/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Locking an account *is* a DoS for the account's legitimate owner.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/579283/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor579385"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jan 7, 2014 2:59 UTC (Tue)
                               by <b>speedster1</b> (guest, #8143)
                              [<a href="/Articles/579385/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That makes no sense to me, perhaps you can explain more... are these DoS victims naive users who are running random things that script kiddies left for them? Or a daemon which has been tricked into running evil code? Either way, if a script kiddie gets to run stuff from an account, that account has been compromised and deserves to be locked out until it can be cleaned up. Maybe instead you are thinking of a way to lock out a non-compromised account with this feature?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/579385/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor579617"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Known-exploit detection for the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jan 8, 2014 16:38 UTC (Wed)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/579617/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Imagine that someone has found a way to exploit, say, procmail, or some other daemon run on the user's behalf that accepts code from the network and is ultimately invoked from the network.<br>
<p>
The right thing to do in that situation is probably to halt mail delivery and just queue everything -- but your proposal would lock the entire account. An attacker that can determine what accounts exist (perhaps via said exploit) could then DoS-attack the entire system trivially.<br>
<p>
(But, of course, if they can execute arbitrary code as one user they can probably do that anyway, in about a million ways, and probably get root too. So perhaps my concerns are unjustified. It might well elevate a failed breakin, via an exploit that doesn't actually work, to a partial DoS, but I'm finding it hard to be too worried about that.)<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/579617/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2013, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
