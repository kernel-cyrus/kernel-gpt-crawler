        <!DOCTYPE html>
        <html lang="en">
        <head><title>The rest of the 5.2 merge window [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/788532/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/788677/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/788532/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>The rest of the 5.2 merge window</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Benefits for LWN subscribers</b>
<p>
The primary benefit from <a href="/Promo/nst-nag5/subscribe">subscribing to LWN</a>
       is helping to keep us publishing, but, beyond that, subscribers get
       immediate access to all site content and access to a number of extra
       site features.  Please sign up today!
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>May 20, 2019</br>
           </div>
By the time Linus Torvalds released the <a href="/Articles/788857/">5.2-rc1 kernel
prepatch</a> and closed the 
merge window for this development cycle, 12,064 non-merge changesets
had been pulled into the mainline repository — about 3,700 since <a
href="/Articles/787963/">our summary of the first "half"</a> was written.  Thus, as
predicted, the rate of change did slow during the latter part of the merge
window.  That does not mean that no significant changes have been merged,
though; read on for a summary of what else has been merged for 5.2.
<p>

<h4>Architecture-specific</h4>
<p>
<ul class="spacylist">

<li> The PowerPC architecture can now take advantage of hardware support to
     prevent the kernel from accessing user-space data in unintended ways.
<li> 32-Bit PowerPC now has support for <a href="/Articles/612153/">KASAN</a>.
<li> Mitigations for the Intel microarchitectural data sampling
     vulnerabilities have been merged.  See <a
     href="https://www.kernel.org/doc/html/latest/x86/mds.html#mds">this
     page from the kernel documentation</a> for a fairly detailed
     description of the problem, and <a
     href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/mds.html">this
     page</a> for mitigation information.
</ul>

<h4>Core kernel</h4>
<p>
<ul class="spacylist">

<li> There is finally a freezer for the control-group version-2
     implementation.  It differs from the v1 freezer in that it puts each
     affected process into a stopped state rather than an uninterruptible
     sleep; that allows those processes to be operated on (killed, traced,
     moved to another group) while the group is frozen.  See <a
     href="https://git.kernel.org/linus/afe471ea2d6f">this commit</a> for
     the documentation update.
<li> The new <tt>vm.unprivileged_userfaultfd</tt> sysctl knob controls
     whether unprivileged users can use the <a
     href="http://man7.org/linux/man-pages/man2/userfaultfd.2.html"><tt>userfaultfd()</tt></a>
     system call.  The default is to allow unprivileged access (which is
     consistent with current kernels).
<li> <a href="/Articles/775971/">Pressure stall monitors</a>, which allow
     user space to detect and respond quickly to memory pressure, have been
     added.  See <a href="https://git.kernel.org/linus/0e94682b73bf">this
     commit</a> for documentation and a sample program.
<li> The tracing subsystem exports a new virtual file,
     <tt>tracing/error_log</tt>, where the more complex tracing operations
     can place error messages when things go wrong.
<li> The <tt>/proc/slab_allocators</tt> file turned out to have yet another
     set of bugs.  Since it clearly hasn't worked correctly for years and
     nobody has complained, this file has been removed.

</ul>

<p>
<h4>Filesystems and block layer</h4>
<p>
<ul class="spacylist">

<li> The handling of soft mounts in NFS v4.0 has been improved, with more
     accurate timeout handling, faster failover, and a new <tt>softerr</tt>
     mount option that can change the error code for timed-out operations
     to <tt>ETIMEDOUT</tt>.
<li> The old <tt>nfsdcld</tt> (NFS client-tracking daemon) API has been
     resurrected as a way of allowing NFS servers to properly track client
     state over a reboot.  If a daemon is running, it takes over the role of
     the <a
     href="http://man7.org/linux/man-pages/man8/nfsdcltrack.8.html"><tt>nfsdcltrack</tt>
     helper</a>; the intent is to create a solution that works better in a
     namespaced environment.
<li> There is a new device-mapper target called <tt>dm-dust</tt>; it can be
     used to simulate bad blocks in the underlying device.  See <a
     href="/Articles/788791/">Documentation/device-mapper/dm-dust.txt</a>
     for details.
</ul>

<P>
<h4>Hardware support</h4>
<p>
<ul class="spacylist">

<li> <b>Clock</b>:
     ASPEED realtime clocks,
     MediaTek MT8183 and MT8516 clocks,
     Qualcomm QCS404 Turing clock controllers,
     Cirrus Logic Lochnagar clock controllers, and
     SiFive FU540 SoC power reset clock interfaces.
<li> <b>Input</b>:
     generic GPIO-controllable vibrators,
     Azoteq IQS550/572/525 trackpad/touchscreen controllers, and
     Microchip AT42QT1050 touch sensors.
<li> <b>Miscellaneous</b>:
     AMD MP2 PCIe I2C adapters,
     Marvell Armada 37xx rWTM BIU mailbox controllers,
     NXP i.MX TPM pulse-width modulators,
     Mellanox BlueField SoC GPIO controllers,
     ROHM BD70528 PMIC watchdog timers,
     NXP IMX SC watchdog timers,
     Maxim MAX77650/77651 power-management ICs,
     STMicroelectronics multi-function eXpanders,
     Ingenic JZ47xx SoCs battery monitors,
     Microchip UCS1002 USB port power controllers, and
     Xilinx ZynqMP FPGA managers.
</ul>

<p>
<h4>Internal kernel changes</h4>
<p>
<ul class="spacylist">

<li> The <a href="/Articles/784574/#fl"><tt>FOLL_LONGTERM</tt> flag</a>
     has been added to <tt>get_user_pages()</tt>; this is a part of the
     bigger effort to solve the problems with that interface and long-term
     mappings. 
<li> Two new functions have been added to ease the task of mapping kernel
     memory into a user-space address range.  <tt>vm_map_pages()</tt> and
     <tt>vm_map_pages_zero()</tt> will map a set of pages into a VMA; they
     differ in that the latter function ignores the <tt>vm_pgoff</tt>
     offset in the VMA.
<li> Code coverage analysis with <tt>gcov</tt> is now supported on
     Clang-compiled kernels.
<li> There have been significant changes to the implementation of
     <tt>vmalloc()</tt> that improve performance considerably; see <a
     href="https://git.kernel.org/linus/68ad4a330433">this commit</a> for
     details.
</ul>
<p>

Barring surprises (and there have not been many surprises in recent years), the
5.2 kernel will be released on July&nbsp;7 or&nbsp;14.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Releases-5.2">Releases/5.2</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/788532/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor788927"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The rest of the 5.2 merge window</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 20, 2019 18:15 UTC (Mon)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/788927/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I hope pressure stall monitors see some adoption. Conventional wisdom in userspace has always been “autodetect core count” for programs that have parallelism (and things like make -j`nproc`), but that number (multiplied by software bloat) is increasing far faster than memory can keep up. Compared to the care taken to not forkbomb users' machines, policies for using memory responsibly seem non-existent.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/788927/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor788979"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">vmalloc() improvement</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 21, 2019 7:23 UTC (Tue)
                               by <b>meuh</b> (guest, #22042)
                              [<a href="/Articles/788979/">Link</a>] 
      </p>
      
      </div>
      </summary>
      According to commit <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=68ad4a330433">68ad4a330433</a>:

<blockquote><pre>
# i5-3320M
&lt;default&gt;                vs   &lt;patched&gt;
real        101m22.813s        real  0m56.805s
user          0m0.011s         user  0m0.015s
sys           0m5.076s         sys   0m0.023s
</pre></blockquote>

That's an improvement !

Another example of <a href="https://accidentallyquadratic.tumblr.com/">accidentally quadratic</a> algorithm.

      
          <div class="CommentReplyButton">
            <form action="/Articles/788979/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2019, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
