        <!DOCTYPE html>
        <html lang="en">
        <head><title>The rest of the 5.15 merge window [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/868221/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/868746/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/868221/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>The rest of the 5.15 merge window</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Benefits for LWN subscribers</b>
<p>
The primary benefit from <a href="/Promo/nst-nag5/subscribe">subscribing to LWN</a>
       is helping to keep us publishing, but, beyond that, subscribers get
       immediate access to all site content and access to a number of extra
       site features.  Please sign up today!
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>September 13, 2021</br>
           </div>
Linus Torvalds <a href="/Articles/869030/">released 5.15-rc1</a> and closed
the merge window for 
this release on September&nbsp;12; at that point, 10,471 non-merge
changesets had found their way into the mainline repository.  Those
changesets contain a lot of significant changes and improvements.  Read on
for a summary of what came into the mainline in the roughly 7,000
changesets pulled since our <a href="/Articles/867821/">first-half
summary</a> was written.
<p>
<h4>Architecture-specific</h4>
<p>
<ul class="spacylist">

<li> As expected, <a href="/Articles/838339/">scheduling support</a> for
     asymmetric Arm systems has been merged.  See <a
     href="https://git.kernel.org/linus/702f43872665">this documentation
     patch</a> for details.
<li> Arm64 kernels can now be built as Hyper-V clients.
<li> The ARC architecture now supports three-level and four-level page
     tables; this is evidently a step toward the eventual support for 64-bit
     processors. 
</ul>


<p>
<h4>Core kernel</h4>
<p>
<ul class="spacylist">

<li> The <a href="/Articles/857148/"><tt>printk()</tt> indexing</a> patch
     set has been merged.  This feature allows the extraction of a list of
     all messages that can be emitted by <tt>printk()</tt>; user-space
     monitoring utilities can use this list to detect changes.
<li> Memory usage accounting for memory control groups has been extended to
     track 
     many more in-kernel data structures, including those created for
     polling, signal handling, namespaces, and more.  Some of those changes
     have since been reverted, though, due to the performance regression
     they caused.
<li> The memory-management subsystem has gained the ability to demote pages
     to a slower NUMA node in favor of reclaiming them entirely.  This
     mechanism can move less-used pages to nodes hosting nonvolatile
     memory, which is better than discarding them.  This is one piece of
     the tiered memory-management scheme described in <a
     href="/Articles/857133/">this article</a>.
<li> The <a href="/Articles/862707/#many">multi-preference memory
     policy</a> patch has been merged; it allows a process to request that
     memory pages be allocated on a given set of NUMA nodes.
<li> The new <a href="/Articles/864184/"><tt>process_mrelease()</tt> system
     call</a> allows a supervisor process to hasten the reclaim of memory
     from an exiting process.
<li> As described in <a href="/Articles/866493/">this article</a>, the code
     implementing the <tt>MAP_DENYWRITE</tt> option to <tt>mmap()</tt> has
     been removed.  As a consequence, the number of situations where a
     write to a file will be denied with an <tt>ETXTBSY</tt> error has been
     reduced; see <a href="https://git.kernel.org/linus/49624efa65ac">this
     commit</a> for a concise list.
<li> "Event probes" are a new type of kernel probe that attach to an
     existing trace event but which contain their own format string; they
     can be used to provide a new view of an existing tracepoint.  <a
     href="https://git.kernel.org/linus/7491e2c44278">This commit</a>
     contains a brief description of how they are used.
<li> The <a href="/Articles/812707/">DAMON subsystem</a> has been merged.
     DAMON allows the monitoring and optimization of memory management from
     user space.  <a href="https://git.kernel.org/linus/c4ba6014aec3">This
     documentation patch</a> contains more information.
</ul>

<p>
<h4>Filesystems and block I/O</h4>
<p>
<ul class="spacylist">

<li> It is no longer possible to turn off disk quota accounting in mounted
     XFS filesystems.  <i>Enforcement</i> can be turned off, but tracking
     will continue to happen under the hood.  From <a
     href="https://git.kernel.org/linus/90c90cda05ae">the pull request</a>:
     "<q>We've tried to do this in a careful enough way that there
     shouldn't be any user visible effects aside from quotaoff no longer
     randomly hanging the system</q>".
<li> XFS now supports filesystems containing dates after 2038.  This
     support has been present for a while but is no longer considered
     experimental.
<li> The EROFS filesystem now supports direct I/O on uncompressed files.
<li> Overlay filesystems now properly handle the immutable, append-only,
     sync, and noatime attributes.
<li> A new NTFS filesystem implementation, said to be far better than the
     kernel's existing version, has been merged.  There were <a
     href="/Articles/866112/#ntfs">some questions</a> about whether this
     filesystem would make it into 5.15, but it seems that the doubts felt
     by some filesystem maintainers have been adequately addressed.
</ul>

<p>
<h4>Hardware support</h4>
<p>
<ul class="spacylist">

<li> <b>Clock</b>:
     Qualcomm SC7280  clock controllers,
     Qualcomm MSM8953 global clock controllers,
     Qualcomm MSM8994 multimedia clock controllers,
     Qualcomm SM6350, SM6115 and SM4250 global clock controllers, and
     MediaTek MT8192 clock controllers.
<li> <b>Graphics</b>:
     Innolux EJ030NA 320x480 LCD panels,
     Widechips WS2401 DPI panels,
     Samsung ATNA33XC20 eDP panels, and
     Ilitek ILI9341 240x320 QVGA panels.
<li> <b>Industrial I/O</b>:
     Sensirion SGP40 gas sensors,
     Analog Devices AD5110 digital potentiometers, and
     Renesas RZ/G2L analog-to-digital converters.
<li> <b>Media</b>:
     Amlogic Meson IR transmitters,
     Sony imx335 and imx412 image sensors, and
     OmniVision OV9282 sensors.
<li> <b>Miscellaneous</b>:
     Xilinx Versal FPGAs,
     General Electric ACHC microcontrollers,
     Nintendo Wii consoles,
     Qualcomm SC8180X interconnects,
     Realtek RTL8188EU Wireless LAN NICs (replacement driver, still in
     staging),
     Intel IXP4xx expansion bus interfaces,
     Renesas RZ/G2L USB/PHY controllers,
     Apple DART I/O memory-management units,
     Renesas I2C-controlled synchronization management units,
     MediaTek CPU-frequency controllers,
     Renesas RZ/G2L DMA controllers, and
     NVIDIA Tegra30 thermal sensors.
<li> <b>PCI</b>:
     Rockchip DesignWare PCIe controllers,
     Toshiba Visconti PCIe controllers, and
     Keem Bay PCIe controllers.
<li> <b>Pin control</b>:
     Qualcomm 9607 pin controllers,
     Qualcomm SM6115 and SM4250 pin controllers,
     STMicroelectronics STM32MP135 pin controllers,
     NXP i.MX8ULP pin controllers,
     Intel Keem Bay pin controllers, and
     Renesas RZ/G2L pin and GPIO controllers.
<li> <b>Sound</b>:
     Renesas RZ/G2L serial sound interfaces.
</ul>

<p>
<h4>Security-related</h4>
<p>
<ul class="spacylist">

<li> The kernel can now be built with the GCC
     <tt>-fzero-call-used-regs=used-gpr</tt> option; in English, that means
     that any registers used within a function will be zeroed just before
     returning from that function.  This helps to prevent data from leaking
     out of functions; it also, as Kees Cook <a
     href="https://git.kernel.org/linus/a82adfd5c7cb">noted</a> in the
     changelog, "<q>helps reduce the number of useful ROP
     [return-oriented programming] gadgets in the
     kernel image by about 20%</q>".

</ul>


<p>
<h4>Virtualization and containers</h4>
<p>
<ul class="spacylist">

<li> The new, fully undocumented gpio-virtio driver allows guests to
     access GPIO lines provided by the host system.
<li> There is a new driver framework called "VDUSE" that allows the
     implementation of virtual block devices in user space, with a Virtio
     transport to the guest.  See <a
     href="https://git.kernel.org/linus/7bc7f61897b6">this documentation
     commit</a> for some more information.
</ul>

<p>
<h4>Internal kernel changes</h4>
<p>
<ul class="spacylist">

<li> <a href="/Articles/841916/">Restricted DMA pools</a> can be used to
     place limits on the pages a DMA-capable device can access on systems
     without an I/O memory-management unit.
<li> Kernel builds will now use the <tt>-Werror</tt> flag by default,
     causing the build to fail in the presence of compiler warnings.  There
     is a new <tt>WERROR</tt> configuration variable that can be used to
     turn this option off; it is meant to be used in cases where a very new
     (or old) compiler is generating spurious warnings.  This change is
     causing build failures for some but, so far, Torvalds <a
     href="/ml/linux-next/CAHk-=wgSzN4p0EW2LkA0YkRBjkOXpdaiLZMez=h=3d4Q2Gjp3A@mail.gmail.com/">is
     unsympathetic</a>:
     <p>
     <blockquote class="bq">
	So the fact that *I* require a clean build, and generally have to
	reject a couple of build requests every merge window because of
	that clearly doesn't mean that we actually have clean builds.
	<p>
	I've had that "no warnings" requirement for years. And that means
	that *my* build has been clean for years.
	<p>
	I want *all* builds to be clean, or at least as far as possible.
     </blockquote>
     <p>
     Even so, Torvalds eventually applied <a
     href="https://git.kernel.org/linus/b339ec9c229a">this patch</a>
     setting the <tt>WERROR</tt> configuration variable to match the value
     of <tt>COMPILE_TEST</tt> to minimize the pain felt by kernel builders
     worldwide.  <a href="https://git.kernel.org/linus/49832c819ab8">Yet
     another patch</a> silences the warning GCC issues when the name
     <tt>main</tt> is used for anything but a function.
<li> When the Clang compiler is used to build the kernel, the LLVM
     integrated assembler will also be used by default.
<li> The SLUB allocator has seen a significant rewrite to minimize its
     disabling of interrupts and make it compatible with realtime
     preemption.  See <a
     href="https://git.kernel.org/linus/cc09ee80c3b1">this changelog</a>
     for some more information.
<li> It is no longer possible to create executable mappings with
     <tt>ioremap()</tt>.
<li> Much of the kernel documentation has been translated into traditional
     Chinese.
</ul>
<p>

Notably not pulled was the folio patch set; see <a
href="/Articles/868598/">this article</a> for more information on that
subject.
<p>
In general, this merge window has been relatively difficult — or, as
Torvalds <a
href="/ml/linux-kernel/CAHk-=wguv1zB0h99LKH1UpjNvcg7tsckE_udYr3AP=2aEUdtwA@mail.gmail.com/">put
it</a>: "<q>This has not been one of those smooth merge windows that we
occasionally have</q>".  Hopefully the stabilization period will be a
bit less rough.  If all goes well and the nine-week schedule sticks, we'll
have the final 5.15 release as an extra Halloween treat on October&nbsp;31.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Releases-5.15">Releases/5.15</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/868221/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor869106"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The rest of the 5.15 merge window</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 13, 2021 16:54 UTC (Mon)
                               by <b>mezcalero</b> (subscriber, #45103)
                              [<a href="/Articles/869106/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This stuff got merged too:<br>
<p>
<a href="https://lore.kernel.org/all/20210712230530.29323-2-mcroce@linux.microsoft.com/">https://lore.kernel.org/all/20210712230530.29323-2-mcroce...</a><br>
<p>
I think thats quite noteworthy too, no?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/869106/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor869154"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The rest of the 5.15 merge window</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 14, 2021 5:05 UTC (Tue)
                               by <b>ndesaulniers</b> (subscriber, #110768)
                              [<a href="/Articles/869154/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
We no longer need CROSS_COMPILE for LLVM=1 builds! Cross compiling is now slightly simpler!<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/869154/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor869228"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GCC 5.1</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 14, 2021 15:53 UTC (Tue)
                               by <b>corbet</b> (editor, #1)
                              [<a href="/Articles/869228/">Link</a>] 
      </p>
      
      </div>
      </summary>
      For completeness: after the close of the merge window, Linus merged <a href="https://git.kernel.org/linus/316346243be6">a patch series raising the minimum GCC version to 5.1</a>.


      
          <div class="CommentReplyButton">
            <form action="/Articles/869228/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor869257"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The rest of the 5.15 merge window</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 15, 2021 10:47 UTC (Wed)
                               by <b>pbonzini</b> (subscriber, #60935)
                              [<a href="/Articles/869257/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Kernel builds will now use the -Werror flag by default</font><br>
<p>
YAY! One fewer way for stars to align wrong and maintainers to screw up.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/869257/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2021, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
