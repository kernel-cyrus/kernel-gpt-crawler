        <!DOCTYPE html>
        <html lang="en">
        <head><title>A story of three kernel vulnerabilities [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/538898/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/538100/">Return to the Security page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/538898/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>A story of three kernel vulnerabilities</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>This article brought to you by LWN subscribers</b>
<p>
Subscribers to LWN.net made this article &mdash; and everything that
       surrounds it &mdash; possible.  If you appreciate our content, please
       <a href="/Promo/nst-nag3/subscribe">buy a subscription</a> and make the next
       set of articles possible.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>February 19, 2013</br>
           </div>
A security-oriented firm called Trustwave recently sent out <a
href="http://www2.trustwave.com/rs/trustwave/images/Trustwave_GSR_ExecutiveSummary_4page_Final_Digital.pdf">a
preview of an upcoming report [PDF]</a> that features some focused criticism of
how the Linux community handles security vulnerabilities.  Indeed, it says:
"<q>Software developers vary greatly in their ability to respond and
patch zero-day vulnerabilities. In this study, the Linux platform had the
worst response time, with almost three years on average from initial
vulnerability to patch.</q>"  Whether or not one is happy with how
security updates work with Linux, three years sounds like a rather longer
response time than most of us normally expect.  Your editor decided to
examine the situation by focusing on two vulnerabilities that are said to
be included in the Trustwave report and one that is not.
<p>
<h4>Three years?</h4>
<p>
As of this writing, Trustwave's full report is not available, so a detailed
look at its claims is not possible.  But, according to <a
href="http://www.zdnet.com/linux-trailed-windows-in-patching-zero-days-in-2012-report-says-7000011326/">this
ZDNet article</a>, the average response time was calculated from these two
"zero-day" vulnerabilities:
<p>
<ul>
<li> <a href="/Articles/369072/">CVE-2009-4307</a>: a divide-by-zero crash
     in the ext4 filesystem code.  Causing this oops requires convincing
     the user to mount a specially-crafted ext4 filesystem image.
<p>
<li> <a href="/Articles/370498/">CVE-2009-4020</a>: a buffer overflow in
     the HFS+ filesystem exploitable, once again, by convincing a user to
     mount a specially-crafted filesystem image on the target system.
</ul>
<p>

The ext4 problem was <a
href="https://bugzilla.kernel.org/show_bug.cgi?id=14287">reported</a> on
October 1, 2009 by R.N. Sastry, who had been doing some filesystem fuzz
testing.  The report included the filesystem image that triggered the bug —
that is the "exploit code" that Trustwave used to call this bug a zero-day
vulnerability.  Since the problem was limited to a kernel oops, and since
it required the victim's cooperation (in the form of mounting the
attacker's filesystem) to trigger, the ext4 developers did
not feel the need to drop everything and fix it immediately; Ted Ts'o
committed <a
href="https://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commit;h=503358ae01b70ce6909d19dd01287093f6b6271c">a
fix</a> toward the end of November.  SUSE was the first distributor to
issue an update containing the fix; that happened on January&nbsp;17, 2010.
Red Hat did not put out an update until the end of March — nearly five
months after the problem was disclosed — and Mandriva waited until February
of 2011.

<p>
One might argue that things happened slowly, even for an extremely
low-priority bug, but where does "three years" come from?  It turns out
that the fix did not work properly on the x86 architecture; Xi Wang
<a href="/Articles/538899/">reported the problem's continued existence</a>
on December&nbsp;26, 
2011, and sent <a href="/Articles/538900/">a proper fix</a> on
January&nbsp;9, 2012.  A new CVE number (<a
href="/Articles/496295/">CVE-2012-2100</a>) was assigned for the problem
and the fix was promptly committed into the mainline.  Distributors were a
bit slow to catch up, though; Debian issued an update in March, Ubuntu in
May, and Red Hat waited until mid-November — nearly eleven months after
disclosure — to ship the fix to its users.  The elapsed time from the
initial disclosure until Red Hat's shipping an update that fixes the
problem properly is, indeed, just over three years.
<p>
The story for the HFS/HFS+ vulnerability is similar.  An initial <a
href="http://marc.info/?l=linux-mm-commits&m=125987755823047&w=2">patch</a>
fixing a buffer overflow in the HFS filesystem was posted by Amerigo Wang
at the beginning of December, 2009.  The fix was committed by Linus on
December&nbsp;15, and distributor updates began with Red Hat's on
January&nbsp;19, 2010.  Some distributors were rather slower, but it was
another hard-to-exploit bug that was deemed to have a low priority.
<p>
The problem is that the kernel supports another (newer) filesystem called
HFS+.  It 
is a separate filesystem implementation, but it contains a fair amount of
code that was cut-and-pasted from the original HFS implementation, much like ext4
started with a copy of the ext3 code.  The danger of this type of code
duplication is well known: developers will fix a bug in one copy but not
realize that the same issue may be present in the other copy as well.
Naturally enough,
that was the case here; the HFS+ filesystem had the same buffer overflow
vulnerability, but nobody thought to do anything about it until Timo Warns
quietly told a few kernel developers about it at the end of April 2012.
Greg Kroah-Hartman <a
href="http://git.kernel.org/linus/6f24f892871acc47b40dd594c63606a17c714f77">committed
a fix</a> on May&nbsp;4, and the problem was publicly disclosed a few days
after that.  Once again, a new CVE number (<a
href="/Articles/500139/">CVE-2012-2319</a>) was assigned, and, once again,
distributors dawdled with the fixes; openSUSE sent an update in June, while
Red Hat waited until October, five months after the problem became known.
The time period from the initial disclosure of the HFS vulnerability until
Red Hat's update for the HFS+ problem was just short of three years.
<p>
One could look at this situation two ways.  On one hand, Trustwave has clearly chosen
its vulnerabilities carefully, then applied an interpretation that yielded
the longest delay possible.  Neither story above describes a zero-day
vulnerability knowingly left open for three years; for most of that time,
it was assumed that the problems had been fixed.  That is doubly true for
the HFS+ filesystem, for which the vulnerability was not even disclosed
until May, 2012.  Given the nature of the vulnerabilities, it is highly
unlikely that the black hats were jealously guarding them in the meantime;
the odds are good that no system has ever been compromised by exploiting
either one of them.  Trustwave's claims, if they are indeed built on these
two vulnerabilities, are dubious and exaggerated at best.
<p>
On the other hand, even low-priority vulnerabilities requiring the victim's
cooperation should be fixed — and fixed properly — in a timely manner,
and it is not at all clear that happened with these problems.  The
response to the ext4 problem was arguably fast enough given the nature of
the problem, but the fact that the problem persisted on the obscure x86
architecture suggests that the testing applied to that fix was, at best,
incomplete.  In the HFS/HFS+ case, one could argue that <i>somebody</i>
should have thought to check for copies of the bug elsewhere.  The fact
that the HFS and HFS+ filesystems are nearly unused and nearly unmaintained
did not 
help in this case, but attackers do not restrict themselves to
well-maintained code.  And, for both bugs, distributors took their time to get
the fixes out to their users.  We can do better than that.
<p>
<h4>Meanwhile, in 2013</h4>
<p>
Perhaps the slowness observed above is the natural response to
vulnerabilities that nobody is actually all that worried about.  Had they
been something more serious, it could be argued, the response would have
been better.  As it happens, there is an open issue at the time of this
writing that can be examined to see how well we do respond; the answer
is a bit discouraging.
<p>
On January 20, a discussion on the private kernel security list went public
with <a href="/Articles/538902/">this patch posting</a> by Oleg Nesterov.
It seems that the Linux implementation of the <tt>ptrace()</tt> system call
contains a race condition: a traced process's registers can be changed in a
way that causes the 
kernel to restore that process's stack contents to an arbitrary location.
The end result 
is the ability to run arbitrary code in kernel mode.  It is a local attack,
in that the attacker needs to be able to run an exploit program on the
target system. But, given the ability to run such a program, the attacker
can obtain full root privileges.  That is the kind of vulnerability
that needs quick attention; it puts every system out there at the mercy of
any untrusted users that may have accounts there — or at the mercy of any
attacker that may be able to
compromise a network service to run an arbitrary program.
<p>
On February 15, the vulnerability was <a
href="/Articles/538904/">disclosed</a> as such, complete with handy exploit
code for those who do not wish to write their own.  Most victims are
unlikely to apply the kernel patch included with the exploit that makes the
race condition easier to 
hit; the exploit also needs the ability to run a process with real-time
priority to win the race more reliably.
But, even without the patch or real-time scheduling, a sufficiently patient
attacker should be able to 
time things right eventually.  Solar Designer <a
href="/Articles/538905/">reacted to the disclosure</a> this way:
<p>
<div class="BigQuote">
	I haven't looked into this closely yet, but at first glance it
	looks like the worst Linux kernel vulnerability in a few years.
	For distro vendor kernels (rather than mainline, which was patched
	almost a month ago), this is a 0-day.
</div>
<p>
Arguably this should not be a zero-day vulnerability: the public discussion
of the fix is nearly one month old, and the private discussion had been
going on for some time before.  But, as of this writing, no distributors
have issued updates for this problem.  That leads to some obvious
questions; quoting Solar Designer again:
<p>
<div class="BigQuote">
	The mainline commits from January are by Oleg Nesterov of Red Hat.
	Why wasn't(?) the issue handled with due severity within Red Hat,
	then - such that Red Hat would at the very least have a statement
	on whether and which of their kernels are affected by now.
</div>
<p>
One assumes that such a statement will be forthcoming in the near future.  In the meantime,
users and system administrators worldwide need to be worried about whether
their systems are vulnerable and who might be exploiting the problem.  
<p>
Once again, we can do better than that.  This bug was known to be a serious
vulnerability from the outset; one of the developers who reported it
(Salman Qazi, of Google) also provided the exploit code to show how severe
the situation was.  Distributors knew about the problem and had time to
respond to it — but that response did not happen in a timely manner.  The
<tt>ptrace()</tt> problem will certainly be 
straightened out in less than three years, but that still may not be a
reason for pride.  Users should not be left wondering what the situation is
(at least) one month after distributors know about a serious vulnerability.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Security-Vulnerabilities">Security/Vulnerabilities</a></td></tr>
            <tr><td><a href="/Security/Index/">Security</a></td><td><a href="/Security/Index/#Bug_reporting">Bug reporting</a></td></tr>
            <tr><td><a href="/Security/Index/">Security</a></td><td><a href="/Security/Index/#Linux_kernel">Linux kernel</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/538898/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor539006"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2013 18:19 UTC (Tue)
                               by <b>joey</b> (guest, #328)
                              [<a href="/Articles/539006/">Link</a>] (13 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
While the ptrace hole is clearly a higher priority class of security hole than a filesystem security hole, filesystem holes barely need the "victim's cooperation" to exploit anymore.<br>
<p>
For example, at LCA2013, the swag bag contained a small USB key with a penguin logo. I'm amoung the probably majority of attendees who plugged that key into a laptop without disabling the default automounting. That could have easily been a mass exploit vector to access development machines for many Linux and free software developers and perhaps a LWN editor too. ;)<br>
<p>
AFAIK it was not, nor was the PDF file on the drive that some attendees also opened.. But all that is needed to do such a mass exploit is an inexpensive hardware order and a bit of social engineering... and a "low priority" kernel security hole.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539006/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539030"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2013 19:32 UTC (Tue)
                               by <b>ms-tg</b> (subscriber, #89231)
                              [<a href="/Articles/539030/">Link</a>] (12 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Is it also possible to exploit this by mounting an image of a filesystem on loopback?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539030/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539109"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 7:12 UTC (Wed)
                               by <b>smurf</b> (subscriber, #17840)
                              [<a href="/Articles/539109/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Definitely.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539109/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor539108"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 7:17 UTC (Wed)
                               by <b>error27</b> (subscriber, #8346)
                              [<a href="/Articles/539108/">Link</a>] (10 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
$ mount -o loop foo mnt<br>
mount: only root can do that<br>
<p>
But otherwise yes, the fuzzer uses loop back filesystems for testing.  The thing about USB sticks is that most distros automount them when you plug them in.<br>
<p>
Probably they should not automount less used filesystems.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539108/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539129"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 9:54 UTC (Wed)
                               by <b>josh</b> (subscriber, #17465)
                              [<a href="/Articles/539129/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'd argue that rarely-used filesystems (90% of the "Miscellaneous Filesystems" menu in kconfig) ought to become FUSE modules running in a seccomp sandbox, having only the permissions they need to read or write the mounted device and respond to FUSE requests.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539129/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539143"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 12:48 UTC (Wed)
                               by <b>robert_s</b> (subscriber, #42402)
                              [<a href="/Articles/539143/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Because the people who use rarely used filesystems don't want them to be fast?<br>
<p>
In an ideal world of course, it would be possible to run all filesystem drivers as FUSE modules or in kernel.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539143/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539155"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 13:39 UTC (Wed)
                               by <b>robert_s</b> (subscriber, #42402)
                              [<a href="/Articles/539155/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;In an ideal world of course, it would be possible to run all filesystem drivers as FUSE modules or in kernel.</font><br>
<p>
Replying to myself - upon reading to the bottom of these comments it seems libguestfs can do this to some extent.<br>
<p>
Perhaps a security-conscious distribution should consider doing auto-mounting of any "removable" block devices through such a mechanism.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539155/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539159"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 14:31 UTC (Wed)
                               by <b>drag</b> (guest, #31333)
                              [<a href="/Articles/539159/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I don't see the benefit of using 'FUSE' from a security perspective. <br>
<p>
FUSE still goes to through kernel file system interface, and then you have all the file system code, and the setuid fuse binaries and special permissions that the user has to have to access /dev/fuse.<br>
<p>
It seems to me to be a attempt to throw code and complexity to obsofgate (sp?) a potential security hole.  It just seems to be a better to approach just to fix the code. <br>
<p>
Also I am pretty sure that if somebody plugs a device into a machine they have the full intention of mounting it to see what is on it.  Having a 'ack' button may be useful in a case where you do not want a device mounted while you are away from the computer and the screen is locked, but besides that having a extra step the user must go through to mount it would serve little purpose. It may make people feel more comfortable or help people (like me) that tend to do odd things with flash file systems that precludes mounting them.<br>
<p>
This is the case were potentially some sort of 'anti-virus' code may be useful to validate the device before mounting it, but that seems to open up a whole new can of worms.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539159/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539163"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 14:48 UTC (Wed)
                               by <b>robert_s</b> (subscriber, #42402)
                              [<a href="/Articles/539163/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;I don't see the benefit of using 'FUSE' from a security perspective. </font><br>
<p>
Well you'd better tell the authors of libguestfs then (largely RedHat) as security seems to be its main intention.<br>
<p>
If you're saying that an exploit granting access to a user space program is just as dangerous as it having access to kernel space, I think most people would disagree with you.<br>
<p>
The point is not whether or not the user wants to mount the device - let's take it for granted that they do, so confirmation is irrelevant. It's whether that USB stick that was just handed to them at a conference is able to directly exploit their kernel on insertion through a specially crafted filesystem.<br>
<p>
"Just fix"ing "the code" in this case means "always getting all filesystem code 100% right 100% of the time".<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539163/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539172"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 16:01 UTC (Wed)
                               by <b>drag</b> (guest, #31333)
                              [<a href="/Articles/539172/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; If you're saying that an exploit granting access to a user space program is just as dangerous as it having access to kernel space, I think most people would disagree with you.</font><br>
<p>
No.<br>
<p>
I am saying that taking a security problem that exists in kernel space and then trying to fix it by moving to a mixture of kernel space and userspace and throwing in a couple setuid root binaries isn't a silver bullet. <br>
<p>
Fuse requires kernel file system features as well as setuid root binaries to operate properly. Without granting users access to /dev/fuse you can't 'mount' fuse file systems.  Just granting users the ability to use fuse is a security risk in itself. <br>
<p>
Now if you were to say that you wanted to use something like GVFS, which itself doesn't require any special privileges or fuse mounts or anything like that, then that's different. That is completely in a user account, but it's not POSIX compatible and requires programs to be GVFS aware.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539172/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539174"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 16:07 UTC (Wed)
                               by <b>drag</b> (guest, #31333)
                              [<a href="/Articles/539174/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Oh and as far as 'userspace vs kernelspace', since all this stuff requires root privileges to do, unless you want to depend entirely on GVFS and whatnot, then any exploit that gives you root access gives you kernel access. Pretty much same different, unfortunately.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539174/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539519"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 21, 2013 19:40 UTC (Thu)
                               by <b>alonz</b> (subscriber, #815)
                              [<a href="/Articles/539519/">Link</a>] 
      </p>
      
      </div>
      </summary>
      The only setuid binary involved with using FUSE is "<tt>fusermount</tt>", which only opens <tt>/dev/fuse</tt> and immediately drops privilege. The filesystem handler itself runs as an unprivileged user.
<p>
So I, for one, really don't get your point.
      
          <div class="CommentReplyButton">
            <form action="/Articles/539519/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor539237"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 20:33 UTC (Wed)
                               by <b>josh</b> (subscriber, #17465)
                              [<a href="/Articles/539237/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Just running in userspace doesn't necessarily give you an inherent security advantage, especially if running as the primary user on the system.  However, many more facilities exist to isolate and sandbox userspace binaries to protect against exploits.  For instance: take a kernel filesystem driver, port it to FUSE, and run the actual process that does filesystem parsing inside of a seccomp sandbox that only has permission to read and write the mounted device and respond to FUSE requests.  Then, even if that filesystem parsing got exploited, the exploit can do very little to harm the system.  It could crash, slow down filesystem accesses, serve up arbitrary file content (already possible if you control the filesystem image), or burn CPU, but it can't make arbitrary system calls and can't easily escalate privileges.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539237/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor540524"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">they have the full intention of mounting it to see what is on it</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 28, 2013 21:20 UTC (Thu)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/540524/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Not at all.<br>
<p>
Assuming the automount works even if the screen is locked (as I get the impression is often the case), this is a perfect way of breaking into someone else's machine. If the exploit opens a root shell on a secret port, that machine is now owned ...<br>
<p>
So in that case, the user knows exactly what is on it. They want to see what's on the machine.<br>
<p>
So a confirmatory pop-up (as I get on my gentoo system) *is* a very effective security step.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/540524/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor539027"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2013 19:45 UTC (Tue)
                               by <b>spender</b> (guest, #23067)
                              [<a href="/Articles/539027/">Link</a>] (17 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The Trustwave "analysis" obviously has a severe bias and its sample size makes it a joke.  It's unfortunate, because there are many legitimate examples that could have been used instead.  Just a sampling from my changelogs shows tons of vulnerabilities whose fixes haven't been backported to earlier stable kernels.<br>
<p>
The PTRACE_SETREGS race vulnerability in various incarnations goes back to at least 2.4, so at least 12 years of vulnerability (both on x86 and x86_64 BTW).  FWIW, given the characteristics of the vulnerability, the constraints on it, and the extensive cleanup required to not bring the system down with it, it's unlikely to be exploitable on a grsecurity system with KERNEXEC/UDEREF enabled.  If it were possible, a large infoleak of kernel .text would be needed (which we've hopefully eradicated via USERCOPY) and an additional infoleak or reliable address with which to store a ROP payload.<br>
<p>
BTW I released the ARM blog I had mentioned earlier, for those who are interested:<br>
<a href="https://forums.grsecurity.net/viewtopic.php?f=7&amp;t=3292">https://forums.grsecurity.net/viewtopic.php?f=7&amp;t=3292</a><br>
<p>
-Brad<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539027/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539051"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2013 21:47 UTC (Tue)
                               by <b>Trou.fr</b> (subscriber, #26289)
                              [<a href="/Articles/539051/">Link</a>] (14 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I concur with spender's remark, the vulnerabilities could have been selected to underline a real problem with security and not just metrics with a DoS nobody will ever trigger (the ext4 one is a joke).<br>
<p>
However, the handling of the ptrace vuln is very representative of the state of security in the Linux world.<br>
<p>
Nobody cares about real security. The only progress that has been made in actual security in a _mainline_ distro was in Ubuntu with the work of Kees Cook. Distros don't care about security, Linus doesn't care either so we're stuck with a platform with very little progresss in 10 years.<br>
<p>
The support for signed kernel module is quite representative too : it's been implemented because of UEFI, 10 years too late (in Linus' words).<br>
<p>
Seeing the awesome work in grsecurity and PaX being ignored is depressing.  The discussion about the inclusion of grsecurity in Debian is quite revealing : <a href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=605090">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=605090</a> :( It leads to fragmentation : people with security needs manage and maintain their own grsecurity kernel and just don't even try to push it upstream because of the refusals they will get...<br>
<p>
Microsoft, which was despised for its horrible security 10 years ago has made such progress that Linux is considerably behind now. I just hope we'll be able to catch up.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539051/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539056"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2013 22:05 UTC (Tue)
                               by <b>rahulsundaram</b> (subscriber, #21946)
                              [<a href="/Articles/539056/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
support for signed kernel modules has existed for a long time and wasn't created because of UEFI.  It has been in the distro kernels for years before it got upstream.  Specifically,  RHEL kernels have been using it.  It just got recently upstream however. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539056/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539060"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2013 22:59 UTC (Tue)
                               by <b>spender</b> (guest, #23067)
                              [<a href="/Articles/539060/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Signed module support is still completely useless unless the /dev/cpu/*/msr vulnerability is fixed properly.  Checking for CAP_SYS_RAWIO doesn't cut it.<br>
<p>
-Brad<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539060/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539066"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2013 23:37 UTC (Tue)
                               by <b>mjg59</b> (subscriber, #23239)
                              [<a href="/Articles/539066/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If you're root you've also got access to the MMIO regions of a bunch of devices with DMA engines, so just locking down MSR access isn't going to be a huge win. The Secure Boot work covers most of this, but it's based on the assumption that unless you've got some mechanism for verifying the integrity of your bootloader and on-disk kernel, the security improvement isn't huge - modify the embedded sectors of the bootloader (so tripwire won't pick things up), and just wait for the system to be rebooted for a kernel security update.<br>
<p>
Signed module support in RHEL was never about security, it was about supportability. If customers are willing to use MSR hacks to load unsigned modules they're also going to be willing to just modify their bug reports to remove the tainted flags, so making it foolproof was never a great concern.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539066/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor539138"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 10:30 UTC (Wed)
                               by <b>renox</b> (guest, #23785)
                              [<a href="/Articles/539138/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; I concur with spender's remark, the vulnerabilities could have been selected to underline a real problem with security and not just metrics with a DoS nobody will ever trigger (the ext4 one is a joke).</font><br>
<p>
"could have been"? What about the HFS+ exploit?<br>
As joey remarked above, it is a real issue..<br>
By focusing on the ext4 DOS, you "forget" the other issue.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539138/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539156"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 13:52 UTC (Wed)
                               by <b>Trou.fr</b> (subscriber, #26289)
                              [<a href="/Articles/539156/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
well it's a "real" issue but it's nothing compared to others that have a wide security impact as in every script kiddie can pwn a webserver :<br>
  1) outdated CMS with remote code execution (mostly PHP)<br>
  2) easy execution of any executable<br>
  3) ready to use exploit that works reliably as unprivileged user<br>
<p>
The HFS+ vuln is not exploitable in that case. While it can be used for "physical" attacks like the USB key, it is not usable remotely.<br>
<p>
_Thousands_ of servers have been compromised with that scenario :<br>
  1) vulnerable webapp<br>
  2) escalation to root using kernel vulnerability (or poor sysadmin)<br>
  3) ssh backdoor to collect passwords<br>
  4) compromise other hosts, goto 3<br>
  5) use compromised servers as DDoS platforms, proxy, whatever...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539156/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539177"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 16:24 UTC (Wed)
                               by <b>bfields</b> (subscriber, #19510)
                              [<a href="/Articles/539177/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
In the late eighties/early nineties I seem to recall infected floppy disks were the main (or at least a very common) vector for virus transmission.<br>
<p>
If people don't exchange data on usb keys as much as they used to on floppies, perhaps that wouldn't be as effective these days.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539177/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539286"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 23:59 UTC (Wed)
                               by <b>andrel</b> (guest, #5166)
                              [<a href="/Articles/539286/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Supposedly Stuxnet was transmitted using a USB key.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539286/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539365"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 21, 2013 11:55 UTC (Thu)
                               by <b>Trou.fr</b> (subscriber, #26289)
                              [<a href="/Articles/539365/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Stuxnet used a vulnerability in the Windows shell (the so-called LNK vulnerability), not in the filesystem code.<br>
<p>
As for floppies, viruses spread mostly by running infected executables, not using vulns.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539365/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor539238"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 20:44 UTC (Wed)
                               by <b>corsac</b> (subscriber, #49696)
                              [<a href="/Articles/539238/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
And about support for signed modules: I'm sure everyone loves having an X509/ASN1 parser running in ring0.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539238/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539243"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 21:23 UTC (Wed)
                               by <b>raven667</b> (subscriber, #5198)
                              [<a href="/Articles/539243/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There is far far far more than that when it comes to complex interfaces.  Aside from the arbitrariness of ioctl there is bpf and GPU command validation as well as iptables and who knows what else that is passing complex data structures into the kernel.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539243/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor539311"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 21, 2013 3:16 UTC (Thu)
                               by <b>draco</b> (subscriber, #1792)
                              [<a href="/Articles/539311/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There's nothing about signing stuff that requires ASN.1 or X.509.  Also, it's entirely possible that userspace uses ASN.1/X.509 to get at the keys to sign with, but something else to carry the signature itself.<br>
<p>
If the kernel must parse ASN.1/X.509 to parse the signature for authentication...yikes, but that's not a requirement.  (And even if they are, I hope it's a really limited implementation.)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539311/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539324"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 21, 2013 6:16 UTC (Thu)
                               by <b>corsac</b> (subscriber, #49696)
                              [<a href="/Articles/539324/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<a href="http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=blob;f=crypto/asymmetric_keys/x509_cert_parser.c;h=7fabc4c01993bd92e3fc159ba05ae92b1732f231;hb=HEAD">http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;...</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539324/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor539513"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 21, 2013 19:13 UTC (Thu)
                               by <b>zlynx</b> (guest, #2285)
                              [<a href="/Articles/539513/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'd rather have an ASN1 parser in there than yet another custom format. At least ASN1 is well defined and doesn't shift its meaning on different machine architectures.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539513/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor540782"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 1, 2013 17:56 UTC (Fri)
                               by <b>lopgok</b> (guest, #43164)
                              [<a href="/Articles/540782/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think the SELinux is real security 'progress in a _mainline_ distro'.<br>
<p>
It is in the mainline kernel.<br>
It is enabled by default in RHEL and fedora and perhaps elsewhere.<br>
I heard it is even in the newest Android builds.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/540782/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor539123"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 9:17 UTC (Wed)
                               by <b>epa</b> (subscriber, #39769)
                              [<a href="/Articles/539123/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yes, they took a biased sample.  But that's the thing about security: you cannot rely on the law of averages to help you.  An attacker only needs to be lucky once.  If Trustwave can cherry-pick three vulnerabilities which took a long time to fix, an attacker can do the same.  So it is quite legitimate to criticize the state of security fixes based on one security hole left unpatched, even if there were a thousand others fixed promptly.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539123/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor539554"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 22, 2013 5:41 UTC (Fri)
                               by <b>jtc</b> (guest, #6246)
                              [<a href="/Articles/539554/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
'The Trustwave "analysis" obviously has a severe bias and its sample size makes it a joke.'<br>
<p>
Not only is their analysis biased, but, if the zdnet summary of their report is to be believed, they've shown themselves to be incompetent:<br>
<p>
"Zero-day flaws — software vulnerabilities for which no patch is available — in the Linux kernel that were patched last year took an average of 857 days to be closed, Trustwave found. In comparison zero-day flaws in current Windows OSes patched last year were fixed in 375 days."<br>
<p>
The obvious implication is that this is a claim that the average of time to close for all zero-day defects in the Linux kernel is 3 years (versus 375 days for Windows).  Obviously, an average cannot be calculated from 2 instances, which are very likely worst-case, out of many critical defects.  Such miscalculation, of course, implies incompetence (or the zdnet summary is inaccurate).  The criticism that these 2 cases took too long to fix is, perhaps, warranted, but nobody paying attention will conclude from their report that the implication of the headline ("Linux trailed Windows in patching zero-days in 2012...") is anything other than bullshit.<br>
<p>
Interestingly, at the end of the zdnet article is:<br>
<p>
"The Trustwave report says the number of critical vulnerabilities, as determined by the Common Vulnerability Scoring System (CVSS) assessment of factors like potential impact and exploitability, identified in the Linux kernel was lower than in Windows last year, with nine in Linux compared to 34 in Windows. The overall seriousness of vulnerabilities was also lower in Linux than Windows, with Linux having an average CVSS score of 7.68 for its vulnerabilities, compared to 8.41 for Microsoft."<br>
<p>
This might be viewed as evidence that Trustwave is not biased, but, unfortunately for them in light of their main (apparent) claim, not as evidence that they are not incompetent.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539554/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor539035"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2013 19:48 UTC (Tue)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/539035/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This is one of the big problems with using 'vendor' kernels<br>
<p>
They are supposed to be more reliable because they have better testing, but that testing takes time, and no distro ships the latest upstream kernel, so every distro has the added delay that they need to<br>
<p>
1. notice that a change needs to be backported to their private kernel (I'm sure the usual suspects will again blast the kernel developers for not labeling every patch with it's security implication so that people could only look at 'security' patches, but that's a very old debate)<br>
<p>
2. backport the change (figuring out if the patch has other implications due to other, unrelated changes that have taken place in the meantime)<br>
<p>
3. test the 'new' kernel<br>
<p>
4. ship the 'new' kernel to users.<br>
<p>
<p>
<p>
All of this takes a long time, a few months of delay is actually surprisingly good (although 11-13 months seems to be a bit on the long side)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539035/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor539041"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2013 20:28 UTC (Tue)
                               by <b>hibiscus</b> (guest, #86633)
                              [<a href="/Articles/539041/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Just for the record, the attached "PoC" code, really was "PoC". It's very far from a "handy working exploit".<br>
<p>
The race is hard to win in this case. And as you can see, the PoC requires a kernel patch to work reliably.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539041/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539044"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2013 21:00 UTC (Tue)
                               by <b>drag</b> (guest, #31333)
                              [<a href="/Articles/539044/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
'work reliably' is a relative term.  <br>
<p>
How many times can a script kiddie try the exploit in a minute? In a hour? In a day? I don't know the details on this exploit, but I expect the answers to any of those questions should range from the thousands to the tens of thousand attempts. <br>
<p>
How many times does it have to work? The answer, of course, is 'once'.  So if the exploit is as little as 0.0001% reliable I bet it can can lead to a rooted computer 100% of the time given the right circumstances.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539044/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539049"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 19, 2013 21:30 UTC (Tue)
                               by <b>hibiscus</b> (guest, #86633)
                              [<a href="/Articles/539049/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
bruteforcing could be baked into a real exploit, but if you're not smart about it it could still take days.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539049/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539095"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 4:09 UTC (Wed)
                               by <b>rahvin</b> (guest, #16953)
                              [<a href="/Articles/539095/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The point is that even a bad exploit that takes days could be scripted to run automatically while the cracker does other things. Unless you've got some rate limiting on such things a script can be written to automate even a 0.000001% success rate into a 100% success rate given time. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539095/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539380"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 21, 2013 15:03 UTC (Thu)
                               by <b>alankila</b> (guest, #47141)
                              [<a href="/Articles/539380/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
To inject some numbers to this claim, and unless I am badly mistaken, the failure chance is 99.999999%. Raising that number to the power of approximately 70 million yields around 50 % success probability. It is fundamentally a matter of chance, so 100% success can never be achieved, though something very close to it can be achieved, of course.<br>
<p>
In any case this sort of probabilities require means to fire the attack several times per second or it will probably take years of continuous attempting before succeeding. Unfortunately ptrace sounds like the sort of thing you can try thousands of times per second.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539380/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539395"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 21, 2013 16:20 UTC (Thu)
                               by <b>drag</b> (guest, #31333)
                              [<a href="/Articles/539395/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I am guessing that those numbers are the worst case scenario when it comes to the viewpoint of the attacker. I would expect that there are a significant number of things that can be done to improve the odds.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539395/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor539139"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Filesystem vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 20, 2013 10:42 UTC (Wed)
                               by <b>rwmj</b> (subscriber, #5474)
                              [<a href="/Articles/539139/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Vendors seem not to consider filesystem vulnerabilities to be serious (including Red Hat who I work for).  Yet they are very serious when you add virtualization into the mix.<br>
<p>
For example OpenStack out of the box will mount untrusted guest filesystems on the host kernel, so all you need to do is upload a malicious filesystem image to a public cloud in order to attack the host and any other VMs running on the same system.<br>
<p>
We (Red Hat) have worked to mitigate this by using libguestfs which adds several layers of protection between a malicious filesystem and the host:<br>
<p>
<a href="http://libguestfs.org/guestfs.3.html#security-of-mounting-filesystems">http://libguestfs.org/guestfs.3.html#security-of-mounting...</a><br>
<p>
But with sysadmins still using kpartx / loopback mounting, there's still a need to take fs vulnerabilities much more seriously.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539139/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539251"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Filesystem vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 21, 2013 1:06 UTC (Thu)
                               by <b>dgc</b> (subscriber, #6611)
                              [<a href="/Articles/539251/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Vendors seem not to consider filesystem vulnerabilities to be serious</font><br>
<font class="QuotedText">&gt; (including Red Hat who I work for).</font><br>
<p>
Vendors take them extremely seriously, but there's lots more to the process than "OMG!!! Security Problem! World ends at 5pm if we don't have a fix by then!". As a filesystem developer (who co-incidentally works for Red Hat, too) I have fixed my fair share of fsfuzz related bug reports over the years.<br>
<p>
So, what's the real issue here? It's that most fuzzer "filesystem vulnerabilities" are either a simple denial-of-service (non-exploitable kernel crash), or are only possible to exploit when you *already have root* or someone does something stupid from a security perspective. However, once a problem is reported to the security process it is captured, and the security process takes over everything regardless of whether subsequent domain-expert analysis shows that the bug is security problem or not.<br>
<p>
<font class="QuotedText">&gt; For example OpenStack out of the box will mount untrusted guest</font><br>
<font class="QuotedText">&gt; filesystems on the host kernel,</font><br>
<p>
This is a prime example of "doing something stupid from a security perspective". Virtualisation is irrelevant here - the openstack application is doing the equivalent of picking up a USB stick in the car park and plugging it into a machine on a secured network.....<br>
<p>
However, to really understand the situation from an fs developer POV you need to understand a bit of history and a bit about risk. That is, any change to filesystem format validation routines has risk of causing corruption or false detection of corruption, and hence you can seriously screw over the entire filesystem's user base with a bad fix.<br>
<p>
Think about it for a moment - a divide by zero crash on a specifically corrupted filesystem is simply not something occurs in production environments. However, the changes to the code that detects and avoids the problem is executed repeatedly by every single ext4 installation in existence. IOWs, the number of people that may be affected by the corrupted filesystem div0 problem is *exceedingly tiny*, while the number of people that could be affected by a bad fix is, well, the entire world.<br>
<p>
Then consider that the CVE process puts pressure on the developers to fix the problem *right now* regardless of any other factors. Hence the fixes tend to rushed, not well thought out, are only lightly tested and not particularly well reviewed.  In the filesystems game, than means the risk of regressions or the fix not working entirely as intended is significant.<br>
<p>
In the past this risk was ignored for security fixes, and that's why we have a long history of needing to add more fixes to previous security fixes. We have proven that the risk of regressions from rushed fixes is real and it cannot be ignored. Hence -in this arena- the CVE process could be considered more harmful to users than leaving the problem unfixed while we take the usual slower, more considered release process. i.e. the CVE process (and measuring vendor performance with CVE open/close metrics) simply does not take into account that fixing bugs badly can be far worse for users than taking extra time to fix the bug properly. <br>
<p>
Vendors that do due diligence (i.e. risk assessment of such bugs outside of the security process) are more likely to correctly classify fuzz-based filesystem bugs compared to the security process. Hence we see vendors mitigating the risk of regressions by testing the filesystem fixes fully before releasing them rather than rushing out a fix just to close a CVE quickly.<br>
<p>
IOWs, -more often than not- vendors are doing exactly the right thing by their user base with respect to filesystem vulnerabilities. The vendors should be congratulated for improving on a process that had been proven to give sub-standard results, not flamed for it...<br>
<p>
-Dave.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539251/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539301"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Filesystem vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 21, 2013 1:55 UTC (Thu)
                               by <b>PaXTeam</b> (guest, #24616)
                              [<a href="/Articles/539301/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
the CVE process has nothing to do with how fast a bug is fixed. it's only concerned with cataloging bugs, disclosure/fix/etc strategy is always up to the vendor/author. so if you had a problem with rushed fixes in the past, look no further than your own managers who forced you to do it.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539301/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor539572"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 22, 2013 10:36 UTC (Fri)
                               by <b>ortalo</b> (guest, #4654)
                              [<a href="/Articles/539572/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Am I mistaken or don't we have every other year a report showing that linux kernel security bugs are fixed very slowly? It started approximately since linux itself gained significant reputation in that area against proprietary operating systems (so nearly forever).<br>
 I think it's FUD. Admittedly that's an uninformed comment because I am so convinced of that, that I do not even take the time to read the reports in question anymore...<br>
 But I'd like to outline something factual: I see 2 CVE ids here from 2009.<br>
In 2009 only, there were over 5500 CVE ids. The evolution of the number of CVE entries since 2000 is, in my opinion, a much more interesting topic [1].<br>
Now my question for Trustwave: who funded that research?<br>
<p>
Just my 2/5500 cents...<br>
<p>
[1] BTW, I have a graph of that data at <a href="http://rodolphe.ortalo.free.fr/COURS_SE_2012_r3.pdf">http://rodolphe.ortalo.free.fr/COURS_SE_2012_r3.pdf</a>, page 15, but everyone can grab it from cve.mitre.org <br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539572/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor539669"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Can't disable unused filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 22, 2013 23:13 UTC (Fri)
                               by <b>jmorris42</b> (guest, #2203)
                              [<a href="/Articles/539669/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Of course something else that would help if if Linux still had something resembling documented, knowable/controllable behavior.  In the days of old /etc/filesystems declared which filesystems could be automatically detected and mounted, all others requiring an explicit mount with the -t switch to force detection of the filesystem.<br>
<p>
That file still exists of course, and the mount command will still honor it when issued from a command line; but it is ignored by graphical desktops.  And this defect is undocumented and if filed as a bug would be instantly closed as NOTABUG.<br>
<p>
For example the machine I'm typing on dual boots Win7 and has an NTFS filesystem for it.  Despite efforts to suppress it, it shows an icon on my desktop and if I right click it the desktop environment happily offers to mount it and it will succeed.  Meanwhile /etc/filesystems is still the stock one supplied by Fedora.  It lists vfat, hfs and hfsplus (why) but does not mention ntfs.<br>
<p>
In a sane world a Linux desktop would not automatically mount rare filesystems, better still it would honor /etc/filesystems so the user could control it.  Just how many users need hfs support?  On a removable device?  Close enough to zero it should default to no.  These days ext[234],vfat,ntfs,iso9660 and udf probably should default to supported with everything else off.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539669/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor539698"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Can't disable unused filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 23, 2013 12:39 UTC (Sat)
                               by <b>cortana</b> (subscriber, #24596)
                              [<a href="/Articles/539698/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It might be possible to implement something like this today with udev rules... if you could set the UDISKS_SYSTEM_INTERNAL property on a disk based on the value of one of its partitions ID_FS_TYPE properties. However I don't know how well that would interact with more interesting disk layouts (e.g., NTFS filesystem inside a LUKS container only unlocked once the user has double-clicked on it in the GUI).<br>
<p>
As for /etc/filesystems and /proc/filesystems, these days mount itself only seems to consult them if '-t auto' is used (or '-t' is absent entirely) and if libblkid fails to identify the correct filesystem. So I get the feeling that /etc/filesystems is really a remnant of an obsolete feature that hasn't been used since kernel module autoloading went in.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539698/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor540919"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Can't disable unused filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 2, 2013 16:59 UTC (Sat)
                               by <b>jmorris42</b> (guest, #2203)
                              [<a href="/Articles/540919/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yea, /etc/filesystems is documented as only being consulted for -t auto or leaving the switch off entirely.  If you explicitly specify a filesystem you expect the system to do what you told it.<br>
<p>
But the key point remains, after several replies nobody can point to a way to actually solve a problem that exists on all graphical desktops.<br>
<p>
udev is clearly not intended to be modified by the end user.  It isn't documented, the files controlling it are written in a way to be hostile to manual editing and the entire subsystem has been churning for years.<br>
<p>
Simply stopping the modules from loading isn't a good solution either.<br>
<p>
You can't even reliably suppress the icons from appearing on a desktop.  I once found a way to do it, it worked until the next Fedora.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/540919/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor540969"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Can't disable unused filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 3, 2013 15:42 UTC (Sun)
                               by <b>cortana</b> (subscriber, #24596)
                              [<a href="/Articles/540969/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
udisks does provide properties you can use to prevent volumes from being mounted by and/or shown to the user, so this should be possible. The churn is a huge pain in the arse, however. And I see it's about to get worse, since udisks is being replaced by udisks2... :/<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/540969/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor541035"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Can't disable unused filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 4, 2013 15:27 UTC (Mon)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/541035/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
In effect udisks has been unmaintained for ages. I've reported several bugs that could well be security holes upstream (writes through null pointers, writes through uninitalized, pointers, the code quality is really quite dire). Not one has ever got a response.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/541035/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor539754"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Can't disable unused filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 24, 2013 8:49 UTC (Sun)
                               by <b>paulj</b> (subscriber, #341)
                              [<a href="/Articles/539754/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Ah, so I'm not the only frustrated by lots of "disk" icons appearing in nautilus, that are to do with the system, and there not being any reasonably obvious way (either from UI or in /etc) to hide them?<br>
<p>
Arg!<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539754/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor542497"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Sure CAN disable unused filesystems =:^)</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 12, 2013 3:59 UTC (Tue)
                               by <b>Duncan</b> (guest, #6647)
                              [<a href="/Articles/542497/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
On gentoo anyway, turning off such filesystem support, and automount support in general, is easy.  Appropriate USE flags and kernel ensure support for this is NOT builtin.  Of course whether you consider gentoo "a reasonably obvious way" or not is up to you, but...<br>
<p>
My gentoo/kde systems are build without udisks, policykit, etc support, the appropriate USE flags turned off, both due to the heavy dependencies (udisks-1 wanted lvm2, udisks2 wants gparted while I use gptfdisk, I need those installed like I need another hole in my head!).  And the kernel is built for the specific system it's on, monolithic, module support turned off.  (Tho I did have to package.provided a couple runtime deps, including kdesu, that I didn't need anyway.  I could of course have edited and overlaid the ebuilds to kill the runtime deps, but that would have been a repeated edit over many updates.  Package.provideing them only need be done once.)<br>
<p>
So no automounting or GUI superuser access and for SURE no support for obscure filesystems!<br>
<p>
Where specific privlege-required functions are to be used by the GUI user, I configure sudoers to allow the specific command, no more, no less, with or without password required, depending on the need and how locked down the command actually is.  Yes, that does require that the user use the commandline for it, but IMO, if a user isn't comfortable using the commandline, they have no business running superuser/privileged commands in the first place.<br>
<p>
Of course that's a bit drastic for many, but that's precisely the point, gentoo, being build from source by the user, allows turning off unneeded features at end-user-controlled build-time, as opposed to centralized distro decided "someone might use it so we better enable it" defaults, at /their/ buildtime.  If you want automount, turn on the appropriate USE flags, else turn them off and don't even have the otherwise required components installed in the first place.  Actually, it's more than that, in effect, over time gentoo STRONGLY ENCOURAGES observance of the security "only install what you actually use" rule, because otherwise you're repeatedly building updates for stuff you don't use anyway, so if you're not actually using it, it quickly becomes simpler to just turn it off and not worry about building it any more.<br>
<p>
So yes, there's a "reasonably obvious" way to turn them off... switch to a distro (and desktop, if necessary, but I'd guess gnome on gentoo allows turning it off too, I just don't know for sure as I don't use it) that allows it, if yours doesn't. =:^)<br>
<p>
Duncan<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/542497/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor539773"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Can't disable unused filesystems</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 24, 2013 15:40 UTC (Sun)
                               by <b>spender</b> (guest, #23067)
                              [<a href="/Articles/539773/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Grsecurity can do this.  It happily prevents udisks from auto-loading modules for whatever filesystems on behalf of unprivileged users.  It's unfortunate though that Linux is moving in this direction (of security decisions being made in userland brokers) as it hinders the ability to enforce more secure mandatory security policies.<br>
<p>
Grsecurity will also prevent mount from being able to load arbitrary kernel modules (it will be restricted to modules that register a filesystem).<br>
<p>
This is a subset of the full GRKERNSEC_MODHARDEN feature which prevents unprivileged users from being able to auto-load kernel modules, without having to implement a posteriori blacklists.<br>
<p>
-Brad<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/539773/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor540377"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A story of three kernel vulnerabilities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 28, 2013 6:40 UTC (Thu)
                               by <b>geek</b> (guest, #45074)
                              [<a href="/Articles/540377/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
"...for most of that time, it was assumed that the problems had been fixed."<br>
Isn't that, in principle, a testable assumption? I'd be interested to know if there is a testing discipline around such an assumption, I suppose it isn't the only time this has occurred.<br>
<p>
Dave<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/540377/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2013, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
