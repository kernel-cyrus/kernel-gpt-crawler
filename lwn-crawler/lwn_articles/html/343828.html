        <!DOCTYPE html>
        <html lang="en">
        <head><title>A tempest in a tty pot [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/343828/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/342949/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/343828/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>A tempest in a tty pot</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Did you know...?</b>
<p>
LWN.net is a subscriber-supported publication; we rely on subscribers
       to keep the entire operation going.  Please help out by <a
       href="/Promo/nst-nag4/subscribe">buying a subscription</a> and keeping LWN on the
       net.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>July 29, 2009</br>
           </div>
There are dark areas of the kernel where only the bravest hackers dare to
tread.  Places where the code is twisted, the requirements are complex, and
everything depends on ancient code which has seen little change over the
years because even the most qualified developers fear the consequences.
Arguably, no part of the kernel is darker and scarier than the serial
terminal (TTY) code.  Recently, this code was getting a much-needed update,
but it now appears that a disconnect within the community has brought that
work to a halt and thrown TTY back into the "unmaintained" column - at a
time when that code has known regressions in the 2.6.31-rc kernel.
<p>
At a first glance, the TTY layer wouldn't seem like it should be all that
challenging.  It is, after all, just a simple char device which is charged
with transferring byte-oriented data streams between two well-defined
points.  But the problem is harder than it looks.  Much of the TTY code has
roots in ancient hardware implementing the RS-232 standard - one of the
loosest, most variable standards out there.  TTY drivers also have to
monitor the data stream and extract information from it; this duty can
include ^S/^Q flow control, parity checking, and detection of control
characters.  Control characters may turn into out-of-band information
which must be communicated to user space; ^D may become an end-of-file
when the application reads to the appropriate point in the data stream,
while other characters map onto signals.  So the TTY code has to deal with
complex signal delivery as well - never a path to a simple code base.
Echoing of data - possibly transforming it in the process - must be handled.
With
the addition of pseudo terminals (PTYs), the TTY code has also become a sort of
interprocess communication mechanism, with all of the weird TTY semantics
preserved.  The TTY code also needs to support networking protocols like
PPP without creating performance bottlenecks.
<p>
All told, it's a complicated problem.  It is also a problem which seems to
interest relatively few developers.  The top of
<tt>drivers/char/tty_io.c</tt> still reads "Copyright (C) 1991, 1992, Linus
Torvalds."  Much of the code is still dependent on the big kernel lock.
There are deadlocks and race conditions to be found.  Almost nobody wants
to touch it, but it still mostly works.
<p>


<div class="tlr">
Alan, you are a true wizard :-) The tty layer is one of 
the very few pieces of kernel code that scares the hell out of me :-)
<br>-- <a href="http://lwn.net/Articles/243968/">Ingo Molnar</a>, July, 2007
</div>



In recent times, though, an energetic TTY maintainer has stepped forward:
Alan Cox.  One could almost hear the sighs of relief across the net when
this happened; if anybody could clean out that particular set of Augean
Stables, it would certainly be Alan, who has the combination of technical
skill and attention to detail needed to avoid breaking things.  Over the
last year, it has been clear that fixing the TTY code has stressed even
Alan's skills; the work has been slow and apparently laborious.  But it has
also been successful at getting the TTY code into better shape while
preserving it as a functioning subsystem.
<p>
At least, that was the case until 2.6.31, where the combination of
significant changes and some last-minute tweaks led to regressions.  Users
started to <a href="http://lkml.org/lkml/2009/7/11/125">report</a> that the
kdesu application stopped working.  The emacs compile mode <a
href="http://bugzilla.kernel.org/show_bug.cgi?id=13815">started losing
output</a>.  And so on.  It turns out that there were a
few separate bugs, not all of which were in the tty layer:
<p>
<ul>
<li> The problem with kdesu appears to be a KDE bug; the application would 
     read too much data, then wonder why the next read didn't have what it
     wanted.  This code worked with the older TTY code, but broke with
     2.6.31.  There is probably no way to fix it which doesn't saddle the
     kernel with maintaining weird legacy bug-compatibility code -
     something the TTY layer does not need more of.
<p>
<li> The emacs problem is different.  In this case, the compile process
     would finish its work (writing its final output to the PTY) and exit.
     Emacs  would try to read that final output, but would get a
     failed read resulting from the SIGCHLD signal sent by the exiting
     compile process.  That failure was unexpected and caused emacs to drop
     the data.  In essence, emacs expected that, by the time the compile
     process had completed its <tt>close()</tt> of the PTY file descriptor,
     the data written to that descriptor had been pushed through to the
     other end and would be available for reading.  The 2.6.31 changes
     broke that assumption.
</ul>
<p>
The second problem results from the complex nature of TTY data processing.
It's not just a serial stream of data; instead, there is the line
discipline processing in the middle.  In 2.6.31, data written to a PTY will
have been queued up for line discipline attention by the time a
<tt>close()</tt> is allowed to complete, but there's no assurance that the
line discipline code will have actually run and passed the data through to
the other end.  So the SIGCHLD signal can pass the data and arrive first.
<p>
Alan <a href="/Articles/343845/">thinks this behavior is reasonable</a>; it
complies with the applicable standards and can be implemented in a
relatively straightforward way.  Making a <tt>close()</tt> on a PTY block
until the other end has received the data might make emacs work better, but
it also risks deadlock if both sides write data and close their file
descriptors at the same time.  Even so, Alan posted <a href="/Articles/343847/">a
"elegant in all the wrong ways" patch</a> which fixed the problem, but also
made it clear that he thought emacs was buggy and that the real fix
belonged there.
<p>
Linus merged <a
href="http://git.kernel.org/linus/3a54297478e6578f96fd54bf4daa1751130aca86">a
version of this patch</a>, but he was not happy about it.  He <a
href="/Articles/343849/">believes</a> that emacs is correct in its
assumptions, and would like to see a better fix which makes the ordering of
events clear and deterministic.  He <a href="/Articles/343850/">made his
frustration clear</a>:
<p>
<div class="BigQuote">
	Why? Why blame emacs? Why call user land buggy, when the bug was
	introduced by you, and was in the kernel? Why are you fighting it?
	Why did it take so long to admit that all the regressions were
	kernel problems?  Why were you trying to dismiss the regression
	report as a user-land bug from the very beginning?
</div>
<p>
At that point, it was <a href="/Articles/343851/">Alan's turn</a> to
express frustration; he did not hold back:
<p>
<div class="BigQuote">
	I've been working on fixing it. I have spent a huge amount of time
	working on the tty stuff trying to gradually get it sane without
	breaking anything and fixing security holes along the way as they
	came up. I spent the past two evenings working on the tty
	regressions.
<p>
	However I've had enough. If you think that problem is easy to fix you fix
	it.  Have fun.
</div>
<p>

The message included a patch removing Alan as the maintainer of the TTY
layer.    
<p>

And that is where things stand, as of this writing.  The TTY code is
unmaintained again, a promising rework has halted partway through, and the
person most qualified to fix the problems has thrown up his hands and left
the building (though it should be noted that he is participating in the
conversation on how the next maintainer, whoever that might be, can fix
things).  Kernel development will go on, but development in this area will
go rather more slowly; the TTY layer has claimed another victim.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Development_model-Kernel_quality">Development model/Kernel quality</a></td></tr>
            <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#TTY_layer">TTY layer</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/343828/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor344055"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 16:36 UTC (Wed)
                               by <b>Baylink</b> (guest, #755)
                              [<a href="/Articles/344055/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
With all due respect to Linus, I don't think it's the tty layer that claimed this victim... I think it's Linus.<br>
<p>
Sure, this is the NFL, wear your pads, and all that crap.<br>
<p>
As several people just pointed out to me, rather strenuously, in the sexism thread, that's really not a good enough answer.  My experience of Alan is not that he's a shrinking violet; perhaps Linus could have approached that in a... slightly more mellow fashion?<br>
<p>
I happen to be on the "if there's really a 'right' way for the kernel to do it, and that breaks user apps that made questionable assumptions, then break them" side, myself, but I don't think it's black and white, either.<br>
<p>
Particularly in this case, where the odds of that kernel getting into distributions are effectively non-existent, I don't think this was resolved in the best way for all concerned.  Though perhaps that observation is obvious enough to be puerile...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344055/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344189"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 20:33 UTC (Wed)
                               by <b>AlexHudson</b> (guest, #41828)
                              [<a href="/Articles/344189/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think you're basically right.<br>
<p>
In other areas of the kernel you wouldn't notice - people have thrown up their hands in places like IDE even after substantial work, it gets chucked out, and other people willingly step up. <br>
<p>
It means that there is really very little compelling reason to 'play nice'. Until it comes to keeping the completer-finisher types for places like tty...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344189/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor344072"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 17:07 UTC (Wed)
                               by <b>mjthayer</b> (guest, #39183)
                              [<a href="/Articles/344072/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Would it not make some sense to move the tty code out into a CUSE driver which would itself access the console driver, possibly modified to suit the user-space driver's needs?  I am sure that all this stuff is not so performance-critical that it needs to be in the kernel, or that it would not cope with a couple of extra context switches.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344072/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344105"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 17:36 UTC (Wed)
                               by <b>BrucePerens</b> (guest, #2510)
                              [<a href="/Articles/344105/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      The console must work during boot, when the kernel panics, etc.
      
          <div class="CommentReplyButton">
            <form action="/Articles/344105/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344135"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 18:23 UTC (Wed)
                               by <b>mjthayer</b> (guest, #39183)
                              [<a href="/Articles/344135/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I didn't talk about moving the console driver into user space, just the tty driver - I actually suggested that the tty driver could use the console driver.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344135/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344137"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 18:31 UTC (Wed)
                               by <b>BrucePerens</b> (guest, #2510)
                              [<a href="/Articles/344137/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yeah, you don't really need the tty discipline for the console. But you do need the ANSI terminal to framebuffer code, and the SysReq code for the keyboard, and both of those have to work when the kernel isn't running processes. So, you end up not having too much that can be moved out of the kernel.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344137/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344161"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 19:35 UTC (Wed)
                               by <b>mjthayer</b> (guest, #39183)
                              [<a href="/Articles/344161/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Why the ANSI terminal to framebuffer code?  I would have thought that simple line printing, along with a couple of ioctls for moving the cursor and selecting colours would be enough.  And of course all the virtual terminal stuff is not needed either for printing kernel messages.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344161/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344165"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 19:41 UTC (Wed)
                               by <b>BrucePerens</b> (guest, #2510)
                              [<a href="/Articles/344165/">Link</a>] 
      </p>
      
      </div>
      </summary>
      Well, the color is set with ANSI codes. And there's a lot of code that backspaces over itself and reprints while indicating something in process.<p>
So. you end up with a reasonably large piece of function-duplicating code if you split the kernel console and a more elaborate user console.
      
          <div class="CommentReplyButton">
            <form action="/Articles/344165/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor344172"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 19:57 UTC (Wed)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/344172/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
And you *do* need the line discipline code for booting on serial consoles, <br>
serial logging of panics, and so on.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344172/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344375"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 8:18 UTC (Thu)
                               by <b>mjthayer</b> (guest, #39183)
                              [<a href="/Articles/344375/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Does that require the line discipline code to be in the kernel, or would running it from the boot loader to set up the line suffice?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344375/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344376"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 8:21 UTC (Thu)
                               by <b>mjthayer</b> (guest, #39183)
                              [<a href="/Articles/344376/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Not that I can immediately think of a single argument as to why having the code in the boot loader would be better than having it in the kernel...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344376/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor344051"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 17:07 UTC (Wed)
                               by <b>iabervon</b> (subscriber, #722)
                              [<a href="/Articles/344051/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There's the additional oddity that TTYs are, abstractly, a non-local communications channel with limited bandwidth and non-zero latency. The other end of a serial connection could send data and signal it was done, and that signal could actually arrive while the data was propagating down the copper (or the RS232 interrupt could have lower priority). The two ends of a real TTY are different observers and can disagree on the ordering of events. PTYs pretend that there's magical ideal hardware connecting the two ends. Emacs makes the assumption that this ideal hardware is perfectly fast, such that no other signals can arrive while the data is on the wire. The new TTY code allows other stuff to be faster than the receiving side virtual serial port decoding. In particular, SIGCHLD can arrive while there's data that has been buffered for decoding but not yet decoded, because the sending side doesn't wait and the receiving side has a step before the data registers as available. If this were a pipe or a socket, it would be there already, but a real TTY wouldn't be so certain, and a PTY is underspecified between these models.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344051/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor344078"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 17:19 UTC (Wed)
                               by <b>allesfresser</b> (guest, #216)
                              [<a href="/Articles/344078/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
By the way, happy birthday, Alan. :)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344078/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344112"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 17:56 UTC (Wed)
                               by <b>nowster</b> (subscriber, #67)
                              [<a href="/Articles/344112/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>The opening of this article reminded me of the opening of an episode of <em>HHGTTG</em>:</p>

<p><blockquote>... when men were real men, women were real women, and large beardy creatures from Alffa Sent&#373;ri (near Swansea) were <em>real</em> large beardy ...</blockquote></p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/344112/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor344076"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 17:29 UTC (Wed)
                               by <b>mheily</b> (subscriber, #27123)
                              [<a href="/Articles/344076/">Link</a>] (94 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This illustrates why dividing the kernel and the userland into two totally separate projects is a broken development model that doesn't scale. I'm not trying to start a flamewar by bringing up BSD, but I've always thought that their approach of releasing a complete operating system allows you to make major infrastructure improvements that cross the boundary between kernel and userland.<br>
<p>
If one of the BSDs wanted to fix their TTY code, they would coordinate the changes in the kernel, core userland, and ports. This allows you to change existing bad behavior with minimal risk of breakage, since users are encouraged to upgrade their entire operating system (kernel, userland, and ports) at the same time.<br>
<p>
Perhaps there should be a "reference implementation" of a complete GNU/Linux operating system that that is blessed by both Richard Stallman and Linus Torvalds, and where extra effort is made to ensure that all the pieces work together. Existing distributions would be free to fork this implementation and add their own differentiating features, like Ubuntu forks Debian every six months and polishes it up for desktop users.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344076/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344107"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 17:39 UTC (Wed)
                               by <b>adicarlo</b> (guest, #8463)
                              [<a href="/Articles/344107/">Link</a>] (70 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Tighter coupling between kernel and userland is better?  You gotta be kidding me.<br>
<p>
That means you gotta run the kernel your distributor provides you.  Want that new driver for that wifi card or USB dongle?  Too bad.<br>
<p>
The GNU + Linux development model is proven and its winning.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344107/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344131"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 18:27 UTC (Wed)
                               by <b>mheily</b> (subscriber, #27123)
                              [<a href="/Articles/344131/">Link</a>] (69 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Tighter coupling between kernel and userland is better? You gotta be kidding me. That means you gotta run the kernel your distributor provides you. Want that new driver for that wifi card or USB dongle? Too bad.</font><br>
<p>
Ever heard of loadable kernel modules? They let you run experimental code that isn't shipped with the distributors kernel. Of course, it helps to have a stable kernel API, but the Linux devs have made their distaste for interface stability perfectly clear.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344131/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344211"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 21:34 UTC (Wed)
                               by <b>adicarlo</b> (guest, #8463)
                              [<a href="/Articles/344211/">Link</a>] (68 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;&gt; Tighter coupling between kernel and userland is better? You gotta be kidding me. That means you gotta run the kernel your distributor provides you. Want that new driver for that wifi card or USB dongle? Too bad.</font><br>
<p>
<font class="QuotedText">&gt; Ever heard of loadable kernel modules? They let you run experimental code that isn't shipped with the distributors kernel. Of course, it helps to have a stable kernel API, but the Linux devs have made their distaste for interface stability perfectly clear.</font><br>
<p>
Sure I've heard of them.  Good luck loading ath5k.ko from 2.6.30 in your vendor-supplied 2.6.26 kernel tho.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344211/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344239"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 22:43 UTC (Wed)
                               by <b>jond</b> (subscriber, #37669)
                              [<a href="/Articles/344239/">Link</a>] (67 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
To be fair to the parent (who I also disagree with) that particular problem only exists due to the lack of a stable kernel API.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344239/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344245"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 23:52 UTC (Wed)
                               by <b>JoeBuck</b> (subscriber, #2330)
                              [<a href="/Articles/344245/">Link</a>] (65 responses)
      </p>
      
      </div>
      </summary>
      And the main reason Microsoft sucks rocks, despite all of the brilliant people who work there, is stable ABIs.  For everything that they've ever done.  No matter how stupid it was.  In many cases, even things that they never documented can never be broken, because critical apps (including Microsoft apps) depend on this undocumented behavior.  They are crushed under the weight of all that legacy.


      
          <div class="CommentReplyButton">
            <form action="/Articles/344245/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344267"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 1:28 UTC (Thu)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/344267/">Link</a>] (56 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I am sorry but that is simply wrong. <br>
<p>
I have written and maintained several large and very non-standard Windows kernel drivers on my own through the years. They worked with minimal effort (if any) across NT4, W2K and WXP (I switched to Linux development before Vista was out). This stability was an immense help to me.<br>
<p>
I would never have had enough time to do it if I had to track incompatible kernel changes every few months. Plus, of course the changes are never clearly documented and the only way to find them is by observing broken compilation or worse broken behavior. Or read LWN, of course. <br>
<p>
This is madness! It takes a full time job just to track the kernel, let alone have time to do other constructive stuff. This is not a sustainable development model and I think that reality has proven me right. Nobody can afford to waste these kind of resources on Linux and ... nobody is. <br>
<p>
No software vendor (Redhad, Novell, etc) tests _all_ or even _most_ of the drivers which are included in the kernel for every new release. Most smaller hardware vendors in turn can't afford to employ kernel developers just for this so they don't test their own products either.<br>
<p>
Compare this to Windows where a company can hire a one time consultant to write a driver and can be reasonably sure that the driver will continue to work for the foreseeable future without _any_ maintenance.<br>
<p>
The argument for including stuff in the mainline kernel is of course completely ridiculous:<br>
<p>
- One, it would be extremely hard, probably impossible, to include a driver for custom hardware which is not widely available. <br>
<p>
- Two, including it in the kernel doesn't guarantee anything more than successful compilation in future versions. As I said, nobody tests the drivers before a kernel release.<br>
<p>
In the end it is much easier to write a new Linux kernel driver, but I suspect that in the long term it is more expensive than Windows to maintain.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344267/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344295"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 2:10 UTC (Thu)
                               by <b>foom</b> (subscriber, #14868)
                              [<a href="/Articles/344295/">Link</a>] (55 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>
- One, it would be extremely hard, probably impossible, to include a driver for custom hardware 
which is not widely available. 
</blockquote>
Apparently not actually true, there are such drivers in the kernel, and the kernel devs seem to 
be happy to include them. (I too find this surprising and a bit strange...)
<blockquote>
- Two, including it in the kernel doesn't guarantee anything more than successful compilation in 
future versions. As I said, nobody tests the drivers before a kernel release.
</blockquote>
Same thing is true of windows drivers -- they promise not to break the ABI, but microsoft isn't 
going to test your little driver for custom hardware with their new OS...sure it might still load, but 
then maybe it'll immediately crash. There's no guarantee against that!
      
          <div class="CommentReplyButton">
            <form action="/Articles/344295/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344301"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 2:53 UTC (Thu)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/344301/">Link</a>] (54 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>Same thing is true of windows drivers -- they promise not to break the ABI, but microsoft isn't going to test your little driver for custom hardware with their new OS...sure it might still load, but then maybe it'll immediately crash. There's no guarantee against that! </blockquote>

<p>No, it is not the same thing by far. While Microsoft will not test my driver (unless I have submitted it for WHQL, which BTW is much easier for a business than submitting to the Linux kernel), the amount of time I would have to spend making sure it works is minuscule by comparison. Plus:<ul>
<li>Microsoft at least tests all the drivers that are shipped with the OS. This is a huge difference with any Linux distribution. 
<li>The above alone guarantees a very high level of API compatibility.
<li>They don't ship new kernels with frequency anywhere near Linux.
</ul>

<p>Even if a 100% reliable stable API is not realistic, aiming for one is a really immense help for developers and businesses alike. Especially for smaller businesses where the need for an extra high salaried employee would make a huge difference.

<p>In my opinion it would be sufficient if Linux maintained a source-level API with explicit versioning, and with explicit documentation for each change. Change the API at every release if you like, but increment the version and maintain a formal documentation of the changes (and I don't mean a GIT log). 

<p>Sigh... Alas, that will never happen. I am convinced that it is one of the big reasons why we will never see mass adoption of Linux on the desktop. Specialized huge volume devices with fixed hardware like phones, netbooks, game consoles - perhaps, but a PC - not until this changes.


      
          <div class="CommentReplyButton">
            <form action="/Articles/344301/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344315"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 4:24 UTC (Thu)
                               by <b>rahvin</b> (guest, #16953)
                              [<a href="/Articles/344315/">Link</a>] (50 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>They don't ship new kernels with frequency anywhere near Linux.</blockquote>Why not admit that this is what you are complaining about, not the lack of an API? The fast moving kernel is the issue that makes it difficult to track, not the lack of an API as you state. The simple solution is to do what many businesses do and develop for kernel releases shipped with distributions. RHEL, Debian, Unbuntu, etc... all ship with specific kernels, there is often little need to track the newest kernel for out of kernel drivers.
      
          <div class="CommentReplyButton">
            <form action="/Articles/344315/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344323"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 5:04 UTC (Thu)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/344323/">Link</a>] (49 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Sigh. You are missing the point.<br>
<p>
The same Windows kernel driver can work from NT 3.51, released in 1995, to at least Windows XP, and for many classes of drivers Vista and Windows 7. During that time the Windows kernel has undergone numerous fundamental improvements (plug and play, power management, etc), and yet the core kernel _concepts_ have been kept stable. Can you point me to a Linux distribution that maintains a kernel for 15 years?<br>
<p>
The frequency of kernel releases would be immaterial if the API was stable or the changes formally tracked and documented. The latter is actually preferable because it wouldn't stop the innovation.<br>
<p>
Oh, yes, the commercial distributions are trying to maintain a stable kernel for some time (although far from 15 years) - of course they would; this is what the vast majority of businesses and users really want and need regardless of what the stupid document "stable_api_nonsense.txt" says. Alas, it is actually causing further incompatibilities and problems between distributions - everybody has a different version, with different patches, etc. It is a nightmare.<br>
<p>
Sometimes I cynically suspect that this is on purpose, or otherwise expensive support contracts wouldn't be that necessary. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344323/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344371"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 8:12 UTC (Thu)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/344371/">Link</a>] (38 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>
The same Windows kernel driver can work from NT 3.51, released in 1995, to
at least Windows XP, and for many classes of drivers Vista and Windows 7.
During that time the Windows kernel has undergone numerous fundamental
improvements (plug and play, power management, etc), and yet the core
kernel _concepts_ have been kept stable. Can you point me to a Linux
distribution that maintains a kernel for 15 years?
</blockquote>
<p>I'm sorry, but practical experience tells me you're wrong. I had a
driver for a SCSI card that was fine in NT 4, fine in 2000, did not even
load on XP; when I followed instructions to force load the driver, it
immediately bluescreened. I've since thrown the card out, because the chip
wasn't supported in Linux, either.
<p>Oh, and the card had different drivers for NT 3.51; those didn't work
with 2000 or XP (I had no access to NT 4 to check if the NT 3.51 driver
worked there).
<p>So, throwing it back at you, can you show me a driver written for NT
3.51 that does something involving DMA (e.g. a SCSI driver, an IDE driver,
a TV card driver) that still works fine in XP? If not, what about one
written for NT 4?
      
          <div class="CommentReplyButton">
            <form action="/Articles/344371/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344494"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 16:44 UTC (Thu)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/344494/">Link</a>] (37 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>I'm sorry, but practical experience tells me you're wrong. I had a driver for a SCSI card that was fine in NT 4, fine in 2000, did not even load on XP; when I followed instructions to force load the driver, it immediately bluescreened. I've since thrown the card out, because the chip wasn't supported in Linux, either. </blockquote>

<p>Well I am speaking from the developer's perspective, not as a user with a closed source driver. The changes between different Microsoft kernels are infrequent, mostly backwards compatible and are well documented. (Vista broke sound and graphics and who knows what else, but it is not like it was unexpected or undocumented).

<p>So, a transition between Microsoft OS versions requires some amount of development work, but the stable API makes that work fairly predictable and routine, plus it doesn't happen frequently. At least that has been my first hand experience.

<p>Of course, if you are a user with a closed source driver you are generally out of luck - but that's an issue separate from the stable API. 
      
          <div class="CommentReplyButton">
            <form action="/Articles/344494/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344667"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 31, 2009 4:47 UTC (Fri)
                               by <b>ebiederm</b> (subscriber, #35028)
                              [<a href="/Articles/344667/">Link</a>] (34 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
In Linux API stability is generally provided by the rule that if you change the API you have to fix all of the drivers.  If there are a lot of drivers that is a lot of work to change everything.<br>
<p>
So if an API changes under you (in linux) for a driver that means either you are using something esoteric that few other drivers use and their was very little pain in changing it.  Or you are using something for which someone felt the pain of changing it was worth the gain.<br>
<p>
Since it is a lot of work to change an API with a lot of users the churn rate should be reasonable, and it should not need to be a full time job.<br>
<p>
Where have you seen the rate of change in the linux kernel APIs churn so fast it was a full time job to keep up?<br>
<p>
And yes there are periodic rants about not changing the driver APIs too much as well.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344667/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344670"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 31, 2009 5:30 UTC (Fri)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/344670/">Link</a>] (33 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
remember that the other poster is complaining about the effort to maintain an out-of-tree driver. those don't get fixed when the api changes<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344670/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344677"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 31, 2009 6:33 UTC (Fri)
                               by <b>alex</b> (subscriber, #1355)
                              [<a href="/Articles/344677/">Link</a>] (31 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
And therein lies the problem. Out of tree is not an efficient way to develop a Linux driver.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344677/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344681"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 31, 2009 8:04 UTC (Fri)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/344681/">Link</a>] (30 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That's the common opinion expressed in "Documentation/stable_api_nonsense.txt". Yet, some people disagree with it.<br>
<p>
Having a driver in tree guarantees only that the driver compiles, nothing more. The responsibility for testing the driver still lies with the manufacturer, though the manufacturer has no direct control over what goes into the kernel. So, the manufacturer is forced to track which bugs are in which kernels (and which distributions), which patches have been accepted, when, why not, etc. As I mentioned elsewhere this is a full time job and not a fun one. <br>
<p>
Having the driver in-tree actually increases the burden to the manufacturers because now they can't control what their customers are getting. Realistically they have to maintain both an in tree and out of tree version, or they just give up on Linux. <br>
<p>
Plus, the whole idea that every single driver should be in tree is frankly dishonest. Is the kernel driver tree going to grow forever with every single device ever manufactured? What's the point? Who is going to really audit and test all these drivers for every single API change? Let's not kid ourselves, this is not happening and is not going to happen.<br>
<p>
As a whole this centralized model is unsustainable. The maintenance of the drivers should be left to the hardware manufacturers, who have customers and financial motivation to produce quality drivers. These manufacturers shouldn't have to track every possible kernel release as long as they comply with the stable API. (Plus, of course, the drivers being GPL is incredibly useful for the quality).<br>
<p>
The end users in turn shouldn't have to jump through hoops to get new hardware working if a driver exists.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344681/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344706"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 31, 2009 11:38 UTC (Fri)
                               by <b>ebiederm</b> (subscriber, #35028)
                              [<a href="/Articles/344706/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
No direct control?  Device driver patches are accepted readily, so if you aren't getting your patches accepted something very strange is going on.<br>
<p>
If a driver has a weird set of bugs on a lot of different platforms it sounds fragile and no amount of stable APIs will help.<br>
<p>
As for manufacturers doing a better job with out of tree drivers quite often hardware manufacturers build a device for a short while sell it and quickly become no longer interested in it.  Which makes a community model where all the people who care (not just the hardware manufacturer) can participate a better thing.<br>
<p>
With our real world examples I can't see where you are coming from.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344706/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344736"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 31, 2009 15:06 UTC (Fri)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/344736/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>No direct control? Device driver patches are accepted readily, so if you aren't getting your patches accepted something very strange is going on.</blockquote>

<p>Let's say I am a manufacturer and I receive a bug report from a customer. How am I supposed to fix it? Submit a patch to LKML and tell the customer to wait for a new kernel version? That is absurd. So, I have to maintain an out-of-tree driver in any case. I want my customers to use the same driver in all kernel versions. 

<p>In general linking a particular driver version to a particular kernel version is just stupid. If I have one a single misbehaving driver I have to update my entire kernel, making many more unnecessary changes. That is is a support and maintenance nightmare.

<blockquote>As for manufacturers doing a better job with out of tree drivers quite often hardware manufacturers build a device for a short while sell it and quickly become no longer interested in it. Which makes a community model where all the people who care (not just the hardware manufacturer) can participate a better thing.</blockquote>

<p>All drivers must still be GPL, of course, so people can participate if they want. But before all, it must be easy for the original manufacturer to participate because that is the most efficient way to do it. Currently, it is very expensive to do that and that is at least part of the reason why many hardware manufacturers aren't doing it at all.
      
          <div class="CommentReplyButton">
            <form action="/Articles/344736/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344743"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 31, 2009 15:17 UTC (Fri)
                               by <b>mjg59</b> (subscriber, #23239)
                              [<a href="/Articles/344743/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
On the other side of the issue, we've seen that vendor drivers often provide custom interfaces, engage in awkward hacks and generally provide a lower level of integration with existing kernel functionality than in-tree drivers. Users generally prefer in-tree drivers because they get a more consistent experience.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344743/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor344759"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 31, 2009 16:28 UTC (Fri)
                               by <b>johill</b> (subscriber, #25196)
                              [<a href="/Articles/344759/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It's not that hard to backport. We do it almost automatically: <a href="http://wireless.kernel.org/en/users/Download">http://wireless.kernel.org/en/users/Download</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344759/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor344844"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2009 10:04 UTC (Sat)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/344844/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>
Let's say I am a manufacturer and I receive a bug report from a customer. 
How am I supposed to fix it? Submit a patch to LKML and tell the customer 
to wait for a new kernel version? That is absurd. So, I have to maintain 
an out-of-tree driver in any case. I want my customers to use the same 
driver in all kernel versions.
</blockquote>
What? You maintain a git repo, the same way anyone else doing kernel 
development does, and feed one branch to Linus and the other to your 
customers. This is really not even slightly rocket science, and git has 
plenty of tools to help keep the branches in sync.

      
          <div class="CommentReplyButton">
            <form action="/Articles/344844/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344866"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2009 16:29 UTC (Sat)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/344866/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Oh, come on, the issue here is not the source control tool. Git is not magically going port your driver between versions. (BTW, I am a git fanatic, but that's another subject).<br>
<p>
A successful compilation is not sufficient. Every release has to be exhaustively tested. Maintaining several slightly different versions of the same driver, plus tracking the yet different version which may or may not have been accepted in the mainline, is a lot of work. Especially if you have direct customers. <br>
<p>
You absolutely need to maintain an out-of-tree driver. There is no two ways about it. <br>
<p>
Look, this is not theoretical. This is my real experience and it has been that out of tree drivers are much more convenient for the users. If I need support for a piece of hardware, I download the module source, compile it and use it. No kernel upgrades, no backports, no crap. If I am going to install an out-of-tree driver, I actually prefer the mainline not to have one.<br>
<p>
So, anything that makes it easier to maintain out of tree drivers would be good in my book. Of course everything must be GPL, and it would be nice if there was a centralized repository for these drivers so you don't have to hunt for them.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344866/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344903"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2009 1:39 UTC (Sun)
                               by <b>foom</b> (subscriber, #14868)
                              [<a href="/Articles/344903/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>This is my real experience and it has been that out of tree drivers are much more 
convenient for the users.</blockquote>
<p>
As a user: yuck. Not only are out of tree drivers more irritating to use/install/upgrade than in-tree 
ones, my experience has been that they're also always buggier.
<p>
And I don't want to have to download the module source, compile it, and use it: I want the device to 
just work when I plug it in, without even thinking about it.
<p>
On the other hand, I do like it, when the driver is brand new, if an out-of-tree version is made 
available for use with older kernel versions. Certainly it's helpful to provide an out-of-tree version 
for the first year or two until everyone's upgraded to a kernel with the driver included already.
      
          <div class="CommentReplyButton">
            <form action="/Articles/344903/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344932"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2009 14:03 UTC (Sun)
                               by <b>alex</b> (subscriber, #1355)
                              [<a href="/Articles/344932/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It would be nice if the distros could compile out-of-tree snapshots in a nice user friendly way. But for this to work they have to be GPL source code and not arbitrary binary blobs.<br>
<p>
Certainly for me as a developer the current wireless testing tree/compat layer is an example of doing it right. I can run wireless with my distro kernel but still have the latest greatest without upgrading the kernel if I want. I wonder if more out-of-tree's could follow the wireless model.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344932/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor344944"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2009 21:05 UTC (Sun)
                               by <b>johnflux</b> (guest, #58833)
                              [<a href="/Articles/344944/">Link</a>] (20 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It's good to get other opinions here, and it's certainly interesting to hear arguments for out-of-tree drivers.<br>
<p>
But one very important question comes to mind:<br>
<p>
What happens when you no longer support that hardware?  What happens if your company goes bankrupt, reduces in size, etc, and can no longer support the out-of-tree driver?<br>
<p>
You then end up in a situation where users cannot ever upgrade their kernel because your out-of-tree driver is no longer being upgraded.<br>
<p>
I worked for a company that has an out-of-tree driver.  We ended up only officially supporting quite an old kernel.  This screwed over customers that needed a newer kernel (typically for newer power management features)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344944/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344981"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2009 4:47 UTC (Mon)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/344981/">Link</a>] (19 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>What happens when you no longer support that hardware? What happens if your company goes bankrupt, reduces in size, etc, and can no longer support the out-of-tree driver? You then end up in a situation where users cannot ever upgrade their kernel because your out-of-tree driver is no longer being upgraded.</blockquote>

<p>Well, since the out-of-tree drivers still must be GPL, if the hardware manufacturer doesn't want to support it, anybody else can do it. Nothing changes in that respect. A stable API gives us best of both worlds. 

<blockquote>I worked for a company that has an out-of-tree driver. We ended up only officially supporting quite an old kernel. This screwed over customers that needed a newer kernel (typically for newer power management features)</blockquote>

I completely agree that, as things are currently, an out-of-tree driver is a lot of work to maintain. That's precisely why I am arguing for a stable API. Then ideally an out-of-tree driver would work with any kernel. If there happen to be driver API changes (realistically those can't be avoided) they will be formally versioned and documented so porting will be routine.
      
          <div class="CommentReplyButton">
            <form action="/Articles/344981/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344984"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2009 6:38 UTC (Mon)
                               by <b>johnflux</b> (guest, #58833)
                              [<a href="/Articles/344984/">Link</a>] (18 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Out-of-tree drivers don't have to be GPL (well, that's a up to debate, but there are certainly proprietary drivers).  And even if it's GPLed, if it's out of tree then there's a good chance that it doesn't meet the coding standards for inclusion into the kernel - for example a company typically might have a single source for Windows and Linux, with hundreds of #ifdef's to switch between them.  There is also often a custom build system, revision control system, etc.<br>
<p>
So this means that once the company goes bankrupt, some volunteer has to take code that he's probably never looked at before and undertake what could be a large task to clean up and adapt the driver for inclusion into the kernel.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344984/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345024"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2009 17:48 UTC (Mon)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/345024/">Link</a>] (17 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>Out-of-tree drivers don't have to be GPL (well, that's a up to debate, but there are certainly proprietary drivers).</blockquote>

<p>That is not really true. I am not aware of anything that allows a Linux kernel driver to be non-GPL. The only gray area is if the driver has been ported from another OS, and this is also questionable. I have seen more than one clear statement from Linus Torvalds on this subject.

<p>There is no question that people violate the Linux GPL all the time. It is ethically disgusting (although I actually understand very well why they do it).

<p>But in any case, a stable source API has not relevance to that problem. 

<blockquote>And even if it's GPLed, if it's out of tree then there's a good chance that it doesn't meet the coding standards for inclusion into the kernel - for example a company typically might have a single source for Windows and Linux, with hundreds of #ifdef's to switch between them. There is also often a custom build system, revision control system, etc.</blockquote>

<p>And that is bad because? The current standards are needed because the kernel developers have to be able to "maintain" (more like coax into compiling)  a mountain of drivers they don't care about. If the drivers are maintained by interested 3rd parties, it doesn't matter in the least, and those 3rd parties should choose whatever standards of their own they prefer. 

<blockquote>So this means that once the company goes bankrupt, some volunteer has to take code that he's probably never looked at before and undertake what could be a large task to clean up and adapt the driver for inclusion into the kernel.</blockquote>

<p>I am sorry but this is a logical fallacy. This volunteer is free to develop a driver of his own using his superior coding standards from day one. Plus, surely having an existing working driver is much better than starting from scratch. 

<p>Look, I am well aware that the idea for a stable API is not popular and for sure I am not the best advocate for it. I actually don't think that a stable API will happen. But I also know what I am seeing in my professional life and it doesn't look good. 

<p>Also (sorry to repeat myself) it is clear to me that with the current situation Linux will <b>never</b> be really successful on the desktop. The stable API is just one of the several reasons for that, but it isn't a small one.

      
          <div class="CommentReplyButton">
            <form action="/Articles/345024/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345052"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2009 20:08 UTC (Mon)
                               by <b>johnflux</b> (guest, #58833)
                              [<a href="/Articles/345052/">Link</a>] (16 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; I am sorry but this is a logical fallacy. This volunteer is free to develop a driver of his own using his superior coding standards from day one. Plus, surely having an existing working driver is much better than starting from scratch. </font><br>
<p>
There's no logical fallacy there.  I stated that an out-of-tree driver requires a lot of work to get into the kernel if it has to be done once the company has gone bankrupt, compared to if the driver was in the tree in the first place.  But you're stating that an out-of-tree driver is easy than no driver at all which is true, but not really relevant to an in-tree or out-tree discussion.<br>
<p>
<p>
I do get where you're coming from, but I do think that in the long run, Linux will have the bigger advantage of having all the drivers in tree.<br>
<p>
The other day, for example, I need to get a webcam working on an ARM device.  In linux it was easy because all the drivers were just there.  I plugged in the webcam and it just worked.<br>
That sort of thing is simply not possible in Windows.<br>
<p>
Likewise I dread re-installing Windows because the drivers for my wireless card are difficult to get.  The company that made the drivers has since gone and their website is now down.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345052/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345070"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2009 22:14 UTC (Mon)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/345070/">Link</a>] (15 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>There's no logical fallacy there. I stated that an out-of-tree driver requires a lot of work to get into the kernel if it has to be done once the company has gone bankrupt, compared to if the driver was in the tree in the first place. But you're stating that an out-of-tree driver is easy than no driver at all which is true, but not really relevant to an in-tree or out-tree discussion.

<p>I do get where you're coming from, but I do think that in the long run, Linux will have the bigger advantage of having all the drivers in tree.</blockquote>

<p>Well, you are implying that it is somehow "bad" to have an existing working GPL driver, which just happens to be out of tree. That is the fallacy. In fact it cannot possibly negatively affect the desired outcome, which is to have a working driver.

<p>I actually think that there should be no drivers in tree. That is an unmanageable situation - keeping all possible drivers in one monolithic source tree, and upgrading them at every kernel release. It should be obvious that this simply cannot scale. You cannot expect a finite number of developers to maintain a potentially infinite number of drivers for ever. 

<blockquote>The other day, for example, I need to get a webcam working on an ARM device. In linux it was easy because all the drivers were just there. I plugged in the webcam and it just worked.
That sort of thing is simply not possible in Windows.</blockquote>

<p>That is a funny example because I have exactly the opposite experience with an embedded project. It is not possible to buy a working camera for it because its kernel can't practically be upgraded. And even with a modern kernel, I can't find a single webcam from Fry's to work on my Linux desktop. 

<p>AFAIK, there is a very high turnover rate with webcam chips, so it simply does not make economic sense to maintain a driver for hardware whose life is 6 months. Now, if only there was a stable driver API ... :-)

<blockquote>Likewise I dread re-installing Windows because the drivers for my wireless card are difficult to get. The company that made the drivers has since gone and their website is now down.</blockquote>

<p>I don't get it. Why would you have to re-install Windows for a single driver? 

<p>Let's for a second forget about the labels Linux and Windows and look at it as impartial scientists performing an experiment. We have "OS A" which owns 99% of a market, and "OS B" which has 0.5% and doesn't seem to be growing even though it is <b>much cheaper</b> (!?!). What reasons could we have, as impartial scientists, to believe that "OS B" is somehow superior?

<p>Personally I obviously think that Linux is superior in many respects, or I wouldn't be here. But I am sure that that it is <i>despite</i> the lack of stable API, not <i>because</i> of it.
      
          <div class="CommentReplyButton">
            <form action="/Articles/345070/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345074"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2009 22:19 UTC (Mon)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/345074/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
what makes you think that the pool of developers to maintain the drivers in the kernel is finite while the pool of drivers is not?<br>
<p>
the number of people who contribute to the kernel continues to grow.<br>
<p>
you believe that the unstable API is a drawback, many others believe that is is a strength.<br>
<p>
the people that you need to convince are not here, you need to go elsewhere to convince them.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345074/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345083"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2009 23:55 UTC (Mon)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/345083/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>the people that you need to convince are not here, you need to go elsewhere to convince them.</blockquote>

<p>Do you mean this in the sense "shut up and go away"?

<p>I don't want to convince anybody. I think that a stable API is a lost cause, like Linux on the desktop, or Linux gaming. It is time to wake up and smell the flowers. The desktop PC is almost gone.

<p>I am curious about intelligent objections against a stable API, but I am not crazy to go get flamed on LKML. (If you do a search, there have been others, brave or stupid enough to post about a stable API there. LOL. Poor suckers. They deserved what was coming to them.)

<p>The people who would need convincing are the big companies who pay for Linux kernel development. It is more than a bit naive to think that volunteers in their free time can influence Linux at this point of its development. But I have a pretty good theory why RedHat, Novell, etc, aren't interested in a stable API. 

      
          <div class="CommentReplyButton">
            <form action="/Articles/345083/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345085"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 4, 2009 0:38 UTC (Tue)
                               by <b>foom</b> (subscriber, #14868)
                              [<a href="/Articles/345085/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'm pretty sure I don't use any 3rd party drivers on my Mac laptop, and I certainly haven't missed <br>
them or thought MacOS was not ready-for-the-desktop because of it...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345085/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345095"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 4, 2009 4:47 UTC (Tue)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/345095/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yeah right. Which parts of your Mac did you buy from a different hardware vendor?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345095/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor345075"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2009 22:29 UTC (Mon)
                               by <b>johnflux</b> (guest, #58833)
                              [<a href="/Articles/345075/">Link</a>] (10 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Well, you are implying that it is somehow "bad" to have an existing working GPL driver, which just happens to be out of tree.<br>
<p>
_Compared_ to having it in tree.  That's all I've ever said.<br>
<p>
<font class="QuotedText">&gt; That is the fallacy. In fact it cannot possibly negatively affect the desired outcome, which is to have a working driver.</font><br>
<p>
Compared to not having it at all, sure.<br>
<p>
<p>
<font class="QuotedText">&gt; That is a funny example because I have exactly the opposite experience with an embedded project. It is not possible to buy a working camera for it because its kernel can't practically be upgraded.</font><br>
<p>
Why can't it be upgraded?  Because of an out-of-tree driver? :-D<br>
<p>
<font class="QuotedText">&gt; And even with a modern kernel, I can't find a single webcam from Fry's to work on my Linux desktop.</font><br>
<p>
I find that unlikely :-)  I've bought 4 webcams randomly, 2 built into laptops, and all just worked in linux.<br>
<p>
<font class="QuotedText">&gt; I don't get it. Why would you have to re-install Windows for a single driver? </font><br>
<p>
Nah, I meant that if I re-install, for an unrelated reason, then I have trouble getting the drivers.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345075/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345082"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2009 23:38 UTC (Mon)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/345082/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>Why can't it be upgraded? Because of an out-of-tree driver? :-D</blockquote>

<p>Laugh all you want :-) But it is a real problem that should not exist... Ignoring it doesn't make it any less important for the developers and users of this product.</p>

<blockquote>I find that unlikely :-) I've bought 4 webcams randomly, 2 built into laptops, and all just worked in linux. </blockquote>

<p>Well, I am not making it up. BTW, I am running Kubuntu LTS and Debian Stable on my desktops. Perhaps you see my problem? ;-)

<blockquote>Nah, I meant that if I re-install, for an unrelated reason, then I have trouble getting the drivers.</blockquote>

<p>Well, that is the problem of closed source, no argument from me there.

<p>BTW, you can still save the drivers. You have to copy the INF file and the files referenced from it and you can reinstall them on a new system without any tricks. Some things in Windows really are that easy :-)
      
          <div class="CommentReplyButton">
            <form action="/Articles/345082/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345114"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 4, 2009 8:06 UTC (Tue)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/345114/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <p>The thing is, and this is from direct personal experience, companies
maintaining out of tree drivers don't put their driver through the Linux
code review process; as a result, they ignore standard Linux interfaces in
favour of inventing their own.
<p>Add to that the fact that they lose interest in maintaining their
driver at all when they've moved onto the new shiny (in the case of one
vendor I've dealt with, the driver stops being maintained as soon as they
have a new chip out, even though they're still selling the old chip), and
the fact that I don't have the time to do more than bugfix drivers that
have already been ported to new APIs, and I find myself thinking that all
the advantages you claim for out of tree drivers are disadvantages from my
perspective.
<p>I want <b>one</b> place to go to for drivers. Not twenty trees, but the
one tree on kernel.org. I have found it easier to backport drivers from
2.6.30 to 2.6.23 than to integrate vendor drivers, so I would prefer in-
aiming to move into the tree (before GregKH's staging area), and that was
quite enough pain.
<p>I'm also afraid that your admission that you're stuck on an old kernel
due to an out-of-tree driver from your board vendor reminds me of a subset
of nVidia graphics card owners, who complain bitterly (regardless of
technical reasons) when X.org releases a new version of the X server that
isn't backwards compatible with the ancient version of the nVidia drivers
that supports their older hardware; I do feel that you should be exerting
pressure on your vendor to make this happen, either by getting their
drivers into the kernel, or getting them to step up and do the work of
maintaining a stable in-kernel API. It's not going to come for free, so
why shouldn't the people who want such an API do the work of maintaining
it?
      
          <div class="CommentReplyButton">
            <form action="/Articles/345114/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345222"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 4, 2009 20:51 UTC (Tue)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/345222/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; The thing is, and this is from direct personal experience, companies</font><br>
<font class="QuotedText">&gt; maintaining out of tree drivers don't put their driver through the Linux</font><br>
<font class="QuotedText">&gt; code review process; as a result, they ignore standard Linux interfaces</font><br>
<font class="QuotedText">&gt; in favour of inventing their own.</font><br>
<p>
I have no opinion about this because I haven't personally experienced it, but I believe you. But why isn't this a problem in Windows?<br>
<p>
<font class="QuotedText">&gt; Add to that the fact that they lose interest in maintaining their driver</font><br>
<font class="QuotedText">&gt; at all when they've moved onto the new shiny (in the case of one vendor</font><br>
<font class="QuotedText">&gt; I've dealt with, the driver stops being maintained as soon as they have</font><br>
<font class="QuotedText">&gt; a new chip out, even though they're still selling the old chip), and the</font><br>
<font class="QuotedText">&gt; fact that I don't have the time to do more than bugfix drivers that have</font><br>
<font class="QuotedText">&gt; already been ported to new APIs, and I find myself thinking that all the</font><br>
<font class="QuotedText">&gt; advantages you claim for out of tree drivers are disadvantages from my</font><br>
<font class="QuotedText">&gt; perspective.</font><br>
<p>
Agreed, but what is your point? You are describing exactly the problems caused by a lack of stable API. Vendors do not want to maintain drivers for hardware which they no longer sell, because it is a never ending cycle of completely pointless but expensive work (from their standpoint). That would not be the case if there was a stable API. <br>
<p>
First, it would be very cheap for them to continue the maintenance, so they would likely do it. Second, even if they didn't, the driver should just continue to work. And lastly, a volunteer can pick it up at any moment.<br>
<p>
<font class="QuotedText">&gt; I want one place to go to for drivers. Not twenty trees, but the one</font><br>
<font class="QuotedText">&gt; tree on kernel.org. I have found it easier to backport drivers from</font><br>
<font class="QuotedText">&gt; 2.6.30 to 2.6.23 than to integrate vendor drivers, so I would prefer in-</font><br>
<font class="QuotedText">&gt; aiming to move into the tree (before GregKH's staging area), and that</font><br>
<font class="QuotedText">&gt; was quite enough pain.</font><br>
<p>
Well, that is you but you are the exception. 99.9% of the Linux users and most of the developers can't backport a driver. While I personally also could do it, there is more than that - for example I don't really have time or support such backported driver in a business setting. <br>
<p>
There is definite value in a central repository for drivers. The problem with the current approach is that the release cycles of all drivers are tied together. Ideally I would like to see a central repository where vendors are free to upload their drivers whenever they want.<br>
<p>
<font class="QuotedText">&gt; I'm also afraid that your admission that you're stuck on an old kernel</font><br>
<font class="QuotedText">&gt; due to an out-of-tree driver from your board vendor [...]</font><br>
<p>
I have never said that. I mentioned a problem where newer webcam drivers are only available for new kernels. This has nothing to do with in-tree vs out-of-tree drivers; it is precisely a matter of lack of stable API.<br>
<p>
It seems that many people who responded negatively to my comments here are confusing a couple of related by separate issues:<br>
<p>
* Stable API. It is equally beneficial to in-tree and out-of-tree drivers because in either case it decreases the maintenance burden. In fact contrary to the common wisdom, a stable API gives more freedom to core developers to make changes because they can keep them isolated behind the facade of the stable API.<br>
<p>
* In-tree vs out-of-tree drivers. It is true that a stable API decreases the incentive to submit drivers to the kernel because the "free maintenance" red herring is gone. But if people perceive value in having a central point for driver development, there is nothing stopping them. <br>
<p>
* Closed source drivers. This is completely unrelated to a stable source level API. They are prohibited by the kernel license and suffer from their well known problems. <br>
<p>
<font class="QuotedText">&gt; reminds me of a</font><br>
<font class="QuotedText">&gt; subset of nVidia graphics card owners, who complain bitterly (regardless</font><br>
<font class="QuotedText">&gt; of technical reasons) when X.org releases a new version of the X server</font><br>
<font class="QuotedText">&gt; that isn't backwards compatible with the ancient version of the nVidia</font><br>
<font class="QuotedText">&gt; drivers that supports their older hardware; </font><br>
<p>
I would like to see an open source Nvidia driver as much as the next guy, but I have to disagree with you. How did Microsoft manage to keep their graphics driver API the same from NT 3.1 to Windows XP? To think that it is a bad thing is to ignore reality. <br>
<p>
<font class="QuotedText">&gt; I do feel that you should be</font><br>
<font class="QuotedText">&gt; exerting pressure on your vendor to make this happen, either by getting</font><br>
<font class="QuotedText">&gt; their drivers into the kernel, or getting them to step up and do the</font><br>
<font class="QuotedText">&gt; work of maintaining a stable in-kernel API. It's not going to come for</font><br>
<font class="QuotedText">&gt; free, so why shouldn't the people who want such an API do the work of</font><br>
<font class="QuotedText">&gt; maintaining it?</font><br>
<p>
Agreed in theory. But you are forgetting that these vendors don't need to support Linux at all. It is less than 1% of their market, but it takes more work to support that Windows. So, why the hell would they do it at all? <br>
<p>
So, they don't have to do anything. It is not their problem. If the Linux community wants to bring these vendors fully on board, it should make it easy for them. Easier than Windows. The major factor for "easiness" is stable APIs. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345222/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345332"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 5, 2009 10:32 UTC (Wed)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/345332/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>
> The thing is, and this is from direct personal experience, companies
> maintaining out of tree drivers don't put their driver through the Linux
> code review process; as a result, they ignore standard Linux interfaces
> in favour of inventing their own.

I have no opinion about this because I haven't personally experienced it, but I believe you. But why isn't this a problem in Windows?
</blockquote>
<p>It is a problem in Windows, too; for example, very few graphics card drivers support Windows native screen rotation in XP - you need to use a vendor utility instead. The difference is that Windows users are used to this, and don't complain as loudly about it. It's becoming less of an issue as things like USB standardize more and more device classes, and manufacturers use the standard classes, because that means that the device is Plug And Play under currently shipping Windows systems (Vista, future Windows 7 installs).
<blockquote>
> Add to that the fact that they lose interest in maintaining their driver
> at all when they've moved onto the new shiny (in the case of one vendor
> I've dealt with, the driver stops being maintained as soon as they have
> a new chip out, even though they're still selling the old chip), and the
> fact that I don't have the time to do more than bugfix drivers that have
> already been ported to new APIs, and I find myself thinking that all the
> advantages you claim for out of tree drivers are disadvantages from my
> perspective.

Agreed, but what is your point? You are describing exactly the problems caused by a lack of stable API. Vendors do not want to maintain drivers for hardware which they no longer sell, because it is a never ending cycle of completely pointless but expensive work (from their standpoint). That would not be the case if there was a stable API. 
</blockquote>
<p>Oops - my bad. I forgot to mention that the case in question was migrating from NT4 to XP in an embedded product. We could still buy the chips in question, but the NT4 driver didn't work in XP, even after we recompiled it against the new DDK (don't know why - I thought there was a stable API?). We ended up having to buy new ASI capture chips, and scrapping the older hardware.
<blockquote>
> reminds me of a
> subset of nVidia graphics card owners, who complain bitterly (regardless
> of technical reasons) when X.org releases a new version of the X server
> that isn't backwards compatible with the ancient version of the nVidia
> drivers that supports their older hardware;

I would like to see an open source Nvidia driver as much as the next guy, but I have to disagree with you. How did Microsoft manage to keep their graphics driver API the same from NT 3.1 to Windows XP? To think that it is a bad thing is to ignore reality.
</blockquote>
<p>They didn't keep the graphics driver API the same from NT 3.1 to Windows XP. Newer OSes cannot run graphics cards using older drivers, pure and simple. No different to Linux, in that respect.
<p>And note that vendors <b>do</b> need to bring the Linux community on board - my employer alone buys a significant number of TV capture cards a month, on condition that they are supported under Linux. We pay a slight premium to buy Hauppauge cards because of the Linux support; other vendors are £5/card cheaper, but cost huge amounts of money in expensive developer time keeping the card going.
      
          <div class="CommentReplyButton">
            <form action="/Articles/345332/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345401"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 5, 2009 18:05 UTC (Wed)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/345401/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>It is a problem in Windows, too; for example, very few graphics card drivers support Windows native screen rotation in XP - you need to use a vendor utility instead. </blockquote>

<p>I don't want to defend Windows, but IIRC that is technically wrong. Unless I am mistaken, XP does not support native screen rotation. It was introduced in Vista.

<p>I do agree with your general point that you can't rely on the vendors to "do the right" thing. Vendors do suck. I have seen really really horrible disgusting things working with closed source drivers. But this is an impossible battle. You can't require all developers for your OS to be perfect. People will do whatever they want to do. The best you can do is give them tools encouraging them in the right direction. Plus, hopefully GPL will shame them into better code.

<p>Look at Google Android. They are basically doing whatever they want with the kernel and not bothering to submit anything back. 

<blockquote>They didn't keep the graphics driver API the same from NT 3.1 to Windows XP. Newer OSes cannot run graphics cards using older drivers, pure and simple. No different to Linux, in that respect.</blockquote>

<p>I am sorry but that is not quite true either. In a previous life I used to do Windows kernel development, and graphics drivers specifically. I have ported drivers from NT4 to W2K and WXP. The API remained backwards compatible and even binary compatible.

<p>In NT4 they did a fundamental architectural change by moving the drivers into the kernel, but the source level API remained compatible with NT 3.51.

<blockquote>And note that vendors do need to bring the Linux community on board - my employer alone buys a significant number of TV capture cards a month, on condition that they are supported under Linux. We pay a slight premium to buy Hauppauge cards because of the Linux support; other vendors are £5/card cheaper, but cost huge amounts of money in expensive developer time keeping the card going. </blockquote>

<p>I don't quite follow. Can you please clarify a bit? Why do the other cards need huge amounts of money? Also, you are saying that Hauppauge is more expensive because it has to support Linux. So, how is that a good thing?

      
          <div class="CommentReplyButton">
            <form action="/Articles/345401/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345446"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 5, 2009 18:15 UTC (Wed)
                               by <b>johnflux</b> (guest, #58833)
                              [<a href="/Articles/345446/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; I don't quite follow. Can you please clarify a bit? Why do the other cards need huge amounts of money? Also, you are saying that Hauppauge is more expensive because it has to support Linux. So, how is that a good thing?</font><br>
<p>
I think his point was that his company was willing to pay extra just for linux support.  So Hauppauge was able to charge more money, and still get his custom.  Whereas the companies that didn't support Linux didn't get his business.<br>
<p>
From a business point of view, if the money that a company loses because of their lack of linux support is greater than the cost of opening the specs or writing the drivers, then the company should write Linux drivers.  The poster was providing anecdotal evidence to indicate that they believe that this is the case for some (most?) companies.<br>
<p>
On a personal note, I think companies perceive the cost of opening their drivers to be far higher than it really is.  <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345446/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor345463"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 5, 2009 18:45 UTC (Wed)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/345463/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>Hauppauge cards tend to work out of the box with a recent enough
kernel; when they don't, Hauppauge employees are happy to help you make
the cards work. Other vendors cards require developer time to make work,
and attempts to get the vendor to help tend to be fruitless (they have
their own out of tree driver that doesn't work well, due to reinvention of
interfaces, and don't understand why you won't simply rewrite your
userspace to match their driver).
<p>Developer time is hugely expensive, as we don't have much to spare;
given the choice between a small amount of extra money per card (to the
vendor), or developer time, we'd rather pay. If you're a vendor, looking
to expand, this is a market, and it has money to spend on you.
      
          <div class="CommentReplyButton">
            <form action="/Articles/345463/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor345583"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 6, 2009 6:28 UTC (Thu)
                               by <b>lysse</b> (guest, #3190)
                              [<a href="/Articles/345583/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; this is from direct personal experience</font><br>
<p>
So why are you generalising from it?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345583/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345597"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 6, 2009 8:10 UTC (Thu)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/345597/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <p>I'm generalising from experience of 15 to 20 vendors, of whom only a
couple had their drivers upstreamed. The remainder simply did not
understand why (to use some examples) I didn't want to use their vendor-
specific DVB-T tuning interface instead of Linux's DVB API, or their
vendor-specific video capture interface instead of V4L2.
<p>However, I recognise that my experience may be atypical; I therefore
mention that I base this on personal experience, so that if I've just had
bad luck with vendors, other people can point out vendors who get it
right.
      
          <div class="CommentReplyButton">
            <form action="/Articles/345597/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345953"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 7, 2009 22:31 UTC (Fri)
                               by <b>Los__D</b> (guest, #15263)
                              [<a href="/Articles/345953/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This is not much different on Windows.<br>
<p>
Stupid devices which needs stupid programs to do what a perfectly capabable standard Windows configuration tool should be doing seems to be more the rule that the exception.<br>
<p>
- The worst part is that Windows seems to support that ridiculous way of doing it. i.e. the Wi-Fi configuration tool has an option to transfer control to a 3rd party program.<br>
<p>
(To be fair, this seems to be getting a bit less frequent lately).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345953/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor346209"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">out of tree</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 10, 2009 16:43 UTC (Mon)
                               by <b>vadim</b> (subscriber, #35271)
                              [<a href="/Articles/346209/">Link</a>] 
      </p>
      
      </div>
      </summary>
      Let me give you my opinion as an user:

As far as I'm concerned, if your hardware doesn't have a driver in the mainline kernel, it
doesn't have one. And that means I don't buy it. And that's not a huge hindrance, since
Linux has modules for everything these days. A device that only has an out of tree
module is a rare exception and easily avoided.

<blockquote>
Having the driver in-tree actually increases the burden to the manufacturers because
now they can't control what their customers are getting.
</blockquote>

But I'm not that interested in you controlling what I'm getting. If I have a 3Com card, I
need it to work. Who makes it work isn't particularly important. If it stops working, I
don't go to 3com.com, I expect my distro to ship a fix.

It's actually something I love about Linux - on Windows every driver comes with random
crap attached. Webcams can't just be webcams, they have to ship some horrible
interface as well, without which it's impossible to have full control of the device.

I much prefer the Linux model: The webcam is an image capture device, nothing more.
Every webcam works identically via a common API. If I remove one and plug in another,
capabilities of the hardware aside, nothing changes. That's precisely how I like it.


      
          <div class="CommentReplyButton">
            <form action="/Articles/346209/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor344810"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 31, 2009 21:54 UTC (Fri)
                               by <b>ebiederm</b> (subscriber, #35028)
                              [<a href="/Articles/344810/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The key point is that despite stable api nonsense and a lot of talk of a nonstable ABI to drivers, the kernel driver API has a lot of inertia and resistance to change.  Generally new apis are introduced while still providing the old api.  Eventually the old API goes away but rarely does it happen in a single kernel release.<br>
<p>
The kernel ABI because it depends on Kconfig options is much less stable and there are a lot to choose from on any given release.<br>
<p>
In general things don't change willy nilly and kill your driver, even out of tree.<br>
<p>
Thinking back on my experiences maintaining code out of tree for sometimes years at a time before it was merged.  Yes there are changes but they aren't hard too hard to keep up with.<br>
<p>
From the other side as one of the people who make changes in the APIs a lot of work is done to make it as painless as possible for the driver developers.  With both the old and the new apis living side by side for a while.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344810/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor344858"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2009 12:09 UTC (Sat)
                               by <b>xilun</b> (guest, #50638)
                              [<a href="/Articles/344858/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You are changing what you say on the fly (ABI -&gt; API), and your last post even contradict itself (the API is stable but sometimes it changes???).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344858/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344865"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2009 16:16 UTC (Sat)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/344865/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Oh, really? Why don't you quote where I said anything about an ABI. etc?<br>
<p>
I have never said anything about ABI, and I have consistently said that what is needed is a versioned and formally documented API.<br>
<p>
But if you can't understand my point, why are you responding?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344865/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor344448"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 14:46 UTC (Thu)
                               by <b>Richard_DCS</b> (guest, #56565)
                              [<a href="/Articles/344448/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This sounds like a nice theory though I've seen lots of counter examples, so I don't think it works.<br>
<p>
Also you miss the point that most users are making the transition from 9x to XP 32bit and then onto Windows 7 64bit in the future. That path stops drivers working on every transition, Linux never had that problem.<br>
<p>
Drivers work best when they are open source and in the mainline kernel where they can be fixed when needed.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344448/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344498"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 16:52 UTC (Thu)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/344498/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
No, no, no. I have been talking about source level API, not ABI! This is about developers, not users. <br>
<p>
I don't expect the same binary to literally work between all Windows or Linux versions (although in many cases it does, but I don't view that as necessary or even useful). <br>
<p>
Plus, I am not disputing the usefullness of open source at all. After all, that's a big part of why I am using Linux. I am just saying that a stable kernel API would make life easier for most developers and businesses. <br>
<p>
We should take the good stuff from Windows (stable API), improve it (make it source-only instead of binary ABI) and apply it to Linux.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344498/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344890"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2009 23:06 UTC (Sat)
                               by <b>Lumag</b> (subscriber, #22579)
                              [<a href="/Articles/344890/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <blockquote>
We should take the good stuff from Windows (stable API), improve it (make it source-only instead of binary ABI) and apply it to Linux.
</blockquote>

We?.. "Show us your code." I mean if you want stable API in some area, you can try working with developers in that area by providing patches that ensure backwards compatibility, etc. Unless you do that, all this talk is no sense. Sorry :)
      
          <div class="CommentReplyButton">
            <form action="/Articles/344890/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor344529"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 19:04 UTC (Thu)
                               by <b>Tomislav</b> (guest, #56442)
                              [<a href="/Articles/344529/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Sigh. You are missing the point.</font><br>
<p>
It seems to me that he's not missing it by much. Although I would prefer a<br>
stable API it looks like this is a matter of priorities. If you prefer<br>
stability and longevity, you choose RHEL or Debian and stick with their<br>
kernels. RHEL 4 supported 2.6.9 for 4 years. <br>
<p>
<font class="QuotedText">&gt; Oh, yes, the commercial distributions are trying to maintain a stable</font><br>
<font class="QuotedText">&gt; kernel for some time (although far from 15 years) - of course they </font><br>
<font class="QuotedText">&gt; would; this is what the vast majority of businesses and users really </font><br>
<font class="QuotedText">&gt; want and need regardless of what the stupid document</font><br>
<font class="QuotedText">&gt; "stable_api_nonsense.txt" says. Alas, it is actually causing further</font><br>
<font class="QuotedText">&gt; incompatibilities and problems between distributions - everybody has </font><br>
<font class="QuotedText">&gt; a different version, with different patches, etc. It is a nightmare.</font><br>
<p>
:shrugs:<br>
You pointed out (several times) that you are speaking from the developers<br>
standpoint. But here you base your argument on a claim that _businesses_<br>
and _users_ want a stable API. It's the ABI they (well, me at least) care<br>
about.<br>
<p>
You can't have rapid development _and_ a stable API in a single product.<br>
If you think this is possible I would very much like to hear about The Way<br>
To Do This. <br>
<p>
Another thing here that sticks in my eye, and I see that I'm not the only<br>
one, is the allusion that Microsoft offers support for it's kernel for 15<br>
years. IMO nobody there has touched the NT4 kernel for quite a while and<br>
would be greatly surprised if the NT5 family had any recent updates. They<br>
are only stable by virtue of being old.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344529/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344541"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 19:41 UTC (Thu)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/344541/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>It seems to me that he's not missing it by much. Although I would prefer a
stable API it looks like this is a matter of priorities. If you prefer
stability and longevity, you choose RHEL or Debian and stick with their
kernels. RHEL 4 supported 2.6.9 for 4 years.</blockquote>

<p>As I pointed out, that doesn't work. 

<p>First, what are you supposed to do with this stable kernel if you want to use newer hardware? 

<p>Secondly, every vendor and distribution has a different "stable" kernel, which in turn is different from the vanilla kernel with the same version. So, what do you do if you a hardware vendor? Even if you have included your driver in the mainline in 2.6.30, who does it help your customers some of who are using 2.6.18, some 2.6.9, some 2.6.26, etc? Is anybody surprised that hardware vendors are not keen on supporting Linux?

<p>Lastly, even if there was only one stable distribution in the world, 4 years is a far cry from 15. 

<blockquote>:shrugs:
You pointed out (several times) that you are speaking from the developers
standpoint. But here you base your argument on a claim that _businesses_
and _users_ want a stable API. It's the ABI they (well, me at least) care
about.</blockquote>

<p>Clearly I mean businesses who develop and support software and their customers who are affected by it because their reliability goes down and their costs go up. What I am going for here is that an enthusiastic hacker who is happy to recompile his own kernel daily (like most of us) can't always see the big picture.

<blockquote>Another thing here that sticks in my eye, and I see that I'm not the only
one, is the allusion that Microsoft offers support for it's kernel for 15
years. IMO nobody there has touched the NT4 kernel for quite a while and
would be greatly surprised if the NT5 family had any recent updates. They
are only stable by virtue of being old.</blockquote>

<p>Huh? Who is talking about support? The point of a stable API is precisely that - to continue using the same source with the newer OS-es which are currently supported. 
      
          <div class="CommentReplyButton">
            <form action="/Articles/344541/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345479"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Then there are no point and case is closed, right?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 5, 2009 19:40 UTC (Wed)
                               by <b>khim</b> (subscriber, #9252)
                              [<a href="/Articles/345479/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>The point of a stable API is precisely that - to continue using 
the same source with the newer OS-es which are currently 
supported.</blockquote>

<p>Sure. And we have many OSes which promised and failed to deliver that: 
Windows, Solaris, etc. <b>It just does not work</b>. Drivers from NT don't 
work in Windows 2000, drivers from Windows 2000 crash the Windows XP, 
drivers from Solaris 8 are unusabel in Solaris 10, etc.</p>

<p>Right now Linux supports more hardware then Windows - sure, the "latest 
and greatest" gadgets are supported by "latest and greatest" release of 
Windows only, but sheer number is on Linux side.</p>

<p>Stable OS (not stable API, but stable OS - I certainly remember cases 
where switch from NT4SP5 to NT4SP6 was impossible because drivers had no 
suppoort for this version) makes support for some hardware easier and for 
some hardware harder (recall NT4 and USB, for example, then do the same 
with Pixel Shaders 4), so I see no huge advantages either way.</p>

<p>What I <b>do see</b> is the wish to reduce number of problems for 
manufacturers by increasing number of problem for users and developers - 
and I can not agree that it's good idea.</p>

<p>If you want to make life easier then implement stable API where it 
naturally exist anyway: on the border between your hardware and my 
hardware!</p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/345479/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345517"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Then there are no point and case is closed, right?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 5, 2009 22:17 UTC (Wed)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/345517/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>Sure. And we have many OSes which promised and failed to deliver that: Windows, Solaris, etc. It just does not work. Drivers from NT don't work in Windows 2000, drivers from Windows 2000 crash the Windows XP, drivers from Solaris 8 are unusabel in Solaris 10, etc.</blockquote>

<p>Well, I am talking about a source level API, so I don't see your point really. Plus, I disagree with your example. The vast majority of drivers did work between Windows versions. Speaking both as a user and as an ex-Windows kernel developer.

<blockquote>What I do see is the wish to reduce number of problems for manufacturers by increasing number of problem for users and developers - and I can not agree that it's good idea.</blockquote>

<p>I am sorry but you are dead wrong. Very ironically just today (about hald an hour ago) I encountered exactly the problem I am describing. 

<p>I was asked to troubleshoot a Debian Lenny image on a new batch of POS machines. Well, guess what, Lenny's kernel 2.6.26 does not support the network adapter (Intel 82567LM-3). 

<p>So, WTF am I supposed to do? All the "wisdom" against out-of-tree drivers and stable API expressed in the numerous responses does not help me a bit! Should I perhaps install a newer kernel version? Huh? What about security updates? Backport a driver from 2.6.28? I don't have time to do that, and I am not a network driver expert.

<p>Fortunately for me, Intel maintains an out-of-tree driver at http://e1000.sf.net/ . An out of tree driver saved the day! As usual and as expected.

<p>Unless somebody can offer me a better solution than this out-of-tree driver, I don't see how the arguments carry any weight.
      
          <div class="CommentReplyButton">
            <form action="/Articles/345517/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345849"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Then there are no point and case is closed, right?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 7, 2009 14:34 UTC (Fri)
                               by <b>deleteme</b> (guest, #49633)
                              [<a href="/Articles/345849/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
But the e1000 driver is in the tree as well, right?  Which has been stated before in this thread, it's nice to have the source directly from the vendor as well.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345849/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor346086"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Then there are no point and case is closed, right?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 9, 2009 11:46 UTC (Sun)
                               by <b>khim</b> (subscriber, #9252)
                              [<a href="/Articles/346086/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <blockquote>Well, I am talking about a source level API, so I don't see 
your point really.</blockquote>

<p>What makes API so much different from ABI? In my experience breakage 
occurs not at format ABI/API level, but at level of semantic: old driver 
presume that something is done in some specific way and it does not work in 
exactly this way after small fix in kernel (I've personally seed cases 
where driver stopped working with NP4SP5=>NT4SP6 and XPSP1=>XPSP2 upgrades) 
- at that point the only solution is some person who can maintain driver... 
and if you have such person why do you need stable ABI or API?</p>

<blockquote>Plus, I disagree with your example.</blockquote>

<p>How can you disagree with truth?</p>

<blockquote>The vast majority of drivers did work between Windows versions. 
</blockquote>

<p>The wast majority of drivers work with Linux out-of-the-box. Speaking as 
a Linux user.</p>

<blockquote>I was asked to troubleshoot a Debian Lenny image on a new batch 
of POS machines. Well, guess what, Lenny's kernel 2.6.26 does not support 
the network adapter (Intel 82567LM-3).</blockquote>

<p>How is it different from my example above - where Windows XP SP2 broke 
drivers for Pinnacle DV500?</p>

<blockquote>So, WTF am I supposed to do?</blockquote>

<p>You know the answer - you just refuse to resign yourself to it.</p>

<blockquote>Should I perhaps install a newer kernel version?</blockquote>

<p>Yes. Either that or ask your vendor for older motherboard.</p>

<blockquote>What about security updates?</blockquote>

<p>What about them? Latest version of kernel always have the latest version 
of security updates applied - it's up to your distribution to package 
them.</p>

<p>Remember that bug in driver can make your system volnerable (<a 
href="http://lwn.net/Articles/300202/">case to the point</a> - and 
conveniently it's about e1000 as well) so there are only two ways to 
live:<br />
1. Use drivers from your distribution kernel (and forgo latest and greatest 
hardware), or<br />
2. Use latest and greatest version of kernel (and live with possible 
bugs).</p>

<p>Both approaches don't need any stable API or ABI...</p>

<p>P.S. Infromation from Windows campus agrees with me: substantial 
percentage of problems with the (in)famous Windows (un)stability are caused 
by drivers.</p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/346086/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor346592"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Then there are no point and case is closed, right?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 12, 2009 4:12 UTC (Wed)
                               by <b>obi</b> (guest, #5784)
                              [<a href="/Articles/346592/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
My first reaction would have been to install Debian's 2.6.30 kernel backport - that way I get all the bugfixes and security updates too.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/346592/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor344426"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 13:13 UTC (Thu)
                               by <b>cortana</b> (subscriber, #24596)
                              [<a href="/Articles/344426/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
To be fair, the WHQL testing is worthless. The WHQL-passed driver for my RT61-based wlan interface causes 64-bit Vista and Windows 7 systems to crash whenever it deals with a non-trivial about of traffic. This is extremely easy to reproduce: just running the Steam server browser, Left 4 Dead or Bittorrent is enough to trigger the crash. But the drivers were rubber stamped, no problem...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344426/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344514"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 17:54 UTC (Thu)
                               by <b>BenHutchings</b> (subscriber, #37955)
                              [<a href="/Articles/344514/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
WHQL testing involves running Microsoft's test suite on your own system. If I remember correctly, they require you use an SMP system, x86-64 and &gt;4GB RAM, which historically have exposed a number of driver bugs, and they test various corner cases in power management. But it's still possible to have the driver cheat to pass the tests, or to run the test suite repeatedly until it passes, or even modify the test suite to falsely report passes.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344514/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor344857"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2009 12:05 UTC (Sat)
                               by <b>xilun</b> (guest, #50638)
                              [<a href="/Articles/344857/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
&lt;quote&gt;Microsoft at least tests all the drivers that are shipped with the OS.&lt;quote&gt;<br>
<p>
Depends of what you call testing. I once tried the SB16 driver available on windows update, which was utterly broken with my SB16. The worse part being than downgrading to the old driver (which worked perfectly, my mistake on wanting to try a new one for no real reason) was a nightmare.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344857/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor344308"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 4:06 UTC (Thu)
                               by <b>elanthis</b> (guest, #6227)
                              [<a href="/Articles/344308/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Microsoft breaks ABIs and userland apps all the fucking time.  Why do you think so many people complain about Vista?  It doesn't run a lot of apps that worked perfectly in XP (even if you install/run them in administrator mode or in XP compatibility mode).  Hell, do any of you actually remember when XP came people?  People bitched about it just as much because it broke a ton of apps that worked just fine in 95/98.  Windows 7 can't run some apps that Vista handled just fine.<br>
<p>
Windows maintains stable ABIs *where it can* because Real Users kind of prefer not having half their desktop stack break every 6 months while proclaiming the endless breakage as "true innovation!"<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344308/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344499"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 17:03 UTC (Thu)
                               by <b>mikov</b> (guest, #33179)
                              [<a href="/Articles/344499/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
No, I am sorry, this is beside the point.<br>
<p>
For one, Microsoft doesn't release a new kernel every 6 months (far from it), so the breakage doesn't occur every 6 months. I don't want to sound like I am defending them, but there are parts of their strategy that are trruly superior to the Linux model in my opinion. We cannot simply say "everything that Microsoft does is bad". Monopoly is part of their success, but a large part of it also is that they did some things right. Having a stable API is definitely one of them.<br>
<p>
That pains me because I am Linux developer and user for both practical and ideological reasons (I am willing to suffer a little pain in the cases when Linux is inferior).<br>
<p>
Plus, I am referring to source level API, and not so much keeping it completely static, but approaching the changes formally by versioning and formal documentation. <br>
<p>
Not having a stable API makes life a little easier for the core kernel developers, but much harder for everybody else. Plus, in the broader picture, I am sure that it is an insurmountable barrier before "Linux" on the desktop.<br>
<p>
Heed my words: Linux will never succeed on the desktop without a stable driver API. I wish it wasn't so.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344499/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344509"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 17:43 UTC (Thu)
                               by <b>foom</b> (subscriber, #14868)
                              [<a href="/Articles/344509/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Linux *does* have stable driver APIs.:<br>
- libusb for usb in userspace.<br>
- FUSE for filesystems in userspace.<br>
- UIO for driving arbitrary hardware from userspace<br>
<p>
Perhaps more?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344509/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344891"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2009 23:11 UTC (Sat)
                               by <b>Lumag</b> (subscriber, #22579)
                              [<a href="/Articles/344891/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
IIRC stuff around netdev was backwards-compatible for ages (not talking about NAPI :)). We experienced only one major change with it - the net_device_ops.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344891/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344920"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2009 8:43 UTC (Sun)
                               by <b>johill</b> (subscriber, #25196)
                              [<a href="/Articles/344920/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Multiqueue was another big change, but didn't matter much unless you used it.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344920/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor344556"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 20:10 UTC (Thu)
                               by <b>rvfh</b> (guest, #31018)
                              [<a href="/Articles/344556/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I just wanted to say that, Linux-lover as I am, I agree with you mikov. It seems that people are a bit too eager to break interfaces (and even Linus complained about it, though it was about the /sys filesystem IIRC).<br>
<p>
Breaking the API when it solves a problem is the Linux way, so improvements can be made, but one should strive not to do it if it can be avoided. And one would expect these changes to be kinda obvious and documented (a proper #warning can help a big deal), or even to a have an in-kernel tool (Coccinelle can do this AIUI) provided to update your code for you! Ok, I know, "easy, tiger."<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344556/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor345188"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 4, 2009 16:02 UTC (Tue)
                               by <b>nye</b> (subscriber, #51576)
                              [<a href="/Articles/345188/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I've not personally come across single application which works in XP but not Vista. The primary problem with Vista is that it's noticeably slower.<br>
<p>
Comparing 95/98 with XP/Vista is fairly absurd. They're not different versions of the same OS; they're completely different OSes which both have very-nearly compatible implementations of some important APIs, most notably win32. In fact, come to think of it, I can't name a single win32 application that works in Windows 95 and not Vista. The only applications that have broken along the way either interact with the OS at a lower level, or are 16-bit, or actually DOS applications. That would be a bit like expecting Linux to provide perfect binary compatibility with Minix.<br>
<p>
The only substantiated bitching I've heard has been about drivers, but you were talking about userland apps; I contend that the number of broken userland apps is vanishingly small.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345188/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345211"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 4, 2009 17:43 UTC (Tue)
                               by <b>mcmanus</b> (guest, #4569)
                              [<a href="/Articles/345211/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <i>I've not personally come across single application which works in XP but not Vista.</i>

<p>
Here's a good one: http://msdn.microsoft.com/en-us/library/aa376635%28VS.85%29.aspx
<p>
Packet Filtering Functions
<p>
[These functions are available for use in the operating systems listed in the Requirements section for each function. In Windows Server "Longhorn", these functions return ERROR_CALL_NOT_SUPPORTED. The MprConfigInterfaceTransportSetInfo function and the Windows Filtering Platform API Management Functions provide similar functionality.]
<p>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345211/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor344405"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 11:43 UTC (Thu)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/344405/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; To be fair to the parent (who I also disagree with) that particular problem only exists due to the lack of a stable kernel API.</font><br>
<p>
No that is completely wrong. The required API was not available (because it was not yet developed) in 2.6.26.<br>
Having a stable API/ABI does not help this at all.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344405/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor344108"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 17:41 UTC (Wed)
                               by <b>fuhchee</b> (guest, #40059)
                              [<a href="/Articles/344108/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <i>This illustrates why dividing the kernel and the userland into two totally separate projects is a broken development model that doesn't scale.</i>
<p>
Tell that to Microsoft, or almost any other system software vendor, which values backward binary compatibility.

      
          <div class="CommentReplyButton">
            <form action="/Articles/344108/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor344102"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 17:41 UTC (Wed)
                               by <b>me@jasonclinton.com</b> (subscriber, #52701)
                              [<a href="/Articles/344102/">Link</a>] (14 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'll try to ignore the political land-mines all over your text and focus specifically on your claim that $OS does this better. The simple fact is that there are *thousands* of user space consumers of the TTY kernel interfaces out there in the wild, even on *BSD.<br>
<p>
For a counter example of how this "un-scalable" development model can actually work just fine--regardless of OS--look no further than the DRI2 and KMS changes coordinated across X.org, other user space and the Linux kernel, all at the same time with many hands involved in the work and with very little user-visible disruption.<br>
<p>
Your (primary) claim just doesn't square with the reality, anywhere.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344102/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344123"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 18:18 UTC (Wed)
                               by <b>mheily</b> (subscriber, #27123)
                              [<a href="/Articles/344123/">Link</a>] (12 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; For a counter example of how this "un-scalable" development model can actually work just fine--regardless of OS--look no further than the DRI2 and KMS changes coordinated across X.org, other user space and the Linux kernel, all at the same time with many hands involved in the work and with very little user-visible disruption.</font><br>
<p>
Your counter-example actually illustrates my point. It is relatively easy to coordinate changes between the kernel and a single userspace project such as X.org. Once you try to make kernel changes that impact many userspace programs, it becomes very difficult to coordinate the necessary changes. The story of what happened with the Linux TTY changes is concrete evidence of the drawbacks of the split kernel v.s. userspace development model.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344123/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344133"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 18:23 UTC (Wed)
                               by <b>me@jasonclinton.com</b> (subscriber, #52701)
                              [<a href="/Articles/344133/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You ignored the part of my response where I pointed out that there are thousands of TTY consumer in *BSD. At this point, I'm just going to assume that you're trolling and not respond to this thread any further.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344133/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344139"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 18:55 UTC (Wed)
                               by <b>mheily</b> (subscriber, #27123)
                              [<a href="/Articles/344139/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Fine. Please ignore the rest of this comment because anything you don't agree with must be a troll. Continuing with the hypothetical example of TTY changes to a BSD-based operating system...<br>
<p>
In order to coordinate changes to the kernel TTY code that potentially impact thousands of userland programs, you would need a team of developers and testers to go through the code looking for problems. First, you fix problems in the the core userland programs (aka. the "base system"). The source code for everything is under /usr/src, so you can start with:<br>
<p>
   $ find /usr/src -type f -exec grep '#include &lt;pty.h&gt;' {} \;<br>
<p>
After you have a patch for the base system, you install the entire ports tree and repeat the search. Ports are installed under /usr/ports, so the command is:<br>
<p>
   $ find /usr/ports -type f -exec grep '#include &lt;pty.h&gt;' {} \;<br>
<p>
Once you have a list of potential problematic ports, you send out a notice to the ports maintainers and users of the -CURRENT branch asking them to test the affected ports against the experimental TTY patch for the base system. Some ports, such as Emacs, may rely on the old behavior, so they will need to be patched. These ports will require patches in order to make them work with the new kernel. Other ports may not need any changes at all.<br>
<p>
Once all the changes are tested and reviewed (kernel, base system, and ports), the combined patchset is applied to the -STABLE branch for inclusion in the next stable release. All of this development and testing is costly, so hopefully the kernel changes were worth it :)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344139/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344148"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 19:12 UTC (Wed)
                               by <b>bronson</b> (subscriber, #4806)
                              [<a href="/Articles/344148/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
KDE and Emacs, the two things that broke in the article, aren't a part of BSD.  It's true that fixing code in ports is easy, just like patching a .deb or .rpm is easy.<br>
<p>
That's not where the problem lies.  Here's are the hard parts:<br>
<p>
- testing the app, figuring out if there are bugs<br>
- finding the bugs, fixing the bugs<br>
- getting code review, regressing your fixes<br>
- upstreaming your patches.  All they do is work around a new and obscure kernel bug?  Good luck with that!<br>
<p>
And THAT is why the kernel &lt;-&gt; user space API should be stable.  I like ports as much as anybody else but they just don't help much here.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344148/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor344175"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 20:02 UTC (Wed)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/344175/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
And if TTY code was that easy to grep for, maybe it would be simple: we <br>
have distributors who can point to such code.<br>
<p>
But it is not. TTY users can be people who accept file descriptors via <br>
pipes and have no idea there are TTYs at the other end: they can be people <br>
who use the Unix98 or the old BSD pty interface (which still has users!); <br>
every use of ioctl() has to be audited: the signal handling in TTY users <br>
has to be checked; it ties in with process groups...<br>
<p>
The TTY stuff introduced in the early BSD Unix is, let's be blunt, a <br>
bloody design mess, and a pervasive one. It's not a nice simple &lt;pty.h&gt; <br>
interface, by any means, although it should have been.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344175/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344248"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Passing fds via pipes?!</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 0:01 UTC (Thu)
                               by <b>i3839</b> (guest, #31386)
                              [<a href="/Articles/344248/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; TTY users can be people who accept file descriptors via</font><br>
<font class="QuotedText">&gt; pipes and have no idea there are TTYs at the other end</font><br>
<p>
How is this possible? Did you mean unix domain sockets instead of pipes?<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344248/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344253"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Passing fds via pipes?!</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 0:37 UTC (Thu)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/344253/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Wrong way round. An fd to a TTY can be passed over a unix-domain socket <br>
and then used (which will trigger line discipline magic even though the <br>
app has no idea it's using it), so it's using a TTY even though it never <br>
opened it or looked at /dev/ptmx. (This is probably not common, but it <br>
makes a comprehensive audit of TTY users ridiculously hard, because use of <br>
AF_UNIX sockets *is* common and fd passing is not particularly rare. One <br>
variation of it, in which the fd is passed into the application as one of <br>
fds 0 to 2, is of course exceedingly common. You don't even need AF_UNIX <br>
sockets for that.)<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344253/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor344240"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 22:46 UTC (Wed)
                               by <b>jond</b> (subscriber, #37669)
                              [<a href="/Articles/344240/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
...and then your user's custom code, not part of the OS, breaks when you release.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344240/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor344320"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 4:47 UTC (Thu)
                               by <b>daniels</b> (subscriber, #16193)
                              [<a href="/Articles/344320/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
On GNU userspace, you could use grep -r. ;)<br>
<p>
(This is a blatant, content-free, troll.)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344320/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345831"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 7, 2009 11:01 UTC (Fri)
                               by <b>efexis</b> (guest, #26355)
                              [<a href="/Articles/345831/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <i>"(This is a blatant, content-free, troll.)"</i><br>
<br>
You kiddin? That's the most helpful thing I've read this thread! :-)


      
          <div class="CommentReplyButton">
            <form action="/Articles/345831/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor344144"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 19:02 UTC (Wed)
                               by <b>berndp</b> (guest, #52035)
                              [<a href="/Articles/344144/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Your perception of the kernel development model is broken: It's not that 2.6.30-rc5 (or 2.6.31) hits the desktop of Joe Plumber the day<br>
after publication on <a href="http://www.kernel.org/">http://www.kernel.org/</a> of distributions. That's the job of distributors (and it's the same in the<br>
BSD world - they are distributing the complete OS so they must be compared the Linux distributors).<br>
<p>
Assuming that "kdesu" is broken, there is plenty of time for "kdesu" to get fixed (and pushed expedited downstream because it's a bug fix!).<br>
Maintaining bug compatibility is plain simply not worth the effort (and it is IMHO violating any sane open-source development model<br>
where it's at least possible to *fix* bugs and not maintain an enormous amount of bug compatibility code - and maintenance effort - for ages.<br>
Why else should Windows needs exponentially more resources with each release?).<br>
<p>
If someone wants eternal backward bug compatibility, please *do* it - but do not complain to others or even ask them.<br>
Especially not for some random buggy app which just happen to not trigger a race condition.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344144/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344159"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 19:32 UTC (Wed)
                               by <b>mheily</b> (subscriber, #27123)
                              [<a href="/Articles/344159/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Sometimes it's not clear which codebase is "broken" and needs to be fixed. Alan Cox's changes may have been totally legal according to the RS-232 standards, but if Emacs and many other programs depend on the old  behavior, it's difficult to say that all userspace programs must be changed. One person's "bug" is another person's "feature" :)<br>
<p>
I do agree with Linus that increased kernel parallelism should avoid impacting userland code that depends (rightly or wrongly) on serialization.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344159/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor345833"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 7, 2009 11:24 UTC (Fri)
                               by <b>efexis</b> (guest, #26355)
                              [<a href="/Articles/345833/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <i>"Why else should Windows needs exponentially more resources with each release?"</i><br>
<br>
Sloppy development, greater number of features we're greater for, and greater number of features that we're really really not.<br>
<br>
Windows uses subsystems for different API sets (whether it's dos, posix, win16, win32, .net etc) that are loaded on use, with backward compatibility confined within the subsystem, or even different versions of the library or live patching. MS are also always pushing their newest 'bestist' API sets, which means if you're not running old software, you tend to not be needing to load the old APIs (you can have windows run with win16/dos support completely removed for example) so there's no extra resource requirement there... and if you are running old software, then of course you need the old support.<br>
<br>
Win7 looks to have lower requirements than Vista (I can even run it on my laptop, something I couldn't dream of with Vista), but still, it's much slower for basic functionality than my 2003 install. Basic stuff like recursive file meta data scanning, more progress bars (which require two-pass operations, one to find out how much stuff there is to be done, and the second to do it) slows down the UI. Services to control CPU scheduling for media applications adds complexity there, as do the various annoyance^H^H^H^H^H^H^H^H^Hsecurity services. It's genuine complexity of the OS combined with less than optimal coding that makes it chug, backward compatibility cruft really isn't as big a player as you might think.
      
          <div class="CommentReplyButton">
            <form action="/Articles/345833/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor344938"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2009 18:29 UTC (Sun)
                               by <b>cortana</b> (subscriber, #24596)
                              [<a href="/Articles/344938/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Hm, you mean the driver changes that left me without working 3d acceleration for my Intel-powered laptop for 8 months? :)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344938/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor344186"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 20:30 UTC (Wed)
                               by <b>nevyn</b> (guest, #33129)
                              [<a href="/Articles/344186/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>
This illustrates why dividing the kernel and the userland into two totally separate projects is a broken development model that doesn't scale. I'm not trying to start a flamewar by bringing up BSD, but I've always thought that their approach of releasing a complete operating system allows you to make major infrastructure improvements that cross the boundary between kernel and userland.
</blockquote>

<p> Ahh, how right you are ... which is why Linux development hasn't scaled as well as *BSD development. Also I know a bunch of Linux customers who would be much happier to be told to just "get their custom enterprise apps. into the main Linux git repo." so that the APIs in the kernel can be broken more often.
</p>

<p> *shakes head and wakes up* ... ooohh, bad nightmare there for a minute.
</p>

<blockquote>If one of the BSDs wanted to fix their TTY code, they would coordinate the changes in the kernel, core userland, and ports. This allows you to change existing bad behavior with minimal risk of breakage
</blockquote>

<p> Last time I checked emacs and kde weren't in BSD. </p>

<blockquote>
Existing distributions would be free to fork this implementation and add their own differentiating features, like Ubuntu forks Debian every six months and polishes it up for desktop users.
</blockquote>

<p> Except this "description" of Ubuntu vs. Debian is not based on reality either. Zero for three, doing well today little troll.
</p>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344186/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344190"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Please</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 20:42 UTC (Wed)
                               by <b>corbet</b> (editor, #1)
                              [<a href="/Articles/344190/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      One might well disagree with the opinions expressed in the parent post, but it was not a troll.  Please, let's try to avoid that kind of language and focus on the real issues, OK?
      
          <div class="CommentReplyButton">
            <form action="/Articles/344190/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344327"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Please</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 5:17 UTC (Thu)
                               by <b>chad.netzer</b> (subscriber, #4257)
                              [<a href="/Articles/344327/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
"GNU + Linux = broken development model".  It should be no surprise that LWN readers (including many Linux developers) won't take kindly to their style of development being called "broken".  That's a statement that requires some compelling evidence to back up; one is essentially saying Linux has progressed so far *in spite of* such a broken model.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344327/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345846"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Please</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 7, 2009 14:14 UTC (Fri)
                               by <b>efexis</b> (guest, #26355)
                              [<a href="/Articles/345846/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The wrongness of one doesn't increase the rightness of another, and the politeness of another isn't a prerequisite for the politeness of oneself. I must say I rather see a single inpolite message in a thread than many, and many others here agree, which is why we prefer for people not to sink to squabble. I think it's fair enough to point that out. There's always LKML and slashdot for flamefests :-)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345846/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor346593"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Please</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 12, 2009 4:25 UTC (Wed)
                               by <b>obi</b> (guest, #5784)
                              [<a href="/Articles/346593/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I wish I could highlight your post; it cheers me up knowing at least some people understand this point. ;-)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/346593/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor344669"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Please</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 31, 2009 5:21 UTC (Fri)
                               by <b>Los__D</b> (guest, #15263)
                              [<a href="/Articles/344669/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Did you look at the title?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344669/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor345922"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">GNU + Linux = broken development model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 7, 2009 18:57 UTC (Fri)
                               by <b>poison</b> (guest, #60114)
                              [<a href="/Articles/345922/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Just a few random unfiltered thoughts that popped up while reading through <br>
this thread. Please forgive me^^<br>
 * What do you mean no stable API? I will spend WAY more time adapting to <br>
API changes compared to implementing the features myself and weeding out <br>
most bugs? WHY ON EARTH SHOULD I USE IT?<br>
 * Innovation through rewriting and completely breaking APIs? Ok, I've done <br>
rewrites. They involved MAJOR changes to requirements. What was your <br>
reason? The new API was neater? Was the performance improvement anywhere <br>
near measurable and not achievable without breaking the API so badly? Was <br>
the design so bad you couldn't implement the features on top? Oh wait, <br>
Linux folks have some strange analogies with software design/biology and <br>
religious nuts. I don't get the comparison but apparently it's a religious <br>
stance that thinking about requirements and laying out an API that could <br>
sustain a a year or two is a bad idea compared to writing some fugly code <br>
that nobody would touch and then rewriting it every few months. Who cares, <br>
it works (somehow).<br>
 * ... Abstraction? Whats that? Oooh, right ... forget about it.<br>
 * Out of tree is easier? Hows that? In case refactoring is REQUIRED, <br>
wouldn't it be easier if everything is in place?<br>
 * OOOh ... out of treeeeee! The things that disappear into the mist once <br>
you upgrade to a new kernel version. What? Recompiling won't help? The API <br>
is gone? Not maintained? Oh well ... I'll just buy a new card.<br>
 * Windows? Like on a submarine? As soon as you open one the trouble <br>
starts? The blue thingy thats so stable you have to reboot your server <br>
every week? (Of course except you do nothing at all with it except letting <br>
it sit there and brag about how stable it is.) At least it has a stable <br>
ABI. Oh to hell with a stable ABI, I just want a stable API!<br>
 * Companies MAINTAINING ...? Sure that'll help sales. Maintaining drivers <br>
for 10 year old hardware! Lots of profits!<br>
 * Standard Interfaces? The ones that get replaced all the time? (Wait ... <br>
I was already there, wasn't I?)<br>
 * Beer.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345922/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor344079"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 17:36 UTC (Wed)
                               by <b>adicarlo</b> (guest, #8463)
                              [<a href="/Articles/344079/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This is a case where Linus came down too hard on Alan.   He swung the axe, not on the basis of lack of work, lack of progress, or any technical issue whatsoever.  AFAICT, Linus stomped based only on his perception of Alan's attitude.<br>
<p>
Sure, I understand why Linus would do that.  He has to cope with bug denial from hackers and maintainers all the time.  Yet it seems to me he's started to develop a hair-trigger towards developers complaining about the abuses of userspace.<br>
<p>
Sure, Alan grumbled about the behavior of TTY consumers in the wild.  Even so, he never showed any resistance to fixing these issues.  My perception is that things had been moving along well, with regressions being closed left and right.<br>
<p>
IMHO, I think Linus should "man up" and offer an apology.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344079/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344251"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 0:22 UTC (Thu)
                               by <b>pr1268</b> (subscriber, #24648)
                              [<a href="/Articles/344251/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>Agreed.  After all, Alan has been working on the Linux kernel for what, fifteen years?  (Maybe longer.)</p>

<p>While I often find value in Linus' pearls of wisdom (often told with an acerbic but magisterial tone), I am troubled by how he snubbed Alan this way.  I pray and hope that the two of them can work out their differences of opinion as (1) our editor has already pointed out that the TTY code is a harsh beast, and (2) Alan is (was) at least willing to try to tame it.</p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/344251/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor344142"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 19:16 UTC (Wed)
                               by <b>Tobu</b> (subscriber, #24111)
                              [<a href="/Articles/344142/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>
Ignoring the I don't like your attitude mismatch, Linus uses sloppy terminology with his "bug".
</p>
<p><pre>
> Why? Why blame emacs? Why call user land buggy, when the bug was 
> introduced by you, and was in the kernel? Why are you fighting it? Why did 
> it take so long to admit that all the regressions were kernel problems? 
> Why were you trying to dismiss the regression report as a user-land bug 
> from the very beginning?
</pre></p>
<p>
While the emacs+tty code together show unexpected and unwanted behaviour (one meaning of bug), it isn't up to him to decide that the tty code has inconsistent semantics (another meaning of bug). He could have been more precise and less insulting.
</p>
<p>
iabervon's comment makes a good point on where the semantics come from.
</p>
<p><small>
(Where to fix things is an entirely different matter of short vs long term maintability, from the point of view of people who freeze things vs people who update things.)
</small></p>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344142/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor344204"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 21:38 UTC (Wed)
                               by <b>dougg</b> (guest, #1894)
                              [<a href="/Articles/344204/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
My vote would be that the original copyright holder of the tty subsystem, if still active if kernel development, should be actioned to do the re-rewrite. Then the best kernel code reviewer (IMO Alan Cox) should be actioned to decide how subtle differences in semantics should be handled. This will only work if the reviewer is given a veto over re-rewriter and the latter has some semblance of humility.  ... just day dreaming.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344204/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344220"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 22:10 UTC (Wed)
                               by <b>tzafrir</b> (subscriber, #11501)
                              [<a href="/Articles/344220/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
To quote the article:<br>
<p>
'The top of drivers/char/tty_io.c still reads "Copyright (C) 1991, 1992, Linus Torvalds."'<br>
<p>
Looks like the original author to me. He also appears to still be active. I also bet he wouldn't be flamed that badly by Linus.<br>
<p>
Sounds like a plan.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344220/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor344226"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Linus and folks need to take a different approach here.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 22:22 UTC (Wed)
                               by <b>drag</b> (guest, #31333)
                              [<a href="/Articles/344226/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Not a huge difference. A small difference.<br>
<p>
The idea that a kernel can maintain perfect userland ABI/API accross all versions for ever and ever is just _wrong_ thinking. They can't do it. It's impossible and is something that they have consistantly failed at over and over again. <br>
<p>
Ideally it should be like that, but it isn't and won't ever be. Sorry. Can't do it. It's impossible. Nobody is that perfect. Soooo.... What should they do differently?<br>
<p>
Version Numbering the ABI<br>
<p>
Every 4 years or so introduce another new userland-ABI compatibility version. This gives people a chance to clean up /proc, /sys, bad sys call designs, odd tty insanity, break compatibility with old X drivers, clean up file system behavior, etc etc.<br>
<p>
Then try to do your best to support the previous ABI. So that the kernel supports 2 versions at most. So that gives you about 8 years of ABI/API compatibility. <br>
<p>
Because right now what is happenning is that the Linux kernel isn't supporting 1 ABI version.. it's supporting _hundreds_. Each time a kernel developer introduces a bug or a odd behavior and applications start taking advantage of that then that is a new feature that Linux will have to support for the rest of the time. (which it will fail at eventually)<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344226/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344247"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Linus and folks need to take a different approach here.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 23:55 UTC (Wed)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/344247/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Consistent ABIs are impossible.<br>
<p>
Also, the X Window System doesn't exist.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344247/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344358"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Linus and folks need to take a different approach here.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 6:44 UTC (Thu)
                               by <b>zlynx</b> (guest, #2285)
                              [<a href="/Articles/344358/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The X ABI has been broken hundreds (probably thousands) of times.<br>
<p>
I unfondly remember the days of the CU computer lab where some applications would not display properly from the HP to the X terminals but worked from the Sun. I recall it was xv the image viewer that was usually good for breaking this stuff.<br>
<p>
I remember some odd problems with that second, higher performing proprietary(I think it was?) X server Red Hat included with the boxed version 5.2.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344358/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor344235"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">the unknown factor</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 22:47 UTC (Wed)
                               by <b>sebas</b> (guest, #51660)
                              [<a href="/Articles/344235/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If KDE or Emacs depend on a bug in the kernel, they need to be fixed. In<br>
those cases it's actually relatively easy, since the bug has already been<br>
triaged and the components that need fixing have been identified.<br>
<p>
Whether or not the kernel should keep compatibility (i.e. the fix for the<br>
regressions) is a different question. If two widely used applications show<br>
problems with a new kernel version, then there's a non-zero chance other<br>
applications are "broken" as well. This $unknown needs to be offset with<br>
the cost of maintaining the incorrect behaviour.<br>
<p>
This again has little to do with personal issues, which play an important<br>
role in this story.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344235/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor344242"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2009 23:40 UTC (Wed)
                               by <b>nowster</b> (subscriber, #67)
                              [<a href="/Articles/344242/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>Just in:</p>

<pre>
commit e043e42bdb66885b3ac10d27a01ccb9972e2b0a3
Author: OGAWA Hirofumi &lt;hirofumi@mail.parknet.co.jp&gt;
Date:   Wed Jul 29 12:15:56 2009 -0700

    pty: avoid forcing 'low_latency' tty flag

    We really don't want to mark the pty as a low-latency device, because as
    Alan points out, the ->write method can be called from an IRQ (ppp?),
    and that means we can't use ->low_latency=1 as we take mutexes in the
    low_latency case.

    So rather than using low_latency to force the written data to be pushed
    to the ldisc handling at 'write()' time, just make the reader side (or
    the poll function) do the flush when it checks whether there is data to
    be had.

    This also fixes the problem with lost data in an emacs compile buffer
    (bugzilla 13815), and we can thus revert the low_latency pty hack
    (commit 3a54297478e6578f96fd54bf4daa1751130aca86: "pty: quickfix for the
    pty ENXIO timing problems").

    Signed-off-by: OGAWA Hirofumi &lt;hirofumi@mail.parknet.co.jp&gt;
    Tested-by: Aneesh Kumar K.V &lt;aneesh.kumar@linux.vnet.ibm.com&gt;
    [ Modified to do the tty_flush_to_ldisc() inside input_available_p() so
      that it triggers for both read and poll()  - Linus]
    Signed-off-by: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;

</pre>
      
          <div class="CommentReplyButton">
            <form action="/Articles/344242/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor344241"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Alan, please reconsider</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 0:04 UTC (Thu)
                               by <b>Felix_the_Mac</b> (guest, #32242)
                              [<a href="/Articles/344241/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<p>
Alan, you don't know me, I am just a Linux fanboy, but out here in Ubuntuland, I have been rooting for you.<br>
<p>
You're the one they sent in where lesser mortals fear to tread.<br>
Nobody else could possibly grok the tangle of code that is the TTY layer.<br>
To me you are the 'asset' dispatched to eliminate the BKL.<br>
<p>
Back in the real world :-) ... you are one of the elders of GNU/Linux and you have devoted (almost) half of your life to it because you believe in it.<br>
<p>
Today, at this moment of stress, when you have been publicly slighted by the boss, please just remember that we, the people, really are counting on you to do a difficult job, that there really is nobody else eager to step in to your shoes and take the huge workload and _apparently_ small reward.<br>
<p>
Most of all please know that your efforts are more widely appreciated than you realise.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344241/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344256"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Alan, please reconsider</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 0:44 UTC (Thu)
                               by <b>johnflux</b> (guest, #58833)
                              [<a href="/Articles/344256/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I was 15 when I first met Alan Cox.  I asked him to sign my Tux teddy bear :-D  He did try, but using a permanent marker on a fluffy toy just didn't work as well as I'd thought it would.<br>
<p>
He seemed very amused by the whole thing.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344256/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor344300"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Alan, please reconsider</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 2:25 UTC (Thu)
                               by <b>pflugstad</b> (subscriber, #224)
                              [<a href="/Articles/344300/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
+5, ditto, "what he said" and all that.<br>
<p>
When Linus flies off the handle (and IMO, he did so here), I always look to Alan's words for a glimpse of sanity. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344300/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor344250"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Getting a new tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 1:10 UTC (Thu)
                               by <b>PaulWay</b> (subscriber, #45600)
                              [<a href="/Articles/344250/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It occurs to me that what the TTY interface needs is a replanning.  Something like:<br>
<p>
1: Work up a new interface ('nu-serial') that communicates serial data and related out-of-band information in a sensible, linear way.  Don't design this to comply with RS-232, RS-422 or anything - design it to work with data and userspace requirements.<br>
2: Convert userspace programs across to this new interface.<br>
3: Write the TTY driver to connect to the nu-serial interface.<br>
4: Optimise the nu-serial interface to work well with threads and across cores.<br>
5: Phase out the old TTY interface.<br>
6: Profit.<br>
<p>
The problem seems to me to be that everyone's got a slightly different interpretation of what a TTY should do, and it's being bolted into a whole bunch of things like ppp, KDE and emacs that are needing quite different things from the serial interface.  If there's already something like nu-serial, then so much the better.<br>
<p>
I'm not a kernel developer, though, so I have no ability to either implement it or guide the project.  Some might argue that I shouldn't be saying anything.  It does seem to me, however, that this is the approach that's been taken in the past with other things - libata, memory allocators, or schedulers being the first (bad) examples that pop into my head.<br>
<p>
Have fun,<br>
<p>
Paul<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344250/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344271"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Getting a new tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 1:20 UTC (Thu)
                               by <b>corbet</b> (editor, #1)
                              [<a href="/Articles/344271/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      The real problem here, of course, is step 2.  The current TTY interface is a little brutal at times, but it's standard and a lot of programs have been written to it.  A new user-space API would be painful to bring in, and we'd still have to support the old one forever.
<p>
Past history in this area is not greatly encouraging either.  Solaris tried more-or-less what you suggest; the result was called "streams."  If you've never had to deal with those, count your blessings.
      
          <div class="CommentReplyButton">
            <form action="/Articles/344271/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344373"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Getting a new tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 8:08 UTC (Thu)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/344373/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The *problem* is also step 2, of course. The TTY layer isn't complicated <br>
by its need to conform to RS232 or whatever. It's complicated by its <br>
horrendously arcane userspace interface (what is it, *two* chapters in <br>
APUE?), which is the very thing whose behaviour must be preserved.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344373/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor344365"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Getting a new tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 7:39 UTC (Thu)
                               by <b>iq-0</b> (subscriber, #36655)
                              [<a href="/Articles/344365/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The problem is in number 2, as many applications try to be os independent (or at least unix-flavor <br>
independent).<br>
This is the point that most people don't seem to grasp and perhaps why Linus was so harsh: Emacs <br>
works on a large number of unixes, why is a breakage on Linux the fault of Emacs? Sure it may be <br>
bug, but that would make it a bug that exists outside of Linux and the main purpose of Linux is and <br>
was to be a independent unix-like posix compatible operation system.<br>
This also means that probably Emacs (by virtue of it being a widely used application) was just first <br>
to be impacted by this behavior. And since other applications are probably also directly impacted by <br>
this change of semantics (read: effective ABI change) is not desirable.<br>
<p>
The KDE bug is different in that there is a clear indication that it would also not work on other <br>
unixes and probably went unnoticed due to different defaults in distributing KDE which caused that <br>
part to be hardly used (or perhaps some ports has a local patch to fix it which never got upstream).<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344365/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344372"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Getting a new tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 8:07 UTC (Thu)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/344372/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Just because something works doesn't mean it's not buggy. I don't know <br>
about Emacs, but XEmacs's TTY code has had data-losing bugs before, and <br>
worked on heaps of platforms until Linux 2.6 came along, when it started <br>
doing exactly what we see Emacs doing now, losing the end of compilations <br>
(but for a different underlying reason). It can happen.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344372/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor344417"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Getting a new tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 12:50 UTC (Thu)
                               by <b>foom</b> (subscriber, #14868)
                              [<a href="/Articles/344417/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      I've seen that same buggy behavior of emacs losing the tail ends of compilations on various 
versions of OSX. I think it's fixed now, I have no idea if it was fixed in the kernel or in emacs, and I 
don't know if it's the same underlying cause or not...but it seems suspicious.
<p>
So the claim that this new version of Linux is fundamentally breaking the Unix ABI and that emacs 
worked fine with all other OSes is not all at obvious!
      
          <div class="CommentReplyButton">
            <form action="/Articles/344417/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344924"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Getting a new tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2009 11:10 UTC (Sun)
                               by <b>iq-0</b> (subscriber, #36655)
                              [<a href="/Articles/344924/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
True, but it is not obvious that it's the other way round either. My point was merely that in these <br>
cases (where we have a cross platform application) it's safer to assume the kernel is at fault until <br>
proven otherwise. Which in these more obscure interactions between programs and kernels <br>
probably means doing some research on what other systems do.<br>
I'm not saying that always following the lead of other is better, but a standard is defined by it's <br>
implementations and if all implementations make more or less the same (possibly) wrong <br>
assumptions, those wrong assumptions arguably are the standard.<br>
Even this doesn't mean we shouldn't deviate from that standard but doing so (breaking lines with <br>
this implicit standard) probably does effectively constitute as a ABI change.<br>
<p>
But it all comes down to wether it is more reasonable to play the "guilty until proven innocent" <br>
versus the "innocent until proven guilty" card in these cases. Both (logically) in the end lead to the <br>
same conclusion (if the problem is deterministic of course).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344924/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor344368"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">When it is a kernel or a userspace bug?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 7:52 UTC (Thu)
                               by <b>simlo</b> (guest, #10866)
                              [<a href="/Articles/344368/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
As far as I see it it all boils down to that question:<br>
<p>
Linus wants to make sure all applications works even though you can say they are buggy. Alan says that applications can't rely on on certain old behaviour and must be fixed.<br>
<p>
I disagree with Linus: You must be allowed to change things once in a while. If the applications assumes some non-standeard behaviour it is broken. To determine what non-standeard behaviour is, look at how it behaves on OTHER kernels. What can Emacs assume when it runs on BSD, Solaris, etc.? If they also comply with the old behavior of TTY then the new behavior is wrong. But if Emacs already has code to handle the new behaviour because the other kernels already do that, then the new behaviour is ok (this is unlikely as Emacs would probably have no problem with the new tty code.)<br>
<p>
In short: If there is no written standeard look at the other OS'es. Applications should not expect special behaviour from the Linux kernel over other Unix kernels unless there is a really good reason to. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344368/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor344380"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The TTY demystified</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 9:16 UTC (Thu)
                               by <b>bakterie</b> (guest, #37541)
                              [<a href="/Articles/344380/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I found the following link very informative. Maybe other readers will as well.<br>
<p>
<a href="http://www.linusakesson.net/programming/tty/index.php">http://www.linusakesson.net/programming/tty/index.php</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344380/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor344394"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 10:44 UTC (Thu)
                               by <b>djm</b> (subscriber, #11651)
                              [<a href="/Articles/344394/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
FWIW Cox is completely correct: a user program must be prepared to cope with short reads and EAGAIN at all times, especially around process exit where delivery of SIGCHLD is highly likely to interrupt pending reads.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344394/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor344622"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Why not fix the tty interface?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2009 22:10 UTC (Thu)
                               by <b>spitzak</b> (guest, #4593)
                              [<a href="/Articles/344622/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Before there was GUI's, I remember the #1 question from people trying to program Unix was "how do I make a getch() function?"<br>
<p>
And the answer was "do this insane set of ioctls". Followed by "oh and make damn sure your program can NEVER EVER crash, because you must undo this before exit or other programs will be screwed up.<br>
<p>
This was obviously insanely wrong then, and it still is now.<br>
<p>
With shells using readline-style libraries now, there are NO programs left that use the TTY in anything other than uncooked mode (programs like cat that are mostly used as destinations of pipes do not count!). It does seem like it is time to scrap this. This would also allow "pty" to be scrapped as well, because you could use plain old pipes for this.<br>
<p>
There should be a trivial uncooked raw io interface that you open as "/dev/newtty" or whatever. The drivers should be about 10 lines long I think.<br>
<p>
The old tty/pty interface should be a CUSE api of some sort that emulates it atop the new interface. And that can be vastly reduced. For instance we can scrap the entire key assignment thing, as nobody ever alters it, and finally (after almost 4 decades!) get both Backspace and Delete to work at the same time!<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344622/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345668"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Why not fix the tty interface?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 6, 2009 15:27 UTC (Thu)
                               by <b>forthy</b> (guest, #1525)
                              [<a href="/Articles/345668/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <p>Yes, I remember that when I started writing a Forth on Unix nearly 20
years ago. The tty interface is broken. Fundamentally. It's not even
fixable. Give me a proper tty interface instead, and dump the old one.
Write a CUSE driver for legacy applications.</p>

<p>Points I have to complain:</p>

<ul><li>Obtain cursor position - impossible when the user types in
something at the same time, due to inherent race condition. The root cause
of this problem is terminal emulation. Whoever wants terminal emulation
should link to /lib/libvt100.so or whatever terminal he likes to
have.</li>
<li>raw/cooked mode and modes that persist over application changes: This
is insane. Give everybody raw terminal access by default and whoever wants
it cooked should link to /lib/libkitchen.so.</li></ul>

<p>The Forth terminal model (that's what I wanted to adapt to Unix, and
still haven't found a way to do that stable and bug-free) is quite simple:
You can type text (which can be completely uninterpreted plain
characters), you can send a carriage return, clear the screen, position
the cursor, query the cursor position, (even more advanced: also the size
of the terminal; setting colors and styles would also be advanced), check
if there's a keyboard event available, obtain one and dispatch what
type of event that is (character, function key - note that the terminal
event model makes the terminal side of the pty a symmetric task to writing
the client side). This separates terminal
data (text) from terminal metadata (formatting, cursor positions, colors),
and therefore is sane interface design. Each of the functions does exactly
one thing, and does it right. Writing a Forth terminal driver for raw
hardware (or just GUI emulation) is a piece of cake. Writing it for Unix
is a PITA. If it is more complicated to do it through the OS than without,
there's something seriously wrong with the OS.</p>

<p>If you happen to have a real terminal (old greenish CRT attached to a
RS232 cable), you have to translate the metadata into data, and adapt to
the terminal emulation (vt100 or any other of 1000 terminal "standards").
This ought to be an intermediate layer, provided by the system, not by the
application. In Unix, you can't position the cursor just by calling an
ioctl(). You have to use termcaps to find out which arcane set of string
will position the cursor for you, or use one or the other arcane library
([n]curses is arcane) to do it for you.</p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/345668/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor346741"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Why not fix the tty interface?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 12, 2009 18:55 UTC (Wed)
                               by <b>yuhong</b> (guest, #57183)
                              [<a href="/Articles/346741/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Well, the good news is that Plan 9 gets rid of this tty mess altogether.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/346741/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor344816"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 31, 2009 23:23 UTC (Fri)
                               by <b>alex_the_d</b> (guest, #59935)
                              [<a href="/Articles/344816/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'm reading <a href="http://www.opengroup.org/onlinepubs/000095399/basedefs/xbd_chap11.html">http://www.opengroup.org/onlinepubs/000095399/basedefs/xb...</a> and...<br>
<p>
1. "Also, no matter how many bytes are requested in the read() call, at most one line shall be <br>
returned." (in canonical mode)<br>
<p>
2. "process to close a terminal device file shall cause any output to be sent to the device and any <br>
input to be discarded."<br>
<p>
I don't think the problem is in userland, neither emacs nor kdesu. Can someone comment?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344816/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344849"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2009 10:15 UTC (Sat)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/344849/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The problem with Emacs, at least, is in userland. POSIX says that closing <br>
(including, implicitly, as a result of process termination) 'shall cause <br>
any output to be sent to the device', but it does *not* impose an ordering <br>
on the dispatch of SIGCHLD versus a read() of those bytes. So the SIGCHLD <br>
can arrive at any time, including while you're reading data.<br>
<p>
Since this can happen when you're reading any data from anywhere, it seems <br>
unfortunate that Emacs isn't looping on -EINTR in read() everywhere.<br>
<p>
(That part of the Unix API sucks rocks. SA_RESTART should have been the <br>
default forever, IMNSHO. Instead, we *still* can't rely on it if we want <br>
to be portable: two of the platforms I have to write code for don't <br>
support it, so it's still -EINTR loops everywhere...)<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344849/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344935"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2009 15:36 UTC (Sun)
                               by <b>pflugstad</b> (subscriber, #224)
                              [<a href="/Articles/344935/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      Good explanation, thanks!
<p>
Shouldn't emacs really be looping until it get EOF/close on the pipe
(which would implicitly loop on -EINTR)?  Unfortunatley, I don't have
my copy of <a href="http://www.kohala.com/start/apue.html">Stevens</a> handy... it's been too long since I messed with tty/pty stuff.
<p>
Depending on the ordering of SIGCHLD and reading data from the pipe seems quite fragile to me.  I'm surprised something as mature/old as Emacs depends on it.
      
          <div class="CommentReplyButton">
            <form action="/Articles/344935/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor344941"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2009 19:58 UTC (Sun)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/344941/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Not exactly, It should loop as long as it gets any data, until it <br>
gets -EOF/close on the pipe or gets *any error other than -EINTR*.<br>
<p>
Otherwise you're going to loop forever if there's an error.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344941/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor345000"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2009 13:02 UTC (Mon)
                               by <b>clugstj</b> (subscriber, #4020)
                              [<a href="/Articles/345000/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Anything as "old/mature" as Emacs probably has other bad assumptions lurking in it.  It should come as no surprise.<br>
<p>
Assuming an order between read() and signal reception is ALWAYS a bad idea.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345000/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor344977"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2009 3:49 UTC (Mon)
                               by <b>alex_the_d</b> (guest, #59935)
                              [<a href="/Articles/344977/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'm pretty sure 'a read() of those bytes' (by emacs) is one part of a proccess of sending output to the <br>
device. Emacs is 'the device' here and terminal line can not be closed and disconnected until all data <br>
is sent. There should be no chance for the application to exit until the output is 'sent to the device' <br>
hence no chance for the kernel to thow SIGCHLD.<br>
<p>
It's not a pipe nor stream, it's an intaractive tty/pty.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344977/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345078"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2009 22:30 UTC (Mon)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/345078/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The process of sending the data through a pty or tty is desynchronized <br>
from the state of the process doing the sending. If a process sends data, <br>
then exits, it can be gone (and SIGCHLD fired) *long* before the buffers <br>
are flushed to the receiving app. This has always been true (I first <br>
remember noticing it on SunOS 4, but it was old even then) and is <br>
essential for good performance over slower lines or under high load.<br>
<p>
(Emacs is not the device. The device and buffering for it are kernel <br>
entities. Emacs is merely the entity on the *master side* of the device.)<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345078/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345111"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 4, 2009 8:46 UTC (Tue)
                               by <b>alex_the_d</b> (guest, #59935)
                              [<a href="/Articles/345111/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; The device and buffering for it are kernel entities.</font><br>
<p>
No, 'kernel entities' are 'device driver(s)'. THE device is that beige box on the table or a piece of <br>
code emulating it (emacs).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345111/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor345236"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 4, 2009 21:06 UTC (Tue)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/345236/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The fact remains that POSIX does not require process exit signal / TTY <br>
flush synchronization, and I know of no Unix that ensures that these <br>
things are synchronized. Your musings about what constitutes 'the device' <br>
are thus not terribly relevant. The system simply does not work the way <br>
you would like it to (and the way some app authors assume).<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/345236/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor344851"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">FreeBSD solution</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 1, 2009 10:30 UTC (Sat)
                               by <b>patrick_g</b> (subscriber, #44470)
                              [<a href="/Articles/344851/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The FreBSD developpers have been able to rewrite the tty layer =&gt; <a href="http://wiki.freebsd.org/TTYRedesign">http://wiki.freebsd.org/TTYRedesign</a><br>
<p>
This new mpsafe tty version will be in the future 8.0 version of FreeBSD. Why Linux developpers cannot do the same thing ?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/344851/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor344987"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Greg KH steps up as the TTY maintainer</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 3, 2009 9:46 UTC (Mon)
                               by <b>csamuel</b> (<b>&#x272D; supporter &#x272D;</b>, #2624)
                              [<a href="/Articles/344987/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>Just merged by Linus:</p>

<pre>
commit 57d7f282271a83fe4ca4bd15eee79be577210210
Author: Greg Kroah-Hartman &lt;gregkh@suse.de&gt;
Date:   Fri Jul 31 21:28:16 2009 -0700

    TTY: Maintainer change

    Clearly, I am a glutton for punishment.  I'll see if I can see Alan's
    changes through to the end, otherwise I'll be fending off a lot of bug
    reports for usb-serial devices.

    Cc: Alan Cox &lt;alan@lxorguk.ukuu.org.uk&gt;
    Signed-off-by: Greg Kroah-Hartman &lt;gregkh@suse.de&gt;
    Signed-off-by: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;
</pre>
      
          <div class="CommentReplyButton">
            <form action="/Articles/344987/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor346425"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A tempest in a tty pot</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 11, 2009 15:24 UTC (Tue)
                               by <b>jonshouse</b> (guest, #60193)
                              [<a href="/Articles/346425/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Almost all of the real world problems here could be solved if Clib/libc had more real world user functions.  What about something like<br>
<p>
if (stdio_raw(1)==0)<br>
{<br>
      // I am in raw mode<br>
}<br>
else<br>
{ <br>
      //something went wrong<br>
}<br>
<p>
The c runtime can even track if raw is on or off, or simply reset to non raw on crashes.......<br>
<p>
Its piss poor API for userland applications not the kernel that makes *nix a bit of a suck to code.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/346425/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2009, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
