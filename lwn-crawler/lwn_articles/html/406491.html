        <!DOCTYPE html>
        <html lang="en">
        <head><title>Broadcom firmware and regulatory compliance [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/406491/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/405665/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/406491/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>Broadcom firmware and regulatory compliance</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Please consider subscribing to LWN</b>
<p>
Subscriptions are the lifeblood of LWN.net.  If you appreciate this
content and would like to see more of it, your subscription will
help to ensure that LWN continues to thrive.  Please visit
<a href="/Promo/nst-nag1/subscribe">this page</a> to join up and keep LWN on
the net.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>September 22, 2010</br>
           </div>
Broadcom's recently-announced open source wireless networking driver was a
major step forward for a company which has, until now, not been forthcoming
when it comes to free support for its wireless products.  That driver
includes the obligatory firmware blob which has been licensed for free
distribution by the company; it is now found in the kernel firmware repository.
Broadcom has not freed the firmware for its older drivers, though, leading
to discussions on the intersection between kernel development and
regulatory compliance.
<p>
The lack of freely-distributable firmware for older Broadcom products makes
life a bit more difficult for users, who must obtain the firmware
separately.  When the new firmware was made distributable, David Woodhouse
asked the company about the older firmware as well, only to told that it
would not be made distributable.  As he <a
href="http://lwn.net/Articles/405376/">explained</a> it, Broadcom is afraid
that allowing the distribution of that firmware could lead to trouble:
<p>
<div class="BigQuote">
	They seem to think that they could be prosecuted even for
	*enabling* people to use the open source b43 driver, because you
	have the possibility of hacking that driver not to conform to the
	regulatory requirements.
</div>
<p>
The reason why the old firmware is different is simple: the newer firmware,
which can only run on newer hardware, has regulatory compliance built into
it.  The older firmware, instead, depends on the driver in the kernel to
ensure that it is not configured to operate in a non-compliant manner.
<p>
David is not known for graceful suffering in the presence of (people he
sees as) fools.  His response was <a href="/Articles/406493/">a patch</a>
which "credits" Broadcom for enabling the development of the
reverse-engineered b43 driver; this "enablement" is said to have come
through the provision of binary-only drivers which could be reverse
engineered.  His goal in writing this patch was described as:
<p>
<div class="BigQuote">
	Everything we do in the b43 and b43legacy drivers is enabled by
	Broadcom's original binary-only drivers.

	So let's make that 'enablement' by Broadcom's binary drivers clear
	in our source code -- in the hope that it'll narrow the 'risk gap'
	that they falsely perceive between open and closed source drivers.
<p>
	Or failing that, in the hope that it'll give their crack-addled lawyers
	aneurysms, and they'll hire some saner ones to replace them.
</div>
<p>

He also expressed a wish that the b43 developers would release more
information - obtained from the binary-only drivers - on how to patch those
binary drivers to get around various regulatory restrictions.  Once again,
he feels that this kind of information would help to make it clear that
free drivers do not make it any easier to operate the hardware in an
illegal manner.
<p>
David's position plays well with developers who have no patience for
obstacles created by lawyers.  There is also a vocal contingent out there
which says that Linux has no business telling users how they should use
their hardware in any case; if the user wants to configure the hardware in
a non-compliant manner, that's the user's problem.  In some cases, that
user may well have a license which makes it entirely legal to run the
hardware outside of the parameters which normally apply to off-the-shelf
wireless networking equipment.  So regulatory compliance naturally
irritates developers who think that the kernel has no business getting in
anybody's way in this regard.
<p>
Luis Rodriguez, on the other hand, is a strong supporter of regulatory
compliance in the Linux kernel; he <a href="/Articles/406494/">stepped into
the discussion</a> to remind people of the <a
href="http://wireless.kernel.org/en/developers/Regulatory/statement">kernel's
regulatory statement</a> and to say that there was no real interest in
encouraging the violation of spectrum-use regulations with any driver.  He
<a href="/Articles/406495/">added</a>:
<p>
<div class="BigQuote">
	The reason why current legislation doesn't seem to make sense is
	because it does not, but just because a law doesn't make sense it
	does not enable vendors to ignore it. So the best you can do in the
	meantime is really be proactive by working on real technical
	solutions.
<p>
	We are not dealing with legal issues on Linux, we are dealing with
	engineering solutions, and trust me, we're light years ahead of
	other OSes because of this now.
</div>
<p>
His point is that the kernel's "engineering solution" to the regulatory
problem has made it possible for wireless vendors to dip their toes into
the open-source water.  That, in turn, has helped to move Linux from having
poor wireless support to, arguably, having the best support over the course
of a few years.  It is hard to argue with the success which the wireless
developers have had recently; any moves which might endanger that success
should be considered carefully, to say the least.
<p>
Of course, it would be nicer to do without the proprietary firmware blob
altogether.  In early 2009, the openfwwf project <a
href="http://lwn.net/Articles/314313/">announced</a> the availability of an
open source firmware implementation for Broadcom adapters.  Since then,
news from that project has been relatively scarce.  On September&nbsp;21,
though, Michael B&uuml;sch <a
href="http://lwn.net/Articles/406379/">announced</a> the availability of a
toolchain for working with the b43 firmware.  Using the disassembler and
assembler, it is possible to decode the device firmware, make changes, then
build a new firmware load.  Naturally, one can also build a new firmware
implementation from the beginning.  With these tools available, we might
just get to a point where we can have device firmware without distribution
restrictions, and which adds features and flexibility to the device as
well.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Device_drivers-Wireless_networking">Device drivers/Wireless networking</a></td></tr>
            <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Networking-Wireless">Networking/Wireless</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/406491/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor406862"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">How does this work?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 24, 2010 10:52 UTC (Fri)
                               by <b>job</b> (guest, #670)
                              [<a href="/Articles/406862/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
How do these drivers handle the different regulatory requirements in different jurisdictions? I can not recall entering my location when installing a recent distribution with wifi support, and if this system respects these requirements it must surely know what they _are_?<br>
<p>
AFAIK simple things such as what frequency bands are used differ between EU, the US, and Japan for example. If the user is limited to the lowest common denominator, he/she may not even be able to connect to the local wifi which may be on a band not allowed somewhere else.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/406862/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor406876"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">How does this work?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 24, 2010 14:03 UTC (Fri)
                               by <b>dtlin</b> (subscriber, #36537)
                              [<a href="/Articles/406876/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <p><a href="http://linuxwireless.org/en/developers/Regulatory">Regulatory - Linux Wireless</a>

<p>In the past, this was set by option <tt>ieee80211_regdom</tt> to the <tt>cfg80211</tt> module.  More recently, this is now configured through the new <tt>nl80211</tt> interface, e.g. <tt>iw reg</tt>.

<p>I live in the US and most everything defaults to US regulations, so I haven't dug into how distributions handle this.
      
          <div class="CommentReplyButton">
            <form action="/Articles/406876/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor407055"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">How does this work?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 26, 2010 0:48 UTC (Sun)
                               by <b>gutschke</b> (subscriber, #27910)
                              [<a href="/Articles/407055/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I would assume that most modern drivers support 802.11d. I believe it was standardized in 2007. It is supposed to automatically pick the correct regulatory domain based on information broadcast by all the other WiFi users in your vicinity.<br>
<p>
In typical urban settings, you can probably see around 50 WiFi devices at any given time. So, this should work pretty reliably. And if you find yourself sufficiently removed from any other WiFi devices, then presumably it wouldn't matter all that much if you pick the wrong regulatory domain as there won't be anybody around that you could interfere with.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/407055/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor407086"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">How does this work?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 26, 2010 7:19 UTC (Sun)
                               by <b>johill</b> (subscriber, #25196)
                              [<a href="/Articles/407086/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Err, no, regulatory restrictions aren't in place to stop wifi devices from interfering with each other (after all, they use carrier sensing and all play nice with each other) -- they are in place to avoid interfering with, to take a recent example, weather radars.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/407086/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor407180"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">How does this work?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 27, 2010 5:55 UTC (Mon)
                               by <b>jzbiciak</b> (guest, #5246)
                              [<a href="/Articles/407180/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Right, but if there are no other WiFi devices around, presumably the card would fall back into a much more passive mode that's likely to be in the intersection of all domain's requirements.  ie. I doubt it'd come out with guns-a-blazin', pumping out 10W until it got a friendly tap on the shoulder that told it "Hey, you're only allowed 100mW peak around these parts."<br>
<p>
Rather, if the supported regulatory domains had maximum transmit powers of, say, 120mW, 100mW and 80mW, in the absence of any guidance to the contrary, I'd imagine it'd stick to under-80mW until it got a whiff of what regulatory environment it was in.<br>
<p>
After all, when you drive on a new local road you've never driven, do you floor it and go 65MPH until you see a speed limit sign telling you it's 30MPH?  (100km/h and 50km/h if you prefer.)  Somehow I doubt it.  You probably look at the other cars and see what range of speeds they're going, and if there's no other traffic, you probably make an educated guess what an appropriate speed would be.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/407180/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor407181"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">How does this work?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 27, 2010 5:57 UTC (Mon)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/407181/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
the biggest problem isn't the power level (as you point out it's easy to do something that's safe everywhere)<br>
<p>
the problem is what frequencies are you allowed to transmit on. guess wrong and you will never talk on the same frequency as the access point, or you could start interfering with other things and get into more trouble.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/407181/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor407186"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">How does this work?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 27, 2010 6:29 UTC (Mon)
                               by <b>jzbiciak</b> (guest, #5246)
                              [<a href="/Articles/407186/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <P>Fair enough and a good point I hadn't considered.
</P><P>
On further reflection, it seems like a computer operating in something resembling a infrastructure mode client would have little reason to transmit until it saw something that gave it an idea of what frequencies and powers were appropriate.
</P><P>
And, since I'm actually allergic to <I>too much</I> idle speculation[*] without a good dose of raw facts, I actually had a go at looking up the relevant standard.  Indeed, the actual default is "passive scanning" (highlighted below):</P>
<BLOCKQUOTE>
<B>9.9.1 Operation upon entering a regulatory domain</B><BR><BR>
A STA that is enabled for operation across regulatory domains shall default to passive scanning when it has lost connectivity with its ESS. Passive scanning is performed using only the receive capabilities of the
station and is, thus, compatible with regulatory requirements. The timeout for determining the loss of connectivity is system dependent and beyond the scope of this standard.
<BR><BR>
When a STA enters a regulatory domain, it shall <B>passively scan to learn at least one valid channel</B>, i.e., a channel upon which it detects IEEE Std 802.11 frames. The Beacon frame contains information on the country code, the maximum allowable transmit power, and the channels to be used for the regulatory domain. Optionally, the Beacon frame may also include, on a periodic basis, the regulatory information that would be returned in a Probe Response frame. Once the STA has acquired the information so that it is able to meet the transmit requirements of the regulatory domain, it shall transmit a Probe Request to an AP to gain the additional regulatory domain information contained in the Probe Response frame, unless the information was previously received in a Beacon fame. The STA then has sufficient information available to configure its PHY for operation in the regulatory domain.</BLOCKQUOTE>
<P><SMALL>(Quoted from <A HREF="http://standards.ieee.org/getieee802/download/802.11d-2001.pdf">here.</A>)</SMALL></P>
<P>So, I guess that's the ultimate way to not break any transmit laws... transmit nothing until you hear a valid local transmission.</P>
<HR>
<P>[*] That's not to say I haven't been guilty of such in the past, nor does it say I won't be guilty of it in the future.  ;-)</P>
      
          <div class="CommentReplyButton">
            <form action="/Articles/407186/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor406939"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Broadcom firmware and regulatory compliance</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 24, 2010 21:08 UTC (Fri)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/406939/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; On September 21, though, Michael BÃ¼sch announced the availability of a toolchain for working with the b43 firmware.</font><br>
<p>
Well, we already released a toolchain that works with b43 firmware several years ago. That is what openfwwf was based on.<br>
<p>
The new announcement was a new version of that toolchain which also works on the recently released firmware for the new brcm80211 driver. (brcm80211 devices have some differences in the instruction set and format).<br>
<p>
So we're currently at a point where Broadcom's latest freely distributable wireless firmware is easily modifiable by anyone. I think that harms Broadcom's argument for not releasing older firmware due to regulatory issues. Technically the new firmware is not really safer than the old one.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/406939/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor407087"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Broadcom firmware and regulatory compliance</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 26, 2010 9:25 UTC (Sun)
                               by <b>dwmw2</b> (subscriber, #2063)
                              [<a href="/Articles/407087/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <BLOCKQUOTE><I>"So we're currently at a point where Broadcom's latest freely distributable wireless firmware is easily modifiable by anyone. I think that harms Broadcom's argument for not releasing older firmware due to regulatory issues."</I></BLOCKQUOTE>

Indeed. Broadcom's position on the whole regulatory thing seems to be entirely based on inconsistent paranoid fantasies, and we should be using all means at our disposal to demonstrate the idiocy of their position.
      
          <div class="CommentReplyButton">
            <form action="/Articles/407087/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor412636"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Broadcom firmware and regulatory compliance</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 1, 2010 13:27 UTC (Mon)
                               by <b>dublindec</b> (guest, #70939)
                              [<a href="/Articles/412636/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The Broadcom card in my MacBook Pro regularly has its country code set (by other people's routers) to the wrong country code. I have no way of returning it to the correct code. How does that help with compliance? It just excludes me from networks in the UK which use channels 12 and 13. Madness.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/412636/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor420136"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Broadcom firmware and regulatory compliance</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 16, 2010 13:37 UTC (Thu)
                               by <b>lacos</b> (guest, #70616)
                              [<a href="/Articles/420136/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <cite>developers who have no patience for obstacles created by lawyers</cite>
<p/>
You could argue that the GPL is one such obstacle, so the above generic expression is double-edged. Law, just like wireless parameters, is not "bad" in itself; it depends on what it is used for.
      
          <div class="CommentReplyButton">
            <form action="/Articles/420136/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2010, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
