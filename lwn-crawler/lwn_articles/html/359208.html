        <!DOCTYPE html>
        <html lang="en">
        <head><title>Staging drivers out [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/359208/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/358221/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/359208/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>Staging drivers out</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>This article brought to you by LWN subscribers</b>
<p>
Subscribers to LWN.net made this article &mdash; and everything that
       surrounds it &mdash; possible.  If you appreciate our content, please
       <a href="/Promo/nst-nag3/subscribe">buy a subscription</a> and make the next
       set of articles possible.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>October 28, 2009</br>
           </div>
The staging tree was conceived as a way for substandard drivers to get into
the kernel tree.  Recently, though, there has been talk of using staging to
ease drivers out as well.  The idea is that apparently unused and unloved
drivers would be moved to the staging tree, where they will languish for
three development cycles.  If nobody has stepped up to maintain those
drivers during that time, they will be removed from the tree.  This idea
was discussed at the 2009 Kernel Summit with no serious dissent.
<p>

Since then, John Linville has decided to test the system with a series of
ancient wireless drivers.  These include the "strip" driver ("<q>STRIP
is a radio protocol developed for the MosquitoNet project - to send
Internet traffic using Metricom radios.</q>"), along with the arlan,
netwave, and wavelan drivers.  Nobody seems to care about this code, and it
is unlikely that any users remain.  If that is true, then there should be
no down side to removing the code.
<p>
That hasn't stopped the complaints, though, mostly from people who believe
that staging drivers out of the tree is an abuse of the process which may
hurt unsuspecting users.  It is true that users may have a hard time
noticing this change until the drivers are actually gone - though their
distributors may drop them before the mainline does.  So the potential for
an unpleasant surprise is there; mistaken removals are easily reverted, but
that is only partially comforting for a user whose system has just broken.
<p>
The problem here is that there is no other way to get old code out of the
tree.  Once upon a time, API changes would cause unmaintained code to fail
to compile; after an extended period of brokenness, a driver could be
safely removed.  Contemporary mores require developers to fix all in-tree
users of an API they change, though, so this particular indicator no longer
exists.  That means the tree can fill up with code which is unused and
which has long since ceased to work, but which still compiles flawlessly.
Somehow a way needs to be found to remove that code.  The "staging out"
process may not be perfect, but nobody has posted a better idea yet.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Staging_tree">Staging tree</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/359208/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor359359"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Staging drivers out</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 29, 2009 11:48 UTC (Thu)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/359359/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This does mean that if you have an old machine with obscure hardware and want to be sure it's not silently dropped, you *have* to run upstream kernels or watch LKML: distributor kernels won't cut it. (They probably don't build modules for obscure hardware, so you probably have to do that anyway.)<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/359359/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor359375"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Staging drivers out</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 29, 2009 13:48 UTC (Thu)
                               by <b>jzbiciak</b> (guest, #5246)
                              [<a href="/Articles/359375/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <P>I wonder if it makes sense to have an "CONFIG_ENABLE_DEPRECATED_DRIVERS" to hide these guys behind once they start down this "staging out" path.  ie. do something so that anyone trying to run a deprecated driver is more likely to notice that their driver is (potentially) going away.</P>

      
          <div class="CommentReplyButton">
            <form action="/Articles/359375/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor359379"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Staging drivers out</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 29, 2009 13:49 UTC (Thu)
                               by <b>johill</b> (subscriber, #25196)
                              [<a href="/Articles/359379/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If you can even run the latest kernel on that machine ...<br>
<p>
Also, for the wireless drivers in question, you have to find at least _two_ machines for it to make sense. And then I suspect not all drivers support ad-hoc mode or whatever it was at the time, so maybe you even have to find an AP for them?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/359379/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor359528"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Staging drivers out</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 30, 2009 0:16 UTC (Fri)
                               by <b>giraffedata</b> (guest, #1954)
                              [<a href="/Articles/359528/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <blockquote>
you have to find at least _two_ machines for it to make sense.  ...
</blockquote>

<p>I don't think the concern is that someone will have a wireless card in a closet for ten years and then decide to build a system with it.  It's that someone has a system running continuously for ten years using that wireless card, which means he also has other machines and APs as required, and then suddenly wants to switch to a new Linux kernel to add a feature.  

<p>It would be nice if he didn't have to choose between the new kernel-provided feature and the old wireless card (and probably a dozen other old components that are tied to it).

<blockquote>
If you can even run the latest kernel on that machine ...
</blockquote>
<p>
That's exactly the question -- whether new Linux will be compatible with old machines.

      
          <div class="CommentReplyButton">
            <form action="/Articles/359528/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor359483"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Staging drivers out</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 29, 2009 18:53 UTC (Thu)
                               by <b>riddochc</b> (guest, #43)
                              [<a href="/Articles/359483/">Link</a>] 
      </p>
      
      </div>
      </summary>
      I remember using Metricom's ricochet modems. Way before its time - the range (if not the speed) you could get from them was pretty impressive. I wish they had survived.

      
          <div class="CommentReplyButton">
            <form action="/Articles/359483/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor359492"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Staging drivers out</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 29, 2009 19:28 UTC (Thu)
                               by <b>bronson</b> (subscriber, #4806)
                              [<a href="/Articles/359492/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
What about intentionally breaking the drivers for a few releases?<br>
<p>
When a deprecated driver is loaded, it could log:<br>
<p>
   WARNING: the metricom driver is deprecated and has been disabled!<br>
   To enable it for this boot only, echo 1 &gt; /proc/sys/kernel/drivers/enable-metricom<br>
   If you are currently using this driver, please contact grek-kh@kernel.org<br>
<p>
That way kernel users would get adequate warning before a driver goes away completely and kernel devs could confirm that nobody cares enough about keeping it to even send an email.<br>
<p>
It does mean that you need to upgrade the kernel on your obsolete hardware every few years.  That seems reasonable.  If you don't, then you don't care what's happening in new kernels anyway.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/359492/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor359564"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Staging drivers out</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 30, 2009 10:05 UTC (Fri)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/359564/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yeah, but if people can't keep CONFIG_DEPRECATED or feature-removal-schedule.txt up to date, why is this any more likely to work? Now the users have to check *three* ways of seeing if something is out of date, and if they miss one, we can blame them for not looking at it! Isn't that fun?<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/359564/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor359565"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Staging drivers out</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 30, 2009 10:08 UTC (Fri)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/359565/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Sorry, *four* ways. There's also drivers that emit clear deprecation messages in the kernel log.<br>
<p>
On one of my machines, booted daily, I'd been getting deprecation messages for one feature for months, but I never noticed it because it was lost among several hundred Kb of mostly-boring messages which flashed past far too fast to read, and it was so long it overshot the dmesg buffer (I hadn't noticed it grow to overflow the buffer in the last few releases). And I'm a bleeding-edge kernel user. How are random users supposed to be able to handle this?<br>
<p>
(Kernel boot message volume on SMP is being reduced, a bit. Good.)<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/359565/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor359595"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Staging drivers out</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 30, 2009 16:00 UTC (Fri)
                               by <b>bronson</b> (subscriber, #4806)
                              [<a href="/Articles/359595/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This is more likely to work because it actually breaks your driver.  You're guaranteed to notice!  And it makes it very easy to unbreak the driver so you're not utterly screwed when it happens to you.<br>
<p>
Agreed, emitting deprecation warnings into the kernel log is equivalent to doing nothing.  Who reads the entire kernel log anymore?  And dumping warnings into feature-removal-schedule.txt is just as bad since nobody reads that either.  Maybe these techniques should be deprecated themselves.  :(<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/359595/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor359902"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Staging drivers out</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 2, 2009 16:22 UTC (Mon)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/359902/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
So... you consider breaking a network driver and breaking headless machines completely, possibly requiring long cross-country treks to fix it, a *good* thing?!<br>
<p>
Upgrading the kernel frankly scares me now. Every single kernel from 2.6.28.x upwards has hit me with at least one severe regression on my home machines alone (defined as 'prevents booting or disrupts normal functioning on an at least daily basis'), and there are only four of them and a few VMs! When I upgrade I now schedule a whole weekend to try to work around the inevitable blasted breakages... even upgrading glibc is less nervewracking.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/359902/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor359942"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Staging drivers out</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 2, 2009 18:06 UTC (Mon)
                               by <b>bronson</b> (subscriber, #4806)
                              [<a href="/Articles/359942/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Jeez, are you deliberately trying to be difficult?  When did I ever say that?<br>
<p>
We're talking about staging drivers out here.  In other words, BREAKING THE DRIVER.  We just need to figure out how to do it with the least amount of distress to end users.<br>
<p>
I claim that breaking the driver softly, then removing it a year later, is better than just yanking it out without warning.  And that the current technique of emitting log messages and adding entries to text files that nobody reads are more or less equivalent to doing it without warning.<br>
<p>
Does that make sense?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/359942/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor360228"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Staging drivers out</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 3, 2009 19:42 UTC (Tue)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/360228/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Ah. Er, yes, true. I lost the context somewhere, despite it being in the <br>
subject line. :)<br>
<p>
And yes, it *is* better to break it softly and only kill it hard later on.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/360228/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor359505"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Staging drivers out</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 29, 2009 21:14 UTC (Thu)
                               by <b>davecb</b> (subscriber, #1574)
                              [<a href="/Articles/359505/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      Jonathan writes: <I>The "staging out" process may not be perfect, but nobody has posted a better idea yet.</I>

<P>Actually the usual process dates back to before Unix, so probably you young whippersnappers just aren't old enough to remember it (;-))

<P>It's a special case of the process described in Paul Stachour's continous maintenance talk, at http://queue.acm.org/detail.cfm?id=1640399#at
<BR>You increment the minor version number, and ship an updater with the new version that warns the user that the program is going to go out of support, and invites them to volunteer. After a while you bump the minor number and make the user confirm that they know it's going away. Then you bump it once more and make it fail.  All over about a 18-month period, just like your normal maintenance.

<P>To be fair, people who maintain linkers will probably know this trick: it's how they commonly handle format changes.

<P>--dave (who helped Paul polish the paper) c-b
      
          <div class="CommentReplyButton">
            <form action="/Articles/359505/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor359778"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Staging drivers out</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 31, 2009 18:04 UTC (Sat)
                               by <b>NAR</b> (subscriber, #1313)
                              [<a href="/Articles/359778/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It only works if the users upgrade always to every new release - which is not the case with the kernel, even the 6-montly distribution releases are bound to miss at least one of the 3-montly kernel releases, not to mention the Debian stable users...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/359778/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor359784"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Staging drivers out</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 31, 2009 19:57 UTC (Sat)
                               by <b>davecb</b> (subscriber, #1574)
                              [<a href="/Articles/359784/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <P>Not necessarily: unwillingness to upgrade and the freedom to not upgrade is why the time periods are so long. In the commercial world, the rule of thumb is that the slower users upgrade every three years, because the hardware turns over in roughly that period.

<P>Instead of the months I usually work with, large-systems and linkers folks tend to support old versions of things for multiple hardware cycles, with complaints in the current, forced user intervention in the second and obsolescence in the third if no-one or note enough people scream bloody murder in the first two.

<P>--dave
      
          <div class="CommentReplyButton">
            <form action="/Articles/359784/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor360640"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Staging drivers out</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 5, 2009 18:21 UTC (Thu)
                               by <b>muwlgr</b> (guest, #35359)
                              [<a href="/Articles/360640/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yes, please move this newer (but long broken) pata_pdc202xx_old driver there, just to tell Fedora and Ubuntu distributions to give users older but working pdc202xx_old one.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/360640/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2009, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
