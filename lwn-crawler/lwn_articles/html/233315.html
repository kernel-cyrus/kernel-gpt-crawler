        <!DOCTYPE html>
        <html lang="en">
        <head><title>More stuff for 2.6.22 [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/233315/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/232961/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/233315/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>More stuff for 2.6.22</h1>
<div class="Byline">[Posted May 9, 2007 by corbet]
               <p>
               </div>
</div>
<div class="ArticleText">
As of this writing, the 2.6.22 merge window remains open, with quite a bit
of code still expected to be merged.  User-visible changes which have gone
in include: 
<p>
<ul>

<li> The mac80211 (formerly Devicescape) wireless networking stack has
     finally found its way into the mainline.  As of this writing there are
     no drivers which actually use that stack, but drivers are said to be
     in the works.
<p>
<li> The sysfs representation of i2c devices has changed in ways which
     could break older tools.  In particular, versions of lm_sensors prior
     to 2.10.3 will have problems.
<p>
<li> A number of old USB touchscreen drivers (<tt>itmtouch</tt>,
     <tt>mtouchusb</tt>, and <tt>touchkitusb</tt>) have been removed in
     favor of the new <tt>usbtouchscreen</tt> driver.
<p>
<li> The x86_64 architecture has gained relocatable kernel support, a
     necessary feature for those wanting to use the kexec-based crash dump
     mechanism.
<p>
<li> Patching of low-level paravirtualization hooks can be inhibited at
     boot time with the new <tt>noreplace-paravirt</tt> boot flag.
<p>
<li> The <tt>REORDER</tt> configuration option, which would rearrange
     functions in the kernel binary for optimal performance, has been
     removed from the x86_64 architecture.  
<p>
<li> The CIFS filesystem supports IPv6 addresses.  There is a new mount
     option to allow user and group IDs to be overridden.  A number of
     performance improvements for CIFS were also merged.
<p>
<li> The kernel virtual machine (KVM) API has seen significant changes.  If
     earlier plans still hold, this should be the last set of incompatible
     KVM changes.
<p>
<li> There is now a framework for supporting the "RF kill" switches (which
     disable the transmitter) found on many mobile devices.
<p>
<li> Support for filesystem "subtypes" has been added.  The target here is
     FUSE-based filesystems, which currently all look the same to the
     kernel and are hard to specify in <tt>fstab</tt>.  Now a FUSE
     ssh-based filesystem can have the type "<tt>fuse.sshfs</tt>".
<p>
<li> Entries in <tt>/proc</tt> now exist to provide position and flags
     information for all open file descriptors.
<p>
<li> There is a new system call:
<p>
<pre>
    long utimensat(int dirfd, char *filename, struct timespec *times,
                   int flags);
</pre>
<p>
     This call allows an application to set the access and modification
     times for the given <tt>filename</tt> with nanosecond precision.
<p>
<li> The device mapper has a new "delay" target which can delay I/O
     operations; this may seem like a feature of dubious value but it's
     intended for testing only.
<p>
<li> Motorola sysv68 disk partition tables are now supported.
<p>
<li> There is a new private futex mechanism which improves scalability by
     avoiding the shared global namespace.
<p>
<li> The PowerPC architecture supports the concept of "slices" - special
     areas of memory which can have different page sizes.  The feature is
     similar to hugetlbfs, but with more page size flexibility.
<p> 
<li> New hardware supported includes Picotux 200 ARM boards, ADS7846
     touchscreen devices, D-Link DSM-G600 boards, MIPS RM9122 integrated
     serial ports, PMC-Sierra MSP71xx serial devices, MS7712SE01 boards,
     L-BOX RE2 router boards, SH7780 and SH7722 Solution Engine boards, Sun
     XVR-500 and XVR-2500 framebuffers, SUN4U PCI-E controllers, Apple
     system management controllers, Ricoh RS5C313 clock chips, Maxim DS1WM
     one-wire ASIC cores, Alchemy au1500 programmable serial controllers,
     Intel LE80578-based framebuffers, PowerPC 750 "Holly" platforms,
     PowerPC 440GP "Ebony" reference boards, Maxim MAX6650 and MAX6651 fan
     controllers, Analog Devices AD741x monitoring chips, Intel Core
     temperature sensors, PA Semi PA6T-1682M random number generators,
     VIA VT8623 framebuffers,
     and various drivers for the new "Blackfin" architecture.

</ul>

<p>
Changes visible to kernel developers include:
<p>
<ul>

<li> The i2c layer has seen significant new changes meant to make i2c
     drivers look more like drivers for other buses.  There are, for
     example, new <tt>probe()</tt> and <tt>remove()</tt> methods for
     notifying devices when i2c peripherals come and go.  Since i2c is not
     a self-describing bus, the support code still needs help to know where
     i2c devices might be; for many classes of device, this information can
     be had from the system BIOS.
<p>
<li> The crypto API has a new set of functions for use with asynchronous
     block ciphers.  There is also a new <tt>cryptd</tt> kernel thread
     which can run any synchronous cipher in an asynchronous mode.
<p>
<li> The <tt>subsystem</tt> structure has been removed from the Linux
     device model; there never really was any need for it.  Most code which
     was expecting a <tt>struct subsystem</tt> argument has been changed to
     use the relevant <tt>kset</tt> instead.
<p>
<li> There is a new version of the in-kernel rpcbind (portmapper) client
     which supports versions 2-4 of the rpcbind protocol.  The portmapper
     API has changed as a result.
<p>
<li> Numerous changes to the <tt>paravirt_ops</tt> methods have been made.
     Additionally, <tt>paravirt_ops</tt> is no longer a GPL-only export.
<p>
<li> There is a new memory function:
     <p>
     <pre>
    void *krealloc(const void *p, size_t new_size, gfp_t flags);
</pre>
     <p>
     As one would expect, it changes the size of the allocated memory, moving it
     if need be.
<p>
<li> The <a href="http://lwn.net/Articles/229984/">SLUB allocator</a> has
     been merged as an experimental (for now) alternative to the slab code.
<p>
<li> A new macro has been added to make the creation of slab caches easier:
<p>
<pre>
    struct kmem_cache KMEM_CACHE(struct-type, flags);
</pre>
     The result is the creation of a cache holding objects of the given
     <tt>struct_type</tt>, named after that type, and with the additional
     slab <tt>flags</tt> (if any).
<p>
<li> The <tt>SLAB_DEBUG_INITIAL</tt> flag has been removed, along with the
     associated <tt>SLAB_CTOR_VERIFY</tt> flag passed to constructors.  The
     result is a set of changes which ripples through quite a few source
     files.  The unused <tt>SLAB_CTOR_ATOMIC</tt> flag is also gone.

<p>
<li> The "quicklist" mechanism has been merged.  Quicklists are a simple
     lookaside cache for page table pages which optimize the allocation and
     initialization of those pages.
<p>
<li> The SuperH architecture has working kgdb support again.
<p>
<li> The ia64 architecture has a new tool which will inject machine check
     errors into a running system.  Not recommended for production
     machines.
<p>
<li> The <a href="http://lwn.net/Articles/228143/">deferrable timers
     patch</a> has been merged.  There is also a new macro for initializing
     workqueue entries (<tt>INIT_DELAYED_WORK_DEFERRABLE()</tt>) which
     causes the job to be queued in a deferrable manner.
<p>

<li> The old <tt>SA_</tt>* interrupt flags have not been removed as
     originally scheduled, but their use will now generate warnings at
     compile time.
<p>
<li> There is a new <tt>list_first_entry()</tt> macro which, surprisingly,
     gets the first entry from a list.
<p>
<li> The <tt>atomic64_t</tt> and <tt>local_t</tt> types are now fully
     supported on a wider set of architectures.
<p>
<li> The "hibernation" (suspend to disk) code has been separated from the
     "suspend" (to RAM) code as part of a larger effort to distinguish
     between those two very different operations.
<p>
<li> Workqueues have been reworked again.  There is a  new
     function:
<p>
<pre>
    void cancel_work_sync(struct work_struct *work);
</pre>
<p>
     This function tries to cancel a single workqueue entry, be it on the
     shared (keventd) or a private workqueue.
     Meanwhile <tt>run_scheduled_work()</tt> has been removed.
</ul>

<p>
The merging process is not yet done, so expect another big set of patches
to go into 2.6.22 before the window closes.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Releases-2.6.22">Releases/2.6.22</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/233315/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor233694"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">-ffunction-sections</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 10, 2007 4:31 UTC (Thu)
                               by <b>dirtyepic</b> (guest, #30178)
                              [<a href="/Articles/233694/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      I can't seem to find the commit where -ffunction-sections (ie. function reordering) was removed for x86_64.  Does anyone know offhand the reason it was punted?<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/233694/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor233695"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">-ffunction-sections</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 10, 2007 4:34 UTC (Thu)
                               by <b>dirtyepic</b> (guest, #30178)
                              [<a href="/Articles/233695/">Link</a>] 
      </p>
      
      </div>
      </summary>
      Of course I stumble across it two seconds later..<br>
<p>
<a href="http://thread.gmane.org/gmane.linux.kernel/517493/focus=517612">http://thread.gmane.org/gmane.linux.kernel/517493/focus=5...</a><br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/233695/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor233730"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">More stuff for 2.6.22</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 10, 2007 9:37 UTC (Thu)
                               by <b>drag</b> (guest, #31333)
                              [<a href="/Articles/233730/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      Go devicescape stack! er.. mac80211<br>
<p>
I know that at least one driver needs it.. the Ralink rt2x00 drivers. The broadcom bcm43xx driver can use it also.<br>
<p>
Other drivers could probably benifit from it also. Make them smaller, faster, and support more advanced features.<br>
<p>
So how was the userspace stuff resolved with Mac80211? Just through wpa_supplicant or something?<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/233730/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor233741"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">More stuff for 2.6.22</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 10, 2007 11:05 UTC (Thu)
                               by <b>tajyrink</b> (subscriber, #2750)
                              [<a href="/Articles/233741/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      There's also zd1211rw that has been moving to devicescape, and adm8211, rtl818x and apparently ipw3945.<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/233741/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor233880"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">More stuff for 2.6.22</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 11, 2007 1:16 UTC (Fri)
                               by <b>drag</b> (guest, #31333)
                              [<a href="/Articles/233880/">Link</a>] 
      </p>
      
      </div>
      </summary>
      That's great. It would be terrific if Linux wireless woes are effectively solved with this and future driver development can be much easier then it's traditionally been....<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/233880/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor234029"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">More stuff for 2.6.22</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 11, 2007 20:14 UTC (Fri)
                               by <b>BradReed</b> (subscriber, #5917)
                              [<a href="/Articles/234029/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      yep, the newer iwlwifi driver for the ipw3945 and ipw4965 is using it.<br>
<p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/234029/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor234113"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">More stuff for 2.6.22</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 12, 2007 22:40 UTC (Sat)
                               by <b>xma</b> (guest, #44981)
                              [<a href="/Articles/234113/">Link</a>] 
      </p>
      
      </div>
      </summary>
      Will ipw2100 and ipw2200 transit to this new WiFi stack ?<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/234113/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor234114"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">More stuff for 2.6.22</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 12, 2007 22:42 UTC (Sat)
                               by <b>xma</b> (guest, #44981)
                              [<a href="/Articles/234114/">Link</a>] 
      </p>
      
      </div>
      </summary>
      I think suspend to ram/disk separation is a good news and I hope it'll <br>
help to have reliable solutions for the s2d part.<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/234114/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2007, Eklektix, Inc.<BR>
            
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
