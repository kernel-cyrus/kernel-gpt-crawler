        <!DOCTYPE html>
        <html lang="en">
        <head><title>Filesystem test suites [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/757239/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/756895/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/757239/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>Filesystem test suites</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Ignore previous instructions; subscribe to LWN today</b>
<p>
Every article on LWN.net is written by humans, for humans. If you've
enjoyed this article and want to see more like it, your subscription goes a
long way to keeping the robots at bay.  We are offering <a href="https://lwn.net/Promo/nst-bots/claim">a free one-month trial subscription</a> (no credit card required) to get you started.
</blockquote>
<div class="FeatureByline">
           By <b>Jake Edge</b><br>June 13, 2018</br>
           <hr>
<a href="/Articles/lsfmm2018/">LSFMM</a>
</div>
<p>
While the 2018 Linux Storage, Filesystem, and Memory-Management Summit
(LSFMM) filesystem track session was advertised as being a 
filesystem test suite 
"bakeoff", it actually focused on how to make the existing test suites more
accessible.  Kent Overstreet said that he has learned over the
years that various filesystem developers have their own scripts for testing
using QEMU and other tools.  He and Ted Ts'o put the session together to
try to share some of that information (and code) more widely.
</p>

<p>
Most of the scripts and other code has not been polished or turned into a
project, Overstreet continued.  Bringing new people up to speed on the
tests and how they are run takes time, but developers want to know how to
run the tests before they send code to the maintainer.
</p>

<p>
Ts'o said that he had a goal for his <a
href="https://opensource.google.com/projects/xfstests-bld">xfstests-bld</a>
tool: give people submitting ext4 patches no excuses for not
running the smoke tests.  He wants to make sure that patches have been
at least minimally tested before spending time reviewing them.
Xfstests-bld has support for a handful of different filesystems, but just
with default options for any beyond ext4; his hope is that other
filesystems will also use it and provide suitable configurations.
</p>

<p>
J. Bruce Fields said that he runs the smoke tests on all patches anyway, so he
would rather have patch submitters run their own tests on the code.  But
Ts'o was adamant that since there are more submitters than maintainers, he
wants to know that the smoke tests have been run before looking at a submission.
</p>

<p>
Overstreet has a test framework that builds a test kernel, boots into it,
and builds the tests and runs them with QEMU.  It uses <tt>debootstrap</tt>
to build a root filesystem and users do not have to mess with Kconfig;
there is a stripped-down configuration that the test uses.  Ts'o said that he
has two configurations, one for QEMU and another for Google Compute
Engine.  Overstreet wondered if it was "silly for us all to maintain our
own" test harnesses.
</p>

<p>
Mimi Zohar had a different complaint: getting started with xfstests is
difficult.  There is minimal documentation and no default configuration,
which means it takes a long time to get going.  That is why some have
created these test scripts, Ts'o said.
</p>

<p>
Ts'o further described his framework.  It can run tests in KVM/QEMU or push
them to Android devices.  The <tt>smoke</tt> parameter will run the
default tests for the filesystem being tested; for ext4, those tests take
about ten minutes.  Full testing of ext4 takes about 20 hours, but an
intern he worked with was able to reduce that to two hours by sharding the
tests in Google Compute Engine.  The Android xfstests require a rooted
device and, likely, one you are not particularly attached to; the tests do
a lot of writes, which may drastically reduce the lifetime of the device.
</p>

<p>
Eric Sandeen noted that the documentation for the different tests and
frameworks is scattered among various web pages; he wondered if it could be
centralized somewhere.  Dave Chinner suggested patches to the xfstests
documentation that at least pointed those interested to all of the
different pages.
</p><br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Development_tools-Testing">Development tools/Testing</a></td></tr>
            <tr><td><a href="/Archives/ConferenceIndex/">Conference</a></td><td><a href="/Archives/ConferenceIndex/#Storage_Filesystem_and_Memory-Management_Summit-2018">Storage, Filesystem, and Memory-Management Summit/2018</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/757239/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor757444"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Filesystem test suites</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 13, 2018 20:14 UTC (Wed)
                               by <b>jhoblitt</b> (subscriber, #77733)
                              [<a href="/Articles/757444/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
While I am completely clueless about kernel fs development, it sounds like a true CI system/service is needed to reduce the bar for entry.  Of course, making such a service stable with quasi-public use is probably non-trivial.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757444/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor757558"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Filesystem test suites</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 14, 2018 22:50 UTC (Thu)
                               by <b>helsleym</b> (guest, #92730)
                              [<a href="/Articles/757558/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
"Full testing of ext4 takes about 20 hours, but an intern he worked with was able to reduce that to two hours by sharding the tests in Google Compute Engine."<br>
<p>
Without details onnumber of nodes and ballpark monetary costs developers can expect to pay for one 2-hour test run on GCE it's kind of difficult to get excited about using GCE.<br>
<p>
That said, 10 minutes for a local smoke test is quite reasonable.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757558/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2018, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
