        <!DOCTYPE html>
        <html lang="en">
        <head><title>Case-insensitive ext4 [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/784041/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/783636/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/784041/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>Case-insensitive ext4</h1>
</div>
<div class="ArticleText">
<div class="FeatureByline">
           By <b>Jake Edge</b><br>March 27, 2019</br>
           </div>
<p>
Handling file names in a case-insensitive way for Linux filesystems has
been an ongoing 
discussion topic for many years.  It is a (dubious) feature of filesystems
for other operating systems (e.g. Android, Windows, macOS), but Linux has
limited support for it. Over the last year or more, Gabriel Krisman
Bertazi has been working on the problem for
ext4, but it is a messy one to solve.  He recently posted his latest patch
set, which reflects some changes made at the behest of Linus Torvalds.
</p>

<p> At the 2018 Linux Plumbers Conference (LPC), Krisman <a
href="/Articles/772960/">presented his plan</a> for allowing ext4
filesystems to be case-insensitive.  That plan would have enhanced the
kernel's Native Language Support (NLS) subsystem to better support
multi-byte encodings and expand the case-folding to
handle UTF-8.
NLS exists to handle filesystems, such as FAT, that support file names with
different encodings, which are specified at mount time.
Krisman <a
href="/ml/linux-fsdevel/20181206230903.30011-1-krisman@collabora.com/">posted</a>
his patch set to make those changes in December shortly after LPC, but Torvalds
<a
href="/ml/linux-fsdevel/CAHk-=wg2JvjXfdZ8K5Tv3vm6+bKRedotF5cr5AwVZVBypVfdAQ@mail.gmail.com/">objected
to the whole idea</a>:

<div class="BigQuote"> Why do people want to do
this? We know it's a crazy and stupid thing to do. And we know that,
exactly because people have done it, and it has always been a mistake.
</div> </p>

<p>
He went on to list a number of different problems that can arise with
case-insensitivity—many of
which have occurred along the way.  He asked for use cases: "<q>I really
want to know what is driving this insanity, and what the 
actual use-case is.</q>"  But he made it pretty clear that he was—at a
minimum—skeptical.
<div class="BigQuote">
The old DOS/Mac people thought case insensitivity was a "helpful"
idea, and that was understandable - but wrong - even back in the 80's.
They are still living with the end result of that horrendously bad
decision decades later. They've _tried_ to fix their bad decisions,
and have never been able to (except, apparently, in iOS where somebody
finally had a glimmer of a clue).
</div>
</p>

<p><blockquote class="ad">
<b><tt>$ sudo subscribe today</tt></b>
<p>
Subscribe today and elevate your LWN privileges. You’ll have
access to all of LWN’s high-quality articles as soon as they’re
published, and help support LWN in the process.  <a href="https://lwn.net/Promo/nst-sudo/claim">Act now</a> and you can start with a free trial subscription.
</blockquote>
<p>
Theodore Y. Ts'o, who has been working with Krisman on this effort, had
apparently brought the patch set to Torvalds's attention in a private email
that Torvalds quotes.  Another reply also didn't make it into the thread,
but in that message (which Torvalds also <a
href="/ml/linux-fsdevel/CAHk-=wgLYy3pRFDxwXB1THf4ev2C6VOmK5m7tfSwwv+EC9pM3Q@mail.gmail.com/">quotes</a>)
Ts'o noted that there was no plan to support encodings other than UTF-8
(and ASCII), which would be set on a per-filesystem basis.
Case-insensitivity would be set on a per-directory basis.  Given that,
Torvalds was adamant that the NLS code was the wrong place to make these
changes:
<div class="BigQuote">
Either you have a horrible fundamental design mistake that has
different per-filesystem locales, or you don't.
<p>
If you don't, you shouldn't be touching any of the nls code.
<p>
Whatever unicode tables you use for case folding shouldn't be in the nls code.
</div>
</p>

<p>
Ts'o <a
href="/ml/linux-fsdevel/20181210000822.GD1840@mit.edu/">suggested</a>
moving the Unicode handling code to <tt>fs/unicode</tt> rather than
changing the NLS code.  He also described the current state of play with
regard to case-sensitivity in filesystems for macOS and Windows, as well as
for network filesystems like Samba and NFS.
Over time, Ts'o said, the inconsistencies in handling file names between
different filesystems have mostly been eliminated.
In January, Krisman <a
href="/ml/linux-fsdevel/20190128213223.31512-1-krisman@collabora.com/">posted</a>
version&nbsp;5 of his patch set, which reflects the switch to the
<tt>fs/unicode</tt> directory. 
</p>

<p>
The patch set also makes a more substantial change in that it switches
normalization methods.  There are multiple ways to create the "same" string
in Unicode, which is known as "<a
href="https://en.wikipedia.org/wiki/Unicode_equivalence">equivalence</a>".
Two different sets of code points that appear the same to a user, but
not to the filesystem, would be confusing, so there are <a
href="https://en.wikipedia.org/wiki/Unicode_equivalence#Normalization">normalization</a>
mechanisms to allow comparisons that take equivalence into account.
Ts'o described the confusion that can result:
<div class="BigQuote">
In the bad old-days, MacOS X's HFS+ was not normalization-preserving.
So it would force filenames to NFD form --- so if the user tried to
create a file named Å, and passed in the Unicode string U+212B to
creat(2), HFS+ would store it as U+0041,U+030A and that is what
readdir(2) would return.  Apple has effectively admitted this was a
mistake, and their new APFS doesn't do this any more.
<p>
Now, both file systems basically say, "we don't care whether you pass
in U+212B or U+0041,U+030A; on the screen it looks identical, Å, so we
will treat it as the same filename; but readdir(2) will return what
you gave us."
</div>

<p>
The
new patch set switched from NFKD to NFD, which in normalization lingo means
a switch from "compatibility" to "canonical" decomposition:
<div class="BigQuote">
The main change presented here is a proposal to migrate the
normalization method from NFKD to NFD.  After our discussions, and
reviewing other operating systems and languages aspects, I am more
convinced that canonical decomposition is more viable solution than
compatibility decomposition, because it doesn't ignore eliminate any
semantic meaning, like the definitive case of superscript numbers.  NFD
is also the documented method used by HFS+ and APFS, so
there is 
precedent. Notice however, that as far as my research goes, APFS doesn't
completely [follow] NFD, and in some cases, like &lt;compat&gt; flags, it
actually does NFKD, but not in others (&lt;fraction&gt;), where it applies the
canonical form.  We take a more consistent approach and always do plain
NFD.
</div>
</p>

<p>
As those quotes indicate, normalization is a messy business.  In fact, the
whole problem of case handling is a horrific mess, as Torvalds (and
others) noted.  But there are use cases, mostly involving interoperability
with other operating systems.  In addition, user-space implementations, with
a variety of shortcomings, exist for both Android (to support
<tt>/sdcard</tt>) and Samba—those could
perhaps be replaced with an in-kernel solution.
</p>

<p>
That posting did not generate all that many comments, though there was
a <a
href="/ml/linux-fsdevel/20190205181041.cdyt5jt7yrqswyy2@pali/">question
from Pali Rohár</a> about the normalization change.  He was concerned that
NFD would be incompatible with various other Linux user-space tools.  But
Krisman <a
href="/ml/linux-fsdevel/8736p2jbov.fsf@collabora.com/">explained</a> that
the patch set implements name-preserving semantics and that NFD is only
used internally for comparison.
</p>

<p>
Handling invalid UTF-8 byte sequences also <a
href="/ml/linux-fsdevel/20190206084752.nwjkeiixjks34vao@pali/">came
up</a>.  There are effectively two possible ways to handle the problem,
Krisman <a
href="/ml/linux-fsdevel/87sgx0hpiv.fsf@collabora.com/">said</a>.  Either
the filesystem can reject any file name that is invalid UTF-8 (and fix
any that are found on the disk) or to simply treat an invalid UTF-8 file
name as it would be today, so there would be no
case-folding or normalization.  Both are implemented and a given
filesystem's behavior can be configured with a feature flag; the default is to
treat them as an opaque byte sequence as they are currently.
</p>

<p>
On March 18, Krisman <a
href="/ml/linux-fsdevel/20190318202745.5200-1-krisman@collabora.com/">posted
version 6</a>, with few changes from the previous version.  He is trying to
flush out any opposition to the normalization change (or anything else in
the patch set), presumably in the hopes of getting it upstream soon.  So
far, there has only been a <a
href="/ml/linux-fsdevel/05dfd6a7-49f0-81a7-cd68-ff9f07182461@infradead.org/">question
from Randy Dunlap</a> about the impact on ext3 filesystems, which are
handled by the ext4 code.  Ts'o <a
href="/ml/linux-fsdevel/20190322235708.GA5675@mit.edu/">noted</a> that
"<q>strictly speaking, there is no such thing as an 'ext3 file
system'</q>" these days. 
Filesystems handled by the ext4 code are defined by the feature bits they
have set; if you create a filesystem using "<tt>-t&nbsp;ext3</tt>" and do
not override any of the options, though, it will not have any of the new
features enabled, thus it will be unaffected by them.
</p>

<p>
In order to use the feature, the filesystem will need to be created with
encoding-awareness information stored in the superblock.
On an encoding-aware ext4 filesystem, case-insensitivity can be enabled on an
empty directory (and its children) by setting an inode attribute.  That
can be done using the <tt>EXT4_CASEFOLD_FL</tt> <tt>ioctl()</tt> command,
though eventually the <a
href="http://man7.org/linux/man-pages/man1/chattr.1.html"><tt>chattr</tt></a>
command would presumably be updated to add support for the case-folding flag.
It should be noted that case-folding and <a href="/Articles/639427/">ext4
encryption</a> cannot be used concurrently for the same directory, though
Krisman is <a
href="/ml/linux-fsdevel/20190318202745.5200-9-krisman@collabora.com/">planning</a> 
to change that restriction down the road.
</p>

<p>
Both encoding-awareness and case-insensitivity are fairly large changes to
the traditional handling of file names.  Unix file names have always been
sequences of any byte values (except NUL and "/") without being interpreted
in any way.  If these changes are adopted, some ext4 filesystems will now
be substantially changing the semantics of various filesystem operations.
File creation and renaming will no longer operate the way they do today,
for example.
</p>


<p>
However, 
case-insensitivity is a feature that has been a long time coming and we 
may see it in the mainline before long.  At this point, though, it has only
run the gauntlet of the filesystem mailing lists; when it gets posted to
linux-kernel, there may be others with opinions—or outright objections.
If not, though, Linux&nbsp;5.3 or&nbsp;5.4 might just have a feature that
has been on some people's wish lists for a decade or two.
</p>
`<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Filesystems-Case-independent_lookups">Filesystems/Case-independent lookups</a></td></tr>
            <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Filesystems-ext4">Filesystems/ext4</a></td></tr>
            <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#UTF-8_encoding">UTF-8 encoding</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/784041/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor784129"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 18:12 UTC (Wed)
                               by <b>clugstj</b> (subscriber, #4020)
                              [<a href="/Articles/784129/">Link</a>] (36 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I've yet to see a legitimate use case for putting this brain damage in the kernel.  Does anyone actually have one?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784129/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784141"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 19:08 UTC (Wed)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/784141/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; I've yet to see a legitimate use case for putting this brain damage in the kernel</font><br>
<p>
Without overly complicated code security researchers wouldn't have any work to do!<br>
<p>
<font class="QuotedText">&gt; Case-insensitivity would be set on a per-directory basis</font><br>
<p>
Insanity has no limit. I was using the (otherwise pretty cool) Windows Subsystem for Linux. This is what happened:<br>
<a href="https://github.com/vector-of-bool/vscode-cmake-tools/issues/531">https://github.com/vector-of-bool/vscode-cmake-tools/issu...</a><br>
<p>
Because I was using the same project sometimes from WSL and sometimes from Windows, some directories *in the same project* were created case-sensitive and others not. Hilarity ensued.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784141/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784156"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 19:47 UTC (Wed)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/784156/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Well, CMake has "is case sensitive" logic baked in at compile time. Apple and Windows are "always case insensitive" and everything else is always case sensitive. I don't know what kinds of changes would be required in build tools to do this case insensitive comparisons. For example, this just doesn't work with ninja on Windows (I assume make has similar issues with the analogous ruleset):<br>
<p>
rule copy<br>
	command = cp $in $out<br>
build foo: copy in<br>
build bar: copy FOO<br>
<p>
saying that no rule makes FOO even though technically it will exist if you build foo. Basically, build tools that exist today need cases to match everywhere. And yes, ninja could figure this out right now, but if `dir/foo` and `dir/FOO` is used and `dir` is made by some rule during the build, its case sensitive flag can't be known at the start.<br>
<p>
Case insensitivity in filesystems is broken. Conditional case sensitivity at a per-filesystem level means even ninja needs to add ioctl queries to figure that out, but `--one-file-system` is something that is at least enforceable. Per-directory flags which require magical "what will the flag on this directory be in the future" is even more broken.<br>
<p>
I'd be surprised if "doesn't work in case insensitive ext4 directories" (nevermind an environment with a mix of case sensitive and insensitive directories) issues don't get closed as WONTFIX in many tools.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784156/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor784143"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 19:10 UTC (Wed)
                               by <b>Karellen</b> (subscriber, #67644)
                              [<a href="/Articles/784143/">Link</a>] (20 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yeah - I wonder what is the specific use case that would not be solved better by having case-insensitive globbing and autocompletion in the shell? In what other situation does a program know that it needs to open a file, and knows the name of that file, but doesn't know the precise capitalisation/normalisation of the name?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784143/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784151"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 19:25 UTC (Wed)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/784151/">Link</a>] (19 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If you don't add case-insensitive version of open() and friends then every open() call will have to scan the whole directory first. This adds up quickly for Samba and other file-server use-cases.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784151/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784160"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 20:02 UTC (Wed)
                               by <b>rweikusat2</b> (subscriber, #117920)
                              [<a href="/Articles/784160/">Link</a>] (15 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It could as well maintain a userspace dictionary mapping normalized/ lowercased names to their actual names (which could be maintained incrementally based on filesystem change notifications).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784160/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784161"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 20:05 UTC (Wed)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/784161/">Link</a>] (11 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Linux has no filesystem notification mechanisms that have required consistency and performance for a fileserver use-case.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784161/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784171"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 21:17 UTC (Wed)
                               by <b>rweikusat2</b> (subscriber, #117920)
                              [<a href="/Articles/784171/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There is no such thing as "a fileserver use case". Samba exists and has existed (and been used) for a while, hence, there are obviously "file server use cases" where the existing mechanisms perform well enough.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784171/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784174"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 21:26 UTC (Wed)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/784174/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Samba exists, but it does case insensitivity in a very expensive way. There are other use-cases as well, like mounting FAT filesystems.<br>
<p>
I've seen this firsthand - I'm using a Linux server for TimeMachine backups for Mac OS X. TimeMachine is braindead - it creates hundreds of thousands files in the same directory. With the default settings Samba slowed down to a crawl. <br>
<p>
Fortunately, TimeMachine doesn't care about file name cases. So by following steps from here: <a href="https://wiki.samba.org/index.php/Performance_Tuning">https://wiki.samba.org/index.php/Performance_Tuning</a> I was able to speed up backups by something like 10x. This is not insignificant and it would be nice for Linux to handle similar use-cases natively.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784174/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor784183"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 0:50 UTC (Thu)
                               by <b>rahulsundaram</b> (subscriber, #21946)
                              [<a href="/Articles/784183/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;  there are obviously "file server use cases" where the existing mechanisms perform well enough.</font><br>
<p>
Have you talked to Samba developers and asked them if they are happy with the current performance or would like to see better support from the kernel?  If you haven't I would encourage you to do that or talk to enterprises supporting Samba or even large customers.  I think you will find that perspectives useful to add to your opinions.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784183/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784260"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 16:10 UTC (Thu)
                               by <b>rweikusat2</b> (subscriber, #117920)
                              [<a href="/Articles/784260/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Someone claimed that Samba opening a file residing on a case-sensitive filesystem would require a pre-open, linear directory traversal. As I pointed out, this isn't true, at least not on Linux: It would be possible to use an incrementally maintained, userspace translation cache instead, however, unless I again have to use Samba for something in a resource-constrained environment, I'm not going to implement that and in the unlikely case that this would happen, I'd certainly not go through the rather pointless hassle of trying to contribute a non-trivial change to an open sausage project, as I have neither the time to do this nor the social skills and pedigree to do so successfully.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784260/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784277"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 18:36 UTC (Thu)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/784277/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; As I pointed out, this isn't true, at least not on Linux: It would be possible to use an incrementally maintained</font><br>
Nope. There is no way to maintain this cache with any sort of consistency guarantees. Linux filesystem change notifications are not up to it.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784277/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784301"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 29, 2019 3:03 UTC (Fri)
                               by <b>pabs</b> (subscriber, #43278)
                              [<a href="/Articles/784301/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
What are they missing now that recent Linux versions offer rename notifications and other directory change notifications?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784301/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784303"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 29, 2019 4:21 UTC (Fri)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/784303/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
inotify is not recursive. It's also best-effort and its notifications are asynchronous.<br>
<p>
fanotify is better, but it also can drop events from time to time under high load.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784303/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor946553"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 4, 2023 18:51 UTC (Wed)
                               by <b>calumapplepie</b> (guest, #143655)
                              [<a href="/Articles/946553/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You get an event when the queue overflows.  If you clear the cache on receiving such an event, you can provide consistency guarantees, at the cost of bad performance while the cache is rebuilt.  Since the queue is pretty big, overflows shouldn't happen too much.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/946553/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor784402"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 29, 2019 22:55 UTC (Fri)
                               by <b>jra</b> (subscriber, #55261)
                              [<a href="/Articles/784402/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
We already have an incrementally maintained, userspace translation cache in Samba. It catches the simple cases where we've seen a filename before - we cache it.<br>
<p>
Unfortunately it isn't enough. Cache misses are the problem. If the SMB client sends a filename "foo" and it isn't in the directory, we don't know if it doesn't exist, or exists under another case (e.g. as "Foo"). In that case we need to scan the directory. This gets really expensive, really quickly.<br>
<p>
We don't negatively cache as we're often used to export filesystems that local processes are also modifying.<br>
<p>
I've been wanting a case-insensitive filesystem lookup option in Linux for a long time (I think ZFS and XFS already have it, however flawed).<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784402/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor784198"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 7:28 UTC (Thu)
                               by <b>patrakov</b> (subscriber, #97174)
                              [<a href="/Articles/784198/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Wouldn't it simplify things if SAMBA stopped any attempts to export an existing directory tree? I.e. mandate that the only way to make a new file exported is to copy it in via the SMB protocol, quite possibly from localhost. Keep filenames opaque, keep files in a clearly-private area, teach users not to mess with them (like they don't directly mess with MySQL files). Keep whatever attributes Windows needs in some sort of a database.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784198/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784199"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 7:35 UTC (Thu)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/784199/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This is doable and is fairly easy, given that Samba has a well-defined pluggable VFS layer. <br>
<p>
But this will break a ton of other software that wants to directly modify the disk files. It will also mean that Linux's VFS is inadequate for a fairly common use-case.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784199/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor784162"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 20:17 UTC (Wed)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/784162/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Ideally this would be some kind of LRU cache which would have some flag to say "this is a one-off open, don't cache" to avoid the inotify (or whatever) mechanism. Plus, I'm sure folks would love having the C library run a thread in the background to listen for its notifications taking locks on this cache whenever something happens. Yeah, I don't see any race conditions, unpredicitable latency issues, or TOCTOU/cache coherency issues here at all.<br>
<p>
Sorry for the snark, it's not in response to your comment in particular, but my mind coming up with all the Pandora's boxes this is threatening to open.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784162/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784170"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 21:11 UTC (Wed)
                               by <b>rweikusat2</b> (subscriber, #117920)
                              [<a href="/Articles/784170/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There's no point in special-casing "one-off opens" unless this demonstrably solves a problem. As then kernel open has to scan the directory, anyway, you'll end up with the exact same kind of TOCTOU races. This is a problem which can't really be solved. As to your other objections: These is a generic list of programming errors, some of them attributable to the idea with "a background thread".<br>
<p>
It's possible to implement case-insensitive open in user space without doing a second linear search through a directory for every open. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784170/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784173"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 21:19 UTC (Wed)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/784173/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
As I understand, the kernel will keep track of canonicalized names in file cache, so it won't have to do a search.<br>
<p>
There's also the problem of making sure that no duplicate files exist.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784173/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor784312"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 29, 2019 9:16 UTC (Fri)
                               by <b>Karellen</b> (subscriber, #67644)
                              [<a href="/Articles/784312/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Why?<br>
<p>
How is a call to open() getting the filename to open? Either it's going to from an existing directory scan, in which case the capitalisation/normal form should already be correct, or it's going to be because a user has selected a file - in which case the shell/picker/whatever should be able to do that work already?<br>
<p>
Where would calls to open() be getting these correctly named but incorrectly capitalised/normalised filenames from?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784312/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784313"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 29, 2019 9:20 UTC (Fri)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/784313/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; How is a call to open() getting the filename to open? Either it's going to from an existing directory scan, in which case the capitalisation/normal form should already be correct, or it's going to be because a user has selected a file - in which case the shell/picker/whatever should be able to do that work already?</font><br>
You have an SMB request to open a file, with a file name. There's nothing else.<br>
<p>
You can try a happy case and just attempt an open() with the provided name. If it fails, you need to scan the directory to find a matching file with a different case.<br>
<p>
And you can't really cache the negative result, patterns like "if !exists(fname) {creat(fname);}" are exceedingly common.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784313/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor784942"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 4, 2019 17:09 UTC (Thu)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/784942/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Where would calls to open() be getting these correctly named but incorrectly capitalised/normalised filenames from?</font><br>
<p>
The user, maybe?<br>
<p>
What about the use case where I type in a name in a picker, and it displays a bunch of matches?<br>
<p>
Or what about the case where I typed in the name on the command line? Some of us still use a command line, you know ...<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784942/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor784184"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 2:05 UTC (Thu)
                               by <b>dw</b> (guest, #12017)
                              [<a href="/Articles/784184/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
as a recent MacOS refugee, frankly I find dicking around with case intensely annoying on a desktop after discovering things don't have to be that way. Sure it's supposed to be in userspace -- good luck with that. Darwin has an approach that works for users, and I'd be very happy to enable this flag the moment it becomes available.<br>
<p>
Was disgusted just last night to discover a Gtk chooser dialog's autocomplete was case sensitive. In a GUI. Total disconnect between Linux and what the real world has been doing successfully for decades now..<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784184/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784214"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 10:44 UTC (Thu)
                               by <b>mpr22</b> (subscriber, #60784)
                              [<a href="/Articles/784214/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Case-insensitivity on ext4 volumes has to be done in userspace, because doing it in the kernel breaks userspace.<br>
<p>
I agree that the Gtk file chooser having case-sensitive autocomplete is daft, but... I don't actually care, because I hate the Gtk file chooser anyway for other, more fundamental design decisions.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784214/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor784185"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 2:10 UTC (Thu)
                               by <b>dw</b> (guest, #12017)
                              [<a href="/Articles/784185/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
As a recent MacOS refugee (after a long previous history on desktop Linux), frankly I find dicking around with case on a desktop extremely annoying, after discovering things don't have to be that way. Sure it's supposed to be in userspace -- good luck retrofitting all that, and really it's just passing the blame. Darwin has an in-kernel approach that works for users, and I'd be very happy to enable this flag the instant it becomes available.<br>
<p>
I was disgusted just last night to discover a Gtk chooser dialog's autocomplete was case sensitive. In a GUI. In 2019. Total disconnect between Linux and what the real world has been doing successfully for decades, and what actual users expect.  No doubt someone will pop up to say 'but I prefer it that way', well, you're free patch whatever brainwrong you like into your desktop, but most people cannot and do not want that -- it's why contemporary developers are walking around with MacBooks rather than Linux boxes<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784185/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784192"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 3:56 UTC (Thu)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/784192/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
What do you expect of tools that have to deal with non existent files in a case insensitive world? Mainly, I'm thinking of build tools here, but there are other categories too where this crops up. Should make expect that there is a dependency here?<br>
<p>
foo:<br>
    touch foo<br>
bar: Foo<br>
    cp Foo bar<br>
<p>
Because if so, this means that tools now need to make a syscall just to do path manipulation to be accurate (something like canonpath() that would give a path which is the same for all equivalent input paths maybe by doing tolower() and normalization). And it has to work for paths that don't exist yet. And I don't think that can even be correct because that path might end up having a bind mount in there at some point which changes behavior (yeah, low chance, but kernels don't always have that luxury).<br>
<p>
Yeah, case insensitivity might be useful at the UI level, but even there you still have to deal with paths using binary data or invalid utf8 because a file that the GUI can't delete is a wonderful thing to diagnose and resolve. Personally, I don't find it that useful (but I encourage you to file an issue against GTK for the completion thing).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784192/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784281"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 19:11 UTC (Thu)
                               by <b>jccleaver</b> (subscriber, #127418)
                              [<a href="/Articles/784281/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Ultimately, this really brings to mind how important initial design is for things.<br>
<p>
Classic Mac OS was designed with case-insensitivity in mind, had no manual tools that needed to be imported with minimal effort rather than a complete rewrite, and had no shell mechanics to emulate.<br>
<p>
Case Insensitivity #JustWorks when people expect it and are going through translation layers (and aren't in the business of writing drivers), and doesn't when people assume low level access.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784281/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784286"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 20:14 UTC (Thu)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/784286/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I still wonder how this would have worked even on Classic Mac OS. Do you just assume that *all* paths can be normalized regardless of location or host filesystem? If so, do you just not support filesystems with alternate paths? Though I suppose the Windows solution of mangling unsupported names on the render side works too[1]. However, this means that any path manipulation has to do a syscall to get some canonical representation of a path or each program has to have a "pathcmp" function to determine that "foo" and "FOO" are really the same thing.<br>
<p>
Would you have expected the shown Makefile snippet to work on Classic Mac OS or would an error that "no rule to make FOO" be acceptable?<br>
<p>
[1]Making a path appear in Explorer via a network share with the name "CON1" renders as some mangled name. Creating a file with that mangled name then shows two files with the same name appear. Deleting either one via the UI deletes the one with the real mangled name first (I assume given a HANDLE, they can be differentiated).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784286/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784289"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 20:35 UTC (Thu)
                               by <b>k8to</b> (guest, #15413)
                              [<a href="/Articles/784289/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yeah, mounting case sensitive filesystem on classic MacOS would have been messy.  I'm sure I did this at some point with e.g. Basilisk II mounting the Linux filesystem underneath it, but that had a hefty translation layer to support the other oddities of classic MacOS like forks etc.<br>
<p>
I think that was the approach taken by other people too, probably one of Apple Single or Apple Double representations which probably had some solution for NFS which was still in vogue in the 90s.<br>
<p>
It wasn't that nice an experience for the Mac users or the non-mac users.  I never programmed against it to experience the extra sharp edges, though.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784289/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor784291"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 21:01 UTC (Thu)
                               by <b>jccleaver</b> (subscriber, #127418)
                              [<a href="/Articles/784291/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Do you just assume that *all* paths can be normalized regardless of location or host filesystem?</font><br>
<p>
I think by System 7.5 (or 7.1 Pro) you did, because if I recall correctly that's how File Exchange/PC Exchange did its work.<br>
<p>
Remember, in classic Mac OS the colon ':' was the directory separator in paths, and you could use '/'s to your heart's content. Actually, you could use pretty much anything to your heart's content, including spaces, punctuation (since no one in the Mac side cared about extensions) and even weird graphs like the f-hook or florin <a href="https://en.wikipedia.org/wiki/%C6%91#Appearance_in_computer_fonts">https://en.wikipedia.org/wiki/%C6%91#Appearance_in_comput...</a> , which I still find myself occasionally doing on OS X 20 years later.<br>
<p>
Anyway, with /. \. and : being used in different locations, there was definitely path-mangling going on below the interface. But general users didn't have to care, and most Mac programs didn't deal with constructed path names, and *never* had to worry about shell-quoting for spaces and whatnot.<br>
<p>
Between this freeform text attitude, the resource and data fork dichotomy, and the use of Type and Creator codes, I definitely feel like we've lost some good capabilities on the Mac side in the quest for broader interoperability.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784291/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor784202"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 8:11 UTC (Thu)
                               by <b>daniels</b> (subscriber, #16193)
                              [<a href="/Articles/784202/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; I've yet to see a legitimate use case for putting this brain damage in the kernel. Does anyone actually have one?</font><br>
<p>
No, everyone involved is just doing this for absolutely no reason at all. Weird.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784202/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor784204"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 8:39 UTC (Thu)
                               by <b>nim-nim</b> (subscriber, #34454)
                              [<a href="/Articles/784204/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Any shared filesystem (network filesystem, removable media) will soon become completely unusable if different systems write on it with different default encodings. Treating filenames as opaque bunches of bytes does not work because you need to convey filenames to humans at some point. Humans do not understand raw bytes they understand decoded bytes, and that requires knowledge of the encoding used in filenames.<br>
<p>
So any shared filesystem will need to export to userspace the encoding used for each part of its tree (either a single encoding for everything, or separate encodings per subtree).<br>
<p>
Casing is something else but once you get past the encoding point casing becomes a less harder to tackle.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784204/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784255"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 15:58 UTC (Thu)
                               by <b>nybble41</b> (subscriber, #55106)
                              [<a href="/Articles/784255/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Casing is something else but once you get past the encoding point casing becomes a less harder to tackle.</font><br>
<p>
Not much less. Casing rules depend not just on encoding but also locale, and while it may be practical to enforce a single universal encoding and normalization scheme you're definitely not going to get away with enforcing a single universal locale.<br>
<p>
The logical way to handle normalization is to simply disallow non-normalized filenames. The kernel doesn't change the encoding or compare different normal forms, it just verifies that the names of new files are in a particular normal form and returns an error if they aren't. Since all names are already in the same normal form comparisons reduce to exact binary matches. The equivalent for case would be to disallow either lowercase or uppercase characters in filenames (assuming you could even clearly define what is "uppercase" or "lowercase"—it depends on the locale). People put up with that in the DOS era but I don't think it would be considered acceptable today.<br>
<p>
The odds that encoding or normalization would be permitted to vary per-filesystem or per-subtree are negligible. Applications aren't prepared to deal with that, nor should they be expected to do so. Any conversions needed for shared filesystems should be handled at the lowest layers of the filesystem, between the storage or network and the kernel.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784255/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784317"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 29, 2019 10:52 UTC (Fri)
                               by <b>nim-nim</b> (subscriber, #34454)
                              [<a href="/Articles/784317/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Assuming the lowest layers of the stack could handle conversions transparently (which I'm doubtful of, that would require low-level knowledge about every possible encoding variation on earth), you still need to know the encoding(s) you start with. Meaning, you have to put at least one pivot encoding definition inside your filesystem.<br>
<p>
That's the part people object to, because they are used to the simplicity of pushing encoding problems somewhere else, with "filenames are streams of bytes". Which was not true even for original UNIX. Actual original Unix filename bytes were 7bit ASCII bytes and nothing else.<br>
<p>
But 7bit ASCII is useless in a modern i18n world. So you need to record other pivot encoding(s) in filesystems¹.<br>
<p>
¹ Record, not reproduce the mistake of original UNIX, that assumed there was a single encoding that would never evolve so there was no need to make it explicit; easy mistake to made in the simpler computer age they lived in; inexcusable mistake to make today.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784317/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor784229"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 14:28 UTC (Thu)
                               by <b>smurf</b> (subscriber, #17840)
                              [<a href="/Articles/784229/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yes. Besides case insensitivity there's also the issue of differently-normalized file names. I would like to have one well-defined on-disk normal form. Otherwise I save "hëllo.txt" (e, combining diaraesis) and then fail to open "hëllo.txt" (e-with-diaraesis). This problem affects my desktop interface as well as web servers with "interesting" URLs.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784229/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor784128"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 18:38 UTC (Wed)
                               by <b>hkario</b> (subscriber, #94864)
                              [<a href="/Articles/784128/">Link</a>] (11 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
the problem is not the encoding of the file names on disk, as long as all the users of the file system (as in, the operating systems, thinking of a USB stick) what the encoding is, the exact one is an implementation detail - though the names need to be normalized before being written to disk (or read and compared with other)<br>
<p>
what IS important is what LOCALE the file system, or rather the user, is working<br>
<p>
lower case "I" (India) in Turkish locale is a letter "ı" (dot-less i). And no, the "I" in Turkish is not any different than the "I" in English, German or Polish, it's the same Unicode codepoint.<br>
<p>
also, there's "İ" that is down-cased to "i" in Turkish locale, and again, the "i" is not special<br>
<p>
combine this with two users that work in different locales on the same file system and "fun ensues"<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784128/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784142"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 19:04 UTC (Wed)
                               by <b>k8to</b> (guest, #15413)
                              [<a href="/Articles/784142/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You can even have this with two processes for the same user, although it's less likely.  It's not that unlikely.<br>
<p>
It's a common defensive pattern to set the locale to something like "C" when you programmatically fire off utilities like 'ps' e.g. for portable process-id validation, and although this is can't produce as much confusion as turkish vs en_US.utf8, it can produce similar problems.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784142/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor784144"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 19:11 UTC (Wed)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/784144/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Table of Contents of <a href="https://www.b-list.org/weblog/2018/nov/26/case/">https://www.b-list.org/weblog/2018/nov/26/case/</a><br>
"Truths programmers should know about case"<br>
<font class="QuotedText">&gt; - There are more than two cases</font><br>
<font class="QuotedText">&gt; - There’s more than one way to determine case</font><br>
<font class="QuotedText">&gt; - You can’t tell a character’s case from looking at it (or from its name)</font><br>
<font class="QuotedText">&gt; - Some characters have no case</font><br>
<font class="QuotedText">&gt; - Some characters may appear to have multiple cases</font><br>
<font class="QuotedText">&gt; - Case is context-sensitive</font><br>
<font class="QuotedText">&gt; - Case is locale-sensitive</font><br>
<font class="QuotedText">&gt; - Case-insensitive comparison requires case folding</font><br>
<font class="QuotedText">&gt; - Enough for now "still not exhaustive on its topic"</font><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784144/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor784145"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 19:15 UTC (Wed)
                               by <b>juliank</b> (guest, #45896)
                              [<a href="/Articles/784145/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Meh. Can just treat I = ı = İ = i<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784145/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784153"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 19:39 UTC (Wed)
                               by <b>mpr22</b> (subscriber, #60784)
                              [<a href="/Articles/784153/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
No, you can't.<br>
<p>
Because people get murdered when you do that.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784153/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784164"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 20:46 UTC (Wed)
                               by <b>dvdeug</b> (guest, #10998)
                              [<a href="/Articles/784164/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Top of any programmer's things to know about names list is that they're not unique. Someone who takes substantive action based on whether or not a name matches is wholly responsible for their own screwups.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784164/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor784215"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 10:42 UTC (Thu)
                               by <b>hkario</b> (subscriber, #94864)
                              [<a href="/Articles/784215/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
you can treat them as the same to the same degree as you can consider "y" to be equivalent to "i", or "oo" to "u"<br>
<p>
Just because you grew up with an alphabet that has 26 letters doesn't mean that it's the only alphabet in use.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784215/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor784152"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 19:30 UTC (Wed)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/784152/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; lower case "I" (India) in Turkish locale is a letter "ı" (dot-less i). And no, the "I" in Turkish is not any different than the "I" in English, German or Polish, it's the same Unicode codepoint.</font><br>
<p>
For some strange reason many (most?) French people think the upper case of:<br>
- é, à, ü, î...<br>
are without accents like:<br>
- E, A, U, I,...<br>
but if you look at any half-professional book or [online] newspaper you'll find:<br>
- É, À, Ü, Î,...<br>
<p>
Windows keyboard for France (!= for French) makes it incredibly hard to enter the correct ones.<br>
<p>
The spell checker in Microsoft Word has a setting letting you decide which one you think is correct:<br>
<a href="https://www.pcastuces.com/pratique/astuces/1718.htm">https://www.pcastuces.com/pratique/astuces/1718.htm</a><br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784152/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784200"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 7:32 UTC (Thu)
                               by <b>andrewsh</b> (subscriber, #71043)
                              [<a href="/Articles/784200/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That’s why upper-case in documents should be a text style, not ACTUAL capitals in the text.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784200/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784216"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 11:05 UTC (Thu)
                               by <b>hkario</b> (subscriber, #94864)
                              [<a href="/Articles/784216/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Good luck writing about the German ß, that can be upper-cased to either SS (the old convention) or ẞ (the new convention).<br>
But when you down-case SS, you do it to ss.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784216/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor784205"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 8:47 UTC (Thu)
                               by <b>nim-nim</b> (subscriber, #34454)
                              [<a href="/Articles/784205/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; For some strange reason many (most?) French people think the upper case are without accents </font><br>
<p>
People are just used to broken systems (broken keyboards on typewriters and computers, broken apps, in legacy typesetting "someone broke the small bit of lead corresponding to the diacritic on the capitalized letter"). Humans habits are a huge source of inertia. When Microsoft finally got around to fix Office for French some Microsoft clients actually complained it was now correcting words to the correct spelling.<br>
<p>
Proper typesetting shops take care to type correct french (typesetting apps correct the windows user breakage), and Linux diverged long ago from the "official" AZERTY layout to make uppercase with diacritics easy to type (French Canadians were smarter: they fixed their official layout to put caps with diacritics proeminently on them. Pity you can't buy Canadian French keyboards easily in France).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784205/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor784206"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 9:01 UTC (Thu)
                               by <b>nilsmeyer</b> (guest, #122604)
                              [<a href="/Articles/784206/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Maybe that's just a matter of convenience? I don't know about keyboards for France, when I want to write É I have to hit three keys in a specific order. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784206/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor784163"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 27, 2019 20:30 UTC (Wed)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/784163/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Either the filesystem can reject any file name that is invalid UTF-8 (and fix any that are found on the disk) or to simply treat an invalid UTF-8 file name as it would be today, so there would be no case-folding or normalization.</font><br>
<p>
Maybe having it reject by default, if only for a while, will prompt people to fix the tools generating invalid UTF-8 filenames in the first place. /usr/bin/zip is notorious for this; I've started using 7zip to extract .zip files because it gets it right.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784163/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor785066"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 5, 2019 20:01 UTC (Fri)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/785066/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'd be inclined to copy the Windows trick, actually, where they have two file names.<br>
<p>
Seeing as it seems it can only be activated on an empty directory, the i-nodes would have to have space for two entries - the canonical form and the user form. Any file-system access converts to canonical and searches on both, but a collision on the canonical name will take the appropriate behaviour.<br>
<p>
That might also provide a way for switching a used directory to case-insensitive - the canonical field would start out empty, but writing to the directory would do a canonical search and return an error if there was a collision. Be a bit messy though possibly.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/785066/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor785154"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 8, 2019 6:57 UTC (Mon)
                               by <b>lkundrak</b> (subscriber, #43452)
                              [<a href="/Articles/785154/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; I'd be inclined to copy the Windows trick, actually, where they have two file names.</font><br>
<p>
Wasn't their patent on a file having two names what the TomTom lawsuit was about?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/785154/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor785264"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 8, 2019 19:38 UTC (Mon)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/785264/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
inodes have no name, and we already have a mechanism for one file having as many names as you like: hard links. I'm sure this can be repurposed somehow...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/785264/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor784217"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 11:20 UTC (Thu)
                               by <b>mjthayer</b> (guest, #39183)
                              [<a href="/Articles/784217/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
To my mind part of the problem is the expectation that there is a clean solution to the problem.  Human writing has been in existence and evolution for thousands of years, and not as a single consistent entity at that.  Even Latin script is split into many many sub-scripts (the Turkish "i" is not an electronic invention).  Computer encodings, locales and filesystems have not been around that long, but have also picked up more than enough legacy which we can't just wish away.  And we want file names to solve a range of problems, some of which are more relevant to users and some to developers.<br>
<p>
Having said that, having file systems encode file names as byte strings and having mechanisms to query those uninterpreted or case-insensitive (or whatever) as processes require seems to me a reasonable square of the circle.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784217/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784290"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 28, 2019 20:40 UTC (Thu)
                               by <b>k8to</b> (guest, #15413)
                              [<a href="/Articles/784290/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I agree with most of that.<br>
<p>
However, I'm not sure that allowing people to create both Foo and foo and then having applications use an interface that "asks for foo" in an insensitive fashion is going to produce a lot of happiness.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784290/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor784398"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 29, 2019 22:41 UTC (Fri)
                               by <b>mirabilos</b> (subscriber, #84359)
                              [<a href="/Articles/784398/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The whole idea is crazy.<br>
<p>
Additionally, did someone ask the Turkish people? (PHP fucked them up, because the word “function” contains a dotted i, and PHP insists on being case-insensitive…)<br>
<p>
There, I ≠ i because they have I ↔ ı and i ↔ İ so you need locales.<br>
<p>
This is the ultimate proof that case-insensitivity cannot (and therefore MUST NOT) be done on the filesystem level.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784398/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor784426"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 30, 2019 22:28 UTC (Sat)
                               by <b>jthill</b> (subscriber, #56558)
                              [<a href="/Articles/784426/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      Seriously, I think the only even halfway-respectable choice here is to encode the specific locale and case sensitivity with each path component.  If that means having a filesystem (probably also system) catalog of encountered locales and a locale index on each directory entry, so be it.

Case folding differs by locale, and locale can be either an intrinsic text attribute or a matter of user interpretation. Punting it to system administration is just begging for botchery, it leaves you with third-party implementations of arbitrary choices affecting the results of fundamental operations.  If I think my `README` is case-insensitive and my `Makefile` is case-sensitive but `*.exe` should be case-insensitive, well, sadly enough that's a reasonably widely understood situation these days
      
          <div class="CommentReplyButton">
            <form action="/Articles/784426/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor784900"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Case-insensitive ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 4, 2019 13:13 UTC (Thu)
                               by <b>bosyber</b> (guest, #84963)
                              [<a href="/Articles/784900/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That might be working for some cases, but I wonder how I'd like that.<br>
<p>
I am Dutch, currently living in Germany, and often conversing in English too (like here; plus sometimes receiving Czech documents). Now, none of those are really difficult cases, I think (SS/ss and ß notwithstanding), but they do have differences in how characters need to be interpreted, but while my usage is for a large part context/file dependant, there are overlaps in what I use when, sometimes in a single context, like in chats, online, and sometimes stored in a single directory, due to where, by whom, and for what a document was created.<br>
<p>
Not sure how what you propose can work correctly when generalized. Imagine I for some reason add Turkish in the mix too, or when I use a more complex, different set of languages as daily use.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/784900/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2019, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
