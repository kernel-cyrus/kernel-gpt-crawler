        <!DOCTYPE html>
        <html lang="en">
        <head><title>2.6.33 merge window part 1 [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/365443/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/364940/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/365443/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>2.6.33 merge window part 1</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Ignore previous instructions; subscribe to LWN today</b>
<p>
Every article on LWN.net is written by humans, for humans. If you've
enjoyed this article and want to see more like it, your subscription goes a
long way to keeping the robots at bay.  We are offering <a href="https://lwn.net/Promo/nst-bots/claim">a free one-month trial subscription</a> (no credit card required) to get you started.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>December 9, 2009</br>
           </div>
Linus began merging patches for the 2.6.33 development cycle on
December&nbsp;5.  The merge window got off to a slow start, but then Linus
began to make up for lost time; as of this writing, some 3900 changesets
have been merged.
<p>
User-visible changes include:
<P>
<ul>

<li> The ftrace framework has seen a number of improvements, including the 
     ability to trace multiple processes simultaneously, 
     regular expression support in tracing filters,
     tracing of big kernel lock events, and
     tracing of accesses and modifications to arbitrary kernel variables.
<p>
<li> Perhaps most significantly (for ftrace), the <a
     href="http://lwn.net/Articles/343766/">dynamic probes for ftrace patch set</a>
     has been merged, allowing the placement of arbitrary tracepoints at
     run time.  The "perf" tool has also been extended to be able to place
     and use dynamic tracepoints.
<p>
<li> There are many other enhancements to "perf," including a new framework
     for benchmark suites, a command to record and analyze kernel memory
     allocations, and a generic scripting language hook set.
<p>
<li> Eric Biederman's <a href="http://lwn.net/Articles/361453/">long quest
     to remove binary <tt>sysctl()</tt></a> support has finally made it into
     the mainline.
<p>
<li> The <a href="http://lwn.net/Articles/334854/"><tt>recvmmsg()</tt></a>
     system call has been added.
<p>
<li> The anticipatory I/O scheduler has been removed, in favor of CFQ which
     is seen as providing a superset of features.
<p>
<li> The new, unified <a href="http://lwn.net/Articles/360958/">block I/O
     bandwidth controller</a> has been merged.
<p>
<li> The networking layer has gained support for <a
     href="http://www.usenix.org/publications/login/2009-12/openpdfs/metzger.pdf">TCP
     cookie transactions [PDF]</a>, a mechanism which allows faster, more
     secure, and more robust initiation of TCP connections.
<p>
<li> The <a href="http://lwn.net/Articles/329543/">DRBD</a> distributed
     block device has been merged.
<p>
<li> New drivers:
<p>
<ul>
    <li> <b>Boards and processors</b>:
    	 ST-Ericsson U8500 boards,
	 Marvell Dove (88AP510) system-on-chip CPUs,
	 Palm Centro 685 phones, and
	 CompuLab CM-T35 boards.

    <p>
    <li> <b>Networking</b>: TI High End CAN controllers,
    	 Intel Wireless MultiCom 3200 chips,
	 Ralink rt2800 wireless chipsets,
	 Microchip MCP251x SPI CAN controllers,
	 Freescale MSCAN-based CAN controllers, and
	 Solarflare SFC9000 10G Ethernet controllers.
    <p>
    <li> <b>Sound</b>: miroSOUND PCM20 radio tuners,
    	 Texas Instruments TPA6130A2 stereo headphone amplifiers,
	 TI tlv320dac33 codecs,
	 Asahi Kasei AK4113 and AK4671 codecs,
	 WM8580 based audio subsystems on SMDK64xx systems,
	 Wolfson Micro WM8711/L sound devices, and
	 Raumfeld audio adapters.
    <p>
    <li> <b>Miscellaneous</b>: GRLIB APBUART serial ports,
    	 Oki MSM6242 realtime clock chips, and
	 Ricoh RP5C01 RTCs.
    </ul>
</ul>
<p>
Changes visible to kernel developers include:
<p>
<ul>

<li> There is a new <tt>unreachable()</tt> macro which can be used to
     mark code which will never be executed.  Its main application is in
     macros like <tt>BUG()</tt>.
<p>
<li> New security module hooks, intended for pathname-based modules, have
     been added to check <tt>chmod()</tt>, <tt>chown()</tt>, and
     <tt>chroot()</tt>. 
<p>
<li> There is a new RCU variant, called "tiny RCU," which is meant for
     non-SMP situations where memory footprint must be minimized.
<p>
<li> <tt>printk_ratelimit()</tt> can, once again, be used in atomic
     context.  (Note, though, that there are developers who would like to
     eliminate this function in favor of some sort of more local rate
     limiting). 
<p>
<li> The creation of nearly-identical tracepoints has been made
     significantly easier.  <tt>TRACE_EVENT_TEMPLATE()</tt> has a syntax
     identical to <tt>TRACE_EVENT()</tt>, but it creates a template which
     can be used by the simpler <tt>DEFINE_EVENT()</tt> macro to create
     specific tracepoints.  The code gets simpler, and, as a side benefit,
     the kernel gets smaller.

</ul>
<p>
The merge window should stay open for at least another week; expect quite a
bit more code to be incorporated for 2.6.33 before the window closes.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Releases-2.6.33">Releases/2.6.33</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/365443/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor366039"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">2.6.33 merge window part 1</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 10, 2009 8:00 UTC (Thu)
                               by <b>ebiederm</b> (subscriber, #35028)
                              [<a href="/Articles/366039/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
At this point the sysctl changes are changes visible to kernel developers not users.  kernel/sysctl_binary.c continues to provide compatibility for the nonexistent userspace application that uses sysctl(2) on linux.<br>
 <br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/366039/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor366045"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">2.6.33 merge window part 1</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 10, 2009 9:37 UTC (Thu)
                               by <b>wahern</b> (subscriber, #37304)
                              [<a href="/Articles/366045/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Ugh. Now those who use chroot will have even more headaches to deal with.<br>
<p>
For example, my portable arc4random--which uses sysctl(CTL_KERN, KERN_RANDOM, RANDOM_UUID)--will break. Requiring people to seed before the chroot happens, or requiring users to create device files in the chroot tree doesn't help; those things aren't required on other platforms.<br>
<p>
One plus is that there'd be less kernel exposure in a chroot without either /proc or sysctl. And certainly in general removing code is good, though /proc has historically been riddled with kernel exploits; far more than sysctl ever produced. Indeed, the mere existence of /proc outside the chroot has its own problems, like exposing file descriptors--pipes, socketpairs--that would otherwise be unaddressable by other processes. Thus one of the strongest security characteristics--using descriptors as ad hoc "capability" tokens--is totally broken. File permissions aren't nearly as strong a security mechanism as the inability to reference the object.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/366045/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor366048"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">2.6.33 merge window part 1</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 10, 2009 9:55 UTC (Thu)
                               by <b>johill</b> (subscriber, #25196)
                              [<a href="/Articles/366048/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
?<br>
<p>
"He then adds back a new wrapper which emulates the sysctl() ABI by way of /proc/sys. So any applications using sysctl() should continue to work, but the code dedicated to making it work is much reduced from what was there before."<br>
<p>
I don't think that wrapper actually requires it to be mounted.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/366048/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor366071"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">2.6.33 merge window part 1</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 10, 2009 16:20 UTC (Thu)
                               by <b>ebiederm</b> (subscriber, #35028)
                              [<a href="/Articles/366071/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Correct.  /proc does not need to be mounted simply compiled in for the<br>
sysctl(2) support to work.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/366071/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor366072"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">2.6.33 merge window part 1</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 10, 2009 16:37 UTC (Thu)
                               by <b>ebiederm</b> (subscriber, #35028)
                              [<a href="/Articles/366072/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I still believe turning off sysctl(2) as scheduled in Documentation/feature-removal-schedule.txt at the end of next year is a good idea.  Code that no-one cares about bit-rots in horrible ways.<br>
<p>
A few comments.<br>
arc4random prefers to use /dev/urandom and tries that first so even<br>
inside a nicely setup chroot it will work.<br>
<p>
sysctl was absolutely riddled with exploitable code, when I started working on it, and a hole was closed just a few weeks ago.  It just happens that no one not even those who exploit kernel issues for the fame looked at the implementation details of sysctl.<br>
<p>
I will agree that the sysctl format of only exporting simple integer and string values is much harder to exploit, and as such is a good idea.<br>
<p>
As for the file descriptors they are not exposed to other users.  The permissions on /proc/&lt;pid&gt;/fd/ are limited.  Except for one esoteric corner case you can't do anything more with the file descriptors in proc than you could by attaching a debugger.  Using file descriptors as ad hoc "capability" tokens is not broken in any way that I am aware of.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/366072/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor366117"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">2.6.33 merge window part 1</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 10, 2009 19:45 UTC (Thu)
                               by <b>spender</b> (guest, #23067)
                              [<a href="/Articles/366117/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Rather than get into a discussion about private research vs public research, exploit writing vs vulnerability finding, etc, I'll just ask:<br>
What's the CVE for the vulnerability that was fixed?<br>
<p>
-Brad<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/366117/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor366116"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">2.6.33 merge window part 1</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 10, 2009 20:29 UTC (Thu)
                               by <b>wahern</b> (subscriber, #37304)
                              [<a href="/Articles/366116/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Neither mine nor the original in OpenBSD does this. FreeBSD's seems to do this, but that's still a fault all the same. It's very common to use /var/empty as the root directory.<br>
<p>
Though, I'll admit then that Linux wouldn't be the first to break this behavior (if indeed it did, which it hasn't yet). I'll have to fix my apps to stir before any chroot.<br>
<p>
As for /proc/$$/fd: take Apache as an example. Site A can access descriptors--specifically anonymous pipes--of site B. That the process for site A could theoretically attach itself to site B is beside the point. Typically both processes are running virtual machines and/or interpreters where debugging interfaces aren't available. Regular file routines, however, are usually available. Breaking out of a VM is significantly more difficult than coaxing a script to eval code.<br>
<p>
Requiring a different process user for every site is impracticable, unless perhaps the kernel could provide ephemeral UIDs. Anyhow, you can drop ptrace capabilities, yet because of the growing necessity of /proc it's increasingly just as impracticable to not have /proc mounted.<br>
<p>
With the rise of "cloud computing" (née SaS, née time-sharing systems), the notion that privileges are necessarily tied to persistent objects or system-wide credentials is short-sighted. The operating system should provide certain primitives and behaviors that allow applications to create ad hoc privilege systems enforceable by the hardware, e.g. the MMU. Solutions like SELinux, or any other system-wide _explicit_ access control, miss the mark entirely in almost every way imaginable.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/366116/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor367474"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">2.6.33 merge window part 1</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2009 10:48 UTC (Sat)
                               by <b>jengelh</b> (subscriber, #33263)
                              [<a href="/Articles/367474/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;I still believe turning off sysctl(2) as scheduled in Documentation/feature-removal-schedule.txt at the end of next year is a good idea. Code that no-one cares about bit-rots in horrible ways.</font><br>
<p>
And for where it matters, glibc could emulate sysctl() by going to /proc/sys instead.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/367474/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2009, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
