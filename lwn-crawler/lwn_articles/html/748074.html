        <!DOCTYPE html>
        <html lang="en">
        <head><title>Shedding old architectures and compilers in the kernel [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/748074/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/747814/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/748074/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>Shedding old architectures and compilers in the kernel</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>LWN.net needs you!</b>
<p>
Without subscribers, LWN would simply not exist.  Please consider
       <a href="/Promo/nst-nag2/subscribe">signing up for a subscription</a> and helping
       to keep LWN publishing.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>February 26, 2018</br>
           </div>
The kernel development process tends to be focused on addition: each new
release supports more drivers, more features, and often new processor
architectures. 
As a result, almost every kernel release has been larger than its
predecessor.  But occasionally even the kernel needs to slim down a bit.
Upcoming kernel releases are likely to see the removal of support for a
number of unloved architectures and, in an unrelated move, the removal of
support for some older compilers.
<p>
<h4>Architectures</h4>
<p>
The <a href="https://en.wikipedia.org/wiki/Imagination_META">Meta
architecture</a> was added to the 3.9 kernel as "metag" in 2013; it is a 32-bit
architecture developed by Imagination Technologies.  Unfortunately, at
about the same time as the code was merged, Imagination Technologies bought
MIPS Technologies and shifted its attention to the MIPS architecture.
Since then, the kernel's support for Meta has languished, and it can only
be built with the GCC 4.2.4 release, which is unsupported.  On
February&nbsp;21, James Hogan, the developer who originally added the Meta
port to the kernel, <a href="/Articles/747759/">proposed that it be
removed</a>, calling it "<q>essentially dead with no users</q>".
<p>
The very next day, Arnd Bergmann, working entirely independently, <a
href="/Articles/748076/">also proposed removing Meta</a>.  Bergmann,
however, as is his way, took a rather wider view of things: he proposed
that the removal of five architectures should be seriously considered.  The
other four were:
<p>
<ul class="spacylist">

<li> The <a href="https://en.wikipedia.org/wiki/S%2Bcore">Sunplus
     S+core</a> ("score") architecture entered the kernel for
     the 2.6.30 release in 2009.  Since then, the maintainers for that
     architecture have moved on and no longer contribute changes to the
     kernel.  GCC support for score was removed in the 5.0 release in
     2015.  Bergman said: "<q>I conclude that this is dead in Linux and
     can be removed</q>".  Nobody has spoken up in favor of retaining
     this architecture.
<li> The <a href="https://en.wikipedia.org/wiki/Unicore">Unicore 32</a>
     architecture was merged for the 2.6.39 kernel in 2011.  This
     architecture was a research project at Peking University.  Bergmann
     noted that there was never a published GCC port and that the
     maintainer has not sent a pull request since 2014.  This architecture,
     too, seems to lack users and nobody has spoken in favor of keeping it.
<li> Qualcomm's <a
     href="https://en.wikipedia.org/wiki/Qualcomm_Hexagon">Hexagon</a> is a
     digital signal processor architecture; support for Hexagon entered the
     kernel in 2011 for the 3.2 release.  Hexagon is a bit of a different
     case, in that the architecture is still in active use; Bergmann said
     that "<q>it is being actively used in all Snapdragon ARM SoCs, but
     the kernel code appears to be the result of a failed research project
     to make a standalone Hexagon SoC without an ARM core</q>".  The GCC
     4.5 port for this architecture never was merged.
     <p>
     Richard Kuo <a href="/Articles/748077/">responded</a> in defense of the
     Hexagon architecture, saying: "<q>We still use the port internally
     for kicking the tools around and other research projects</q>".  The
     GCC port is indeed abandoned, he said, but only because Qualcomm has
     moved to using LLVM to build both kernel and user-space code.
     Bergmann <a href="/Articles/748078/">responded</a> that, since there
     is still a maintainer who finds the code useful, it will remain in the
     kernel.  He would like to put together a working LLVM toolchain to build
     this port, though.
<li> The <a href="https://openrisc.io/">OpenRISC</a> architecture was
     merged in the 3.1 release, also in 2011.  Bergmann observed that OpenRISC
     "<q>seems to have lost a bit of steam after RISC-V is rapidly
     taking over that niche, but there are chips out there and the design
     isn't going away</q>".  He added it to his list because there is no
     upstream GCC support, but said that the OpenRISC GCC port is easy to
     find and the kernel code is being actively maintained.  Philipp Wagner
     <a href="/Articles/748079/">responded</a> that the GCC code has not
     been upstreamed because of a missing copyright assignment from a
     significant developer; that code is in the process of being
     rewritten.  The end result is that there is no danger of OpenRISC
     being removed from the kernel anytime soon.
</ul>
<p>

Bergmann also mentioned in passing that the FR-V and M32R architectures
(both added prior to the beginning of the Git era) have been marked as
being orphaned and should eventually be considered for removal.  It quickly
became apparent in the discussion, though, that nobody seems to care about
those architectures.  Finally, David Howells added support for the mn10300
architecture for 2.6.25 in 2008 and is still its official maintainer but,
according to Bergmann,
it "<q>doesn't seem any more active than the other two, the last real
updates were in 2013</q>".  Others in the discussion mentioned the tile
(2.6.36 in 2010) and blackfin (2.6.21, 2007) as being unused at this
point. 
<p>
The <a href="/Articles/748080/">plan</a> that emerged from this discussion
is to remove score, unicore, metag, frv, and m32r in the 4.17 development
cycle, while 
hexagon and openrisc will be retained.  There will be a
brief reprieve for blackfin and tile, which will be removed "<q>later
this year</q>" unless a maintainer comes forward.  And mn10300 will be
marked for "<q>pending removal</q>" unless it gains support for
recent chips.  All 
told, there is likely to be quite a bit of code moving out of the kernel in
the near future.
<p>
<h4>Compilers</h4>
<p>
The <a
href="https://elixir.bootlin.com/linux/v4.15.6/source/Documentation/process/changes.rst"><tt>changes.rst</tt>
file</a> in the kernel documentation currently states that the oldest
supported version of GCC is&nbsp;3.2, which was released in 2002.  It has
been some time, though, since 
anybody has actually succeeded in building a kernel with a compiler that
old.  In a discussion in early February, Bergmann <a
href="/Articles/748082/">noted</a> that the oldest version known to work is
4.1 from 2006 — and only one determined developer is even known to have
done that. 
The earliest practical compiler to build the kernel would appear to be 4.3
(2008), which is still supported in the SLES&nbsp;11 distribution.
<p>
Linus Torvalds, though, <a href="/Articles/748083/">said</a> that the real
minimum version would need to be&nbsp;4.5 (2010); that is the version that added
the "<tt>asm goto</tt>" feature allowing inline assembly code to jump to
labels in C&nbsp;code.  Supporting compilers without this feature requires
maintaining a fair amount of fallback code; <tt>asm goto</tt> is also
increasingly needed for proper Meltdown/Spectre mitigation.  Some
developers would be happy to remove the fallback code, but there is a minor
problem with that as <a href="/Articles/748084/">pointed out</a> by Kees
Cook: LLVM doesn't support <tt>asm goto</tt>, and all of Android is built
with LLVM.  Somebody may need to add <tt>asm goto</tt> support to LLVM in
the near future.
<p>
Peter Zijlstra <a href="/Articles/748085/">would like</a> to go another
step and require GCC&nbsp;4.6, which added the <tt>-fentry</tt> feature;
this replaces the old <tt>mcount()</tt> profiling hook with one that is
called before any other function-entry code.  That, too, would allow the
removal of some old compatibility code.  At that point, though, <a
href="/Articles/748086/">according to Bergmann</a>, it would make sense to
make the minimum version be 4.8, since that is the version supported by a long
list of long-term support distributions.  But things might not even stop there,
since the oldest version of GCC that is said to have support for the
"retpoline" Spectre mitigation is&nbsp;4.9, released in 2014.
<p>
Nobody has yet made a decision on what the true minimum version of GCC
needed to build the kernel will be so, for now, the documentation retains the
fictional 3.2 number.  That will certainly change someday.  Meanwhile,
anybody who is using older toolchains to build current kernels should
probably be thinking about moving to something newer.
<p>
(Thanks to Arnd Bergmann for answering a couple of questions for this
article.  It's also worth noting that he has recently updated <a
href="https://www.kernel.org/pub/tools/crosstool/index.html">the extensive
set of cross compilers</a> available on kernel.org; older versions of those
compilers can be had from <a
href="https://www.kernel.org/pub/tools/crosstool/files/bin/">this
page</a>.)<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Architectures">Architectures</a></td></tr>
            <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Build_system">Build system</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/748074/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor748120"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 0:52 UTC (Tue)
                               by <b>james</b> (subscriber, #1325)
                              [<a href="/Articles/748120/">Link</a>] (24 responses)
      </p>
      
      </div>
      </summary>
      ARM says that the A53 and some other cores aren't vulnerable to Spectre, presumably because they don't do enough prediction.<p>
There must be other still-supported architectures where all the cores ever produced are too simple to be affected by Spectre—and, of course, many kernels are built for embedded environments where they're only going to run on one sort of core.
<P>
So it's by no means obvious that everyone should be using a complier that supports retpolines.
      
          <div class="CommentReplyButton">
            <form action="/Articles/748120/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748125"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 8:59 UTC (Tue)
                               by <b>jmspeex</b> (subscriber, #51639)
                              [<a href="/Articles/748125/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The A53 is indeed (mostly?) immune because it is an in-order core, with no speculation to trigger the kind of issues with Spectre and Meltdown. OTOH, I believe cores like the A57 (which is out-of-order) are vulnerable to Spectre. So ARM users do care about those bugs.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748125/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor748137"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 14:41 UTC (Tue)
                               by <b>abatters</b> (<b>&#x272D; supporter &#x272D;</b>, #6932)
                              [<a href="/Articles/748137/">Link</a>] (22 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
My company deploys Linux in embedded x86-64 appliances that never run any untrusted 3rd-party code, so the whole spectre/meltdown thing is irrelevant to those systems even though the underlying arch is vulnerable.  So for our use case we don't care about retpolines even on x86-64.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748137/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748183"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 17:56 UTC (Tue)
                               by <b>rahvin</b> (guest, #16953)
                              [<a href="/Articles/748183/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If the appliance accepts a network connection any bugs in your software could make spectre/meltdown a real risk for a determined hacker, particularly if they are exposed to the broader internet. All you need is a buffer overflow or other bug that would allow a network service to insert a command that is then executed. Spectre and Meltdown are the bugs that are going to continue to give for a very long time. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748183/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748186"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 18:40 UTC (Tue)
                               by <b>pbonzini</b> (subscriber, #60935)
                              [<a href="/Articles/748186/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There are many cases in which breaking $networkprocess is just as bad as getting root. (There are also many cases in which everything that you worry about is running as root, though these are less likely to run on a core with speculative execution). In both cases, Meltdown and Spectre are not really much to worry about.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748186/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748278"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 28, 2018 18:54 UTC (Wed)
                               by <b>clump</b> (subscriber, #27801)
                              [<a href="/Articles/748278/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
We can only speculate(!) about abatters use case. You need to think about risks you can't forsee. If you don't use a network, can a network be created? Did you still include a network stack in your embedded OS? Your use case might not include peripherals but can peripherals be attached? Are you carrying software that's not used in your product? <br>
<p>
You can't protect against everything but you can take precautions. Some performance impacting mitigations on later kernels can be disabled, but having them opt-out by default is reasonable.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748278/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor748311"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 1, 2018 1:28 UTC (Thu)
                               by <b>rahvin</b> (guest, #16953)
                              [<a href="/Articles/748311/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I disagree, the capability of Meltdown/Spectre to read out the entire memory stack makes them far and away some of the most dangerous bugs. We need to keep in mind that only the very first exploits have rolled on these and because Spectre is fundamental to the design of almost all modern processors it's going to be the bug that continues to give for a very long time. <br>
<p>
IMO It's simply a matter of time with Spectre, and the timing attacks that it's based on, before we get the remote exploit that makes it the single biggest threat to computing. Hopefully I'm wrong. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748311/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748454"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 3, 2018 2:47 UTC (Sat)
                               by <b>himi</b> (subscriber, #340)
                              [<a href="/Articles/748454/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think the point was that if all your code is running as root, /any/ security vulnerability will open up access to any and all memory on the system - meltdown and spectre don't add any additional problems.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748454/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748478"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 3, 2018 19:12 UTC (Sat)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/748478/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Quite. If everything important is running as one uid (as is true of most single-user setups!) both Spectre and Meltdown are also unimportant, because the attack doesn't need to use either when it could just ptrace() far more cheaply.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748478/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748481"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 3, 2018 20:56 UTC (Sat)
                               by <b>excors</b> (subscriber, #95769)
                              [<a href="/Articles/748481/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Unless you're running e.g. untrusted scripts in a sandboxed interpreter. Even if everything is running as root, you expect the sandbox to prevent the scripts accessing arbitrary memory. With Spectre you lose that guarantee. ("Script" could mean JS or eBPF or pretty much any kind of data that can cause the program to do a bounds-checked array access, which might include data that doesn't really look anything like a script at all.)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748481/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748494"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 4, 2018 14:04 UTC (Sun)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/748494/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yeah, the old guarantees that language purity could enforce security appear pretty much dead now. The implementation always needs to do extra work to keep people from reaching out beyond the bounds of the implementation via side channels like this -- and we don't know what new side channels may exist in the future, or may exist now yet be unknown to us :(<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748494/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor748328"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 1, 2018 12:49 UTC (Thu)
                               by <b>matthias</b> (subscriber, #94967)
                              [<a href="/Articles/748328/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You should keep in mind that at least in theory, Spectre can be exploited remotely: Send crafted network packets to train the speculation engine and afterwards extract information based on timing of future packets.<br>
<p>
I do not expect this to be a problem right now, as it will be even harder than a local exploit and the bandwidth of the hidden channel will be much lower than for a local attacker. The SNR will be much worse, due to increased noise. But it is not as easy as saying "If $networkprocess is broken, then we have lost anyway". Spectre works even without breaking any process.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748328/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor748392"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 2, 2018 1:34 UTC (Fri)
                               by <b>gerdesj</b> (subscriber, #5446)
                              [<a href="/Articles/748392/">Link</a>] (12 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
"My company deploys Linux in embedded x86-64 appliances that never run any untrusted 3rd-party code, so the whole spectre/meltdown thing is irrelevant to those systems even though the underlying arch is vulnerable. So for our use case we don't care about retpolines even on x86-64."<br>
<p>
What exactly are you contributing to the discussion here?  At best you are correct about all of your assertions and at worst some clever bugger will prove you very, very wrong on one or two of them.<br>
<p>
Personally I always attack problems assuming I'm stupid.  If you find yourself promoting terms like "best practice" (you didn't but you came close) then you are doomed, I tell you, doomed.  You may be a clever person but there is always someone else that is better than you and our colleagues here will include some of them - they may point out the flaw in your reasoning.  The baddies won't.<br>
<p>
That's the way of the sys 'n' network admin as I see it.  No tin foil, just simple scepticism.  Perhaps you are the dog's bollocks when it comes to IT security but I note that your firm were not involved in this disclosure (or were you?), so were just as surprised as the rest of us (sort of, see papers from ~1993 onwards.)<br>
<p>
Me? I'm stupid, always have been and always will be.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748392/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748404"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 2, 2018 13:01 UTC (Fri)
                               by <b>intgr</b> (subscriber, #39733)
                              [<a href="/Articles/748404/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I agree with the rest of your comment but...<br>
<p>
<font class="QuotedText">&gt; If you find yourself promoting terms like "best practice" (you didn't but you came close) then you are doomed, I tell you, doomed.</font><br>
<p>
What's wrong with "best practice"? The way I see it, a best practice documents general conventions that are a good idea to follow "stupidly" as you describe. Applying all security updates periodically is one such best practice, even if you think they don't apply to your use case. As opposed to cherry-picking patches that you think apply -- because you're bound to miss some.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748404/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748405"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 2, 2018 13:34 UTC (Fri)
                               by <b>farnz</b> (subscriber, #17727)
                              [<a href="/Articles/748405/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>The problem with "best practice" is that it comes without a rationale, and thus documents things that you "must" do, but not why you must do them. Thus, when advice in a best practices document becomes wrong (e.g. due to external changes), there's no way to even notice that it is wrong, let alone fix it.
      
          <div class="CommentReplyButton">
            <form action="/Articles/748405/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor748452"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 3, 2018 0:13 UTC (Sat)
                               by <b>gerdesj</b> (subscriber, #5446)
                              [<a href="/Articles/748452/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
"What's wrong with "best practice"?"<br>
<p>
There be bad practice and there be good practice.  As soon as I see anyone claiming that they know what is "best practice" I briefly lose the will to live.  You said it yourself in a way:  "The way I see it, a best practice documents general conventions that are a good idea to follow"   "good idea to follow" - here you dilute "best" to "good idea".  <br>
<p>
I am being very pedantic with this point, I know.  I doubt that many people here have ever written documentation that claimed to be *shudder* "a best practice".  There are a lot of opinionated folk here (me included) and quite a lot of "I'm right and you are talking twaddle" style bike shedding err ... discussion, but rarely, if ever, do I see an invocation of "best practice".  I do often see that phrase elsewhere rather a lot and I generally use it as a litmus test for possible but unlikely guide to solution of the problem at hand, which is a bit sad.<br>
<p>
I suppose that in the end I'm a bit of a grammar fiend: good, better, best - adjective, comparative, superlative.  Soz!<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748452/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748479"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 3, 2018 19:13 UTC (Sat)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/748479/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
What about calling it 'best current practice' like the RFCs do, then? That doesn't carry the ridiculous implication that this practice is best for all time, the best ever, rah rah!<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748479/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor748456"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 3, 2018 6:21 UTC (Sat)
                               by <b>cladisch</b> (<b>&#x272D; supporter &#x272D;</b>, #50193)
                              [<a href="/Articles/748456/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>User <a href="https://meta.stackexchange.com/users/138822/rosinante">Rosinante</a> on the Meta Stack Exchange <a href="https://meta.stackexchange.com/a/142354/242554">expressed it best</a>:</p>
<blockquote><p><font class="QuotedText">While <em>you</em> may be an exemplary, clear-thinking individual, who uses the term <em>best practice</em> in a constructive manner, you have been preceded by a giant procession of zombies who use it as the antithesis of thought. Instead of understanding the important specifics of their situation and looking for an appropriate solution, all they want is to spot a herd in the distance and go trotting off after it.</font></p>
<p><font class="QuotedText">Thus, the term <em>best practice</em> has been rendered an extremely strong signal of an empty resonant cavity in the place where a brain should be, and questions that mention the phrase get closed.</font></p></blockquote>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748456/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor748836"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2018 14:17 UTC (Thu)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/748836/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; I agree with the rest of your comment but...</font><br>
<p>
<font class="QuotedText">&gt; &gt; If you find yourself promoting terms like "best practice" (you didn't but you came close) then you are doomed, I tell you, doomed.</font><br>
<p>
Not often, but some things are clearly best practice. Like what I documented :-) at a previous employer ...<br>
<p>
"Switch compiler warnings to max, and if you can't fix them you need to explain them".<br>
<p>
:-) :-)<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748836/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748839"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2018 15:00 UTC (Thu)
                               by <b>excors</b> (subscriber, #95769)
                              [<a href="/Articles/748839/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Not often, but some things are clearly best practice. Like what I documented :-) at a previous employer ...</font><br>
<font class="QuotedText">&gt; </font><br>
<font class="QuotedText">&gt; "Switch compiler warnings to max, and if you can't fix them you need to explain them".</font><br>
<p>
But that isn't clearly best. In some compilers, the maximum 'warning' level (e.g. Clang's -Weverything) includes various diagnostic messages that are merely pointing out something the compiler noticed about your code, without implying there's really any problem with it. Perhaps those messages are useful in niche situations, or they were requested by one customer with a bizarre coding style, or a bored compiler developer added them because they could. It's not worth your time to modify your code to avoid those warnings, and it's probably not even worth your time going through the list of the hundreds of available messages and selectively disabling them. The compiler developers have already produced a list of reasonably useful warnings and called it -Wall or something, so that's usually a better place to start.<br>
<p>
Maybe "set everything to max" is good advice when -Wall *is* the max. But if you just state that advice without any rationale, it will become poor advice when people switch to a compiler with many less-useful warnings.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748839/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor770287"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 1, 2018 5:23 UTC (Thu)
                               by <b>brooksmoses</b> (guest, #88422)
                              [<a href="/Articles/770287/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Also, of course, there's the "which compiler?" question.  Once you start getting into esoteric "extra" warnings, it's pretty common to end up with situations where avoiding a warning in one compiler will cause a warning in another.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/770287/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor748437"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your security model</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 2, 2018 17:13 UTC (Fri)
                               by <b>abatters</b> (<b>&#x272D; supporter &#x272D;</b>, #6932)
                              [<a href="/Articles/748437/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
In a discussion of dropping support for old compilers simply because they lack retpoline support, the point, of course, was that since retpoline support may not be essential to everyone, keeping support for the old compilers might still be useful to some people even for x86-64.  Upgrading development environments is a PITA.<br>
<p>
I have found the responses to my comment very insightful.  I am glad I posted my comment, if only to get other people to share their perspectives.  Let me summarize:<br>
<p>
1) If a system does not allow 3rd-party code to be installed or run, and is not network-attached, then Meltdown/Spectre might not matter.<br>
<p>
2) If a system does not allow 3rd-party code to be installed or run, and is network-attached, then Spectre might be remotely exploitable by network packet timings, although this has yet to be demonstrated and is only theoretical.<br>
<p>
3) If a system does not allow 3rd-party code to be installed or run, and is network-attached, and an attacker manages remote code injection into a network process, then Meltdown/Spectre can be used for further compromise.  In some cases, compromising an important network process is already "game over" so Meltdown/Spectre would not be of any use, but for other cases, Meltdown/Spectre could be used to gain complete control after compromising a low-privilege network process.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748437/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748463"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your hardware</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 3, 2018 13:53 UTC (Sat)
                               by <b>anton</b> (subscriber, #25547)
                              [<a href="/Articles/748463/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>keeping support for the old compilers might still be useful to some people even for x86-64.</blockquote>

In addition to those where Meltdown/Spectre are irrelevant because there is no attack scenario where they worsen the situation, there are also x86-64 CPUs that are not vulnerable to Meltdown/Spectre (in particular, those based on <a href="https://en.wikipedia.org/wiki/Bonnell_%28microarchitecture%29">Bonnell</a>), and hopefully we will see many more CPUs without these vulnerabilities in a few years.
      
          <div class="CommentReplyButton">
            <form action="/Articles/748463/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748890"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your hardware</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2018 20:20 UTC (Thu)
                               by <b>landley</b> (guest, #6789)
                              [<a href="/Articles/748890/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Linux on nommu still exists. If a system without spectre/meltdown mitigation can't possibly be viable to run, you're expressing a pretty strong opinion about those too. (There are more nommu processors than with-mmu processors on the planet about the same way there are more bacterial cells than mammalian cells. This is the dark matter of the hardware world.)<br>
<p>
Half the embedded developers already tend to stay several versions behind on everything (kernel, compiler, libc, userspace), as in it took them several years to notice upstream uClibc was dead and move to musl-libc or the uclibc necromancy fork. That's why I had a <a rel="nofollow" href="http://landley.net/toybox/faq.html#support_horizon">http://landley.net/toybox/faq.html#support_horizon</a> in busybox (and now toybox): clear policy with leeway for old systems but also a defined "ok, that's enough, you can move now" cutoff.<br>
<p>
If you remove support for all but the newest toolchains, they'll just stop upgrading the kernel in their sdk, as in they'll develop _new_ devices against old stuff. (It's already enough of a pain to convince embedded developers to stop developing new devices based on a 2.6 kernel they have lying around. Make your policies too tight, you lose traction.)<br>
<p>
Rob<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748890/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748892"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">It also depends on your hardware</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 8, 2018 21:09 UTC (Thu)
                               by <b>excors</b> (subscriber, #95769)
                              [<a href="/Articles/748892/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I believe nommu systems still need Spectre mitigation, as long as they do speculative execution. Something like a JavaScript interpreter that is designed to run untrusted code in a sandbox ought to be safe on a nommu system, but Spectre still makes it vulnerable exactly like with-mmu.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748892/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor748124"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 8:08 UTC (Tue)
                               by <b>liam</b> (guest, #84133)
                              [<a href="/Articles/748124/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
May I assume that a minimum supported compiler version defined per-arch is off the table?<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748124/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748126"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 9:30 UTC (Tue)
                               by <b>comio</b> (subscriber, #115526)
                              [<a href="/Articles/748126/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I hope to have a min version that doesn't depend on architecture or other stuffs. We have already too many entropy in this world.<br>
Which is the oldest (enterprise) distro that is still supported?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748126/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748133"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 11:41 UTC (Tue)
                               by <b>rsidd</b> (subscriber, #2582)
                              [<a href="/Articles/748133/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Don't enterprise distros stick to the same major kernel version no matter how old? If so, why not allow GCC 4.3 for kernel 3.10 (for example), but insist on GCC 4.9 for a current kernel? <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748133/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748153"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 15:47 UTC (Tue)
                               by <b>mageta</b> (subscriber, #89696)
                              [<a href="/Articles/748153/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
AFAIK:<br>
<p>
Redhat does. Suse does upgrades with service-packs. Canonical sticks to the original kernel, but for a shorter time and provides no hardware-enablement at all via that old version, but with new kernels (hwe kernels) instead. So this could hit the two later.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748153/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748180"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 16:22 UTC (Tue)
                               by <b>kiko</b> (guest, #69905)
                              [<a href="/Articles/748180/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
For Ubuntu, I think we're fine.<br>
<p>
While 12.04 and 14.04 LTS are still formally supported, they won't receive modern kernels via HWE; in reality only 4 kernel versions are ever available to be installable on any given Ubuntu release. See the "Kernel release end of life" for details at <a href="https://www.ubuntu.com/info/release-end-of-life">https://www.ubuntu.com/info/release-end-of-life</a> -- but the summary is that neither of them would be affected by a GCC requirement uplift.<br>
<p>
For 16.04 LTS, similarly, the last HWE kernel received will be 4.15, which is the kernel release targeted for the next LTS, 18.04 LTS, due in April. So it too would be unaffected by an uplift in GCC version.<br>
<p>
Bionic itself comes with GCC 7.3 (and 6.4) which should be acceptable for any kernel version it ends up receiving.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748180/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor748188"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 19:12 UTC (Tue)
                               by <b>willy</b> (subscriber, #9762)
                              [<a href="/Articles/748188/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Because we want to allow someone running a currently supported RH release to be able to build a current kernel.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748188/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor748742"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 7, 2018 16:06 UTC (Wed)
                               by <b>BenHutchings</b> (subscriber, #37955)
                              [<a href="/Articles/748742/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Debian 7 "wheezy" (released 2013) has gcc 4.7. But we will probably add gcc 4.9 shortly, specifically so we can build the kernel with retpolines.<br>
<p>
However, RHEL 5 (2007) is also still supported and apparently still has gcc 4.1 as the default compiler (with 4.4 available as an alternative).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748742/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor748127"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 10:09 UTC (Tue)
                               by <b>moltonel</b> (guest, #45207)
                              [<a href="/Articles/748127/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If the "minimum compiler version" is just documentation (as opposed to a build-time check), why not document the range of versions and their respective cons ? Something like "=&lt;4.1 will require manual workarounds, =&lt;4.5 lacks asm goto and uses inferior fallbacks, =&lt;4.6 lacks --fentry which impacts tracing, =&lt;4.9 lacks retpoline which is important for security".<br>
<p>
I know documenting it this way doesn't get rid of (for example) asm goto fallback, but for users it gives a clearer picture and for developers wanting to unsupport something it puts the info in the Linux repo rather than a mailing list and people's minds.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748127/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748150"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 15:21 UTC (Tue)
                               by <b>doublez13</b> (guest, #122213)
                              [<a href="/Articles/748150/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Because by completely dropping support for older compilers, we're able to get rid of chucks of code needed only to support them. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748150/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748187"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 19:11 UTC (Tue)
                               by <b>moltonel</b> (guest, #45207)
                              [<a href="/Articles/748187/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yes, I know that's the whole point of droping support.<br>
<p>
But my comment was about documenting the more nuanced support: the LKML thread shows that documenting a single minimum version hides a lot of useful info ("gcc foo is supported but you'll miss out on bar"). Detailed support docs should help both users of old tools and support-droping efforts by developers.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748187/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748312"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 1, 2018 4:16 UTC (Thu)
                               by <b>xtifr</b> (guest, #143)
                              [<a href="/Articles/748312/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Sounds like a great idea. How soon can you have a first draft for us to check out?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748312/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor748480"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 3, 2018 19:19 UTC (Sat)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/748480/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That's... not really useful, because nobody ever reads the documentation. The kernel's build dependencies have been documented in the same place for decades (they moved from Documentation/Changes to Documentation/process/changes.rst recently, but left a symlink), yet when I've added build dependencies there I see many questions from people who encounter build failures because of the lack of those dependencies but never consider even looking to see if the kernel's build-deps are documented anywhere, let alone looking to see if they changed.<br>
<p>
And that's something as obvious as a build failure when turning on a new feature: i.e. doing something active, intentionally. Nobody will think to look in documentation if a *lack* of upgraded compiler causes a failure (or, worse, a silent change in semantics). Nobody.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748480/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748482"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 3, 2018 22:14 UTC (Sat)
                               by <b>moltonel</b> (guest, #45207)
                              [<a href="/Articles/748482/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The logical conclusion to "nobody ever reads the doc" is that the docs should be deleted, to reduce the maintenance burden. Maybe your premise is true for users. I guess it is true for me, a desktop user getting his build tools and kernel sources from a distro.<br>
<p>
But it's clearly not true for (some) kernel devs, since they are discussing raising the minimum version (which is only defined in the docs). Since the goal is to get rid of old workarounds and to be sure that certain features are available, wouldn't it make sense for devs to document what those features and workarounds are ? So that devs know what can be removed from the kernel after raising requirements to this or that ? Wouldn't a short "version X brings you Y" table speed things up for the next reqs update discussion, compared to a single "version X required" statement ?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748482/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748495"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 4, 2018 14:06 UTC (Sun)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/748495/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
My premise is from, uh, kernel developers working for a major Linux distributor (unnamed to save their blushes). Maybe the problem is that nobody ever *rereads* Documentation/Changes after they read it once, since the assumption is that after your latest pull the deps are unchanged. (I am guilty here too, of course. So is everyone who builds a lot of kernels.)<br>
<p>
But if kernel devs don't read the things, I see no reason to assume that anyone else will.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748495/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor748129"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Smallest common denomiator</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 10:20 UTC (Tue)
                               by <b>moltonel</b> (guest, #45207)
                              [<a href="/Articles/748129/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Looking at the minimum version of all the other tools (appart from gcc), they're all comparatively recent. I'd be surprised if one of them (binutils, procps, udev, grub, openssl...) didn't yield a higher minimum gcc version independently of kernel code. You can use an older gcc for your kernel than for your userspace, but that's arguably just looking for trouble.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748129/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor748132"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 11:36 UTC (Tue)
                               by <b>jmm</b> (subscriber, #34596)
                              [<a href="/Articles/748132/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The only official GCC releases which supports building a retpoline-enabled kernel is 7.3. But there are various backports made by HJ Lu for older branches available at <a href="https://github.com/hjl-tools/gcc">https://github.com/hjl-tools/gcc</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748132/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748193"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 20:35 UTC (Tue)
                               by <b>arnd</b> (subscriber, #8866)
                              [<a href="/Articles/748193/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Thanks, that's what I had been looking for. I should have a look there if I want to rebuild the cross toolchains for kernel.org. Not sure if we want to keep both version (with and without retpoline support), or if I should just replace the binaries I uploaded.<br>
<p>
If I understand it right, the changes in that git tree are only relevant for x86; other architecture might need similar work but nothing else has it, right?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748193/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor748195"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 27, 2018 20:54 UTC (Tue)
                               by <b>geert</b> (subscriber, #98403)
                              [<a href="/Articles/748195/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      Can we get rid of one more arch/ directory by (finally) merging arm64 and arm?
Or is it still <a href=https://marc.info/?l=linux-kernel&m=134184818409286>too early</a>?
      
          <div class="CommentReplyButton">
            <form action="/Articles/748195/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor752990"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 27, 2018 21:08 UTC (Fri)
                               by <b>willy</b> (subscriber, #9762)
                              [<a href="/Articles/752990/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Do arm and arm64 have enough in common that it's worth unifying them? It's not like we ever tried to unify i386 and ia64<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/752990/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor753023"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Shedding old architectures and compilers in the kernel</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Apr 28, 2018 19:34 UTC (Sat)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/753023/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
We have a unified arch/x86/ for i386 and amd64 nowadays, which wasn't always the case (see commit 208652d6b2c).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/753023/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor748513"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Old compilers, new kernels</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 5, 2018 6:37 UTC (Mon)
                               by <b>fratti</b> (guest, #105722)
                              [<a href="/Articles/748513/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Are there any users who would conceivably build brand-spanking new kernels with decade-old compilers? Aside from appeasing archaeologists 1000 years from now trying to piece together what lead to humanity's downfall and running into issues dating fragments of our past, I can't really think of a user that would use an old compiler without also using an old kernel. Perhaps I'm not familiar enough with the embedded vendor landscape to know the restrictions they have to live by though.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748513/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor748523"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Old compilers, new kernels</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Mar 5, 2018 14:44 UTC (Mon)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/748523/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I see this all the time. Not with kernels, but folks want to compile 10+ million SLOC projects changed yesterday using Ubuntu 12.04, so they require everyone support CMake 2.8.9 or whatever. Nevermind that just adding CMake to the pile of code they want to build would save everyone a lot of headaches.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/748523/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor756371"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Old compilers, new kernels</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 3, 2018 14:11 UTC (Sun)
                               by <b>dps</b> (guest, #5725)
                              [<a href="/Articles/756371/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You are clearly out of touch with far too many production systems. The idea of upgrading from long unsupported old releases of things, like python 2.3, very old sshd, etc with known unfixed security issues is anathema. I would advocate using current stable versions but that was not my pigeon and it was feared hat some bugs might be revealed. Actually fixing those bugs would obviously be the wrong thing.<br>
<p>
I have extensive experience of not using things which are clearly the right thing because the production environment is sufficiently ancient that it is not supported. Let it suffice to say that this experience was obtained at multiple very large software companies.<br>
<p>
I would not worry about the lack of spectre mitigation on those boxes because there are so many easier ways of owning them.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/756371/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2018, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
