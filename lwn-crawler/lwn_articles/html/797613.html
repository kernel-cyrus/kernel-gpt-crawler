        <!DOCTYPE html>
        <html lang="en">
        <head><title>Change IDs for kernel patches [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/797613/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/797799/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/797613/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>Change IDs for kernel patches</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Ready to give LWN a try?</b>
<p>
With a subscription to LWN, you can stay current with what is happening in the Linux and free-software community and take advantage of subscriber-only site features.  We are pleased to offer you <b><a href="https://lwn.net/Promo/nst-trial/claim">a free trial subscription</a></b>, no credit card required, so that you can see for yourself.  Please, join us!
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>August 29, 2019</br>
           </div>
For all its faults, email has <a href="/Articles/702177/">long proved</a>
to be an effective communication 
mechanism for kernel development.  Similarly, Git is an effective tool for
source-code management.  But there is no real connection between the two,
meaning that there is no straightforward way to connect a Git commit with
the email discussions that led to its acceptance.  Once a patch enters a
repository, it transitions into a new form of existence and leaves its past
life behind.  Doug Anderson recently went to the ksummit-discuss list with
<a
href="/ml/ksummit-discuss/CAD=FV=UPjPpUyFTPjF-Ogzj_6LJLE4PTxMhCoCEDmH1LXSSmpQ@mail.gmail.com/">a
proposal</a> to add Gerrit-style change IDs as a way of connecting the two
lives of a kernel patch; the end result may not be quite what he was asking
for.
<p>
The <a href="https://www.gerritcodereview.com/">Gerrit</a> code-review
system needs to be able to track multiple versions of the same patch; to do
so, it adds a Change-Id tag to the patches themselves:
<p>
<pre>
    Change-Id: I6a007dfe91ee1077a437963cf26d91370fdd9556
</pre>
<p>
The tag is automatically added to the first version of a new patch;
developers are expected to retain that tag when posting subsequent versions
so that Gerrit can associate the new and old versions.  These tags are
useful for Gerrit, but they have never been welcome in the kernel
community; Anderson posted his missive in the hope of changing that
attitude and getting the community to allow (or actively encourage) the use
of change IDs in patches:
<p>
<div class="BigQuote">
	The basic summary is that I'd like there to be some way to track a
	logical patch over its lifetime.  I don't believe there is a
	reliable (non-heuristic) way to do this today and I think Change-Id
	provides a nice solution.  While we could come up with a new and
	different solution (because Change-Id was not invented here), it
	feels like adopting Change-Id is convenient and easy and provides a
	true benefit.
</div>
<p>
The problem Anderson describes is real enough; your editor, who spends a
lot of time digging up old versions of patch postings to work out how a
patch has evolved over time, can attest to that.  Guenter Roeck <a
href="/ml/ksummit-discuss/dc1a4c98-5e29-094c-ead8-889df35de811@roeck-us.net/">complained</a>
that he has to "<q>use a combination of subject analysis and patch
content analysis using fuzzy text / string comparison, combined with an
analysis of the patch description</q>" to determine whether a given
patch has been merged.  There seems to be little doubt that the community
as a whole would appreciate a better way to associate a patch's history
over time and its final resting place in the kernel repository.  That is
about where the agreement stops, though.
<p>
Linus Torvalds was quick to <a
href="/ml/ksummit-discuss/CAHk-=whFbgy4RXG11c_=S7O-248oWmwB_aZOcWzWMVh3w7=RCw@mail.gmail.com/">reject</a>
the idea of putting a bare change ID into patch changelogs, citing the same
reasoning that has kept those IDs out thus far: they are really only useful
to whoever put that ID into the changelog in the first place.  Gerrit
change IDs are useful to people who know which Gerrit instance is tracking
the patch in question and who actually have access to that instance.  For
everybody else, it's just a number that is just extra noise in the
changelog; as Torvalds put it: "<q>A 'change ID' that I can't use to
look anything up with is completely pointless and should be removed from
kernel history</q>".  That assertion also implies, of course, 
that an ID that <i>can</i> be looked up by third parties might have some
value.
<p>
One way to make a Gerrit change ID useful, he suggested, would be to turn
it into a publicly accessible web link; then anybody could follow the link,
see whatever other information exists, and track the history of the patch.
Olof Johansson <a
href="/ml/ksummit-discuss/CAOesGMgryBghLuTSufjhOUFUFDvL2Jv7qJ3uwaZUwCkMXpEmng@mail.gmail.com/">disliked</a>
that idea, saying that the Gerrit server could be shut down, making the
link useless.  Ted Ts'o <a
href="/ml/ksummit-discuss/20190823013619.GA8130@mit.edu/">responded</a>
that such a fate could befall any web link, including others (such as
bugzilla links) that are accepted in changelogs now.
<p>
There may be other ways to solve this problem, though.
The idea that Torvalds <a
href="/ml/ksummit-discuss/CAHk-=whxp0Vm5V6MtaRNC0_ou0=U4-+Y7Ktzq6osU8JgHy_xhQ@mail.gmail.com/">liked
the best</a> — and which seems to have the widest support across the
community — is to use the unique ID that is already associated with a patch
posting, which is the message ID created by the poster's email client:
<p>
<div class="BigQuote">
	The first time it gets magically and reliably created for you
	without you having to do a single thing. The second time, you just
	look it up.
<p>
	Ta-daa - you have a "uuid" that is useful to others, and that
	describes the whole series unambiguously.
</div>
<p>
There are a few ways this ID could be presented, but the most popular way
is to create a "Link:" tag containing a link to the posting of the patch in
a public mailing-list archive server (generally <a
href="https://lore.kernel.org/lists.html">lore.kernel.org</a> in recent
times).  This is not a new practice; it appears to have first been used for <a
href="https://git.kernel.org/linus/f994d99cf140">this patch</a> applied by
H. Peter Anvin in 2011.  Use of this tag is not universal, but it is
growing; the number of patches in recent kernels carrying Link: tags is:
<p>
<blockquote>
<table class="OddEven">
<tr><th>Release</th><th>Tags</th><th>Percent</th></tr>
<tr><td>4.18</td>
    <td align="right">1,413</td>
    <td align="right">10.6%</td></tr>
<tr><td>4.19</td>
    <td align="right">1,944</td>
    <td align="right">13.8%</td></tr>
<tr><td>4.20</td>
    <td align="right">1,609</td>
    <td align="right">11.6%</td></tr>
<tr><td>5.0</td>
    <td align="right">1,778</td>
    <td align="right">13.9%</td></tr>
<tr><td>5.1</td>
    <td align="right">1,908</td>
    <td align="right">14.6%</td></tr>
<tr><td>5.2</td>
    <td align="right">2,295</td>
    <td align="right">16.4%</td></tr>
<tr><td>5.3</td>
    <td align="right">2,614</td>
    <td align="right">18.4%</td></tr>
</table>
</blockquote>
<p>
Creation of this tag is relatively easy; it can be entirely automated at
the point where a patch is applied to a Git repository.  But it doesn't
solve the entire problem; it can associate a commit with the final posting
of a patch on a mailing list, but it cannot help to find previous versions
of a patch.  Generally, the discussion of the last version of a patch is
boring since there is usually a consensus at that point that it should be
applied.  It's the discussion of the previous versions that will
have caused changes to be made and which can explain some of the decisions
that were made.  But kernel developers are remarkably and inexplicably poor
at placing the 
message ID of the final version of a patch into the previous versions.
<p>
The most commonly suggested solution to that problem is not fully automatic.
Developers like <a
href="/ml/ksummit-discuss/alpine.DEB.2.21.1908231740020.1896@nanos.tec.linutronix.de/">Thomas
Gleixner</a> and <a
href="/ml/ksummit-discuss/20190828122234.3femrepecvswo7ws@wittgenstein/">Christian
Brauner</a> argued in favor of adding a link to previous versions of a
patch when posting an updated version.  Gleixner called for a link to the
cover letter of the prior version, while Brauner puts links to all previous
versions.  Either way, an interested developer can follow the links
backward to see how a patch series has changed, along with the discussions
that led to those changes.
<p>
A convention like that would provide most or all of what developers like
Anderson are asking for.  It would, however, require that developers do
some work to insert those links, and not everybody is convinced that this
will ever happen.  Dmitry Torokhov <a
href="/ml/ksummit-discuss/20190823161947.GA112509@dtor-ws/">said</a> that
he could not be bothered:
<p>
<div class="BigQuote">
	As a patch submitter, I frankly could not care less about proper
	trace, history, etc. I might be putting cover letter and outline
	the version changes, but I am doing that to reduce friction and
	help committer to land my change. That's it.
</div>
<p>
Developers, he said, simply would not do the extra work to add links to
previous postings to their cover letters.  Anderson also <a
href="/ml/ksummit-discuss/CAD=FV=VJt4+XRj59h6tmma5LfU52E_6QOSQVjh3T3M+1V=eMsQ@mail.gmail.com/">asserted</a>
that "<q>the adoption rate will be near to zero</q>".  Such concerns
have merit; it is hard to force a community of thousands of developers to
do more work for every patch they submit.  But without their cooperation,
this idea will not go far.
<p>
The answer, naturally, is to provide tools that make the right thing happen
with a minimum of extra work.  Gleixner <a
href="/ml/ksummit-discuss/alpine.DEB.2.21.1908232150580.1939@nanos.tec.linutronix.de/">described</a>
the setup he uses with <a
href="https://savannah.nongnu.org/projects/quilt">Quilt</a>, but it seems
unlikely that all developers 
will find it useful for their purposes.  Joel Fernandes <a
href="/ml/ksummit-discuss/CAJWu+oq8jFnJ4iJ+R3swr-93eMwDgbWXe1W2Aiu-r+tuYSY5Ag@mail.gmail.com/">described</a>
a tool that he is considering writing that might be more generally useful.
Greg Kroah-Hartman <a
href="/ml/ksummit-discuss/20190828090837.GA31704@kroah.com/">described</a>
it as overly complex, though, and suggested simply posting patches as a
reply to previous versions, but others pointed out that not all mailers
would make that entirely easy to do.
<p>
Ts'o more-or-less ended the discussion by <a
href="/ml/ksummit-discuss/20190828135820.GA24857@mit.edu/">saying</a> that
it was time for interested developers to go off and implement a prototype
of the tools they have in mind for this task.  Then the code could be
evaluated to see how it actually works.  "<q>Trying to pick
something before people who actually have to use it day to day have
had a chance to try it in real life is how CIO's end up picking Lotus
Notes</q>".  That is where things stand now; the next step will come
about when somebody comes forward with a tool that might provide a better
solution to the problem.  Until then, we'll have to continue to use fuzzy
string comparisons and other tricks to track the history of patches in the
repository.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Development_model-Patch_management">Development model/Patch management</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/797613/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor797878"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Change IDs for kernel patches</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 30, 2019 0:08 UTC (Fri)
                               by <b>dianders</b> (subscriber, #73136)
                              [<a href="/Articles/797878/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Nice summary!  A further link for those interested in one solution that might be an OK compromise (if anyone adopts it):<br>
<p>
<a href="https://patchwork.ozlabs.org/patch/1154833/">https://patchwork.ozlabs.org/patch/1154833/</a><br>
<p>
-Doug<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/797878/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor797892"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Change IDs for kernel patches</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 30, 2019 6:44 UTC (Fri)
                               by <b>diconico07</b> (guest, #117416)
                              [<a href="/Articles/797892/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
For me it completely relates to what Konstantin Ryabitsev said in his blog post:<br>
<a href="https://people.kernel.org/monsieuricon/patches-carved-into-developer-sigchains">https://people.kernel.org/monsieuricon/patches-carved-int...</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/797892/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor797900"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Change IDs for kernel patches</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 30, 2019 9:21 UTC (Fri)
                               by <b>kleptog</b> (subscriber, #1183)
                              [<a href="/Articles/797900/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Linus Torvalds was quick to reject the idea of putting a bare change ID into patch changelogs, citing the same reasoning that has kept those IDs out thus far: they are really only useful to whoever put that ID into the changelog in the first place. </font><br>
<p>
I find this an odd comment. Given the ID is effectively a globally unique string, simply throwing the Change-ID into $SEARCHENGINE will immediately return any and all mail conversations, bug trackers, etc referring to this patch. This seems much more useful that some email message ID, which is not easily searchable because it contains so many word-breaking characters and significant constant parts.<br>
<p>
In any case, even in Gerrit you don't really use those Change-IDs to search for patches, each change has an actual URL too, but that doesn't appear in the commit while it's under discussion. The Change-ID is mostly useful after the fact to locate patches that are related.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/797900/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor798173"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Change IDs for kernel patches</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 3, 2019 4:25 UTC (Tue)
                               by <b>Fowl</b> (subscriber, #65667)
                              [<a href="/Articles/798173/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Given the ID is effectively a globally unique string</font><br>
<p>
Indeed - I'm not sure why an actual GUID wouldn't work, they're shorter and don't require mailing anything. I guess they're a bit Microsoft-y.<br>
<p>
Couldn't a first/arbitrary comit hash become the 'change ID'? Even if that exact commit never ends up in a tree it's a shortish, unique string that doesn't require any new tooling to generate.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/798173/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor798176"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Change IDs for kernel patches</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 3, 2019 6:50 UTC (Tue)
                               by <b>khim</b> (subscriber, #9252)
                              [<a href="/Articles/798176/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Couldn't a first/arbitrary comit hash become the 'change ID'?</font><br>
<p>
You don't really need it: it's highly likely that this particular commit would only exist on a developer's machine and would never be posted.<br>
<p>
Change-Id: used by Gerrit is not really created by Gerrit - that's just a random string which git presubmit hook adds to the description if it's not there.<br>
<p>
This is done that way precisely because Android developers don't have a central Gerrit server: there are bazillion of them - each vendor have one, Google have half-dozen and so on.<br>
<p>
Change-Id just allows you to do a search, nothing more, nothing less.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/798176/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor798177"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Change IDs for kernel patches</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 3, 2019 7:14 UTC (Tue)
                               by <b>Fowl</b> (subscriber, #65667)
                              [<a href="/Articles/798177/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; You don't really need it: it's highly likely that this particular commit would only exist on a developer's machine and would never be posted.</font><br>
<p>
And this confusion is probably the flaw in the idea - once people read 'commit hash' they'll be assume it's a commit they can find. ;)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/798177/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor798428"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Change IDs for kernel patches</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 5, 2019 8:54 UTC (Thu)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/798428/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; I find this an odd comment</font><br>
<p>
It's not just odd, it's plain wrong.<br>
<p>
Change-Id are being re-used across Gerrit instances and across branches and it works great.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/798428/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor797904"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Change IDs for kernel patches</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 30, 2019 10:58 UTC (Fri)
                               by <b>wiktor</b> (guest, #132450)
                              [<a href="/Articles/797904/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; The idea that Torvalds liked the best — and which seems to have the widest support across the community — is to use the unique ID that is already associated with a patch posting, which is the message ID created by the poster's email client</font><br>
<p>
For the record `git am` already has `--message-id` option that can be used to insert back-reference to the patch message's ID: <a href="https://git-scm.com/docs/git-am#Documentation/git-am.txt---message-id">https://git-scm.com/docs/git-am#Documentation/git-am.txt-...</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/797904/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor797910"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Change IDs for kernel patches</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 30, 2019 12:01 UTC (Fri)
                               by <b>johill</b> (subscriber, #25196)
                              [<a href="/Articles/797910/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
And we use that, with some commit log mangling, to create the Link: in most cases.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/797910/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor797939"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Change IDs for kernel patches</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 30, 2019 13:02 UTC (Fri)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/797939/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Hmm. How hard would it be to ask that subsequent submissions use `--in-reply-to=` the previous patchset (usually its cover letter)? That's what I do on my (admittedly rare) submissions. It keeps the patchsets together in mail viewers and provides context for the previous submission(s).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/797939/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor798068"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Change IDs for kernel patches</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 1, 2019 20:32 UTC (Sun)
                               by <b>pbonzini</b> (subscriber, #60935)
                              [<a href="/Articles/798068/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Most maintainers actually dislike that, because they (or their scripts) are used to having one thread per submission---so if you want to apply temporarily v(n-1) it would be harder to extract the appropriate patches out of a thread that includes multiple versions. Others' scripts might have different issues.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/798068/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor798150"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Change IDs for kernel patches</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 2, 2019 17:28 UTC (Mon)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/798150/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Hmm. I haven't been told to stop doing it yet (like I said, my submissions are rare). I feel like such scripts could easily be modified to only look at reroll count subject prefixes or only find patches under a given cover letter. *shrug* it's a thought. I don't maintain any kernel bits, but it's probably how I'd run it if I were to do so.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/798150/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor797942"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Change IDs for kernel patches</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 30, 2019 13:31 UTC (Fri)
                               by <b>rgb</b> (subscriber, #57129)
                              [<a href="/Articles/797942/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
"Greg Kroah-Hartman described it as overly complex, though, and suggested simply posting patches as a reply to previous versions, but others pointed out that not all mailers would make that entirely easy to do."<br>
<p>
I agree with Greg. That's what reply is there for, to provide context. Also reply is such a basic functionality I'm really curious what kind of mail program does not support reply?<br>
<p>
I doubt that anyone can come up with an alternative to reply, that is as easy to use and adopt by most/all developers.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/797942/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor797964"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Change IDs for kernel patches</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 30, 2019 15:26 UTC (Fri)
                               by <b>jgg</b> (subscriber, #55211)
                              [<a href="/Articles/797964/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think my general complaint is that the built in git tooling for sending to a mailing list does not do nearly enough porcelain stuff to make the patch submission flow easy. I'm always sad when using git send email.<br>
<p>
But there is some much potential here! Surely someone must have written nice wrapper scripts..<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/797964/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor798058"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Change IDs for kernel patches</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 1, 2019 15:08 UTC (Sun)
                               by <b>glasserc</b> (subscriber, #108472)
                              [<a href="/Articles/798058/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This discussion is interesting, but I wish it didn't focus on the specific use case of code review for the Linux kernel. Any git project where feature branches are revised and shared over time could benefit from having links from one version of a commit to a previous one. I've often wished Git had something like Mercurial's "obsolesence markers" (from the "changeset evolution" extension). From my (non-kernel) perspective, the question of how these links are serialized into emails is not very important, but having them enables a bunch of other features.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/798058/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor798432"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">History of the history</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 5, 2019 9:33 UTC (Thu)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/798432/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Any git project where feature branches are revised and shared over time could benefit from having links from one version of a commit to a previous one.</font><br>
<p>
The tool laser-focused on the "history of the history" is  <a href="https://github.com/git-series/git-series">https://github.com/git-series/git-series</a><br>
<p>
Unlike email, all tools specialized for code review implement some form of linking between revisions in their database. While such linking is one of the most basic code review features, there are surprisingly big differences between the approaches.<br>
<p>
Gerrit (obviously) supports this well for individual patches but doesn't treat series as a "first-class" citizens, patches in a series are just "related":<br>
<a href="https://gerrit-review.googlesource.com/Documentation/user-review-ui.html#related-changes">https://gerrit-review.googlesource.com/Documentation/user...</a> Trying for instance to see how a series has been re-ordered is close to impossible with that user interface. I just fetch the two revisions and compare with git locally.<br>
 <br>
On the other hand Gerrit's ability to filter out rebase noise has become as impressive as git series': <a href="https://bugs.chromium.org/p/gerrit/issues/detail?id=217#c42">https://bugs.chromium.org/p/gerrit/issues/detail?id=217#c42</a><br>
<p>
Github is probably the worse at this. Series are first-class citizens but the recommended workflow is to never rewrite anything and always add the equivalent of fixup! commits until the review is finished - except there's no way to mark which commit is a fixup for what. Force pushes are possible but break a number of features.  More details and references at  <a href="https://github.com/zephyrproject-rtos/zephyr/pull/14444">https://github.com/zephyrproject-rtos/zephyr/pull/14444</a><br>
<p>
Gitlab follows github's model but seems to cope with force pushes much better.<br>
<p>
Also related: <a href="https://public-inbox.org/git/?q=%22volatile+branches%22+sha1">https://public-inbox.org/git/?q=%22volatile+branches%22+sha1</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/798432/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor798161"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Cover letter</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 2, 2019 21:13 UTC (Mon)
                               by <b>meuh</b> (guest, #22042)
                              [<a href="/Articles/798161/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I've used Link: tag inside commit messages to link those to the cover letter, as I found there's quite often the need to look at the patchset to understand a patch. The cover letter, and the patch series give more context, even in the presence of a "good" commit message.<br>
<p>
Those links wouldn't be needed if the cover letter was included as commit message for a merge, but, first, merge commit almost only happen as a result of a pull request, second, it's usual for a patchset to go through different trees.<br>
<p>
Also, I've made my best to provide a changelog for each patch series, with links to previous iterations. Having the Link: to the cover letter allows access to this changelog.<br>
<p>
Anyway, one could wonder when Git would be able to record the patchset history, so that this history is not recorded in mail box, but in proper version control.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/798161/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor798178"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Cover letter</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 3, 2019 7:44 UTC (Tue)
                               by <b>johill</b> (subscriber, #25196)
                              [<a href="/Articles/798178/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Some maintainers will create a side-branch and merge it for a bigger series of patches, and put the cover letter into the merge commit message, which seems like a good way to capture this. Perhaps it should be done more often.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/798178/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor798263"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Change IDs for kernel patches</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 3, 2019 23:49 UTC (Tue)
                               by <b>neilbrown</b> (subscriber, #359)
                              [<a href="/Articles/798263/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; This is not a new practice; it appears to have first been used for this patch applied by H. Peter Anvin in 2011.</font><br>
<p>
It is predated by the URL: tag, first used (that I can find) by  Dominik Brodowski in 2005.<br>
<p>
<a href="https://git.kernel.org/pub/scm/linux/kernel/git/history/history.git/commit/?id=e49546f9717bb0c583284520796b44e02159298d">https://git.kernel.org/pub/scm/linux/kernel/git/history/h...</a><br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/798263/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor799279"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Git needs a information preserving rebase</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 16, 2019 12:00 UTC (Mon)
                               by <b>jrincayc</b> (guest, #29129)
                              [<a href="/Articles/799279/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Side note: Git needs to by default preserve information during a rebase.  As in just as each commit records the parents, patches produced by rebase should record the git id of the patches that were used for the rebase.   This would allow automated tools to more easily figure out where a patch came from.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/799279/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor799283"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Git needs a information preserving rebase</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 16, 2019 13:51 UTC (Mon)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/799283/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Maybe only if those commits are actually available somewhere? References to commits which only existed locally before rebases seems like pure noise to me. Also, what do you do for split/joined commits? Do the magic fixup! or squash! prefixes suppress this? What about manual fixup or squash?<br>
<p>
(From a heavy git-rebase user :) )<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/799283/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor799338"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Git needs a information preserving rebase</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 16, 2019 16:01 UTC (Mon)
                               by <b>zblaxell</b> (subscriber, #26385)
                              [<a href="/Articles/799338/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Indeed, the whole point of git rebases is that they are *not*<br>
information-preserving.  Rebase is a tool to discard irrelevant cruft:<br>
typos, failed experiments, rejected patches, accidentally added binaries,<br>
commits where you forgot to add "-s", and so forth.<br>
<p>
If someone comes up with a way to import and archive patch review<br>
discussions (perhaps in a separate branch or tree) and reference them<br>
in git commits in a way that plays nicely with 'git push' and 'git gc',<br>
then rebase should preserve _that_.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/799338/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor799416"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Git needs a information preserving rebase</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 17, 2019 9:57 UTC (Tue)
                               by <b>wtarreau</b> (subscriber, #51152)
                              [<a href="/Articles/799416/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I just had the same idea when reading the discussion above. We could have "git rebase", "git am", "git commit --amend", "git cherry-pick" automatically append a tag "original-id:" with the ID of the original patch. In case of fixup/squash, it may very well merge all of them. This way we do keep good traceability in patch series with exactly *zero* effort nor risk of mistake on the developer's side. In fact the developer would only make an effort to remove the tag!<br>
<p>
This would also cover part of what is already being done with "cherry-pick -x" that's used a lot for backports. And very often the information provided there would be useful because it would reference a commit ID which is available in another public tree, and even if that tree is not publicly available it would at least serve as a common tracking key.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/799416/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2019, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
