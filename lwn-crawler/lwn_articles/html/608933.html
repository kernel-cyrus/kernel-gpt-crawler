        <!DOCTYPE html>
        <html lang="en">
        <head><title>The state of linux-next [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/608933/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/608617/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/608933/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>The state of linux-next</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Did you know...?</b>
<p>
LWN.net is a subscriber-supported publication; we rely on subscribers
       to keep the entire operation going.  Please help out by <a
       href="/Promo/nst-nag4/subscribe">buying a subscription</a> and keeping LWN on the
       net.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>August 20, 2014</br>
           <hr>
<a href="/Articles/KernelSummit2014/">Kernel Summit 2014</a>
</div>
Once the discussion of the stable tree had completed, the group at the 2014
Kernel Summit turned its attention to the most unstable tree of all:
linux-next.  This tree holds code that, for the most part, is destined to
go into the mainline during the next merge window; its contents can change
wildly over the course of a development cycle as patches are added and
removed.  Linux-next maintainer Stephen Rothwell provided an update on how
this tree is doing.
<p>
In general, Stephen said, about 90% of the code that shows up in the
mainline during the merge window was in linux-next prior to the opening of
the window.  Is that good enough?  He left that for the group to decide.
He also noted that there are currently more than 220 trees feeding into
linux-next, and wondered if that might be too many.  About 25 of those, he
said, are dedicated to urgent fixes and are probably OK.  He is not so sure
about the "preparatory trees" that feed patches into another tree that is
also pulled into linux-next.  Many of those trees are not as stable as he
would like; the code found there may not really be ready for mainline, so
the trees get shuffled and rebased a lot.
<p>
Related to the preparatory trees are the "lead-in" trees run by
sub-subsystem maintainers.  The wireless networking and Bluetooth trees
were held up as an example.  These trees are "mostly OK," Stephen said,
though some of them run on their own schedules.  The Bluetooth tree, he
noted, acquired a bunch of new work during the merge window, a practice

<a href="/Articles/608940/"><img
src="https://static.lwn.net/images/conf/2014/ks/StephenRothwell-sm.jpg" width=150 height=188
alt="[Stephen Rothwell]" title="Stephen Rothwell" hspace=3 vspace=3
align="left"></a> 


that Stephen discourages.  If new patches flow into linux-next during that
time, it complicates the task of figuring out what hasn't been merged into
the mainline yet.
<p>
A significant change to linux-next is the addition of build-test coverage
for the ARM architecture; until recently, only x86 and PowerPC were
tested.  Stephen expressed some amazement at how often an "allmodconfig"
build test fails; sometimes, developers are putting code into linux-next
that clearly has never been compiled.  That runs counter to the rule that
all linux-next code should be ready for the mainline.  While an occasional
build failure for an architecture like PowerPC might be understandable, he
said, there really is no excuse for failing to build on x86; that is a
fundamental test that every developer should be running.  Linus added that
he gets grumpy when that kind of code is directed his way as well.
<p>
Josh Triplett suggested that, perhaps, all code should have to go through a
public build test before being accepted into linux-next.  The problem there
is that linux-next <i>is</i> that build test, for all practical purposes.
Additionally, Fengguang Wu's automatic test system should be finding build
problems.  We don't, Stephen said, need a more formal process; we just need
developers to pay a bit more attention.
<p>
Rafael Wysocki said that, while he appreciated the merge conflict
resolution work that Stephen does, he would rather fix conflicts in his
trees himself.  The problem, Stephen said, is that when he hits a conflict
in the process of pulling trees into linux-next, he does not have the time
to contact the appropriate maintainer and get a fix from them.  It's faster
and easier just to deal with it himself.  And, in any case, the conflict
may come from somewhere else anyway.  In general, Stephen said, he gets
four or five conflicts on a normal day, which is not that hard to deal
with.  Just before the merge window, when 
the tree is big and everybody is trying to get their code in place, things
get much worse, though.  That can lead to twelve-hour days, leading Ted
Ts'o to wonder if the job isn't getting too big for one person to do.
<p>
There is, Stephen said, still too much rebasing of trees that feed into
linux-next.  Sometimes it's unavoidable, but a tree should normally be in a
finished state before being put into linux-next.
<p>
A developer asked: what should be done about a patch that has found its way
into linux-next and which turns out to be bad?  Should the tree containing that
patch be rewritten, causing the bad patch to disappear from the change
history entirely?  Or is it better to simply revert the patch at the head
of the tree?  Linus answered that dropping the patch (and rewriting the
tree) is, essentially, a 
rebasing of the tree â€” and he tends not to respond well when asked to pull
a just-rebased tree.  There can be value in doing that; it makes the
history cleaner.  But it should not be done just before sending a pull
request; at that point the patch should just be reverted.  Having the patch
and the revert in the history is embarrassing, he said, but in the end it's
fine.  Unless, he added, your tree has more reverts than commits, in which
case there may be a problem.
<p>
While things can always be improved, it would appear from Stephen's
report that the linux-next tree is working reasonably well.  In the years
that it has been operating, it has become a vital part of the kernel
development process, helping the merge window (and the whole development
cycle) to go more smoothly.
<p>
<b>Next</b>: <a href="/Articles/608945/">Kernel tinification</a>.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Development_model-linux-next">Development model/linux-next</a></td></tr>
            <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#linux-next">linux-next</a></td></tr>
            <tr><td><a href="/Archives/ConferenceIndex/">Conference</a></td><td><a href="/Archives/ConferenceIndex/#Kernel_Summit-2014">Kernel Summit/2014</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/608933/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor609088"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The state of linux-next</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 20, 2014 23:13 UTC (Wed)
                               by <b>neilbrown</b> (subscriber, #359)
                              [<a href="/Articles/609088/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Having the patch and the revert in the history is embarrassing, he said, but in the end it's fine.</font><br>
<p>
... unless someone trips over it doing a "git bisect".<br>
Anything that makes "git bisect" harder is a *bad thing*.<br>
So I guess it depends how serious the bug is.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/609088/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2014, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
