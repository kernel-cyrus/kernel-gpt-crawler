        <!DOCTYPE html>
        <html lang="en">
        <head><title>The future of the realtime patch set [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/617140/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/616394/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/617140/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>The future of the realtime patch set</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Benefits for LWN subscribers</b>
<p>
The primary benefit from <a href="/Promo/nst-nag5/subscribe">subscribing to LWN</a>
       is helping to keep us publishing, but, beyond that, subscribers get
       immediate access to all site content and access to a number of extra
       site features.  Please sign up today!
</blockquote>
<div class="FeatureByline">
           By <b>Jake Edge</b><br>October 21, 2014</br>
           <hr>
<a href="/Archives/ConferenceByYear/#2014-Linux_Plumbers_Conference">Linux Plumbers Conference</a>
</div>
<p>
In a followup to last year's <a href="/Articles/572740/">report on the
future of realtime Linux</a>, Thomas Gleixner once again summarized the
status of the long-running patch set.  The intervening year did not result
in the industry stepping up to fund further work, which led Gleixner to
declare that realtime Linux is now just his hobby.  That means new
releases will be done as his time allows and may eventually lead to
dropping the patch set altogether if the widening gap between mainline and
realtime grows too large.
</p>

<p>
Gleixner was speaking at the realtime microconference that was part of this
year's <a href="http://www.linuxplumbersconf.org/2014/">Linux Plumbers
Conference</a> (LPC).  Much of what he had to say was a reprise from earlier in
the week when the <a
href="https://www.osadl.org/Dusseldorf-2014.rtlws16-dusseldorf-2014.0.html">Real
Time Linux Workshop</a> (RTLWS) was held in DÃ¼sseldorf, Germany at the same
venue 
as LPC.  In effect, his October&nbsp;16 LPC talk was a recap of the
discussion from RTLWS.
</p>

<h4>Status</h4>

<a href="/Articles/617256/">
<img src="https://static.lwn.net/images/2014/lpc-gleixner-sm.jpg" border=0 hspace=5 align="right"
alt="[Thomas Gleixner]" width=285 height=282>
</a>

<p>
He started with a  brief report on the status of the patches themselves, along
with what needs to be worked on to move more of the patch set into the
mainline. At RTLWS, they came up with some "easy things to go upstream",
including some code that avoids the "complexities of workqueues", he said.
The discussion also resulted in some plans to change some of the patches
from last year so they can go upstream as well.
</p>

<p>
Maintaining the patch set takes a lot of time and effort.  But it has also
led to improving the quality of the mainline kernel over time.  Another
effort could lead to similar results, he said: annotating the various uses
of the <tt>preempt_disable()</tt> call.  Those calls are made to protect
some kernel data structure, but it is not at all clear what they are
protecting.  That turns them into a "per-CPU BKL [big kernel lock] that is
painful to understand".

<p>
For the realtime patches, sections where preemption is
disabled need to be made as small as possible, but that is difficult to do
if it is unclear what is being protected.  
Currently, developers creating patches for performance improvements often
disable preemption, but do not care that it has an impact on the
out-of-tree realtime patch set.
It is likely, though, that annotating
those uses in the mainline will not only help realtime, it will find
bugs of various kinds as well.
</p>

<p>
People have asked over the years how they can help with realtime,
Gleixner said, but there isn't a simple answer to that.  He cannot just
assign people to work on certain pieces.  Instead, interested people need
to find some part they are interested in, understand it, and then start
sending patches and handling the review comments that are generated.  It is
a matter of new people catching up "with the knowledge of people doing it
for ten years".
</p>

<p>
In many cases, adding realtime patches to the mainline is a matter of
enabling certain features, then "see what explodes and then figure it out
and fix it", he said.
</p>

<h4>Success and disaster</h4>

<p>
Realtime Linux is both a success and a disaster, Gleixner said.  It has
proven that it is possible to turn a general-purpose operating system (OS)
like 
Linux into a realtime OS, which was something that many academics said
couldn't be done.  Ideas from Doug Niehaus in the 1990s ended up in the
realtime patches ten years later, though there are still some of those
ideas, like proxy locking, that have not yet been tried.
</p>

<p>
It is also a success because it has made the Linux mainline into "a better
place", he said.  There are a number of features that came from realtime
and made their way into the mainline, including high-resolution timers, the
foundations of the "nohz" (tickless) patches, threaded interrupt handlers,
generic timekeeping, real mutexes, and so on.  In addition, the "lockdep"
locking validator has helped many kernel developers understand how locking
should be done.
</p>

<p>
On the disaster side, though, is the lack of funding to actually complete
the project.  There has been a lot of work put into getting
the realtime patches upstream.  That is partly the "fault" of the US Navy,
which noted in the contract that started the realtime effort that all of
the work should be upstreamed on a "best effort basis".  But projects go
away and budgets dry up, Gleixner said.
</p>

<p>
In five years, the realtime project has gone from a "moderately lively"
community-style project to roughly one-and-a-half people working just to
keep it alive.  The maintenance of the patch set is "not fun", with its
six-month development cycle, followed by six months of stabilization.  Now
the funding has essentially "dried up to zero".
</p>

<p>
Earlier in the microconference, there had been several indications of use
cases where 
realtime will be used in products.  But there is (seemingly) no interest
from the industry to keep the project alive.  That is "disturbing",
Gleixner said.
</p>

<p>
There are a number of "well-funded and vibrant projects" out there, but
there are others that have no funding even when they are widely used.  He
pointed to projects like Apache and the TYPO3 content-management system as
examples of the former.  Those kinds of projects are used by new companies
that are interested in keeping the projects alive because it is part of
their business model.
</p>

<p>
On the other hand, the typical realtime use cases, such as embedded,
automotive, and automation, are from companies that build machines.  So
the hardware is where they think the value is, Gleixner said.  Lots of the
value is 
actually in the software, but companies that do "mechanical stuff" often
don't see that.  Or at least that is his theory.
</p>

<p>
The Linux Foundation (LF) and the <a href="https://www.osadl.org/">Open Source
Automation Development Lab</a> (OSADL, which organizes RTLWS each year)
have both been trying to drum up funds for the last year or more without
success.  They are trying to get companies to
 collaboratively
provide money or capable developers.  There was some tentative interest,
but nothing really came of it, he said.  He wondered if the industry was
treating it like the
"Mikado game", where "whoever moves first, loses".
</p>

<h4>Realtime as a hobby</h4>

<p>
So, he has concluded that he will be working on the realtime patches on a
"hobbyist basis".  He needs to work on things that bring in money for him
and his family; the realtime work evidently does not fit the bill.  He will
be working on the 3.16-rt patches in his hobby 
time, though he noted that he does have other hobbies too.
</p>

<p>
He has received email from around two dozen companies asking for a schedule
for the 3.16-rt release because they need to make product plans.  He has
responded by telling them that there is no budget and asking if they want to
help. He got different types of responses, he said.  Some didn't reply at all,
which he called "honest".  Others said they had no money.  It is "crazy"
to build a product around a technology and to have no budget to work on it,
he said.  Others said they would be building their products around the
3.12-rt 
kernel.  
</p>

<p>
While it is a hobby project as of now, that can change, but it is up to
those who want to see that happen to make it happen.  The LF and OSADL are
still working on it, so interested parties should contact them.
</p>

<p>
He also noted that if funding takes too long to materialize, the realtime
project will be harder to restart.  There is a gap between mainline and
realtime that grows over time.  The scalability and performance
improvements flowing into mainline are "massive", he said.  Those
developers often come up with solutions that are "horrible for realtime".
Since the realtime patches are out of the mainline, there is nothing to
stop those kinds of changes being made.
</p>

<p>
There are both technical and political problems to be solved before the
remaining realtime patches can be merged into the mainline.  Both types of
problem can be solved, Gleixner said.  Linus Torvalds is willing to merge
realtime patches, as long as they don't interfere with the rest of the
kernel core.  But, before he does so, he also wants to see some
organization with a long-term interest in supporting and maintaining the
realtime code. 
</p>

<p>
Patches for realtime are quite different than some random driver or filesystem;
those can be removed or ignored if they stop being maintained.  But
realtime is "a different beast" as it changes the core kernel code.  It
also "causes kernel developers to think more", which is a good thing, he said.
</p>

<p>
The industry appears not to have heard the call from a year ago, so it may
be optimistic to think that will change now.  The future of realtime Linux
may be fairly bleak.  It will be unfortunate if things continue down their
current path and companies realize in a year or two that they need the
hardware support or other features from a 4.4 kernel, say, but also need
the latency guarantees that the realtime patches provide.  It could quite
possibly be far too expensive to try to pick up the project and move
forward at that point.
</p>

<p>
[ I would like to thank the Linux Foundation for travel assistance to
DÃ¼sseldorf for LPC. ]
</p><br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Realtime">Realtime</a></td></tr>
            <tr><td><a href="/Archives/ConferenceIndex/">Conference</a></td><td><a href="/Archives/ConferenceIndex/#Linux_Plumbers_Conference-2014">Linux Plumbers Conference/2014</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/617140/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor618135"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of the realtime patch set</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 27, 2014 7:16 UTC (Mon)
                               by <b>speedster1</b> (guest, #8143)
                              [<a href="/Articles/618135/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Disappointing to see this... why doesn't the Linux Foundation step in here? This seems like a good investment for those who actually have funds available for improving Linux! <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/618135/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor618138"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of the realtime patch set</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 27, 2014 8:29 UTC (Mon)
                               by <b>liam</b> (guest, #84133)
                              [<a href="/Articles/618138/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Always great to see projects that improve the quality of the Linux kernel getting their due.<br>
So, it looks like one area where Linux will never catch up to Solaris will be in its ability to provide latency distributions. Yup, apparently Solaris has had real-time capabilities since 1993.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/618138/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor618207"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Solaris realtime OS?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 27, 2014 23:57 UTC (Mon)
                               by <b>vonbrand</b> (subscriber, #4458)
                              [<a href="/Articles/618207/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <p>In 2000 Linux was so much faster on the same machine (SPARC) than Solaris du jour it was not funny anymore. Real time it wasn't, not by a very long shot.</p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/618207/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor618210"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Solaris realtime OS?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 28, 2014 0:33 UTC (Tue)
                               by <b>liam</b> (guest, #84133)
                              [<a href="/Articles/618210/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Who said anything about faster?<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/618210/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor618212"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Solaris realtime OS?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 28, 2014 0:58 UTC (Tue)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/618212/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Anything can be "real time" if the deadlines are long enough.<br>
<p>
And if the system isn't fast enough to get the work done, it's got no chance to be "real time"<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/618212/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor619080"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Solaris realtime OS?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 4, 2014 0:50 UTC (Tue)
                               by <b>liam</b> (guest, #84133)
                              [<a href="/Articles/619080/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'm not sure you're being completely genuous with that reponse.<br>
RT certainly doesn't necessarily mean high performance (rarely, in fact, but not impossible in certain circumstances as, iirc, thomas gliexner has previously mentioned that he expected the preempt-rt network stack to provide even more throughput than mainline---I don't think this ever came to pass), or very short interrupt handling, but it does mean that you can offer guarantees of service, which mainline linux can't offer 100% of the time (always ignoring hardware failure). <br>
Unfortunately, solaris has long had the advantage of extensive, and cheap, tracing, and have used this to be able to track down sources of excessively long preempt-disable.<br>
LITMUSrt has a similar facility, but not the resources, or the purview, to do what solaris was able.<br>
Your last line isn't applicable to the topic at hand, though it is certainly true in so far as it must be true.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/619080/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor626992"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of the realtime patch set</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Dec 19, 2014 7:34 UTC (Fri)
                               by <b>WMW</b> (guest, #100296)
                              [<a href="/Articles/626992/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Many Thanks to the people who have done a very good job with PREEMPT_RT so far.<br>
<p>
A reason why nobody wants to fund the further development may be, that the realtime patches are deeply integrated into the linux kernel and no one has control over linux kernels further directions. From the point of view of machinery builders the claim "Linux for the desktop" sounds like poison for real-time applications. Otherwise machinery builders have to deal with functional saftey and therfore with validation and verification of the OS used. Very difficult with 17 million LOC of kernel. They appreciate small rt kernels.<br>
<p>
Nowadays there are better solutions out. Multicore SoCs are very cheap. So it seems better to partition the multicore for mission critical real-time, safety and linux applications. You can use unmodified mainline linux if you choose a core with hypervisor. Particulary if you have a product life cycle of 10 to 25 year, which is very common in machinery industry, this promises a clearly better maintainability.<br>
<p>
I'm sorry to say this, the rt patch set is a really nice und sophisticated piece of software but has limited value for machine and machinery builders. It may be well suited for gadgets, but who needs real-time there?<br>
<p>
There is definetely no market and therefore no funds for real-time patch set.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/626992/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor635162"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The future of the realtime patch set</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Feb 28, 2015 10:54 UTC (Sat)
                               by <b>kramlie</b> (guest, #101239)
                              [<a href="/Articles/635162/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
So LF and OSADL are looking for companies to fund the project, but what about donations from users? Of course they can't individually provide the money that a company can, but put together it might add up. The RT patch set has many users, for instance in the audio production scene.<br>
<p>
Personally I'd very much like to contribute, and a simple donation button would make it easier.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/635162/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2014, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
