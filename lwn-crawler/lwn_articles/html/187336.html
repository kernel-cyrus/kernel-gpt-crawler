        <!DOCTYPE html>
        <html lang="en">
        <head><title>Time for ext4? [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/187336/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/186754/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/187336/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>Time for ext4?</h1>
<div class="Byline">[Posted June 12, 2006 by corbet]
               <p>
               </div>
</div>
<div class="ArticleText">
As described in <a href="/Articles/187321/">this article</a>, patches which
add extents and 48-bit capability to the ext3 filesystem have been
circulated for wider review.  Everybody seems to agree that these changes
are good and should be part of the Linux kernel.  Well, <a
href="/Articles/187337/">almost everybody</a> agrees.  But the way in which
these features get in has become the inspiration for an extended discussion
on how filesystem development should work.
<p>

Some developers, most prominently Jeff Garzik, have <a
href="/Articles/187339/">expressed concerns</a> about merging these changes
into ext3; they would rather see a new ext4 filesystem created for new
features.  There are a number of reasons put forward for doing things this
way.  First and foremost, perhaps, is the fact that using the extents/48-bit
features results in filesystems which are no longer backward compatible.
If a system administrator enables extents on a filesystem, a special
"incompatible feature" flag will be set in the filesystem superblock.
Thereafter, it will no longer be possible to mount that filesystem with any
older kernel which does not recognize that flag.  Until now, it has
generally been possible to mount ext3 filesystems on older kernels - even
those which only support ext2 (with one ugly exception involving a
distributor which was heavily pushing SELinux features).
<p>

The overall effect of all these changes on filesystem stability is also a
concern.  Filesystems are important, and users tend to take a very dim view
of "upgrades" which introduce bugs or impact performance.  As <a
href="/Articles/187340/">Linus puts it</a>:
<p>
<div class="BigQuote">
	For me, the biggest cost tends to actually be support. A stable
	filesystem that is used by thousands and thousands of people and
	that isn't actually developed outside of just maintaining it IS A
	REALLY GOOD THING TO HAVE.
</div>
<p>
The incorporation of major features into ext3 certainly takes it out of the
"just maintaining it" realm.
<p>
As more features are added, the filesystem code (which must support
filesystems both with and without that feature) gets more complicated.  In
particular, one sees increasing amounts of code which looks like:
<p>
<pre>
    if (has_this_fancy_feature)
    	do_it_the_fancy_way();
    else
    	do_it_the_old_boring_way();
</pre>
<p>
Such code can be harder to follow, and it tends not to isolate the new
feature code as nicely as one might like.  If, instead, one were to put the
new features into a new filesystem, a lot of these conditionals could be
taken out.
<p>
Finally, it is said that the need to be so careful about backward
compatibility is a drag on filesystem development.  By separating
development filesystems from those which are meant to be stable, the
developers can push forward with the new capabilities they would like to
implement.  For practical examples, consider the separation of ext2 and
ext3, the separation of the SMB and CIFS filesystems, and the creation of
libata rather than shoehorning serial ATA support 
into the old ATA drivers.
<p>

Needless to say, the ext3 developers have their own take on all of this.
A filesystem with the new features will not work on older kernels
regardless of whether it is called ext3 or ext4.  Since a feature like
extents must be explicitly enabled by the system administrator (assuming
the distributor does not quietly do it for them), nobody should be
surprised by a filesystem which no longer works on older systems.  Pushing
the new features into an ext4 would simply slow their uptake without buying
much else.
<p>

While some think that splitting out development into a new filesystem will
ease code maintenance, others are less sure.  In particular, there is worry
that bugs fixed in one of the filesystems may not get fixed in the other.

<p>
It has been noted, repeatedly, that users very much like to be able to get
new features into their filesystems without having to backup and restore
the whole thing.  The transition from ext2 to ext3 is a clear example of
how this can work; if moving to ext3 had required restoring the filesystem
from scratch, ext3 would have been adopted much more slowly, and less
universally, than it was.  As this example shows, however, putting new
features into a new ext4 filesystem would not necessarily preclude this
sort of upgrade.
<p>

The ext3 developers also point out that they have been working on that
filesystem for many years and have not yet created big problems for the
Linux user base.  They have, they feel, earned a certain amount of trust.
So they would rather move ahead with some features which have been put
together with great care and extensive review rather than cloning ext3 into
ext4 and starting something new.
<p>

An attempt to guess how all this might settle out could start with <a
href="/Articles/187349/">these words from Linus</a>:
<p>
<div class="BigQuote">
	Quite frankly, at this point, there's no way in hell I believe we
	can do major surgery on ext3. It's the main filesystem for a lot of
	users, and it's just not worth the instability worries unless it's
	something very obviously transparent.
</div>
<p>

<a href="/Articles/187346/">Yet another point of view</a> comes from Andrew
Morton:
<p>
<div class="BigQuote">
	All that being said, Linux's filesystems are looking increasingly
	crufty and we are getting to the time where we would benefit from a
	greenfield start-a-new-one.  That new one might even be based on
	reiser4 - has anyone looked?  It's been sitting around for a couple
	of years.
</div>
<p>
As reiser4 shows, getting a truly new filesystem into the kernel isn't
necessarily an easy thing to do.  It may well not happen before large
numbers of users start running into the current limits of ext3.  So the
current set of enhancements will probably find its way in - though what the
resulting filesystem will be called is still not entirely clear.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Development_model">Development model</a></td></tr>
            <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Filesystems-ext3">Filesystems/ext3</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/187336/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor187827"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">ext3 is not compatible with itself</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2006 4:31 UTC (Thu)
                               by <b>jreiser</b> (subscriber, #11027)
                              [<a href="/Articles/187827/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <i>Until now, it has generally been possible to mount ext3 filesystems on older kernels - even those which only support ext2 (with one ugly exception involving a distributor which was heavily pushing SELinux features).</i>
<p>The exception affects most ext3 filesystems that were first created before sometime in 2004, and it makes ext3 incompatible with <i>itself</i>.  I was angry when it tripped me; the "bugfix" should have created a new filesystem type right then.  <a href="https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=137068">
https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=137068</a>
      
          <div class="CommentReplyButton">
            <form action="/Articles/187827/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor187829"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Time for ext4?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2006 4:46 UTC (Thu)
                               by <b>jwb</b> (guest, #15467)
                              [<a href="/Articles/187829/">Link</a>] 
      </p>
      
      </div>
      </summary>
      I don't care what they call it.  I hope they merge the extents patch to make the delta from Lustre smaller.  The closer Lustre becomes to being in the mainline, the better it will be for Lustre users and the rest of the high-performance filesystem community.<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/187829/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor187837"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another possible improvement to ext[234]</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2006 6:48 UTC (Thu)
                               by <b>barryn</b> (subscriber, #5996)
                              [<a href="/Articles/187837/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <P><A HREF="http://lkml.org/lkml/2006/6/9/476">Continuation inodes</A>.</P>
<P>This actually raises the possibility, combined with <A HREF="http://lwn.net/Articles/177066/">another patch</A>, of taking ext<i>2</i> and improving it so that, after a crash, only part of the FS needs to be fscked (i.e. decrease the time spent doing fsck without having to resort to journaling).</P>
<P>Just mentioning this so that it doesn't get completely buried by the discussion of extents and 48-bit block addresses...</P>
      
          <div class="CommentReplyButton">
            <form action="/Articles/187837/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor187842"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Time for ext4?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2006 7:25 UTC (Thu)
                               by <b>meyert</b> (subscriber, #32097)
                              [<a href="/Articles/187842/">Link</a>] 
      </p>
      
      </div>
      </summary>
      Just call it ext3a!<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/187842/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor187844"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">XFS a good contender.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2006 7:55 UTC (Thu)
                               by <b>migpc</b> (guest, #24484)
                              [<a href="/Articles/187844/">Link</a>] (13 responses)
      </p>
      
      </div>
      </summary>
      Wouldn't XFS be a good contender to the Linux Filesystem Throne?<br>
<p>
It's been for really long in the main kernel. <br>
It's stable and mature.<br>
It works with LILO and GRUB.<br>
It is faster than ext3.<br>
Has ACL support ... <br>
<p>
The question shouldn't be why? but why not?.<br>
<p>
To me the 9 exabyte limit sounds pretty impressive.<br>
<a href="http://oss.sgi.com/projects/xfs/">http://oss.sgi.com/projects/xfs/</a><br>
<a href="http://jamesthornton.com/hotlist/linux-filesystems/">http://jamesthornton.com/hotlist/linux-filesystems/</a><br>
<p>
Why rebuilding the wheel when we already have better wheels to use?<br>
<p>
M*<br>
<p>
<p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/187844/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor187883"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">XFS a good contender.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2006 11:24 UTC (Thu)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/187883/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      Well, XFS is really complicated and its code is really rather ugly, with abstraction layers to make the Linux in-memory inode look like the traditional Unix in-memory inode (for ease of merging with IRIX) and other things which are normally not permitted in Linux at all.<br>
<p>
So, no, I don't think that'll happen.<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/187883/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor187931"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">XFS a good contender.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2006 14:46 UTC (Thu)
                               by <b>HenrikH</b> (subscriber, #31152)
                              [<a href="/Articles/187931/">Link</a>] 
      </p>
      
      </div>
      </summary>
      And of course there is no way that the XFS code can be cleaned up ;). Especially now since SGI is bust so there is no more IRIX.<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/187931/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor188019"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">XFS a good contender.  On SGIs.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2006 18:20 UTC (Thu)
                               by <b>rfunk</b> (subscriber, #4054)
                              [<a href="/Articles/188019/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      I used to be a big XFS fan. <br>
 <br>
Then I discovered how easy it can be to lose a filesystem when the disk <br>
loses power or connectivity at the wrong time.  Apparently SGI hardware <br>
works a bit differently from PC hardware, and XFS was built assuming the <br>
SGI hardware behavior. <br>
 <br>
Now this was on a firewire-connected disk, so I didn't run out to re-mkfs <br>
my servers, but later when I was redoing the filesystems on one server <br>
anyway, I changed it to ext3. <br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/188019/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor188127"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">XFS a good contender.  On SGIs.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 16, 2006 14:58 UTC (Fri)
                               by <b>sbergman27</b> (guest, #10767)
                              [<a href="/Articles/188127/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      I believe this if only pertinent to the 1.0.x versions.  It was fixed in the 1.1 version, released over four years ago.<br>
<p>
<a href="http://tinyurl.com/mvvzr">http://tinyurl.com/mvvzr</a><br>
<p>
That said, ext3 in its default data=order mode, and also in its data=journal mode, makes stonger guarantees about the consistency of the data after an unplanned shutdown.  Of the Linux journalled filesystems, I believe that only ext3 and reiserfs even give you the option of these higher levels of guarantee.<br>
<p>
But I believe that XFS is currently no worse than any other metadata only journalling filesystem out there, which means most of them.<br>
<p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/188127/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor188130"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">XFS a good contender.  On SGIs.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 16, 2006 15:23 UTC (Fri)
                               by <b>rfunk</b> (subscriber, #4054)
                              [<a href="/Articles/188130/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      Considering that my XFS problem happened with a 2.6 kernel, I don't think  <br>
XFS 1.1 quite solved it all. <br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/188130/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor188188"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">XFS a good contender.  On SGIs.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 17, 2006 0:57 UTC (Sat)
                               by <b>dododge</b> (guest, #2870)
                              [<a href="/Articles/188188/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <p>The file-destruction problem certainly still exists:</p>

<a href="http://oss.sgi.com/projects/xfs/faq.html#nulls">http://oss.sgi.com/projects/xfs/faq.html#nulls</a>

<p>
It can make some types of debugging <em>very</em> painful.  For example about a month ago my Xubuntu dapper system (using XFS) was having trouble getting X running on multiple video cards, and the failure mode of X was a hard-lock of the machine requiring a power-cycle.  The use of XFS pretty much guaranteed that after reboot, <cite>Xorg.0.log</cite> was useless for debugging the problem.  In at least one case it also null-filled the <cite>xorg.conf</cite> file that I was using for testing.  I quickly got in the habit of typing "sync" a few times before doing anything even remotely risky, in hopes of protecting at least files that I wasn't actively working on.
</p>

<p>
I don't know what's worse -- the fact that it fills the file with null bytes, or the fact that it leaves the metadata intact so that the file <em>looks</em> fine if you just do an "ls".  A similar experience with Reiser4 resulted in <cite>xorg.conf</cite> disappearing entirely after a hard reboot, and perhaps that was a better way to fail since it was at least obvious that there was a problem.
</p>

<p>
That said, I'm still using XFS.
</p>

      
          <div class="CommentReplyButton">
            <form action="/Articles/188188/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor188246"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">XFS a good contender.  On SGIs.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 18, 2006 11:33 UTC (Sun)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/188246/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      I think it likely that the maintainer of GNU tar is using xfs. (Why? Because tar-1.15.90/src/extract.c contains nothing but null bytes, that's why.)<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/188246/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor188339"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">XFS a good contender.  On SGIs.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 19, 2006 17:00 UTC (Mon)
                               by <b>dododge</b> (guest, #2870)
                              [<a href="/Articles/188339/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      Strange. extract.c seems to be fine in tar-1.15.90.tar.bz2 and tar-1.15.91.tar.bz2 from alpha.gnu.org.
      
          <div class="CommentReplyButton">
            <form action="/Articles/188339/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor189016"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">XFS a good contender.  On SGIs.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2006 20:08 UTC (Fri)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/189016/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      Hm, maybe *I* had disk corruption. (On two separate machines, with RAID arrays? Strange.)<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/189016/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor189039"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">XFS a good contender.  On SGIs.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 23, 2006 22:15 UTC (Fri)
                               by <b>dododge</b> (guest, #2870)
                              [<a href="/Articles/189039/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <p>
I only checked the two tarfiles from one archive, so it's possible a copy somewhere is corrupt.
</p>

<blockquote><i>(On two separate machines, with RAID arrays? Strange.)</i></blockquote>

<p>
That it would happen the same way in two different filesystems is certainly unlikely.
</p>

<p>
Aside: it's a bit surprising how common RAID failures can be.  At a LUG discussion a few weeks ago someone mentioned that their RAID-5 was destroyed when, while synchronizing to repair a lost drive, a second drive died in the array.  Several people (incuding myself) immediately jumped into the discussion with similar stories.
</p>

      
          <div class="CommentReplyButton">
            <form action="/Articles/189039/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor189980"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">XFS a good contender.  On SGIs.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 3, 2006 23:12 UTC (Mon)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/189980/">Link</a>] 
      </p>
      
      </div>
      </summary>
      Yes; before 2.6.15, the md driver in the kernel had no way to test arrays for read-correctness without doing a massive dd by hand or a reconstruction, and no recourse when a bad block was found but to kick the drive (bad news if reconstructing).<br>
<p>
Neither of these are true any longer, thanks be to Neil Brown :) you're only in trouble now if you have *the same* block unreadable on enough drives.<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/189980/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor188095"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Or JFS?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 16, 2006 7:41 UTC (Fri)
                               by <b>eru</b> (subscriber, #2753)
                              [<a href="/Articles/188095/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      Also has been in the kernel for a while, has better performance than ext3,
and is backed by a Linux-friendly company likely to be around for awhile
(unlike SGI).
<p>
Any downsides?

      
          <div class="CommentReplyButton">
            <form action="/Articles/188095/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor188189"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Or JFS?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 17, 2006 1:40 UTC (Sat)
                               by <b>hchristeller</b> (guest, #4246)
                              [<a href="/Articles/188189/">Link</a>] 
      </p>
      
      </div>
      </summary>
      JFS filesystems can expand, but not shrink.  XFS has the same issue.  This has made upgrading my MythTV system more complicated than it might have been. You can shrink ext3.<br>
<p>
Other than that, I've been very pleased with JFS and how it handles the huge files created when recording HDTV.  Adding a new disk with LVM and expanding the JFS filesystem was quick and easy.<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/188189/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor187868"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">ext2 - ext3 - ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2006 10:31 UTC (Thu)
                               by <b>zmi</b> (guest, #4829)
                              [<a href="/Articles/187868/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      When ext3 arrived, it was basically an ext2 with journalling. You didn't <br>
have to bother, just mount it as ext3 and you are done. If you didn't like <br>
it (who didn't?), you could just remount it as ext2 again.<br>
<p>
The new code sounds similar - just mount it and you have nicer features. <br>
The downside is: once mounted as the new type, you can't go back to ext3 <br>
anymore. So it *must* be called ext4, or at least not ext3. It's <br>
incompatible (not much, but still), so it can't have the same name!<br>
<p>
mfg zmi<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/187868/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor187884"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">ext2 - ext3 - ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2006 11:26 UTC (Thu)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/187884/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      This is an argument for calling it 'ext3'.<br>
<p>
If the extents code were added in a copy of the filesystem, called ext4, then you could go to ext4+extents easily, but going back would be impossible unless extents were optional even in ext4 (which introduces to ext4 all the complexity problems which ruled out its being called ext3!)<br>
<p>
If extents are optional, then you can remove extent blocks from files by mounting without extents (but *with an extent-capable fs*, so new ext3 or ext4 or whatever), then copying and renaming all files which have extents on them. It's fiddly, but doable.<br>
<p>
If you introduce an ext4 with non-optional extents, then there's no filesystem which can read extents but prefers not to write them. Oops, *now* you can't go back.<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/187884/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor187893"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">ext2 - ext3 - ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2006 12:31 UTC (Thu)
                               by <b>NAR</b> (subscriber, #1313)
                              [<a href="/Articles/187893/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <I>which introduces to ext4 all the complexity problems which ruled out its being called ext3!</I>
<P>
No, I don't think this is the reason. The problem with the "new ext3" is that someone upgrades the kernel, accidentally or intentionally mounts the filesystem with the <B>same</B> fstype, but with different options, then goes back to the previous kernel and finds that some of the files can't be read. I believe that a filesystem should be compatible with itself <B>regardless</B> of mount options.
<P>
<CENTER>Bye,NAR</CENTER>
      
          <div class="CommentReplyButton">
            <form action="/Articles/187893/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor187897"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">ext2 - ext3 - ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2006 12:54 UTC (Thu)
                               by <b>ekj</b> (guest, #1524)
                              [<a href="/Articles/187897/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      Not being able to go back is perfectly acceptable for a new filesystem. Arguably less so for the same filesystem.<p>

I would except a kernel with support for ext3 to be able to mount a ext3 filesystems. Everything else is, imho, lunacy.<p>

There's no reason to expect though, that an ext3-driver should be able to mount a ext4-filesystem. If the oposite works as a migration-path it's a big benefit, but that's it.<p>

      
          <div class="CommentReplyButton">
            <form action="/Articles/187897/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor188079"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">ext2 - ext3 - ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 16, 2006 2:15 UTC (Fri)
                               by <b>jzbiciak</b> (guest, #5246)
                              [<a href="/Articles/188079/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      And, since the change is isolated to meta-data, what really stops there from being an e4fsck flag that finds ext4-specific files and rewrites them as ext2 format (space permitting)?<br>
<p>
As for a "start over again" filesystem, I believe Andrew Morton's position is non sequitur.  We should keep evolving ext with whatever steps we think are appropriate, and let someone dedicated to filesystem design come up w/ the next big thing.  It'll have to be obviously superior to ext3 (or ext4 or ext99 or whatever) to win, but if there was true benefit to the new filesystem, then it's worth it.<br>
<p>
The corollary to my argument is that while Reiser4 seems to be just that sort of "rethink and do-over" type of filesystem, it's not obviously superior to ext3, and so it hasn't won a place in the Linux kernel yet.  At least, that's how I see it.<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/188079/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor188088"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">reiser4, and general administration of Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 16, 2006 5:16 UTC (Fri)
                               by <b>zmi</b> (guest, #4829)
                              [<a href="/Articles/188088/">Link</a>] 
      </p>
      
      </div>
      </summary>
      They way they wrote it on lwn.net, I understand that reiser4 is too <br>
intrusive for inclusion yet, as it makes many traditional things change. I <br>
believe time has come for some "revolution" in FS, because the actual <br>
handling is quite limited. I'm still missing the ease-of-administration I <br>
had with Novell's Netware 4 back in 1996, where groups could be assigned <br>
rights in the FS very simple. That's (a bit) possible with ACL's now, but <br>
not as easy and smooth.<br>
<p>
And, a bit OT, I'm missing something like "make that user having the right <br>
to administrate his domain - manage users, ftp, and such". This is <br>
currently a PITA, and not really funny. Linux is stuck with the <br>
traditional "root is king" view, where it should adopt. SELinux seems to <br>
be a step in the right direction, but all that SELinux/ACLs security tools <br>
forget about the admin, who should be able to quickly manage things. <br>
Commandline is nice and a must, but some GFX tools for the <br>
not-so-much-keyboard-king type of admins should be there also. Just look <br>
at Novells NDS, it's a fun to administer it.<br>
<p>
mfg zmi<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/188088/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor188245"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">ext2 - ext3 - ext4</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 18, 2006 11:31 UTC (Sun)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/188245/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <blockquote>
I would except a kernel with support for ext3 to be able to mount a ext3 filesystems. Everything else is, imho, lunacy.
</blockquote>
In that case ext2 and ext3 have always been lunatic. There have always been flags in the superblock indicating features that the fs driver must possess before the FS can be mounted read-only, and features that it must possess before the FS can be mounted writable.
      
          <div class="CommentReplyButton">
            <form action="/Articles/188245/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor187894"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Evolutionary or Revolutionary?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2006 13:00 UTC (Thu)
                               by <b>brugolsky</b> (subscriber, #28)
                              [<a href="/Articles/187894/">Link</a>] 
      </p>
      
      </div>
      </summary>
      Sadly, the discussion has tended to conflate a number of issues:
<P>
<OL>
<LI>Compatibility
<LI>Maintainability
<LI>Stability
</OL>
<P>
My principal question regarding Jeff Garzik's approach is whether putting work into an Ext4 that is largely compatible with Ext3 (w.r.t. things like chattr, EA, etc.), but is really a different filesystem is worthwhile, rather than taking the lesssons learned from Daniel Phillips's Tux2, Reiser4, ZFS, and experimental work such as ext3cow, and starting from scratch to create the next-gen default Linux fs.  In other words, if extents are going to go in, what bundle of features should go with it?  Can the format be changed in a way that makes adding features like in-filesystem COW snapshots or checksums possible without breaking compatibility?  Will such flexibility grossly hamper performance?
      
          <div class="CommentReplyButton">
            <form action="/Articles/187894/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor187899"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Time for ext4?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2006 13:22 UTC (Thu)
                               by <b>job</b> (guest, #670)
                              [<a href="/Articles/187899/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      There is no shortage of more interesting file systems than ext3. If the <br>
user can't switch back and forth as was the case with ext2/ext3, there is <br>
no reason not to be more ambitious. Reiser4 would be a much better <br>
starting point, and is actually architected around Linux from the start.<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/187899/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor187952"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Time for ext4?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2006 15:41 UTC (Thu)
                               by <b>smoogen</b> (subscriber, #97)
                              [<a href="/Articles/187952/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      I think the biggest problem with reiser4 is the various 'political/religous' wars between Hans Reiser and many other kernel developers. Hans does fantastic work, but he seems to have a hard time taking criticism or dealing with people who want to keep a status quo for a while. <br>
<p>
One problem I have heard from commercial people is what happens when reiser5 comes out? Do we end up with the same 'upgrade or else' arguments that seemed to come out when reiser3 came out. These were people who had been using reiser3 and felt burned when they couldn't get fixes except from SuSE and some felt derided by Hans when they didn't want to move all their production systems to reiser4 immediately.<br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/187952/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor188233"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Time for Reiser4?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 18, 2006 2:12 UTC (Sun)
                               by <b>giraffedata</b> (guest, #1954)
                              [<a href="/Articles/188233/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <blockquote>
I think the biggest problem with reiser4 is the various 'political/religous' wars between Hans Reiser and many other kernel developers.
</blockquote>
<p>
I agree, but it's irrelevant to this conversation.  There's no law that Hans Reiser has to be the one to develop and maintain Reiser4.
<p>
If the Linux community wants a better filesystem type and existing Reiser4 code is the best starting point available for that, there's no reason the Linux community can't do the required development, and then properly support users of that filesystem type in the future.

      
          <div class="CommentReplyButton">
            <form action="/Articles/188233/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor188132"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Time for ext4?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 16, 2006 15:29 UTC (Fri)
                               by <b>rfunk</b> (subscriber, #4054)
                              [<a href="/Articles/188132/">Link</a>] 
      </p>
      
      </div>
      </summary>
      On my production server I don't want an "interesting" filesystem.  I want <br>
one that (among other things) I can rely on to work well now and far into <br>
the future. <br>
 <br>
Switching back and forth is nice, but a one-way upgrade path is still <br>
better than a total dump-and-restore. <br>
      
          <div class="CommentReplyButton">
            <form action="/Articles/188132/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor188250"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Time for ext4?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 18, 2006 15:48 UTC (Sun)
                               by <b>malor</b> (guest, #2973)
                              [<a href="/Articles/188250/">Link</a>] 
      </p>
      
      </div>
      </summary>
      The biggest reason a new, incompatible FS should be called ext4 is because of user ignorance. <br>
<p>
Not all admins track lwn.net or the LKML.  (I certainly don't touch LKML, sheesh!)   There's a fundamental expectation that if it's ext3, it should be mountable by anything that supports ext3.  <br>
<p>
Calling it ext4 automatically will map it, in most people's heads, to the correct ideas: <br>
<p>
1. "It's in the ext series, so it's probably stable."<br>
2. "It has more features than ext3."<br>
3. "My existing ext3 kernels will not be able to read an ext4 volume without an upgrade."<br>
4. "I will be able to upgrade from ext3 to ext4, just as I could from 2 to 3."<br>
<p>
If, on the other hand, you call it ext3, but then break the compatibility, I guaran-damn-tee you there are going to be frustrated, unhappy users out there. They're gonna be PISSED when they can't fall back to an earlier kernel, or when they can't copy files off their thumb drive.  If you call it ext3, you're making a guarantee about portability, and breaking that WILL cause a lot of user frustration. <br>
<p>
The ext guys are right that they have huge street cred.  They have so much cred, in fact, that calling it ext4 will improve uptake.  People trust ext.  I trust ext.  I'd happily run ext4 the very first time it was available.  <br>
<p>
But forcing invisible upgrades is a _bad idea_.  Even if the new ext3 features require special command-line arguments, at least some distros are going to use them, and at least some users are going to be bitten.<br>
<p>
Wanting to call it ext3 is a feature to benefit the developers; they want their code to be as widely used as possible.  It is NOT a feature that benefits users.<br>
<p>
Be fair to the user base and call an incompatible upgrade an UPGRADE, not the same thing. <br>
<p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/188250/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2006, Eklektix, Inc.<BR>
            
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
