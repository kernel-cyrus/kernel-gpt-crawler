        <!DOCTYPE html>
        <html lang="en">
        <head><title>4.18 Merge window, part 1 [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/756898/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/756895/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/756898/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>4.18 Merge window, part 1</h1>
</div>
<div class="ArticleText">
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>June 8, 2018</br>
           </div>
As of this writing, 7,515 non-merge changesets have been pulled into the
mainline repository for the 4.18 merge window.  Things are clearly off to a
strong start.  The changes pulled this time around include more than the
usual number of interesting
new features; read on for the details.
<br clear="all">
<p>

<h4>Architecture-specific</h4>
<p>
<ul class="spacylist">

<li> The 32-bit ARM architecture has gained fixes for Spectre
     variants&nbsp;1 and&nbsp;2.
<li> 32-Bit x86 systems now have a just-in-time compiler for eBPF
     programs.
</ul>

<h4>Core kernel</h4>
<p>
<ul class="spacylist">

<li> There is <a href="/Articles/743714/">a new polling interface</a>
     for use with asynchronous I/O.  
<li> The new <tt>no5lvl</tt> command-line parameter turns off five-level
     paging even if the kernel and the hardware support it.  This is
     essentially a "chicken bit" that can turn off this new feature if it
     creates problems.
<li> The <a href="/Articles/744047/">power domain performance levels</a>
     patch set has been merged.  This code extends the power-management
     subsystem to be able to run the entire system (including peripheral
     devices) according to the needed power/performance balance.
<li> Trace markers (described briefly in <a href="/Articles/366796/">this
     article</a>) can now be used to fire triggers for actions like histogram
     generation.  See <a href="/Articles/756953/">this documentation
     patch</a> for details.
<li> The control-group memory controller supports a new <tt>memory.min</tt>
     parameter.  Like the existing <tt>memory.low</tt>, it is meant to
     ensure that the group has a minimum amount of RAM available to it, but
     it is meant to provide a stronger guarantee even when no reclaimable
     memory exists.  <a
     href="https://git.kernel.org/linus/bf8d5d52ffe89aac5b46ddb39dd1a4351fae5df4">This
     commit</a> includes the documentation for this new parameter.
</ul>

<p><blockquote class="ad">
<b><tt>$ sudo subscribe today</tt></b>
<p>
Subscribe today and elevate your LWN privileges. You’ll have
access to all of LWN’s high-quality articles as soon as they’re
published, and help support LWN in the process.  <a href="https://lwn.net/Promo/nst-sudo/claim">Act now</a> and you can start with a free trial subscription.
</blockquote>
<p>
<h4>Filesystems</h4>
<p>
<ul class="spacylist">

<li> There have been a few Btrfs improvements this time around.  An
     empty subvolume can now be deleted with <tt>rmdir()</tt>; no special
     capabilities are required.  The new <tt>FS_IOC_FSGETXATTR</tt> and
     <tt>FS_IOC_FSSETXATTR</tt> <tt>ioctl()</tt> commands can be used to
     manipulate various file attributes (the append-only and immutable
     flags, for example).  There is also a new set of <tt>ioctl()</tt>
     commands to allow unprivileged users to look up subvolume
     information. 
<li> It is now possible for users running as root within a user namespace
     <a href="/Articles/755593/">to mount filesystems</a>, even if they
     lack privilege outside of the namespace.  The filesystem type itself
     must be marked to allow this type of mount; the only filesystem so 
     marked at this point is the filesystems in user space (FUSE) module,
     which has seen      a number of changes to enable this functionality
<li> The fscrypt module, used for encryption of F2FS and ext4 filesystems,
     has gained support for the Speck128 and Speck256 ciphers.  Speck is
     somewhat <a href="/Articles/756964/">controversial</a> (the US NSA
     seems a little too enthusiastic 
     about promoting it), but it does enable encryption on the lowest-end
     devices.  Ted Ts'o <a href="/Articles/756929/">said</a> that it's
     unlikely to be enabled on higher-end devices at all.  "<q>This is
     really intended for 'The Next Billion Users'; phones like Android Go
     that was disclosed at the 2017 Google I/O conference, where the
     unsubsidized price is well under $100 USD</q>".

</ul>
<p>
<h4>Hardware support</h4>
<p>
<ul class="spacylist">

<li> <b>Audio</b>:
     Realtek RT1305/RT1306 amplifiers,
     Realtek RT5668B codecs,
     Mediatek MT6351 audio codecs,
     Analog Devices SSM2305 speaker amplifiers,
     Atmel I2S controllers, and
     Tempo Semiconductor TSCS454 codecs.
     
<li> <b>Graphics</b>:
     NVIDIA Volta GPUs,
     Xen paravirtualized front-end displays,
     Allwinner A31 MIPI-DSI controllers,
     Thine THC63LVD1024 LVDS decoder bridges,
     Cadence DPI/DSI bridges,
     Samsung Exynos image scalers,
     Broadcom V3D 3.x (and newer) GPUs,
     NXP TDA9950/TDA998X HDMI CEC engines, and
     AMD Vega&nbsp;20 GPUs.
<li> <b>Media</b>:
     Video devices using I2C transports,
     Sharp QM1D1B0004 tuners,
     Cadence CSI-2 RX/TX controllers,
     OmniVision OV7251 sensors,
     Renesas R-Car MIPI CSI-2 receivers, and
     Sony IMX258 sensors.
     The (170&nbsp;KLOC) atomisp driver has been removed from the staging tree
     due to a lack of progress.
<li> <b>Miscellaneous</b>:
     ChipOne icn8505 touchscreens,
     Crane CR0014114 LED boards,
     Spreadtrum Communications SC27xx LED controllers,
     TI LM3601x LED controllers,
     Lattice MachXO2 SPI FPGA controllers,
     Rave SP EEPROM controllers,
     IBM virtual management channel adapters, 
     Rockchip PCIe endpoint controllers, and
     STMicroelectronics STM32 inter-processor communication controllers.
<li> <b>Networking</b>:
     Texas Instruments DP83TC822 PHYs and
     Microsemi Ocelot Ethernet switches.
<li> <b>Pin control</b>:
     Actions Semi S900 pin controllers,
     Renesas R8A77470 and R8A77990 pin controllers, and
     Allwinner H6 R_PIO pin controllers.
<li> <b>USB</b>:
     Richtek RT1711H Type-C USB controllers,
     Aspeed vHub virtual hubs,
     HiSilicon STB xHCI host controllers,
     Atheros AR71XX/9XXX USB PHYs, and
     MediaTek XS-PHY transceivers.
</ul>

<p>
<h4>Miscellaneous</h4>
<p>
<ul class="spacylist">

<li> The crypto subsystem now supports the <a
     href="https://facebook.github.io/zstd/">Zstandard</a> compression
     algorithm and the <a
     href="https://www.techrepublic.com/resource-library/whitepapers/aegis-a-fast-authenticated-encryption-algorithm/">AEGIS</a>
     and <a href="https://competitions.cr.yp.to/round3/morusv2.pdf">MORUS
     [PDF]</a> encryption algorithms.
<li> The <tt>/proc</tt> interface for IPMI statistics has been removed;
     that information is still available in sysfs.
<li> The (scrupulously undocumented) BPF type format mechanism provides a
     metadata format for the description of the data types used by BPF
     programs.  Its initial use is for the pretty-printing of values in
     BPF maps.
</ul>     

<p>
<h4>Networking</h4>
<p>
<ul class="spacylist">

<li> The TCP protocol now supports <a href="/Articles/754681/">zero-copy
     receive operations</a> under some conditions.
<li> The <a href="/Articles/750845/"><tt>AF_XDP</tt></a> subsystem has been
     merged; it allows zero-copy networking under the control of one or
     more BPF programs loaded from user space.  <a
     href="https://git.kernel.org/linus/b4b8faa1ded7a3bb34db374c692a51cea29f9080">This
     commit</a> contains a sample <tt>AF_XDP</tt> application.
<li> The core <a href="/Articles/747551/">bpfilter</a> mechanism has been
     merged.  It is not truly functional for packet filtering at this
     point, but the infrastructure is now there to build on.  That
     infrastructure includes a reworked <a
     href="/Articles/755919/">user-mode blob helper</a> mechanism that is
     likely to see use well beyond bpfilter.
<li> The in-kernel TLS protocol implementation has gained support for
     offloading that protocol support into suitably capable hardware.  The
     Mellanox mlx5 driver now supports TLS offloading.
<li> The TCP protocol supports selective acknowledgment (SACK)
     compression; its purpose is to limit the number of SACK packets sent
     when the network is already overloaded.
<li> It is now possible to attach a BPF program to a socket and have it run
     on <tt>sendmsg()</tt> calls; that program can do things like rewrite
     the IP addresses in the outgoing packet.
</ul>


<h4>Internal kernel changes</h4>
<p>
<ul class="spacylist">

<li> As part of the new AIO polling mechanism, the interface to the
     <tt>poll()</tt> method has changed.  The new function is:
     <p>
<pre>
    __poll_t	(*poll_mask) (struct socket *sock, __poll_t events);
</pre>
     <p>
     Many internal <tt>poll()</tt> implementations have been converted to
     this interface.  To be able to support AIO polling, drivers should
     also implement the new <tt>get_poll_head()</tt> method, which
     returns the wait queue used for polling.
<li> The qspinlock implementation has been improved to eliminate potential
     starvation problems.
<li> There is a new <tt>__kernel_timespec</tt> structure:
<p>
<pre>
    struct __kernel_timespec {
	__kernel_time64_t       tv_sec;                 /* seconds */
	long long               tv_nsec;                /* nanoseconds */
    };
</pre>
<p>
     Its purpose is to facilitate the creation of year-2038-safe system
     calls on 32-bit systems by making the internal time representation be
     the same for both the 32-bit and 64-bit versions.  Various
     implementations of system calls with year-2038 problems (<tt><a
     href="http://man7.org/linux/man-pages/man2/nanosleep.2.html">nanosleep()</a></tt>,
     for example) have been updated to use this new type.
<p>
<li> The Sys V interprocess communication system calls have seen some work
     to make them year-2038 safe.
<p>
<li> The kernel configuration language has grown a new macro definition
     subsystem; it is intended to facilitate moving various build-time
     tests from the makefiles into the <tt>Kconfig</tt> files.  See <a
     href="/Articles/756963/">Documentation.kbuild/kconfig-macro-language</a>
     for details on how it works.
<li> A number of the <a href="/Articles/753078/">improvements to <tt>struct
     page</tt></a> discussed at <a href="/Articles/lsfmm2018/">LSFMM
     2018</a> have been merged.
</ul>
<p>

By the normal schedule, the 4.18 merge window should continue through
June&nbsp;17.  The second half is likely to be somewhat slower than the
first, though, since Linus Torvalds has indicated that he will be traveling
during that time.  If all goes to schedule, the final 4.18 release can be
expected on August&nbsp;5 or&nbsp;12.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Releases-4.18">Releases/4.18</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/756898/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor757000"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">4.18 Merge window, part 1</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 8, 2018 23:25 UTC (Fri)
                               by <b>fratti</b> (guest, #105722)
                              [<a href="/Articles/757000/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;Graphics: NVIDIA Volta GPUs, [...] and AMD Vega 20 GPUs.</font><br>
<p>
Did a double take there because I was pretty sure both of these were unannounced, but actually at least Vega 20 seems to have been announced a few days ago.<br>
<p>
Also, what's NVIDIA desktop stuff doing in the kernel? Is this just glue code for their binary blobs and PCI identifier stuff?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757000/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor757006"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">4.18 Merge window, part 1</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 9, 2018 0:00 UTC (Sat)
                               by <b>knan</b> (subscriber, #3940)
                              [<a href="/Articles/757006/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Volta has pro variants released. Titan V and Quadro GV100.<br>
<p>
And this is for the reverse-engineered Nouveau opensource driver.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757006/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor757007"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">4.18 Merge window, part 1</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 9, 2018 0:02 UTC (Sat)
                               by <b>fratti</b> (guest, #105722)
                              [<a href="/Articles/757007/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Oh, neat, didn't know that. Nouveau is pretty quick.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757007/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor757008"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">4.18 Merge window, part 1</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 9, 2018 0:04 UTC (Sat)
                               by <b>Kamilion</b> (subscriber, #42576)
                              [<a href="/Articles/757008/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;Also, what's NVIDIA desktop stuff doing in the kernel? Is this just glue code for their binary blobs and PCI identifier stuff?</font><br>
<p>
DRM console and modesetting, I'd figure.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757008/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor757013"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Mounting filestytems as root in a user namespace</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 9, 2018 2:15 UTC (Sat)
                               by <b>ebiederm</b> (subscriber, #35028)
                              [<a href="/Articles/757013/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Fuse is not the first filesystem just the first filesystem with backing store.<br>
<p>
The proc, sysfs, tmpfs, ramfs, devpts and mqueue filesystems have been mountable for a while.<br>
<p>
Fuse was made possible by vfs work to handle xattrs, device nodes and other filesystem features that could lead to privilege escalation if they retained their usual filesystem handling.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757013/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor757015"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">2038 Fixes</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 9, 2018 3:58 UTC (Sat)
                               by <b>songmaster</b> (subscriber, #1748)
                              [<a href="/Articles/757015/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Why is __kernel_timespec::tv_nsec defined as a long long? Doesn’t that make it 64 bits (on current architectures), which is twice as wide as is needed to store the number of nanoseconds in a second? Even a signed int32_t can store 2e9, so what will the extra 32 bits ever be used for?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757015/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor757018"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">2038 Fixes</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 9, 2018 7:51 UTC (Sat)
                               by <b>arnd</b> (subscriber, #8866)
                              [<a href="/Articles/757018/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Two reasons:<br>
<p>
- For comparison mode on 64 bit architectures, we want the same binary layout for structures with a timespec between existing 64 bit and new 32 bit user space.<br>
<p>
- When copying out timestamps to user space, it's better to avoid structures with padding, this helps prevent data leaks.<br>
<p>
Note that both inside of the kernel (timespec64) and in user space, tv_nsec is 'long', only the interface between the two uses an explicit 64 bit type.  Most new machines these days are 64 bit (even for embedded), so tv_nsec is already excessively long as mandated by both posix and c99.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757018/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor757537"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">2038 Fixes</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 14, 2018 17:46 UTC (Thu)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/757537/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I suspect in the long term those bits will end up being abused as flags for something or other, by software authors sharing the opinion that they're pointless.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757537/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor757020"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">4.18 Merge window, part 1</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 9, 2018 8:03 UTC (Sat)
                               by <b>seanyoung</b> (subscriber, #28711)
                              [<a href="/Articles/757020/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Also BPF can do IR decoding now. This should remove the need to run lircd for IR protocols that the kernel IR decoders don't support, once the user-space tooling is complete.<br>
<p>
<a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=ee7dbd974797e6dcbfd0df6d3c2d95a5a55ac0c8">https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/...</a><br>
<p>
(Obviously I'm biases as I wrote the code).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757020/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor757029"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">IR decoding</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 9, 2018 13:00 UTC (Sat)
                               by <b>corbet</b> (editor, #1)
                              [<a href="/Articles/757029/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      Argh, I'm not sure how I forgot to put that in.  It's an interesting development that's been on my radar for a bit...  
      
          <div class="CommentReplyButton">
            <form action="/Articles/757029/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor757190"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">IR decoding</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 11, 2018 18:03 UTC (Mon)
                               by <b>admalledd</b> (subscriber, #95347)
                              [<a href="/Articles/757190/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Chances of an article about it sometime in the future? This is an interesting edge of the kernel that isn't noticed much until someone needs it, and a interesting bpf use as well...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757190/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor757106"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">4.18 Merge window, part 1</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 11, 2018 3:38 UTC (Mon)
                               by <b>jcm</b> (subscriber, #18262)
                              [<a href="/Articles/757106/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
btw, technically it's "arm" or "Arm Architecture" now. They did away with the meaning of the acronym. Many people (myself included) strongly oppose and disagree with that, but it's what happened.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757106/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor757251"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">4.18 Merge window, part 1</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 12, 2018 6:28 UTC (Tue)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/757251/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; btw, technically it's "arm" or "Arm Architecture" now. They did away with the meaning of the acronym.</font><br>
<p>
Yeah, like people will care or even notice.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757251/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor757573"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Speck isn't &quot;controversial&quot;, it's highly suspicious.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2018 11:06 UTC (Fri)
                               by <b>nettings</b> (subscriber, #429)
                              [<a href="/Articles/757573/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The mail linked to in the article (well worth a read) is from one of the experts on the ISO standards panel if I understand correctly, and the ISO decided to shoot it down. Not just because of its provenance, but because of a long string of general fishiness that my lack of crypto knowledge doesn't let me understand in detail, but it's out there, both in Tomer Ashur's mail and other news outlets.<br>
<p>
More on-the-record commentary from him as a spokesperson for ISO: <a href="https://www.cbronline.com/news/nsa-ciphers-iso">https://www.cbronline.com/news/nsa-ciphers-iso</a><br>
And another quite damning statement from another member of the ISO board: <a href="https://boingboing.net/2018/04/24/fool-me-once.html">https://boingboing.net/2018/04/24/fool-me-once.html</a><br>
<p>
In my opinion it's a shame to see this adopted by Linux until the severe allegations have been addressed. In crypto (particularly when it originates from a repeat offender), "innocent until proven guilty" is really the wrong approach, no matter how wise it is in jurisprudence.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757573/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor757614"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Speck isn't &quot;controversial&quot;, it's highly suspicious.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2018 17:31 UTC (Fri)
                               by <b>zyzzyva</b> (guest, #107472)
                              [<a href="/Articles/757614/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I caution against reading too much into the ciphers themselves, as opposed to the interaction between the ISO and NSA.  NSA has traditionally had the best cryptographers and has escaped some of the academic norms; now they are being held to them more strictly, and due to the NSA's past actions and the political environment even being expected to far exceed the norms.<br>
<p>
I think that is clear if you actually read the academic literature, including third-party cryptanalysis but also the Simon+Speck team's own papers.  The designers' latest paper is actually quite comprehensive and detailed in comparison to what you find from other cryptographers, and certainly *much* more than what you'd find from the NSA in the past.  Yes, it does have parts that still need clarification, and naturally the NSA isn't going to provide details of their own cryptanalysis other than saying that it found no weaknesses and used in part some publicly known techniques -- so there's that.  But the designers actually do make it clear how they claim to have set the security margins: they added AES-128's security margin of ~30% from the limiting attacks in the standard attack model, which were (and still are) differential attacks.  Note that Dr.  Ashur's slightly improved attacks using RX cryptanalysis are only valid in the known-key distinguishing attack model for certain weak key classes, so they're not directly comparable to "real" attacks like the differential attacks.  I caution against relying too much on one person's opinion, especially if they have in the past stated preconceived political views, which might compromise their impartiality.  Claims of a 15% security margin don't appear supported by the literature; the real margin in the standard attack model still appears to be 25-30%, similar to AES-128's.<br>
<p>
Of course, some cryptographers (understandably) prefer larger security margins, as more of a buffer against future cryptanalytic advances.  But there is a real-world cost to adding more rounds, and Speck is specifically designed to be a "lightweight" cipher, usable on devices where more conservative designs are not possible.<br>
<p>
Speck is also an *extremely* simple ARX cipher, with a tiny parameter space.  So it's actually quite unclear how it might be able to have any sort of intentional weakness, and I don't think any claim of a weakness actually appears in the literature.  Meanwhile the NSA has approved Speck128/256 for encrypting the U.S.  government's own data; so in that context it would be seem quite odd for it to have a known weakness.<br>
<p>
Note also that due to the restrictions of where they work, the Simon+Speck team isn't generally able to respond publicly to criticism outside of their official publications.  I agree it's problematic and it would be much better if they were fully open and more involved with the community, but just know that this means you don't always get their side of the story.<br>
<p>
(Not to mention that Speck was added to Linux's crypto API as an alternative for no encryption, on very low-end devices without AES hardware support, where using AES is not feasible.  It's disappointing to see people seriously argue for *no encryption* over Speck, when there aren't any currently feasible options for the use case -- see the prior posts in the thread for details.  Even if it turns out that Speck is weaker than thought, for some users it still provides a massive security benefit over the status quo of no encryption.  As a full disclosure, I am the person who wrote the patches.)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757614/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor757617"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Speck isn't &quot;controversial&quot;, it's highly suspicious.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 15, 2018 18:56 UTC (Fri)
                               by <b>zyzzyva</b> (guest, #107472)
                              [<a href="/Articles/757617/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Sorry, my last paragraph should say "when there aren't any *other* currently feasible options for the use case".  Speck128-XTS is *almost* still too slow, but is believed to be fast enough especially given the benefit of encryption over no encryption, and is among the fastest options considered.  Unfortunately, the faster options had problems like being stream ciphers and therefore unsuitable for length-preserving disk encryption; being hand-rolled or very new constructions lacking proper cryptanalysis or publications; being actually cryptographically broken; and/or not having an effective key length in line with modern ciphers.  In my personal opinion, it would be unethical to use no encryption, or a known insecure option like a stream cipher with nonce reuse, just to avoid the (mostly non-technical) "controversy" around Speck.  Hopefully there will be other feasible options in the future, but for now Speck128-XTS seems the strongest contender from a technical perspective.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757617/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor757696"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Speck isn't &quot;controversial&quot;, it's highly suspicious.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 17, 2018 21:30 UTC (Sun)
                               by <b>nettings</b> (subscriber, #429)
                              [<a href="/Articles/757696/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Thanks for your reply. It's certainly valid to argue for less-than-ideal crypto rather than none at all. But will users always be aware of it? Ok, if I want to prevent random people from prying into my phone, this might be ok. But some people will have more fundamental (or even existential) crypto needs, and they might not always know which compromise they are making. With no encryption at all, at least you know what you have, and act accordingly.<br>
<p>
As to your comment about "activism", well, yeah, of course that comes into it, and justifiably so. Taking research from an institution with a track record of subverting random number generators and lobbying them into NIST standards for public use certainly should be questioned.<br>
Looking at its lack of respect for the civil rights of US citizens is already quite sobering. For a non-US citizen like me, should I consider it anything other than a hostile force? I mean, our very own BKA certainly doesn't make me proud, but at least I don't find their stuff in the Linux kernel.<br>
<p>
I cannot validate your technical argument for lack of knowledge, but I do value it. However, unlike you, I'm in the same position as most users: I have to trust crypto gurus. Now the lesson I've learned is to look for open-source implementations of algorithms developed in the open and vetted openly by experts who disclose their methods. You are basically saying, trust me, in this particular case it's ok to get into this nice uncle's car and take the ice cream. Yeah, one kid was never seen again a few years back, but uncle has seen the error of his ways. That is undoing many of the education efforts preached for years by Schneier and others, and goes against the only procedure laypersons have for chosing trustworthy cryptography.<br>
If that's activism, call me an activist.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757696/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor757698"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Speck isn't &quot;controversial&quot;, it's highly suspicious.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 17, 2018 21:33 UTC (Sun)
                               by <b>nettings</b> (subscriber, #429)
                              [<a href="/Articles/757698/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
To stretch the ice cream analogy just a bit more: "Of course, only follow this advice if Mom or Dad can't buy you one".<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757698/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor757701"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Speck isn't &quot;controversial&quot;, it's highly suspicious.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 18, 2018 2:41 UTC (Mon)
                               by <b>zyzzyva</b> (guest, #107472)
                              [<a href="/Articles/757701/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Actually, today Android doesn't proactively inform you whether your phone is even encrypted or not, though there are ways for users to find out.  Likewise, there are also ways for more technical users to check the type of encryption, e.g. full-disk or file-based and the cipher used.  FWIW, I also recently updated fs/crypto/ to log the cipher it's using to the kernel log.  Personally I'd support making this information more visible to non-technical users; just understand that this isn't a new problem, and having more allowed ciphers just adds another dimension to it.  And at some point a simplification clearly has to be made, e.g. web browsers don't make you click through a pop-up showing all the crypto algorithms used in the certificate and TLS connection every time you visit a HTTPS web site, just in case you personally object to any of them.  Rather, experts have already made a determination of how secure each algorithm is.<br>
<p>
I believe that crypto primitives should never be taken at face value, and the designers should never be trusted.  That's why we chose a cipher that, among other things, has undergone extensive independent cryptanalysis (at least in comparison to other AES alternatives), yet still has a security margin similar to AES; has a very simple and straightforward design that is in line with other ARX ciphers found in the literature; where the designers have released  extensive design rationale that actually *exceeds* the quality of what is normally found in the literature (if you disagree, I encourage you to actually read the papers and compare them to others); that is naturally resistent to timing attacks; and that supports secure block and key sizes.<br>
<p>
Yes, Speck is an NSA-designed algorithm, which given their dual mission I too view as a negative.  But I disagree that NSA-designed algorithms should be removed from consideration entirely on principle, any more than you would refuse to consider e.g. Chinese algorithms due to not trusting China, or refuse to use HTTPS, Bitcoin, etc. because their security is dependent on the NSA-designed SHA-256 algorithm.  Remember that the NSA's mission also includes "information assurance", they've long had some of the world's best cryptographers, and they've been involved in crypto standards for decades (both designing algorithms, like SHA-1 and SHA-2, and reviewing and strengthening algorithms), with a positive role in all but one case which was actually a very obvious backdoor using public key cryptography.  Note that it's impossible for Speck to contain a public key backdoor, as its parameter space is far too tiny.  Therefore, any weakness in it can be exploited by anyone, not just the designers.  And given that the NSA has approved Speck128/256 for use in U.S. National Security Systems (even up to "Top Secret" stuff, IIUC), it would be *very* awkward for them to know it has a weakness.<br>
<p>
I know the field of cryptography has always had a political element, but I really hope that we can retain at least a scrap of technical merit, and not start having to choose algorithms based purely on things like the where the designers work and live; or, even worse, being unable to use crypto at all because all the viable crypto choices are too politically contentious, yet "no crypto" is somehow okay.<br>
<p>
BTW, the actual biggest weakness of the encryption used on phones is probably the user's PIN, as it's usually short enough to be brute-forced regardless of which cipher is used; see e.g. <a href="https://blog.malwarebytes.com/security-world/2018/03/graykey-iphone-unlocker-poses-serious-security-concerns/">https://blog.malwarebytes.com/security-world/2018/03/gray...</a>.  I find it silly that people worry about a certain nation-state adversary breaking a *block cipher* (despite pretty solid evidence they can't), when said adversary, and even some less capable adversaries, can almost certainly already "break" the cryptosystem anyway even if the cipher is AES.  Of course, this still doesn't make encryption useless; it's still good to make attacks as difficult and costly as possible, and raise the bar to exclude as many adversaries as possible.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757701/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor761030"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Speck isn't &quot;controversial&quot;, it's highly suspicious.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 27, 2018 1:42 UTC (Fri)
                               by <b>ras</b> (subscriber, #33059)
                              [<a href="/Articles/761030/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Speck is also an *extremely* simple ARX cipher, with a tiny parameter space.</font><br>
<p>
It's hard to overstate that point.  The meat of it is 7 lines of C, with no ancillary tables like S boxes.  There is nowhere to hide.  It gives me the same feeling of beauty I got from comparing Sha2 to  Keccak.  It makes all previous attempts look like they were made someone has throwing obscure code and magic numbers at the wall, stopping when the output passed randomness tests.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/761030/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor757657"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">SPECK comments</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 16, 2018 8:52 UTC (Sat)
                               by <b>zdzichu</b> (subscriber, #17118)
                              [<a href="/Articles/757657/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Ted Ts'o said that it's unlikely to be enabled on higher-end devices at all. "This is really intended for 'The Next Billion Users'; phones like Android Go that was disclosed at the 2017 Google I/O conference, where the unsubsidized price is well under $100 USD".</font><br>
<p>
I may be reading this wrong, but what the implication here? <br>
“It may be compromised, but people who can only afford low-end phone don't deserve security/privacy”? <br>
or<br>
“Most kernel developers can buy higher-end device and won't be affected by this, so don't complain”?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757657/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor757658"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">SPECK comments</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 16, 2018 12:12 UTC (Sat)
                               by <b>rahulsundaram</b> (subscriber, #21946)
                              [<a href="/Articles/757658/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;  I may be reading this wrong, but what the implication here? </font><br>
<p>
I read it as, compromises have to be made to push out products at this price point.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757658/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor757666"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">SPECK comments</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 16, 2018 18:00 UTC (Sat)
                               by <b>zyzzyva</b> (guest, #107472)
                              [<a href="/Articles/757666/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; I read it as, compromises have to be made to push out products at this price point.</font><br>
<p>
That's correct; currently most phones in that price range are unencrypted because AES isn't nearly fast enough, due to the lack of CPU support (ARM CE).  Speck-XTS allows getting encryption to those devices now, without waiting years.  The belief is that encryption is for everyone, not just people who can afford mid/high-end phones.  So Speck is replacing no encryption, not AES.<br>
<p>
Also I strongly disagree that Speck doesn't provide any "security/privacy".  While I did write in the Kconfig help that "Speck may not be as secure as AES, and should only be used on systems where AES is not fast enough", that's not truly supported by the current academic literature, despite ~70 cryptanalysis papers on Simon and Speck, and even taking into account a certain very vocal person's claims.  In fact, currently the best attacks on AES are actually *better* than the best attacks on Speck.  I included that conservative statement primarily out of caution, since Speck is a newer algorithm with fewer years of study, so there is probably a greater chance of improved attacks being published on Speck, in comparison to AES; and also to a lesser extent, an understanding that people are using Simon and Speck as an outlet for political activism, so I don't want people unfamiliar with the situation to choose Speck and potentially run into said activism unless they have no other option.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757666/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor757699"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">SPECK comments</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jun 17, 2018 23:20 UTC (Sun)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/757699/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;In fact, currently the best attacks on AES are actually *better* than the best attacks on Speck.</font><br>
It would be a strange situation indeed if the opposite were already true.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/757699/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2018, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
