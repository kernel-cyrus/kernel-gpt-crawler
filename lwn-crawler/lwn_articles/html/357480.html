        <!DOCTYPE html>
        <html lang="en">
        <head><title>KS2009: Regressions [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/357480/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/357480/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>KS2009: Regressions</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>This article brought to you by LWN subscribers</b>
<p>
Subscribers to LWN.net made this article &mdash; and everything that
       surrounds it &mdash; possible.  If you appreciate our content, please
       <a href="/Promo/nst-nag3/subscribe">buy a subscription</a> and make the next
       set of articles possible.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>October 19, 2009</br>
           <hr>
LWN's <a href="/Articles/KernelSummit2009/">2009 Kernel Summit coverage</a>
</div>
Regressions are the worst sort of bug.  As long as working systems continue
to work, we can be reasonably confident that the kernel is getting better
over time.  But if we break working systems, the situation is far more
questionable.  For this reason, it is important to avoid introducing
regressions into the kernel.  When they occur, they must be recognized as
such, tracked, and fixed as quickly as possible.  The kernel's regression
tracker is Rafael Wysocki; he presented some information on how we have
been doing over the last year.
<p>
Various plots showing the number of regressions reported and the number
fixed against the age of each kernel were presented.  These plots can  be
fitted to an exponential distribution which is very similar to that seen
for phenomena like radioactive decay.  Looking at things that way, Rafael
says, regressions have a half life of about 17 days, and a mean lifetime of
24 days.
<p>
There is an important qualification to bear in mind here, though: these
plots only show regressions which have been fixed.  Over the year or so
surveyed, 858 regressions were reported, but only 738 of those were
reported to be fixed.  So, says Rafael, the full picture has to include a
second type of regression which is harder to find and to fix.
<p>
The 2.6.30 kernel, it seems, has a steeper regression curve than its
predecessors; it is not flattening out in the same way.  But the number of
regressions reported is fewer for this point in the cycle.  A fair amount
of time was spent trying to figure out just what that means.  Perhaps this
kernel is simply better, with fewer bugs to report in the first place.  Or
perhaps there are fewer testers.  Rafael believes that the number of
testers is roughly constant, as is the rate at which they can find bugs.
But, as the kernel grows, there is more code which will surely have bugs in
it.  So Rafael fears that more regressions are slipping through the cracks.
<p>
This worry was echoed by others, some of whom noted that Rafael's
regression list contains only a small subset of the problems.  Distribution
bug trackers tend to fill with many more issues.  There doesn't seem to be
any easy way to propagate distribution bug data upward, though; developers
for distributions which ship relatively young kernels tend to be working
flat-out already.
<p>
Ted Ts'o noted, though, that he feels much safer running -rc1 kernels now
than in the past.  They really seem to be getting more stable.
<p>
Arjan van de Ven put up some data from <a
href="http://kerneloops.org/">Kerneloops.org</a> suggesting that the number
of bugs per kernel release remains roughly constant.  As always, most users
are affected by a relatively small number of bugs.  In an aside, some
questioned whether the posting of certain types of crashes - null pointer
dereferences in particular - could be a security concern, but Alan Cox
responded that null-pointer problems are being reported on the mailing
lists all the time and few people are doing anything about them.  A listing
on kerneloops.org seems unlikely to worsen the situation.
<p>
So how can we make things better?  Rafael suggested that, in the current
development model, the opening of the merge window tends to distract
developers just when the just-released kernel is starting to get more
users.  That, in turn, can keep them from looking at regression reports.
So he suggested that it might make sense to delay the opening of the merge
window for one week after a major kernel release.  Linus did not like the
idea, though, saying that it would just drag out releases without helping
things much.  Rather than pay attention to regression reports, developers
would just continue to bash out new stuff for the delayed merge window,
creating even more regressions the next time around.
<p>
What would really help, it was agreed, is more testers - hardly a new or
novel conclusion.  Perhaps if more people would run linux-next, more bugs
would be found (and fixed) early.  Linux-next is hard to test, though, and
hard to debug.  It changes radically from one day to the next, and it is
not bisectable.  Rafael thinks that there is little benefit to users to
testing it, since any bugs found there are relatively unlikely to be
fixed.  Andrew Morton thought that developers should be testing their code
in linux-next as a way of finding bugs caused by interactions with other
changes.  That is a hard sell, though; working with linux-next can force
developers to contend with bugs from completely unrelated changes.  Alan
Cox noted that linux-next is often more reliable than the -rc1 releases. 
<p>
There was some talk about how long it can take for regression fixes to get
into the mainline.  Often these fixes will set in maintainer trees for some
time.  Might there be a way to get them in more quickly?  As it turns out,
a number of subsystem maintainers feel that these fixes should age for a
while in a testing tree, lest they introduce other problems.  So that
situation is not likely to change much.
<p>
<a href="/Articles/357481/">Next: The future of perf events</a><br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Development_model-Regressions">Development model/Regressions</a></td></tr>
            <tr><td><a href="/Archives/ConferenceIndex/">Conference</a></td><td><a href="/Archives/ConferenceIndex/#Kernel_Summit-2009">Kernel Summit/2009</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/357480/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor357504"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">KS2009: Regressions</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2009 17:22 UTC (Mon)
                               by <b>dyqith</b> (guest, #31406)
                              [<a href="/Articles/357504/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Maybe what we need is a group/company/foundation/person to come up with a huge collection of machines for automatic regression testing for new kernels.<br>
There should be a couple of machines from different categories (servers, laptops, desktops, mobiles) and manufacturers (Dell, HP, etc), and for testing at different levels (configure/compile, static analysis, boot, devices, filesystems, memory, etc).<br>
<p>
We have a set standard of tests, and users/devs can add in new tests when new features are needed to be tested.<br>
The output of the tests can then be posted to a bug tracker somewhere.<br>
<p>
The way I see it is testers have two problems (time and materials).<br>
Some have lots of time to test things, but no machine to play with;<br>
others have no time, but lots of machines.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/357504/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor357522"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">KS2009: Regressions</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2009 19:12 UTC (Mon)
                               by <b>dmk</b> (guest, #50141)
                              [<a href="/Articles/357522/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<a href="http://ltp.sourceforge.net/">http://ltp.sourceforge.net/</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/357522/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor357592"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">KS2009: Regressions</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 19, 2009 21:07 UTC (Mon)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/357592/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
We *have* that. The problem is that users tend to have stranger hardware <br>
and stranger configurations than anything that we can actually *test*: <br>
this is as opposed to Ingo's randconfig does-it-boot testing, which while <br>
otherwise excellent doesn't spot problems where drivers not needed for <br>
booting and building kernels don't work properly. I've had at least one <br>
regression with every one of the last four released kernels, and not one <br>
of them was something that would have been spotted by Ingo's randconfig <br>
testing (because that testing had wiped out all the low-hanging fruit <br>
already).<br>
<p>
However, all those regressions got squashed *fast* once I reported them: <br>
even the one I didn't realise was a regression until someone else reported <br>
it (the stuck-keys-in-X-on-SMP 2.6.31 locking bug). The key is to report <br>
and test :)<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/357592/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor358446"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">KS2009: Regressions</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 23, 2009 23:22 UTC (Fri)
                               by <b>jmspeex</b> (subscriber, #51639)
                              [<a href="/Articles/358446/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think one problem is that older hardware doesn't seem to get tested. From my (limited) experience, what happens is that when a new machine gets released, Linux support is often not great because it doesn't know how to handle some of the new hardware. Then, things get better as the bugs are fixed. Then after a year or so, you start seeing regression as the machine becomes old and less tested. For example, my last two laptops both had suspend fully working at some point and both had it broken by some kernel update.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/358446/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor358487"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">KS2009: Regressions</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 24, 2009 11:19 UTC (Sat)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/358487/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That's when you report the bugs :))) I've kept some machines working for a <br>
decade and more simply by reporting bugs when their old hardware breaks. <br>
The only machine I've ever given up on was a box with an ancient Promise <br>
ISA disk controller, which suddenly broke in 2.4.x versus 2.2.x. Of course <br>
this was before git and bisection: these days I could bisect to find the <br>
faulty commit and report it, but in those days I was pretty stuffed.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/358487/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor358511"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">KS2009: Regressions</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 24, 2009 18:01 UTC (Sat)
                               by <b>jmspeex</b> (subscriber, #51639)
                              [<a href="/Articles/358511/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
For the first laptop on which suspend got broken I was able to pinpoint that the problem happened between 2.6.12-rc5-git5 and 2.6.12-rc5-git6 after several months of testing (the problem occurred only after several days and it was my main work machine). This was by using the git "pre-releases" on kernel.org. After finding that, the response I got was simply "you need to learn git to further bisect otherwise we're not even looking at it" (I had already bisected to within one *day* of patches). At this point I just gave up. I *do* still report bugs for projects that treat reports better (gcc is one that comes to mind), but I'm no longer bothering with kernel bugs unless it *really* annoys me or there's a developer committed to putting some time into finding the problem instead of forever asking me to do more work without even looking at the code.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/358511/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor358481"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">KS2009: Regressions</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 24, 2009 10:47 UTC (Sat)
                               by <b>modernjazz</b> (guest, #4185)
                              [<a href="/Articles/358481/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If the issue is getting more testers, then it seems clear that the "easy"<br>
solution is to start making real use of the data in the distributions' bug<br>
trackers. Since the distribution developers are swamped, people who care<br>
about the kernel should be browsing the distribution bug databases<br>
themselves. Saying "we need more testers!" but then not exploiting this<br>
resource seems somewhat disingenuous.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/358481/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor358545"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">KS2009: Regressions</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 25, 2009 6:42 UTC (Sun)
                               by <b>kreutzm</b> (guest, #4700)
                              [<a href="/Articles/358545/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Although not mentioned in the text, I guess the real problem here is that distribution kernels tend to be old by kernel developer standards. And if someone reported "my upgrade from Etch to Lenny broke ..." then it is not clear that this person would be able to either git-bisect the exact faulty patch nor that he would be able to run the latest kernel (which might not even run out of the box). <br>
<p>
The dull (but probably) working solution would be if someone with deep knowledge of kernel regression would occassionally run through the distribution BTSs and mark things "fixed-upstream" when he notices that some regression is already solved, so that the reporter knows about it (and maybe the distro can cherry pick something if they so desire). But I can hardly estimate how much this would actually help.<br>
<p>
Maybe someone with lots of disk space could regularly compile the latest kernels (lets say every stable, -rc, ..) for all major distributions such that "mere mortals" could yum or apt-get them. Then experienced users could narrow the problem down by quite a bit and either distro kernel people could jump in (if the problem is solved in kernels newer than the one shipped) or kernel devs could notice if it is still present in the latest upstream one. This, and a good explanation of the procedures involved (git-bisect, ....) could maybe help some more.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/358545/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2009, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
