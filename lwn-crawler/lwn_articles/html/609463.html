        <!DOCTYPE html>
        <html lang="en">
        <head><title>Kernel.org news: two-factor authentication and more [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/609463/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/609255/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/609463/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>Kernel.org news: two-factor authentication and more</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>This article brought to you by LWN subscribers</b>
<p>
Subscribers to LWN.net made this article &mdash; and everything that
       surrounds it &mdash; possible.  If you appreciate our content, please
       <a href="/Promo/nst-nag3/subscribe">buy a subscription</a> and make the next
       set of articles possible.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>August 25, 2014</br>
           <hr>
<a href="/Articles/KernelSummit2014/">Kernel Summit 2014</a>
</div>
Kernel developers depend heavily on kernel.org for the hosting of Git
repositories and the management of patch flow in general, so it is not
surprising that the annual Kernel Summit sets aside a slot to discuss what
is happening with this site.  In recent years, there has been a lot of
change to discuss, mostly relating to the reorganization of kernel.org
management 
resulting from the compromise of the site in 2011.  The 2014 kernel.org
discussion, run by Konstantin Ryabitsev, shows that, in a lot of
ways, the pace of change is slowing, but the kernel.org maintainers are
still working to improve their support and make it more secure.
<p>
There are, Konstantin said, now 286 developer accounts on kernel.org â€” 34
more than one year ago. The number of Git trees hosted has grown
considerably; there are now 604 repositories on the site, most of which are
clones of the mainline kernel repository.  The Git "alternate" mechanism is
used to store these repositories, though, so there is only one copy of each
distinct object on the site.  That means that, despite hosting over 600
repositories, kernel.org only dedicates about 20GB of disk space to that
task.
<p>
There is a new front-end system being installed in Montreal; full off-site
backups will be performed to that system.  Once that is in place,
Konstantin said, the west coast of the United States could disappear
entirely.  "We'll miss you," but kernel.org will be able to recover and
continue serving repositories.
<p>
Two other front-end systems are in operation now, one in Palo Alto (hosted
by ISC) and one in Portland (hosted by the Tizen Association).  Previous efforts to place
front-end systems outside of North America seem to have fallen by the
wayside for the time being; these systems are expensive to run and the

<a href="/Articles/609465/"><img
src="https://static.lwn.net/images/conf/2014/ks/KonstantinRyabitsev-sm.jpg" alt="[Konstantin
Ryabitsev]" title="Konstantin Ryabitsev" border=0 hspace=3 vspace=3
align="right"></a> 

sponsorship support just isn't there.  The good news is that the problem
has been somewhat "sidestepped" with the creation of a set of mirrors on <a
href="https://kernel.googlesource.com/">kernel.googlesource.com</a>.  These
servers are located all around the world and should only be a few minutes
behind the main kernel.org servers.  Developers wanting to clone trees
can use this resource if kernel.org is too slow from their location.
<p>
Access in mainland China remains a bit problematic, though; the Google
servers are not reachable from there.  Konstantin said that the problem is being
worked on, but he offered no thoughts on when a China-based server might
become available.
<p>
Systems installed for kernel.org tend to be big, since they must support a
planet full of developers.  The recently installed "Si-Pi" system is an
exception, though.  It is a Raspberry-Pi-based system charged with the
generation of SHA hashes for files stored on the site.  This little
machine is plugged directly into the main storage array and goes about its
task without bothering the rest of the network.
<p>
Getting back to big systems, there is a new <a
href="http://mirrors.kernel.org/">mirrors.kernel.org</a> system going
into service in the near future.  The mirror network provides access to
distributions and more; it needs a lot of space.  The new box will feature
60TB of storage, a 
significant increase from the 16TB offered by the current system.  There
will be two mirror nodes, again hosted in Palo Alto and Portland.  A
European mirror is high on the list of things they would like to have, but
the funding isn't there.  These mirrors consume a lot of bandwidth, so it
is hard to find a host willing to take one on.
<p>
<h4>Two-factor authentication</h4>
<p>
The biggest change at kernel.org this year, though, is arguably the
addition of two-factor authentication for write access to repositories.
The 2011 compromise almost certainly started with the acquisition of SSH
keys from one or more developer laptops; it is important to be less exposed
to that type of attack in the future.  The removal of shell access has
certainly helped in that regard, but an attacker with access to an SSH key
could still corrupt a repository.  Two-factor authentication aims to
mitigate that risk.
<p>
The use of two-factor authentication is optional, at least for now, and can
be enabled on a per-repository basis.  It is not being forced on anybody,
and there will be no flag day where it must be used.  Only operations that
change repositories are affected by two-factor authentication; repositories
remain readable to all as always.  Authentication via <a
href="http://en.wikipedia.org/wiki/HMAC-based_One-time_Password_Algorithm">HOTP</a>
(as found in hardware tokens like the <a
href="/Articles/594498/">Yubikey</a> devices) and <a
href="http://en.wikipedia.org/wiki/Time-based_One-time_Password_Algorithm">TOTP</a>
(a time-based mechanism) is supported.
<p>
The kernel.org mechanism comes down to the whitelisting of IP addresses.
Each repository can have a list of one or more user/address pairs that have
been authenticated for write access.  When a user attempts to push a
repository update to kernel.org, the system will check to see if the
originating address has been whitelisted already; if so, the update
proceeds normally.  Otherwise, the push will be rejected.  The developer
would then run a command like:
<p>
<pre>
    ssh git.kernel.org 2fa val <i>token</i>
</pre>
<p>
Where <tt><i>token</i></tt> is a magic one-time token provided by the
authentication device.  Assuming the token validates, the originating IP
address will be whitelisted for the next 24&nbsp;hours.  Optionally,
developers can ask for a longer whitelisting period up to 30&nbsp;days. 
<p>
Authentication is per-user; in cases where multiple users have access to
the same repository, each must validate separately.  There are two modes
for the enabling of two-factor authentication on a repository; the "opt-in"
mode only enforces two-factor authentication for users who are enrolled,
while the "required" mode requires all users to be enrolled.
<p>
For developers who want to use TOTP, there are a few options available.
The proprietary <a
href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=en">Google
Authenticator</a> system is supported, as is <a
href="https://www.authy.com/">Authy</a>.  The best option, though,
according to Konstantin, is <a
href="/Articles/581086/">FreeOTP</a>, which was forked from
Google Authenticator before it went proprietary.  In the end, though, most
developers may opt for hardware-based authentication instead.  To help in
that regard, Konstantin was passing out Yubikey devices from a bag donated
by Yubico.

<p>
Linus Torvalds and Greg Kroah-Hartman, it seems, have been using two-factor
authentication for 
about a month without any serious ill effects.  With a couple of the
toughest customers already satisfied, chances are that the new two-factor
authentication mechanism will catch on without much in the way of major
hitches.  And that, in turn, should help to improve the security of
kernel.org and boost confidence in the security of the kernel code base
going forward.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Development_tools-Infrastructure">Development tools/Infrastructure</a></td></tr>
            <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Kernel.org">Kernel.org</a></td></tr>
            <tr><td><a href="/Archives/ConferenceIndex/">Conference</a></td><td><a href="/Archives/ConferenceIndex/#Kernel_Summit-2014">Kernel Summit/2014</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/609463/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor609522"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">How the two-factor authentication is done?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 25, 2014 18:54 UTC (Mon)
                               by <b>jnareb</b> (subscriber, #46500)
                              [<a href="/Articles/609522/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
How the two-factor authentication is done from server side? What tools are used to implement it?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/609522/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor609523"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">How the two-factor authentication is done?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 25, 2014 18:55 UTC (Mon)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/609523/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Not sure, but there's the oathtool[1] project I have which I use to have a TOTP client-side implementation on my machines (and not just my mobile devices).<br>
<p>
[1]<a href="http://www.nongnu.org/oath-toolkit/man-oathtool.html">http://www.nongnu.org/oath-toolkit/man-oathtool.html</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/609523/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor609524"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">How the two-factor authentication is done?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 25, 2014 18:56 UTC (Mon)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/609524/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Bleh, bad wording from an incomplete edit. It's not my project; I'm just a user.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/609524/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor609527"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">How the two-factor authentication is done?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 25, 2014 19:15 UTC (Mon)
                               by <b>mricon</b> (subscriber, #59252)
                              [<a href="/Articles/609527/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It uses totpcgi integration with gitolite:<br>
<a href="https://github.com/mricon/totp-cgi/tree/master/contrib/gitolite">https://github.com/mricon/totp-cgi/tree/master/contrib/gi...</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/609527/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor609538"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">How the two-factor authentication is done?</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 26, 2014 0:44 UTC (Tue)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/609538/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Ooh. That looks really nice. *adds to the TODO list*<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/609538/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor609533"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Kernel.org news: two-factor authentication and more</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 25, 2014 20:43 UTC (Mon)
                               by <b>NightMonkey</b> (subscriber, #23051)
                              [<a href="/Articles/609533/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
"Systems installed for kernel.org tend to be big, since they must support a planet full of developers. The recently installed "Si-Pi" system is an exception, though. It is a Raspberry-Pi-based system charged with the generation of SHA hashes for files stored on the site. This little machine is plugged directly into the main storage array and goes about its task without bothering the rest of the network."<br>
<p>
Awesome. More is coming. A new hardware revolution is in progress. Fun! :)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/609533/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor609616"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Kernel.org news: two-factor authentication and more</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 27, 2014 2:07 UTC (Wed)
                               by <b>zblaxell</b> (subscriber, #26385)
                              [<a href="/Articles/609616/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That thing is either a tiny, unassailable digital fortress...or the weakest link in the whole security chain.  I don't know which way to bet.  ;)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/609616/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor609935"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Kernel.org news: two-factor authentication and more</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 29, 2014 14:58 UTC (Fri)
                               by <b>Cato</b> (guest, #7643)
                              [<a href="/Articles/609935/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Quite a nice service for those who don't want to roll their own mobile apps, servers, and admin features (revoke lost phones/tokens, enroll new ones, send bypass codes) is Duo Security - free for up to 10 users and has a nice SDK etc - <a href="https://www.duosecurity.com/">https://www.duosecurity.com/</a><br>
<p>
The admin and recovery features of 2FA are often neglected - while HOTP and particularly TOTP are nice, the acid test is how easy is it for an admin, or a user, to recover from a phone that gets lost with all the TOTP secret keys (i.e. seeds) for 10-20 services.  Enrolling a 2nd token (maybe a hardware token) is one way, but that requires interaction with every service.<br>
<p>
I don't think there's a great solution to any of this, and I'm not aware of any open source tools, but I'd urge anyone looking at TOTP or HOTP to think about the recovery scenarios.  Phones do get lost or stolen, along with the seeds for many services, so quick recovery is important for security and continued access for the user.<br>
<p>
From a security POV you also need to watch out for what happens to the TOTP secrets/seeds in your phone app, or the hardware token.  Stolen/lost phones mean the seeds are in the hands of a possible attacker, requiring quick reset - but at least mobile phone apps can permit that with the right TOTP server setup. Stolen/lost tokens are less of an issue as the seeds are usually held in RAM (but cold boot attacks may apply) - and there's the issue of the token factory, which normally has the keys from when they were manufactured.<br>
<p>
Yubikey is an interesting option (can also work with Duo or directly with suitable services) - it's a HOTP-supporting hardware token so no timer, but you can configure it with fresh keys when you issue the token.  So the keys are as secure as you can make them and you can re-key quite easily.  <br>
<p>
The only downside of Yubikey is the lack of timer required for TOTP, so that requires a helper app on your computer or Android phone (with NFC).    I'd strongly recommend Yubikey NEO for TOTP, as that lets you store a whole set of TOTP seeds on the Yubikey, whereas the older Yubikey standard only lets you store one TOTP seed per slot (max 2 per token). See <a href="http://www.yubico.com/products/yubikey-hardware/yubikey-neo/">http://www.yubico.com/products/yubikey-hardware/yubikey-neo/</a> - not cheap though.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/609935/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor609966"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Kernel.org news: two-factor authentication and more</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 29, 2014 16:04 UTC (Fri)
                               by <b>mstone_</b> (subscriber, #66309)
                              [<a href="/Articles/609966/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Is there any public info on this Si-Pi thing?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/609966/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor610687"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Kernel.org news: two-factor authentication and more</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 4, 2014 5:29 UTC (Thu)
                               by <b>madhatter</b> (subscriber, #4665)
                              [<a href="/Articles/610687/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The new-generation Yubikeys can do TOTP, too, in conjunction with a smartphone to provide time data.  The Yubikey acquires the data over NFC, processes it cryptographically, then returns the TOTP code over the same NFC channel.<br>
<p>
I have a Yubikey Neo doing TOTP via the free (libre, gratis) Yubico Authenticator program for Android, which I use in production.<br>
<p>
Disclaimer: I have no connection with Yubico, I just like their product and use it in real life.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/610687/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2014, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
