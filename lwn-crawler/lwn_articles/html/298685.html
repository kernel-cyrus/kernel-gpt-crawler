        <!DOCTYPE html>
        <html lang="en">
        <head><title>KS2008: Tracing [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/298685/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/298685/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>KS2008: Tracing</h1>
</div>
<div class="ArticleText">
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>September 17, 2008</br>
           <hr>
LWN's <a href="/Articles/KernelSummit2008/">2008 Kernel Summit coverage</a>
</div>
Tracing is a hot issue in the Linux community, mostly as the result of the
actions of an allegedly friendly company: Sun Microsystems has been putting
a lot of marketing energy into telling customers that DTrace makes Solaris
a better system.  The fact of the matter is that Linux does not lack
tracing tools, but it <i>does</i> seem to lack tools which are usable to
the wider community.  The second day of the 2008 kernel summit started with
a pair of sessions dedicated to determining where the gaps are and trying
to figure out what to do about them.
<p>
James Bottomley started with a description of his experiences with
SystemTap, the utility which is most often cited as our answer to DTrace.
He had a lot of trouble getting it to work with his system.  In his mind,
the root cause for all this trouble is the simple fact that nobody from the
development community is actually using SystemTap.  A quick query of the
room suggested that about half of the developers present had tried using
SystemTap at one point or other; maybe 20% actually succeeded.  So there is
a roadblock of sorts here; SystemTap needs attention from kernel developers
to progress, but those developers find it unsuited to their needs and
difficult to use, so they tend to ignore it.
<p>

But kernel developers are not the targeted user base for a tool like
SystemTap; it is aimed at end users and deployed systems.  To help clarify
what those users need, Vinod Kutty from the Chicago Mercantile Exchange
took some time to talk about his needs for tracing tools.  In general,
these users need a higher level of visibility into running, production
systems.  They need to be able to track down slowdowns, look at the
environment in which processes are running, and, in general, to be able to
look in corners of the system which nobody will have anticipated in
advance.  All of this has to happen while the system is running in
production; it is, he says, somewhat like needing to look under the hood of
a car while driving at 100mph.
<p>

Also useful is the ability to run tracing tools in a "flight recorder"
mode, where an administrator can look at historical data after something
goes wrong.  And it is necessary to be able to look at user-space events as
well as those from the kernel.  Events generated in user space are often
more meaningful to the people running the system.  All of this is needed to
be able to communicate with distributors about where the problems come up,
so that the distributor can work toward a fix.  Current tracing tools for
Linux are insufficient.
<p><blockquote class="ad">
<b><tt>$ sudo subscribe today</tt></b>
<p>
Subscribe today and elevate your LWN privileges. You’ll have
access to all of LWN’s high-quality articles as soon as they’re
published, and help support LWN in the process.  <a href="https://lwn.net/Promo/nst-sudo/claim">Act now</a> and you can start with a free trial subscription.
</blockquote>
<p>

Linus asked: is tracing needed primarily to track down bugs or to find
performance issues?  It turns out that performance problems are the big
issue.  James asked what parameters were the most important; the answer
mentioned individual process I/O events, user-space events, and the ability
to map user events to kernel-level events.
<p>

Moving on, Vinod also noted that low impact is important; the tracing tool
cannot place a heavy load on the system.  These tools need to start
quickly.  Current tools are far too big.  There is also a need for good
filtering; tracing tools can generate a <i>lot</i> of data.  Administrators
and developers need a way to boil down all that data to an amount they can
deal with.  Even better are tools which can spot problems in the trace
stream and raise red flags when they happen.
<p>

And, of course, tracing tools really cannot crash the system while they are
running.  SystemTap still falls a little short in this area; it's not hard
to bring down a system while trying to trace it.  Adding a DTrace-style
virtual machine was discussed; in theory, a VM can make the tracing tool
demonstrably safer.  Vinod responded that it could be useful, but the proof
of maturity is in watching the software run for a while.
<p>

This is where Linus came in to proclaim that he hates every tracing tool he
has seen.  SystemTap is far too complicated; these tools need to be
simpler.  Adding a virtual machine to SystemTap would just make things more
complicated; that's not the way to fix its problems.  According to Linus,
most of the problems solved by tracing come down to figuring out scheduling
issues, and we have the tools to do that now.  We should be making better
use of the simple tools which are currently in the kernel before trying to
put more complicated 
stuff in.  We should, for example, make latencytop work better
and push to get it into the enterprise distributions.  This "use the tools
we already have" suggestion came back many times during the session.

<p>
Christoph Hellwig brought up another recurring theme: while dynamic tracing
is nice, there is a lot of value to be had from well-placed static trace
points which are managed by the maintainer of the code.  Matthew Wilcox
added that the user-space trace points (for DTrace) added to PostgreSQL have
proved to be highly useful for database administrators; people running
PostgreSQL now have a strong motivation to do so on Solaris systems.  We
would do well to match that functionality on Linux.

<p>
A key component of SystemTap is the collection of "tapsets," scripts which
allow a user to look into the kernel for specific information.  These
tapsets are a problem, though; they are tightly tied to a specific kernel,
but the kernel is constantly being changed.  So tapsets go stale quickly.
Moving these tapsets into the kernel might help, but they will still be a
separate body of code which is prone to breaking.  Static trace points,
which can be maintained directly with the code they monitor, are much more
likely to continue to work in the long term.
<p>
Martin Bligh noted that Google maintains a set of 20-30 static trace points
for use with the LTTng trace tool.  This very small set of trace
points is sufficient to solve most problems that Google encounters.  Martin
will, hopefully, be posting those trace points for inclusion into the
mainline, though Google's associated tools might not be available.
<p>
Vinod finished this portion of the session by stating the he likes the
tapset concept.  It allows him (or somebody in his group) to write a script
aimed at a specific situation, and others can make use of it immediately.
There's no need to wait for the release of a more specialized tool.
<p>
<h3>Trace toolkits</h3>
<p>
Mathieu Desnoyers spent a few moments introducing the <a
href="http://ltt.polymtl.ca/">LTTng</a> tracing package.  LTTng is a static
tracing tool, depending on markers placed in the kernel itself.  It has
been designed for high performance and simplicity; that, in turn, should
help to make it safe to use on production systems.  All LTTng trace points
have to be in the kernel code itself and be maintained by the appropriate
subsystem maintainers.
<p>
The core kernel code includes a module for precise time stamping (needed to
preserve the ordering of events which go through different per-CPU relay
buffers), the relaying code, and a netlink-driven module to control
tracing.  There is a user-space library and, of course, a set of analysis
tools.  LTTng can support "flight recorder" mode which can initiate tracing
when a specific trigger situation comes about.  There is also a mechanism
for putting markers into user space.
<p>
Frank Eigler spent some time talking about SystemTap; he used much of that
time to 
defend the design decisions which had been made.  When the SystemTap
project started, the kernel had almost no tracing features at all, so
they had to pick a path that worked.  Since there is a lot of hostility to
putting a virtual machine into the kernel, they had to go with code
generation instead.  They used kprobes because that was the mechanism that
was available.  And so on.  In general, SystemTap has a lot of the same
objectives as LTTng, plus, of course, the dynamic tracing feature.  There
are "some demos" showing working user-space tracing.
<p>
James stated that there was a real need for the users of these tools -
kernel developers, in this case - to provide input into how they work.
Frank responded that the SystemTap team has been crying out for people to
help.  It's clear, though, that this particular user base is not
sufficiently engaged in the development process.  It was said that the real
users of SystemTap are Red Hat consultants, who find that it works well
with the standard RHEL kernel.  But people trying to use SystemTap with a
current mainline kernel have to download "a shaky weekly tarball" to try to
make it work.  Until SystemTap is easier to use with the mainline kernel,
it will be a hard sell in the development community.
<p>
The problem there, of course, is that keeping SystemTap current while it is
out of the mainline tree is always going to be a struggle.  Resolving that
problem will require getting more of that code merged.  It seems that the
core SystemTap code is about 15,000 lines - small, according to Frank.
This could maybe go in, but Linus is resistant, saying that we need to get
the current, simple, in-kernel tracing tools into a usable state before we
try to add more of them.
<p>
Ted Ts'o remarked that there is a real difference with SystemTap: it is the
only Linux-based tracing package which, like DTrace, allows users to run code at the
trace points.  Thus it is able to do more complicated triggering,
filtering, and analysis.  Thomas Gleixner responded that this is all good,
but what is really needed is a simple trace package which does not require
the installation of a whole set of new tools.  He does tracing (using
ftrace) on a number of platforms, including embedded systems, and he isn't
willing to deal with the hassle involved in adding another complicated set
of software.
<p>
After that the conversation wandered into various, relatively obscure
technical topics like the details of how buffering mechanisms should work,
who should really be managing trace points, who manages instrumentation as
a whole, and so on. But there was a general sense that the summit wasn't
the venue for that kind of low-level detail, which isn't where the real
problems are anyway.  The tracing topic will be revisited at the Linux
Plumbers Conference, so it was decided to defer much of the discussion of
the details until then.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Tracing">Tracing</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/298685/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor298951"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 18, 2008 4:27 UTC (Thu)
                               by <b>bronson</b> (subscriber, #4806)
                              [<a href="/Articles/298951/">Link</a>] (20 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Did anybody mention the Linux dtrace port?  <a href="ftp://crisp.dynalias.com/pub/release/website/dtrace/">ftp://crisp.dynalias.com/pub/release/website/dtrace/</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/298951/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor298953"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 18, 2008 4:35 UTC (Thu)
                               by <b>fuhchee</b> (guest, #40059)
                              [<a href="/Articles/298953/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
LWN doesn't allow a simple "no" for an answer, so<br>
this is a sentence stating "no".<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/298953/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor298962"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 18, 2008 5:19 UTC (Thu)
                               by <b>corbet</b> (editor, #1)
                              [<a href="/Articles/298962/">Link</a>] (17 responses)
      </p>
      
      </div>
      </summary>
      No mention of the DTrace port.  The licensing of Linux makes a DTrace port undistributable by anybody, so it is not of any practical interest.
      
          <div class="CommentReplyButton">
            <form action="/Articles/298962/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor299020"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 18, 2008 10:15 UTC (Thu)
                               by <b>zdzichu</b> (subscriber, #17118)
                              [<a href="/Articles/299020/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It's a learning material. From all discussion about Linux tracing I get a feeling that no Linux kernel developer seen DTrace in action. And no one exactly knows what they compete against. It would be nice if kernel developers tried DTrace, learn about problems it helped to solve (there are many reports on blogs) and saw how powerful yet easy it is.<br>
<p>
DTrace is wonderfully usable by Joe random admin and is generic enough to stop blooming of specialised tracing frameworks. Sure, latency top is cool, powertop is cool, usbmon is cool, blktrace is cool, but each of them needs its own hooks in kernel. On Solaris, powertop is implemented on top of DTrace, without modifing kernel.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299020/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor299145"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 18, 2008 16:56 UTC (Thu)
                               by <b>zooko</b> (guest, #2589)
                              [<a href="/Articles/299145/">Link</a>] (15 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It could be of practical interest if someone wanted to download it and install it and use it, right?<br>
<p>
Also, I find it hard to imagine that some Linux copyright holder would sue you if you redistributed it to a third party.  That would be interesting.  I would almost want to be sued (for what -- monetary damages?  An injunction forbidding me to keep redistributing it?) just to see it happen.<br>
<p>
Unfortunately, I don't have time today to download the dtrace port, combine it with the Linux kernel, and put it up on my web server for redistribution.  Maybe tomorrow.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299145/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor299272"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 19, 2008 1:48 UTC (Fri)
                               by <b>njs</b> (guest, #40338)
                              [<a href="/Articles/299272/">Link</a>] (14 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
But the point is that it doesn't matter if you redistribute it; in the big picture it only matters if major distros start redistributing it.<br>
<p>
And no major distro's legal department is going to let them blatantly violate the copyrights of everyone on lkml and open themselves up to legal action.  (But at least SCO would finally have a valid case against Novell!)<br>
<p>
So don't let me stop your fun, but you're kind of tilting at windmills, to prove some sort of point that I don't quite see...<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299272/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor299355"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 19, 2008 12:22 UTC (Fri)
                               by <b>zooko</b> (guest, #2589)
                              [<a href="/Articles/299355/">Link</a>] (13 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Hm...  Wouldn't this mean that the dtrace-for-linux code is in the exact same legal status as the "proprietary codecs" that various distributions have various ways of dealing with?<br>
<p>
For example:<br>
<p>
<a href="http://fedoraproject.org/wiki/ForbiddenItems#MP3_Support">http://fedoraproject.org/wiki/ForbiddenItems#MP3_Support</a><br>
<p>
<a href="https://help.ubuntu.com/community/RestrictedFormats">https://help.ubuntu.com/community/RestrictedFormats</a><br>
<p>
In both cases, there is some source code which is legal for end-users to use, but (perhaps?) not legal for Linux distributions to distribute.<br>
<p>
If I'm right that this is the same legal situation, then this implies that it is legally possible for dtrace-on-linux to be as widely used as MP3-on-linux is.  :-)<br>
<p>
Regards,<br>
<p>
Don Quizooko<br>
<p>
P.S.  I love tilting at windmills.  Every now and then you get a solid hit on those titanic monsters.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299355/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor299503"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 20, 2008 1:37 UTC (Sat)
                               by <b>rahulsundaram</b> (subscriber, #21946)
                              [<a href="/Articles/299503/">Link</a>] (12 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Copyright incompatibilities affect everybody. Patent encumbrances are more region specific. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299503/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor299533"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 20, 2008 14:43 UTC (Sat)
                               by <b>zooko</b> (guest, #2589)
                              [<a href="/Articles/299533/">Link</a>] (11 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That's a good point.  A more precise comparison then would be copyright-restricted codecs or the Microsoft fonts, or copyright-restricted drivers.<br>
<p>
How's that for a comparison?  The legal constraint on using dtrace or ZFS on Linux is exactly the same as the legal constraint on using a proprietary hardware driver on Linux.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299533/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor299558"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 21, 2008 4:43 UTC (Sun)
                               by <b>njs</b> (guest, #40338)
                              [<a href="/Articles/299558/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That sounds accurate.<br>
<p>
I note that proprietary hardware drivers *suck* in many, many ways.  They make your system impossible to provide support for, which is kind of a problem for a product whose core market is high-end enterprise production servers.  They break things horribly and regularly -- and dtrace is obviously *much* more intrusive than your average driver.  They're a huge pain to use and maintain -- is there any reason to think that the guy porting dtrace will be more successful at tracking linux mainline than RH's engineers are with systemtap?  And will it even be possible to load as a module, or will you have to patch your core kernel/rebuild/reboot?  <br>
<p>
And, perhaps worst, they create all kinds of obnoxious arguments that divide the community -- look at any discussion of nvidia drivers, or the dtrace discussions here.  Part of the magic of FOSS is that normally the enthusiasts, the law-skirters, the enterprise distros, the big-iron vendors, the small consultants, etc. etc. can all work towards common goals, and all provide necessary value at different parts of a system's lifecycle.  When people spend their time yelling at each other over whether nVidia's drivers are legal or whether systemtap/btrfs/whatever is worth the effort, we all lose.<br>
<p>
Which maybe shouldn't be surprising, since all the evidence suggests that one of Sun's strategic goals in choosing to license dtrace and ZFS in a Linux-incompatible way was to create exactly this sort of division within the FOSS community, and thus give Solaris a competitive chance.  What I'm still not clear on is which of these titanic monsters you're going after, exactly...<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299558/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor299574"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 21, 2008 12:39 UTC (Sun)
                               by <b>zooko</b> (guest, #2589)
                              [<a href="/Articles/299574/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Wait, that's a different argument.  The original statement by bronson was  Argument 1: that the licensing issues make dtrace "undistributable by anybody, so therefore not of any practical interest".  NJS added that it "only matters if major distros start redistributing it".<br>
<p>
But this original argument is not true.  At least, it is true only inasmuch as it is also true that the licensing issues of nvidia drivers make them undistributable by anyone, so therefore not not of any practical interest.<br>
<p>
Now you're making two other arguments.  If I understand correctly, Argument 2: If people do use kernel modules or patches with this kind of legal restriction, it is hard to support and tends to break.  and Argument 3: It distracts the community with inflammatory bickering about legal issues.<br>
<p>
I don't necessarily disagree with either of those.  I personally have gone to great effort to get Free Software drivers for my graphics cards.  On the other hand, I have occasionly fallen back to using the proprietary graphics card drivers when needed.  I think it could be useful to people to understand that even if the latter two arguments are valid, the first one wasn't: dtrace and ZFS are exactly as legally-portable-to-linux as are proprietary graphics card drivers.<br>
<p>
Regards,<br>
<p>
Zooko<br>
<p>
P.S.  Oh wait, I'm not sure if I agree with Argument 2.  Argument 2 is a strong argument when we're talking about proprietary, closed-source software, but dtrace and ZFS are Free and Open source, so I'm not sure that it would be as fragile and problematic as proprietary drivers.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299574/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor299582"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 21, 2008 18:38 UTC (Sun)
                               by <b>njs</b> (guest, #40338)
                              [<a href="/Articles/299582/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;But this original argument is not true. At least, it is true only inasmuch as it is also true that the licensing issues of nvidia drivers make them undistributable by anyone, so therefore not not of any practical interest.</font><br>
<p>
It's still of no practical interest to kernel developers, distributors, enterprise users, and many others.  Jon's (not bronson's) comment was totally reasonable in context -- a kernel developers' discussion about what enterprise-funded developers should work on!<br>
<p>
But fair enough -- there may be (probably are) others who find linux-dtrace of practical interest.<br>
<p>
But arguments 2 and 3 are linked to this -- to the extent that such people use linux-dtrace, the harms described in those arguments swing into effect.  To the extent they avoid linux-dtrace, the harms are abated -- with a trade-off: then they lose dtrace's benefits.  There's a tragedy of the commons danger here; the costs of supporting inscrutably broken systems and inflammatory bickering are borne by the community, while the benefits of dtrace are received only only by individuals.  Plus, people using/supporting linux-dtrace are not doing themselves any favors in the long run, because it's clearly a dead-end; it's better than nothing, but getting a great solution will require abandoning it and switching to one of the other systems that linux-dtrace sucks the oxygen away from.<br>
<p>
So I guess 2 &amp; 3 are arguments for why if we encounter someone for whom linux-dtrace is of practical interest, we should attempt to stop them ;-).<br>
<p>
<font class="QuotedText">&gt;dtrace and ZFS are exactly as legally-portable-to-linux as are proprietary graphics card drivers.</font><br>
<p>
As a side-point, I'm actually not convinced, at least for dtrace.  The nvidia driver uses two tricks: it makes a serious attempt not to be a derived work of the kernel, by including a Free shim layer to basically a windows driver.  And it's always distributed separately from the kernel -- otherwise you're distributing a combined, thus derived, thus un-distributable, work.  Even the little distros that tried to play fast and loose seem to have given in on this point.<br>
<p>
Dtrace is far more intrusive than a graphics driver, and in copyright relevant ways -- it needs to muck around with other people's code to put hooks in.  That makes both of the above tricks hard to achieve.  Maybe not impossible, I don't know.  From his rhetoric about licenses, I haven't gotten the impression that Paul Fox is being that careful.  I would not tell people that linux-dtrace as it exists is legal to distribute at all without knowing many more details.<br>
<p>
<font class="QuotedText">&gt;Argument 2 is a strong argument when we're talking about proprietary, closed-source software, but dtrace and ZFS are Free and Open source, so I'm not sure that it would be as fragile and problematic as proprietary drivers.</font><br>
<p>
It's true the problems are worse for proprietary drivers, but they're quite bad even for plain old out-of-tree drivers.  (Note part of the discussion above is about RH's systemtap team's trouble keeping sync with mainline!)  And worries about license contamination are an extra burden on top of that.<br>
<p>
Sorry for nattering on so!<br>
-- Nathaniel<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299582/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor299565"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 21, 2008 9:29 UTC (Sun)
                               by <b>paulj</b> (subscriber, #341)
                              [<a href="/Articles/299565/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <p><blockquote>The legal constraint on using dtrace or ZFS on Linux is exactly the same as the legal constraint on using a proprietary hardware driver on Linux.</blockquote>
</p><p>
Uh, not really. DTrace is free software..
</p>




      
          <div class="CommentReplyButton">
            <form action="/Articles/299565/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor299572"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 21, 2008 11:22 UTC (Sun)
                               by <b>Jonno</b> (subscriber, #49613)
                              [<a href="/Articles/299572/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
But it's not GPL compatible, so the *legal* constraints are the same.<br>
<p>
Morally and technically it's another matter however, as the source *is*<br>
availible, and *can* be fixed if nessesary...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299572/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor299659"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 22, 2008 10:58 UTC (Mon)
                               by <b>paulj</b> (subscriber, #341)
                              [<a href="/Articles/299659/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
And yet Linux distros still manage to ship these proprietary, binary-only drivers, despite these terrible legal constraints. <br>
<p>
With DTrace being free-software, there isn't even much of a moral hazard...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299659/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor299671"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 22, 2008 13:57 UTC (Mon)
                               by <b>corbet</b> (editor, #1)
                              [<a href="/Articles/299671/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      The number of Linux distributions shipping binary-only drivers has gotten quite small; there are good reasons for that.
<p>
DTrace presents a different hazard; imagine a Sun-turns-SCO scenario, for example.  The fact that Sun does not appear to be interested in taking that path now is irrelevant; neither was Caldera, once upon a time.
      
          <div class="CommentReplyButton">
            <form action="/Articles/299671/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor299674"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 22, 2008 14:54 UTC (Mon)
                               by <b>paulj</b> (subscriber, #341)
                              [<a href="/Articles/299674/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There's no hazard from Sun, as the CDDL licensed DTrace bits can be combined just fine with GPL bits, as far as the former licence is concerned. The hazard is from a Linux kernel copyright holder turning SCO on Linux distributors, I thought we had established in an earlier discussion.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299674/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor299681"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 22, 2008 15:42 UTC (Mon)
                               by <b>zooko</b> (guest, #2589)
                              [<a href="/Articles/299681/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Wait, what happens if Sun decides to try to use all of its copyrights to sue Linux distributors or users or otherwise to do harm to Linux development?  Haven't they already granted a permanent, irrevocable Free Software licence over the current versions of DTrace and ZFS, in the form of the CDDL?<br>
<p>
I have a feeling that you already addressed this in your "What if Sun turns Evil?" article, but I don't recall any actual problems that could result from use of DTrace or ZFS source code.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299681/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor299703"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 22, 2008 17:33 UTC (Mon)
                               by <b>njs</b> (guest, #40338)
                              [<a href="/Articles/299703/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Well, there is Sun's ongoing refusal to answer questions like "Are you willing to grant a license to any ZFS patents you hold to other FOSS implementations?", which creates at least a cloud of uncertainty about what they might do if they became evil, or just decided that Linux was catching up with Solaris and threatening them.<br>
<p>
Unless they have changed their mind and answered this at some point.  I hope so -- haven't followed closely.<br>
<p>
But paulj is right re: copyrights; Sun wrote the CDDL in such a way that combining CDDL and GPLv2 violates the GPL but not the CDDL.  This has the same effect in practice as not granting permission, but it means that for copyright issues we don't need to worry about Sun-turns-SCO -- we need to worry about SCO-turns-SCO.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299703/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor299575"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 21, 2008 12:43 UTC (Sun)
                               by <b>zooko</b> (guest, #2589)
                              [<a href="/Articles/299575/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That's a really good point that DTrace is Free Software.  I just now eventually came around to realizing the relevance of that in another post on this thread.<br>
<p>
However, my point here was that resulting restrictions on use and redistribution are similar:<br>
<p>
The copyright holder on DTrace has granted permission to use it in Linux systems, but the GPL which governs redistribution of Linux source code forbids redistributing derived works which include non-GPL'ed code such as DTrace.<br>
<p>
This winds up imposing the same sort of restriction on users and distributors that a proprietary driver does: the copyright holder of the proprietary driver grants you the right to use it in your Linux kernel, but the Linux licence forbids you to redistribute it (assuming the current standard interpretation of GPL applied to this issue).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299575/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor299215"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">dtrace on Linux</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 18, 2008 20:10 UTC (Thu)
                               by <b>SEJeff</b> (guest, #51588)
                              [<a href="/Articles/299215/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<a href="http://www.crisp.demon.co.uk/blog/">http://www.crisp.demon.co.uk/blog/</a> his blog is pretty interesting to watch also. He doesn't update it super often, but it is always something good.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299215/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor299334"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">KS2008: Tracing</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 19, 2008 10:37 UTC (Fri)
                               by <b>mjw</b> (subscriber, #16740)
                              [<a href="/Articles/299334/">Link</a>] 
      </p>
      
      </div>
      </summary>
      Nice to see immediate results from this in the systemtap code base.
<p>
<i>Also useful is the ability to run tracing tools in a "flight recorder" mode, where an administrator can look at historical data after something goes wrong.</i>
<p>
<pre>
commit 2fa2a091a0b248855d7f77aa20677ef4c7a7cc61
Author: Nobuhiro Tachino &lt;tachino@jp.fujitsu.com&gt;
Date:   Tue Sep 16 22:04:02 2008 -0400

    add new stap -F (flight recorder) option that just passes through to staprun -L
</pre>
      
          <div class="CommentReplyButton">
            <form action="/Articles/299334/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor299408"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">DTrace != Marketing endeavor</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 19, 2008 17:19 UTC (Fri)
                               by <b>bcantrill</b> (guest, #31087)
                              [<a href="/Articles/299408/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This piece -- as with your several others on the subject -- is generally quite strong, and balanced with respect to DTrace.<br>
<p>
There is, however, one issue I would like to lay to rest.  DTrace is not, contrary to ongoing assertions here and elsewhere, a marketing endeavor.  DTrace has succeeded because we (Team DTrace) worked damned hard for a damned long time solving a damned hard problem -- and we succeeded at a time when the world didn't want to hear anything that wasn't "Linux" (trust me on this).  Far from putting "a lot of marketing energy" into telling customers about DTrace,  Sun has put virtually no marketing dollars into DTrace, and it (ironically) took a herculean effort on our part to get even the most basic marketing support.  (As an example:  when we held a DTrace un-conference this past March, it was a Sun partner who stepped up to pay for it.)  It's especially grating when we are accused of "hyping" aspects of the technology -- safety in particular -- that are foundational in nature.  We are not and have not "hyped" our safety -- but we (and particular, I) have also not hesitated to point out the architectural differences between DTrace and SystemTap in this regard, e.g.:<br>
<p>
  <a rel="nofollow" href="http://blogs.sun.com/bmc/entry/dtrace_safety">http://blogs.sun.com/bmc/entry/dtrace_safety</a><br>
<p>
Providing motivation for architectural decisions is not "marketing", it's technology -- and you mar your otherwise strong work when you dismiss it as being something less...<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299408/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor299482"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">DTrace != Marketing endeavor</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 19, 2008 22:02 UTC (Fri)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/299482/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'm surprised by dtrace not getting marketing $$$: I've heard more people <br>
raving about dtrace than every other feature of Solaris put together, even <br>
than things like ZFS and zones. dtrace *should* be a marketing endeavour <br>
in the sense that marketing loves it and pushes it hard, because it rocks <br>
and customers love it. (The license incompatibility is really annoying. <br>
I'd like to see dtrace everywhere but this is impossible until someone <br>
shoots the current copyright system or reimplements all of dtrace, what a <br>
waste of time.)<br>
<p>
i.e. this is as opposed to the sort of marketing endeavour where marketing <br>
lies to customers with ridiculously overblown promises ("our program will <br>
make your coffee for you and can replace all your staff with AIs which <br>
don't need paying"), makes up features that don't exist, or outright makes <br>
up features that are only implementable in a parallel universe with <br>
different maths ("[system] analyses your programs and warns about all <br>
those that will halt" as one project I declined to work on was described).<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299482/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor299486"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">DTrace != Marketing endeavor</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Sep 19, 2008 22:21 UTC (Fri)
                               by <b>bcantrill</b> (guest, #31087)
                              [<a href="/Articles/299486/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
To be fair, I should point out that the lack of marketing focus on DTrace was somewhat deliberate on our part:  we kept any and all marketing folks in the dark until we had satisfied customers.  (I've always believed in talking as little as possible about what you're working on until you have cut enough code to back up any claims.)  Once we had a bevy of happy customers, our marketing folks gladly talked about it -- but it was never a focus on their part, and the reception of DTrace in the marketplace certainly has nothing to do with their efforts.  Anyway. you can imagine the frustration in repeatedly hearing the success of DTrace being attributed to non-existent marketing efforts... ;)<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/299486/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2008, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
