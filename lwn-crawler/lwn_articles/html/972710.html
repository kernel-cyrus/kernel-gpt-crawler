        <!DOCTYPE html>
        <html lang="en">
        <head><title>Another push for sched_ext [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/972710/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/973074/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/972710/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>Another push for sched_ext</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>We're bad at marketing</b>
<p>
We can admit it, marketing is not our strong suit. Our strength is
writing the kind of articles that developers, administrators, and
free-software supporters depend on to know what is going on in the
Linux world. Please <a href="/Promo/nsn-bad/subscribe">subscribe today</a> to help us keep doing that, and so
we don’t have to get good at marketing.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>May 9, 2024</br>
           </div>
The extensible scheduler class (or "sched_ext") is a comprehensive
framework that enables the implementation of CPU schedulers as a set of BPF
programs that can be loaded at run time.  Despite having attracted a fair
amount of interest from the development community, sched_ext has run into
considerable opposition and seems far from acceptance into the mainline.
The posting by Tejun Heo of <a
href="/ml/linux-kernel/20240501151312.635565-1-tj@kernel.org/">a new
version of the sched_ext series</a> at the beginning of May has restarted
this long-running discussion, but it is not clear what the end result will
be.
<p>
As a quick refresher: sched_ext allows the creation of BPF programs that
handle almost every aspect of the scheduling problem; these programs can be
loaded (and unloaded) at run time.  Sched_ext is designed to safely fall
back to the completely fair scheduler should something go wrong (if a
process fails to be run within a time limit, for example).  It has been
used to create a number of special-purpose schedulers, often with
impressive performance benefits for the intended workload.  See <a
href="/Articles/922405/">this 2023 article</a> for a more detailed overview
of this work.
<p>
Heo lists a number of changes that have been made to sched_ext since <a
href="/ml/linux-kernel/20231111024835.2164816-1-tj@kernel.org/">the
previous version</a> was posted in November.  For the most part, these
appear to be adjustments to the BPF API to make the writing of schedulers
easier.  There is also a new shutdown mechanism that, among other things,
disables the BPF scheduler during power-management events like system
suspend.  There is now support for CPU-frequency scaling, and some
debugging interfaces have been added to make developing schedulers easier.
The core design of sched_ext appears to have stabilized, though.
<p>
<h4>Increasing interest</h4>
<p>
Even before getting to the changes, though, Heo called attention to the
increasing interest in sched_ext that is being shown across the community
and beyond.  Valve is planning to use sched_ext for better game scheduling
on the Steam Deck.  Ubuntu <a
href="https://bugs.launchpad.net/ubuntu/+source/linux/+bug/2045503">is
considering shipping it</a> in the 24.10 release.  Meta and Google are
increasing their use of it in their production fleets.  There is also
evidently interest in using it in ChromeOS, and Occulus is looking at it as
well.  Heo concludes that section with:
<p>
<blockquote class="bq">
	Given that there already is substantial adoption which continues to
	grow and sched_ext doesn't affect the built-in schedulers or the
	rest of kernel in an invasive manner, I believe it's reasonable to
	consider sched_ext for inclusion.
</blockquote>
<p>
Whether that inclusion will happen remains an open question, though.  The
posting of <a
href="/ml/linux-kernel/20230711011412.100319-1-tj@kernel.org/">version&nbsp;4</a>
of the patch set in July 2023 led to a slow-burning discussion on the
merits of this development.  Scheduler maintainer Peter Zijlstra <a
href="/ml/linux-kernel/20230726091752.GA3802077@hirez.programming.kicks-ass.net/">rejected
the patches outright</a>, saying:
<p>
<blockquote class="bq">
	There is not a single doubt in my mind that if I were to merge
	this, there will be Enterprise software out there that will mandate
	its own BPF sched thing, or else it won't work.
<p>
	They will not care, they will not contribute, they might even pull
	a RedHat and only share the code to customers.
</blockquote>
<p>
He added that he saw no value in merging the code, and dropped out of the
conversation.  Mel Gorman also <a
href="/ml/linux-kernel/20230817124457.b5dca734zcixqctu@suse.de/">expressed
his opposition</a> to merging sched_ext, echoing Zijlstra's concern that
enterprise software would start requiring the use of special-purpose
schedulers.  He later <a
href="/ml/linux-kernel/20230926092020.3alsvg6vwnc4g3td@suse.de/">added</a>
that, in his opinion (one shared with Zijlstra), sched_ext would work
actively against the improvement of the current scheduler:
<p>
<blockquote class="bq">
	I generally worry that certain things may not have existed in the
	shipped scheduler if plugging was an option including EAS,
	throttling control, schedutil integration, big.Little, adapting to
	chiplets and picking preferred SMT siblings for turbo boost. In
	each case, integrating support was time consuming painful and a
	pluggable scheduler would have been a relatively easy out that
	would ultimately cost us if it was never properly integrated.
</blockquote>
<p>
Heo, naturally, <a
href="/ml/linux-kernel/ZSXLqNKajmeFRT8x@slm.duckdns.org/">disagreed</a>
with a lot of the concerns that had been raised.  There are, he said,
scheduling problems that cannot be addressed with tweaks to the current
scheduler, especially in "hyperscaling" environments like Meta.  He
disagreed that sched_ext would impose a maintenance burden, arguing that
the intrusion of BPF into other parts of the kernel has not had that
result.  Making it possible for users to do something new is beneficial,
even if there will inevitably be "<q>stupid cases</q>" resulting from how
some choose to use the new feature.  In summary, he said, opponents are
focused on the potential (and, in his opinion, overstated) costs of
sched_ext without taking into account the benefits it would bring.
<p>
<h4>Restarting the conversation</h4>
<p>
That message, in October, was the end of the conversation at the time.  Heo
is clearly hoping for a better result this time around, but Zijlstra's <a
href="/ml/linux-kernel/20240503085232.GC30852@noisy.programming.kicks-ass.net/">response</a>
was not encouraging:
<p>
<blockquote class="bq">
	 I fundamentally believe the approach to be detrimental to the
	 scheduler eco-system.  Witness the metric ton of toy schedulers
	 written for it, that's all effort not put into improving the
	 existing code.
</blockquote>
<p>
He said that he would not accept any part of this patch series until
"<q>the cgroup situation</q>" has been resolved.  That "situation" is a
performance problem that affects certain workloads when a number of control
groups are in use.  Rik van Riel had put together <a
href="/ml/linux-kernel/20190822021740.15554-1-riel@surriel.com/">a patch
series</a> to address this problem in 2019, but it never reached the point
of being merged; Zijlstra seems to be insisting that this work be completed
before sched_ext can be considered, and he gave little encouragement that
it would be more favorably considered even afterward.
<p>
Heo <a href="/ml/linux-kernel/ZjgWzhruwo8euPC0@slm.duckdns.org/">expressed
a willingness</a> (albeit reluctantly) to work on the control-group problem
if it would clear the way for sched_ext.  He strongly disagreed with
Zijlstra's characterization of sched_ext schedulers as "toy schedulers" and
the claim that working on sched_ext will take effort away from the mainline
scheduler, though.  There is, he said, no perfect CPU scheduler, so the
mainline scheduler has to settle for being good enough for all users.  That
makes it almost impossible to experiment with "<q>radical ideas</q>", and
severely limits the pool of people who can work on the scheduler.  Much of
the energy that goes into sched_ext schedulers, he said, is otherwise
unavailable for scheduler development at all.
<p>
There is, he said, value in some of those radical ideas:
<p>
<blockquote class="bq">
	Yet, the many different ways that even simple schedulers can
	demonstrates sometimes significant behavior and performance
	benefits for specific workloads suggest that there are a lot of low
	hanging fruits in the area.  Low hanging fruits that we can't
	easily reach from our current local optimum. A single
	implementation which has to satisfy all users all the time is
	unlikely to be an effective vehicle for mapping out such landscape.
</blockquote>
<p>
Igalia developer Changwoo Min, who is working with Valve on gaming-oriented
scheduling, <a
href="/ml/linux-kernel/344145d4-ec56-423f-a016-cbddada8abe5@igalia.com/">supported
Heo's argument</a>, saying that: "<q>The successful
implementation of sched_ext enriches the scheduler community with
fresh insights, ideas, and code</q>".
That, as of this writing, is where this conversation stands.
<p>
<h4>What next?</h4>
<p>
Sched_ext is on the schedule for the BPF track of the <a
href="https://events.linuxfoundation.org/lsfmmbpf/">Linux Storage,
Filesystem, Memory-Management, and BPF Summit</a>, which begins on
May&nbsp;13.  That discussion will cover the future development of
sched_ext but, most likely, will not be able to address the question of
whether this work should be merged at all.  <i>That</i> discussion could
continue, on the mailing lists and elsewhere, for some time yet.
<p>
Sometimes, when a significant kernel development stalls in this way,
distributors that see value in it will ship the patches anyway, as Ubuntu,
Valve, and ChromeOS are considering doing.  While shipping out-of-tree code
is often discouraged, it can also serve to demonstrate interest in a
feature and flush out any early problems that result from its inclusion.
If things go well, this practice can strengthen the argument for merging
the code into the mainline, albeit with the ever-present possibility of
changes that create pain for the early adopters.
<p>
Whether that will be the path taken for sched_ext remains to be seen.  What
is certain is that this work has attracted a lot of interest and is
unlikely to go away anytime soon.  Sched_ext has the potential to enable a
new level of creativity in scheduler development, even if it remains out of
the mainline — but that potential will be stronger if it does end up being
merged.  Significant scheduler patches are not merged quickly even when
they are uncontroversial; this one will be slower than most if it is
accepted at all.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#BPF-CPU_scheduling">BPF/CPU scheduling</a></td></tr>
            <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Scheduler-Extensible_scheduler_class">Scheduler/Extensible scheduler class</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/972710/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor973097"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 9, 2024 15:36 UTC (Thu)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/973097/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; &gt; I fundamentally believe the approach to be detrimental to the scheduler eco-system. Witness the metric ton of toy schedulers written for it, that's all effort not put into improving the existing code. </span><br>
<p>
No, no. There isn't a “scheduler ecosystem”. There is a scheduler *monoculture*, and for twenty years now people have interpreted that as damage and routed around it. The few of those who've dared to negotiate with the scheduler tyrant directly in the past have burned out and left kernel development forever - which is why it took a witheringly embarrassing fifteen years to properly address the Wasted Cores paper with more than a band-aid.<br>
<p>
The only two choices remaining here are either accept the reality of the situation and address the root cause (in old hacker parlance, "maintainer needs face time with a LART"), or continue to be obstinate about it and encourage downstream hacks to proliferate - both individual and corporate. The corporations don't need royal consent to F up the kernels they ship on their devices, they've *been* doing it. And because they're butchering their device-specific kernels with hardwired hacks, for want of a sane pluggable mechanism, *users* are the only ones that get screwed because they can't turn it off.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973097/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973098"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 9, 2024 15:48 UTC (Thu)
                               by <b>intelfx</b> (subscriber, #130118)
                              [<a href="/Articles/973098/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; in old hacker parlance, "maintainer needs face time with a LART"</span><br>
<p>
Could you please translate that? I’m not old hacker enough and that doesn’t seem to parse (or google).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973098/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973104"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 9, 2024 16:03 UTC (Thu)
                               by <b>schessman</b> (subscriber, #82966)
                              [<a href="/Articles/973104/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
LART : Luser Attitude Readjustment Tool.  See Clue-by-four.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973104/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor973119"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 9, 2024 19:56 UTC (Thu)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/973119/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; that doesn’t seem to parse (or google).</span><br>
<p>
FWIW, DDG gave the "Luser" expansion in its info box. My Google result has Wikipedia/Wiktionary as the first result (same thing).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973119/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor973794"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 15, 2024 21:05 UTC (Wed)
                               by <b>Conan_Kudo</b> (subscriber, #103240)
                              [<a href="/Articles/973794/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <p>I personally would love to see <em>sched_ext</em> to land upstream for the simple reason that nobody upstream cares about desktop Linux and regular user needs for scheduling.</p> 

<p>Having a way to build optimized schedulers outside of the kernel to bypass <em>CFS</em> and <em>EEVDF</em> and their flawed behaviors for regular users gives us an actual chance to deal with long-running responsiveness and performance-under-load issues that desktop Linux users observe that otherwise drive them to use alternative kernels that patch in other schedulers (like Con Kolivas' <em>MuQSS</em> and its predecessors).</p>


      
          <div class="CommentReplyButton">
            <form action="/Articles/973794/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973797"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 15, 2024 22:06 UTC (Wed)
                               by <b>jordalgo</b> (guest, #170580)
                              [<a href="/Articles/973797/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Totally agree. It would be great to be able to experiment with new schedulers quickly.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973797/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor973931"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 16, 2024 17:00 UTC (Thu)
                               by <b>Manifault</b> (guest, #155796)
                              [<a href="/Articles/973931/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Improving the desktop experience was definitely one of the biggest targets we had in mind for potential improvements that could result from sched_ext. See this for an example of efforts to improve interactivity: <a href="https://drive.google.com/file/d/1fyHt9BYGha6apl7HAkibwpy52UTi8-AQ/view">https://drive.google.com/file/d/1fyHt9BYGha6apl7HAkibwpy5...</a>. The techniques used there could also be added to EEVDF, which I'd be super happy to see.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973931/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor973111"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 9, 2024 18:30 UTC (Thu)
                               by <b>summentier</b> (subscriber, #100638)
                              [<a href="/Articles/973111/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; [Peter Zijlstra] said that he would not accept any part of this patch series until ""the cgroup situation"" has been resolved</span><br>
<p>
I understand that it has been common practice to strongarm^Wencourage patch submitters into cleaning up about as much mildly related kernel code as they are willing to in order to get their patches merged.<br>
<p>
This on the other hand seems to make just as much sense as the argument that Ukraine aid cannot be passed until the US-Mexican border is completely secure.<br>
<p>
Or am I missing something here? Unfortunately, the maintainer does not really elaborate in his post ...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973111/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973114"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 9, 2024 19:13 UTC (Thu)
                               by <b>summentier</b> (subscriber, #100638)
                              [<a href="/Articles/973114/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Umm, okay.<br>
<p>
I was trying to be funny there, but upon rereading this, I realized I was WAY out of line. This is the kernel, nobody's life is on the line. Apologies to Mr Zijlsta for drawing such a connection.<br>
<p>
Unfortunately, there is no way to delete a comment. Granted, it would have been better to catch this before posting. Mr Corbet, feel free to delete this.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973114/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973371"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 12, 2024 14:48 UTC (Sun)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/973371/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Ignoring the "out of line" analogy, this seems like a good question. Hopefully some people can see past the former and help answer the latter.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973371/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor975478"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 28, 2024 2:44 UTC (Tue)
                               by <b>DanilaBerezin</b> (guest, #168271)
                              [<a href="/Articles/975478/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Okay what happened here?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/975478/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor973139"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">This is probably futile, but...</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 9, 2024 23:32 UTC (Thu)
                               by <b>mattdm</b> (subscriber, #18)
                              [<a href="/Articles/973139/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The "pull a RedHat" comment is a non sequitur. The final, best, accepted versions of every improvement or patch Red Hat makes or applies to RHEL are distributed to everyone via CentOS Stream. Interim updates may go to customers only (usually, backported patches instead of an upstream with a new version which may incorporate slightly different code), but the actual code is shared with the world. <br>
<p>
That situation _still_ may not make everyone happy, but it'd at least be nice if people were mad about the actual thing, rather than something very different.<br>
<p>
If Red Hat makes improvements to the scheduler, via the mainline scheduler or BPF, they'll be shared back in a way that ultimately benefits everyone, and which emphasizes upstream collaboration -- _even if_ the BPF approach would technically allow us to not do so. (If this policy changes in the future, I'll go on record as saying that I'll be one of the people angry about it.)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973139/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973174"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">This is probably futile, but...</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 10, 2024 11:11 UTC (Fri)
                               by <b>hkario</b> (subscriber, #94864)
                              [<a href="/Articles/973174/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Red Hat has a long-standing policy of first merging the patches upstream, only then shipping them in RHEL: <a href="https://www.redhat.com/en/blog/what-open-source-upstream">https://www.redhat.com/en/blog/what-open-source-upstream</a> we call it "upstream first"<br>
<p>
(there are exceptions, of course, like security fixes, or unresponsive upstreams, etc. but the policy is still very much to get every patch shipped merged upstream)<br>
<p>
disclaimer: I work at Red Hat<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973174/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973176"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">This is probably futile, but...</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 10, 2024 11:24 UTC (Fri)
                               by <b>sdalley</b> (subscriber, #18550)
                              [<a href="/Articles/973176/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I like these kinds of disclaimers. They show that you are very likely to know what you're talking about, and can be treated with rather greater confidence than those who smear from the outside.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973176/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973311"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">This is probably futile, but...</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 11, 2024 16:51 UTC (Sat)
                               by <b>mattdm</b> (subscriber, #18)
                              [<a href="/Articles/973311/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
For the record, I too work at Red Hat. So, same disclaimer.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973311/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973430"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">This is probably futile, but...</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2024 9:03 UTC (Mon)
                               by <b>sdalley</b> (subscriber, #18550)
                              [<a href="/Articles/973430/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Thank you for speaking up!<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973430/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor973144"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 10, 2024 1:26 UTC (Fri)
                               by <b>hmanning77</b> (subscriber, #160992)
                              [<a href="/Articles/973144/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
According to the BPF Licensing page of the kernel documentation, some BPF program types (currently Linux Security Models and TCP Congestion Control) are restricted to loading programs licensed under the GPL. If the concern is that vendors will develop custom schedulers without contributing improvements back upstream, could the GPL requirement not be extended to CPU scheduler BPF programs?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973144/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973150"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 10, 2024 2:14 UTC (Fri)
                               by <b>Manifault</b> (guest, #155796)
                              [<a href="/Articles/973150/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That requirement does apply to all BPF sched_ext schedulers. The verifier will fail to load any BPF sched_ext scheduler program that is not licensed with GPL v2.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973150/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973225"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 10, 2024 14:08 UTC (Fri)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/973225/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Isn't that in itself a breach of the GPL? Any version?<br>
<p>
From v3, section 2<br>
<p>
  All rights granted under this License are granted for the term of<br>
copyright on the Program, and are irrevocable provided the stated<br>
conditions are met.  This License explicitly affirms your unlimited<br>
permission to run the unmodified Program.  The output from running a<br>
covered work is covered by this License only if the output, given its<br>
content, constitutes a covered work.  This License acknowledges your<br>
rights of fair use or other equivalent, as provided by copyright law.<br>
<p>
So if the verifier refuses to load a BPF program at runtime, ANY BPF program, isn't it in breach of the GPL?<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973225/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973229"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 10, 2024 14:42 UTC (Fri)
                               by <b>Manifault</b> (guest, #155796)
                              [<a href="/Articles/973229/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'm not a lawyer, but that seems like a... rather naive interpretation of the text. The GPL does not guarantee your right to always have your program run _successfully_ in any environment. It's guaranteeing your right to _use_ your program as much as you want without being sued by some entity claiming that it's their intellectual property. The verifier rejecting an unsafe (or improperly licensed) BPF program is no different than if the main kernel returns an error code for some system call that has invalid inputs. If the verifier considers a BPF program unsafe or unsuitable to load it, it's under no legal obligation to load it. If your GPLv2 program is broken, you can still use it, but the operating system is (obviously) under no obligation to run it for you.<br>
<p>
Also, my comment said that the verifier will reject sched_ext programs that are _not_ licensed with GPLv2. If it rejects programs with a different license, they wouldn't get any protections from GPLv2 regardless.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973229/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973258"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 10, 2024 21:10 UTC (Fri)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/973258/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think the real questions are:<br>
<p>
1. Is it legal to make a modified version of the BPF verifier which does not reject non-GPL-licensed programs? It might violate 17 USC 1201 (and similar laws in other countries). Version 3 of the GPL explicitly repudiates that provision of copyright law, but the kernel is licensed under GPLv2. OTOH, the GPL is much more permissive than a "typical" (proprietary) copyright license, so I don't know what courts would say in that situation. Certainly the spirit of the license is that you can change whatever you want, so long as you distribute those changes (if at all) under the GPL. I also believe this is the intent of most if not all of the people who have actually contributed source code to the kernel.<br>
2. Is it legal to make a BPF sched_ext program that is not GPL? In most countries, this will turn on some kind of substantial similarity analysis. In the US, some courts have adopted a software-specific test called the "abstraction-filtration-comparison test," which complicates things, but the short version is that there must be portions of the allegedly infringing work (the BPF program) which are both eligible for copyright protection and also present in the original work (the kernel), and those portions must be substantial enough to infer that some kind of "copying" happened. This is not necessarily limited to literal copying of source code, but it can't be something as abstract as an entire algorithm, either (nobody owns quicksort, for example). The AFC test is basically just a more methodical and specific way of doing that analysis for software. Probably other countries won't do the exact same analysis, but it is hard to imagine them doing something wildly different.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973258/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973266"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 11, 2024 1:07 UTC (Sat)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/973266/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; Is it legal to make a modified version of the BPF verifier which does not reject non-GPL-licensed programs?</span><br>
<p>
This feels more like a DMCA kind of thing to me.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973266/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973271"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 11, 2024 8:39 UTC (Sat)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/973271/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There's another point here too.<br>
<p>
Are BPF programs distributed as source? I thought the kernel ran them through a jit compiler? <br>
<p>
Because we have the problem there that the GPL is not a particularly suitable licence for stuff distributed as source, about the only Freedom you're missing is the ability to distribute - the mere fact it's source gives you everything else.<br>
<p>
Oh - and by the way, does it REALLY refuse to run anything that's not GPL2? What about BSD? MIT? MPL2? PD etc?<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973271/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor973270"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 11, 2024 6:54 UTC (Sat)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/973270/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt;Is it legal to make a modified version of the BPF verifier which does not reject non-GPL-licensed programs?</span><br>
<p>
Yes, of course. That does not change the licensing situation at all.<br>
<p>
You can:<br>
- Remove this check from the verifier.<br>
- Use the modified verifier.<br>
- Distribute the resulting verifier code.<br>
- Write a non-GPL BPF program and use it locally without distributing.<br>
<p>
It may be a license violation (courts have to decide), if:<br>
- You distribute your non-GPL BPF program.<br>
<p>
It might also be totally fine to distribute the non-GPL BPF program along with the modified verifier, if a court rules that the BPF program is not a derived work.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973270/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor973332"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 11, 2024 23:58 UTC (Sat)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/973332/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; Witness the metric ton of toy schedulers written for it, that's all effort not put into improving the existing code.</span><br>
<p>
I would expect most of the work there to be not so much about "code" but much more about experimenting with and benchmarking a very wide range of workloads. It sounds like the real question here is not really about "improving existing code" but rather "Can a unique scheduler do everything well enough?" If feels like a very difficult question but it's probably even harder to answer with less room to experiment...<br>
<p>
<span class="QuotedText">&gt; While shipping out-of-tree code is often discouraged, it can also serve to demonstrate interest in a feature and flush out any early problems that result from its inclusion. If things go well, this practice can strengthen the argument for merging the code into the mainline, albeit with the ever-present possibility of changes that create pain for the early adopters.</span><br>
<p>
Absolutely: trial and error. Sometimes that requires actually shipping it to gather measurements and experience on a very large scale.<br>
<p>
I heard some guys even send rockets in space nowadays with the expectation that they will fail.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973332/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor973372"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 12, 2024 15:15 UTC (Sun)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/973372/">Link</a>] (10 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; There is not a single doubt in my mind that if I were to merge this, there will be Enterprise software out there that will mandate its own BPF sched thing, or else it won't work.</span><br>
<p>
And? What's new?<br>
<p>
I bet the vast majority of CPU cycles "scheduled" by Linux already involve large amounts of closed-source software. Even when most web browsers (the OS on top of the OS) are now "open-core", (1) they still include a fair amount of closed-source code (2) The javascript they run is complex and minified (3) WASM is probably closed-source most of the time.<br>
<p>
In other words, it's never been possible to reproduce and test "Enterprise" or any other real workload out of the box. If you want help from the maintainer and community, then you've always had to simplify, open and share your workload first. If no one can understand what you do then you're on your own, good bye. That's always been the deal. Simple.<br>
<p>
Same logic with source code. Products almost always ship with custom stable branches with various backports and out of tree code. Even Linux distributions have always done this. So to engage from the community and get "free" support, you always had to switch to the latest commit on the main branch and to the maintainer's .config first (minor exaggeration to get the point across).<br>
<p>
So I really don't see why a different logic would suddenly apply to custom BPF schedulers. If it's private then you're on your own as usual. Same thing if you share your BPF scheduler but maintainers think it's cr*p, as in "doctor, it hurts when I do this..." The answer to that question has never changed.<br>
<p>
BTW what are the open-source test suites and workloads available for the scheduler? I'm surprised none was mentioned, it seems like a key element in that discussion.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973372/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973390"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 12, 2024 20:17 UTC (Sun)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/973390/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; maintainers think it's cr*p, as in "doctor, it hurts when I do this..." The answer to that question has never changed.</span><br>
<p>
The problem comes when the patient says "doctor it hurts when I do ..." something that's necessary for normal life, like go for a walk. That regularly lands my grand-daughter in considerable pain. It could easily land my daughter temporarily paralysed on the floor.<br>
<p>
And this is the problem. I get the impression there are quite a few important people in the Linux community who's attitude seems to be "the computer is there to run the OS. Who cares about the users" ... this discussion seems to have added another one to the list ...<br>
<p>
"BOFH, my computer crashes every time I run our production software" - "Well, don't run your production software, then ..."<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973390/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973398"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 12, 2024 22:51 UTC (Sun)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/973398/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
More like:<br>
<p>
- ... crashes when I run my production software.<br>
- Interesting! What is that software, what does it do?<br>
- Can't tell you. <br>
- .....<br>
<p>
Or like:<br>
- Here is the list of all the stupid things the documentation told me not to do and that I'm doing anyway with my custom BPF scheduler...<br>
- Good bye!<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973398/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973434"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2024 9:43 UTC (Mon)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/973434/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; Or like:</span><br>
<p>
"We're running this commercial software on stock &lt;distro of choice&gt;".<br>
<p>
Like my daughter / grand-daughter going for a walk.<br>
<p>
What then?<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973434/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973506"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2024 14:02 UTC (Mon)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/973506/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; What then?</span><br>
<p>
"Contact &lt;commercial software vendor&gt; for support."<br>
<p>
(And, more often than not, the &lt;vendor&gt; will say "you're not using the supported OS/hardware we specified, goodbye.")<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973506/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973522"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2024 15:15 UTC (Mon)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/973522/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Are you sure?<br>
<p>
I'm running stock Excel on stock Windows. Response times are absolute shite - to the point that we are in danger of it taking longer to run than the time available.<br>
<p>
(Crap choice of software, I know. Not my choice.)<br>
<p>
The most likely response from the vendors I know of is "ask the community". <br>
<p>
But the point is, you're all coming up with POSSIBLE excuses for the vendor. What happens when the vendor's recommended, supported environment is "not fit for the purpose intended" to quote UK legalese? ESPECIALLY if said environment contains obvious flaws (not necessarily the vendor's fault) that would help you massively if they were fixed.<br>
<p>
That was the complaint with ext4 years ago. That's the complaint with ext_sched now. That's the complaint with Rust. There are people who are actively obstructing attempts to improve Linux, because all they can see is their personal downside.<br>
<p>
Are they Luddites? I don't know, I sincerely hope not. After all, the true Luddites could see the benefits of the technology they destroyed - that's why they destroyed it, because they could see the benefits would go to others, not them.<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973522/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973546"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2024 16:49 UTC (Mon)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/973546/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; The most likely response from the vendors I know of is "ask the community". </span><br>
<p>
The fact that the vendors you know are universally crappy doesn't change whose obligation it is to provide support.<br>
<p>
Again, $user has a *commercial* relationship with $vendor.  $user has no such relationship with "the community", which made $user zero promises, received zero compensation, and thus has precisely zero legal or moral obligation to give $user the time of day, much less provide support for a product they had nothing to do with.<br>
<p>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973546/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973553"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2024 17:08 UTC (Mon)
                               by <b>mb</b> (subscriber, #50428)
                              [<a href="/Articles/973553/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yes. All correct.<br>
Yet, the users will spam the community mailing lists, because that's the next logical step for them, if the vendor refuses support.<br>
<p>
Why should we merge a feature that doesn't benefit the community?<br>
If sched_ext benefits the community, I'm all for it. If not, why can't the exceptional use cases just ship a patched kernel?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973553/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973555"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2024 17:30 UTC (Mon)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/973555/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; Yet, the users will spam the community mailing lists, because that's the next logical step for them, if the vendor refuses support.</span><br>
<p>
Yep.  And that's what $vendors are counting on as it lets them save money on knowledgeable support staff.<br>
<p>
(Mind you, user support request to vendors are not necessarily reasonable.  After all, you wouldn't expect a company that makes hammers to "support" a customer complaining that the structure they are building keeps falling apart)<br>
<p>
<span class="QuotedText">&gt; Why should we merge a feature that doesn't benefit the community?</span><br>
<p>
Every feature benefits someone.  Unfortunately every feature also brings along costs that rarely fall onto the same someones that are reaping the benefits.<br>
<p>
Those costs can be short term ("performance regression under every other workload") or longer term (technical debt, combinatorial complexity, security vulnerabilities with cutsey names, etc)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973555/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor973582"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2024 22:02 UTC (Mon)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/973582/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<span class="QuotedText">&gt; Yet, the users will spam the community mailing lists, because that's the next logical step for them, if the vendor refuses support.</span><br>
<p>
And? What's new?<br>
<p>
<span class="QuotedText">&gt;  If sched_ext benefits the community, I'm all for it. If not, why can't the exceptional use cases just ship a patched kernel?</span><br>
<p>
Agreed: if sched_ext turns out to be used ONLY by closed-source vendors then it shouldn't be merged. But that seems rather unlikely, doesn't it?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973582/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor975002"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 25, 2024 0:16 UTC (Sat)
                               by <b>mrugiero</b> (guest, #153040)
                              [<a href="/Articles/975002/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Maybe the same policy as with DRM drivers should be applied here. Give me some useful BPF programs (not just toy schedulers) that I may be interested in running, and then I may merge the code needed to run them. That's the safe bet, if you require that you already vanished the possibility of those magical cool schedulers never coming to the wider public.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/975002/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor973544"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 13, 2024 16:17 UTC (Mon)
                               by <b>riking</b> (subscriber, #95706)
                              [<a href="/Articles/973544/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I've seen a few people express the opinion elsewhere that the success of the EEVDF scheduler has massively reduced the impetus for sched_ext -- that is, they wanted sched_ext in order to implement basically EEVDF.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973544/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor973842"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 16, 2024 9:14 UTC (Thu)
                               by <b>rwmj</b> (subscriber, #5474)
                              [<a href="/Articles/973842/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I have a couple of technical questions which I don't think were answered in the article or comments so far ...<br>
<p>
(1) Is BPF actually fast enough here?  I mean, surely this code is called every time you do schedule(), which would be very frequent, so you'd want that to be as fast as it can be.  BPF is JITted but does it compete with AOT-compiled C code?<br>
<p>
(2) Related to (1), why wouldn't a pluggable system of regular kernel modules work for this use case?  From a quick scan of kernel/sched in the sources it seems like the current schedulers are not modules.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/973842/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor973909"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 16, 2024 13:27 UTC (Thu)
                               by <b>corbet</b> (editor, #1)
                              [<a href="/Articles/973909/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      I'm not the expert in this area, but can try to answer the questions...
<p>
As I understand it, BPF is indeed fast enough to use in this way.  It's all native code by the time it runs.
<p>
Using regular modules would forego many of the safety features of BPF, making it much easier to hose the system.  That would be undesirable in a system meant to encourage experimentation.  


      
          <div class="CommentReplyButton">
            <form action="/Articles/973909/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor974081"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Another push for sched_ext</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 17, 2024 14:57 UTC (Fri)
                               by <b>daroc</b> (editor, #160859)
                              [<a href="/Articles/974081/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'll also note that many of the sched_ext folks I've spoken with have been hopeful that people will use sched_ext for experimentation, and then contribute those algorithms as actual schedulers later, avoiding any overhead left from the JIT. I attended a talk at LFSMM (article forthcoming) where the speaker mentioned that BPF now has almost all the features needed to implement EEVDF — the main remaining item being the ability to safely call kfuncs while holding a lock — at which point they hope to see people use sched_ext to experiment directly on EEVDF.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/974081/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2024, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
