        <!DOCTYPE html>
        <html lang="en">
        <head><title>The core of the -stable debate [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/863505/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/864007/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/863505/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>The core of the -stable debate</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Please consider subscribing to LWN</b>
<p>
Subscriptions are the lifeblood of LWN.net.  If you appreciate this
content and would like to see more of it, your subscription will
help to ensure that LWN continues to thrive.  Please visit
<a href="/Promo/nst-nag1/subscribe">this page</a> to join up and keep LWN on
the net.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>July 22, 2021</br>
           </div>
Disagreements over which patches should find their way into stable updates
are not new — or uncommon.  So when the topic came up again recently, there
was little reason to expect anything but more of the same.  And, for the
most part, that is what ensued but, in this exchange, we were also able to
see the core issue that drives these discussions.  There are, in the
end, two fundamentally different views of what the stable tree should be.
<p>
The <a
href="/ml/linux-kernel/20210712060912.995381202@linuxfoundation.org/">5.13.2</a>
stable update was not a small one; it contained an even 800 patches.  That
is 5% of the total size of the mainline 5.13 development cycle, which was
not small either.  With the other stable kernels going out for consideration on
the same day, there were over 2,000 stable-bound patches in need of review;
that is a somewhat tall order for even a large community to handle in the
two days that are allowed.  Even so, Hugh Dickins was able to <a
href="/ml/linux-kernel/2b1b798e-8449-11e-e2a1-daf6a341409b@google.com/">raise
an objection</a> over the inclusion of several memory-management patches
that had not been specifically marked for inclusion in the stable
releases.  Those patches, he thought, were not suitable for a stable kernel
and should not have been selected.
<p>
Stable-kernel maintainer Greg Kroah-Hartman <a
href="/ml/linux-kernel/YO0zXVX9Bx9QZCTs@kroah.com/">responded</a> that the
size of the update was due to maintainers holding onto fixes until the
merge window opens.  Once the -rc1 release comes out, those fixes all
land in the stable updates, which 
are, as a result, huge.  But it is clear that the amount of change going
into the stable kernels has been growing over time.  If one looks at the
number of changes going into the first five updates for each release
(enough updates to include the merge-window fixes), the result is:
<p>
<blockquote>
<table class="OddEven">
<tr><th rowspan=2>Release</th>
    <th rowspan=2>Updates</th>
    <th colspan=2>Changes</th></tr>
<tr><th>First 5</th><th>Total</th></tr>

<tr><td align="right">4.19</td>
    <td align="right">198</td>
    <td align="right">754</td>
    <td align="right">19,682</td></tr>
<tr><td align="right">5.0</td>
    <td align="right">21</td>
    <td align="right">408</td>
    <td align="right">2,387</td></tr>
<tr><td align="right">5.1</td>
    <td align="right">18</td>
    <td align="right">353</td>
    <td align="right">1,747</td></tr>
<tr><td align="right">5.2</td>
    <td align="right">21</td>
    <td align="right">779</td>
    <td align="right">2,429</td></tr>
<tr><td align="right">5.3</td>
    <td align="right">18</td>
    <td align="right">561</td>
    <td align="right">2,178</td></tr>
<tr><td align="right">5.4</td>
    <td align="right">134</td>
    <td align="right">435</td>
    <td align="right">14,414</td></tr>
<tr><td align="right">5.5</td>
    <td align="right">19</td>
    <td align="right">653</td>
    <td align="right">2,516</td></tr>
<tr><td align="right">5.6</td>
    <td align="right">19</td>
    <td align="right">364</td>
    <td align="right">1,864</td></tr>
<tr><td align="right">5.7</td>
    <td align="right">19</td>
    <td align="right">581</td>
    <td align="right">2,984</td></tr>
<tr><td align="right">5.8</td>
    <td align="right">18</td>
    <td align="right">899</td>
    <td align="right">2,755</td></tr>
<tr><td align="right">5.9</td>
    <td align="right">16</td>
    <td align="right">1,244</td>
    <td align="right">2,339</td></tr>
<tr><td align="right">5.10</td>
    <td align="right">52</td>
    <td align="right">841</td>
    <td align="right">7,295</td></tr>
<tr><td align="right">5.11</td>
    <td align="right">22</td>
    <td align="right">948</td>
    <td align="right">3,588</td></tr>
<tr><td align="right">5.12</td>
    <td align="right">19</td>
    <td align="right">1,446</td>
    <td align="right">3,843</td></tr>
<tr><td align="right">5.13</td>
    <td align="right">4</td>
    <td align="right">1,416</td>
    <td align="right">1,416</td></tr>
</table>
</blockquote>
<p>

While 5.13 has not yet reached five stable releases as of this writing, it
seems safe to predict that it will collect more changes in its first five
stable updates than any of its predecessors.  The number of patches going
into the stable updates is increasing in general, at a rate that would seem
to exceed the growth in the rate at which changes are applied during
mainline kernel development cycles.  Long-term
stable kernels now receive more patches during their "stable" period than
during the development cycle leading up to their "final" release.  In other
words, the development cycle is not even close to being finished when Linus
Torvalds applies a tag and leaves the building.
<p>
Developers and maintainers can indicate that a mainline patch should be
backported to the stable releases by including a
"<tt>CC:&nbsp;stable@vger.kernel.org</tt>" tag, but that is not how most
patches get there; of the 1,416 commits in 5.13.4, only 259 — 18% — contained such
a tag.  The stable maintainers have increasingly aggressively
sought out mainline patches that look like fixes and put them into the
stable releases.  The <tt>Fixes</tt> tag found on many patches is used as a
cue that a patch is a fix, but <a href="/Articles/764647/">machine learning
is also being used</a> to select patches.  The result is a lot of commits
going into stable updates without having ever been explicitly marked for
that treatment.
<p>
This work has always been controversial, especially when regressions slip
through.  Regressions are inevitable regardless, but it is hard to imagine
a way to add over 3,000 changes to a kernel during a three-month short-term
stable cycle without a few of them being bad.  The patches singled out by
Dickins this time around are <i>not</i> responsible for any regressions
(that anybody knows about yet), but the memory-management developers are
clearly worried about the possibility.
<p>
To avoid any such outcome, memory-management maintainer Andrew Morton has <a
href="/ml/linux-kernel/20210713182813.2fdd57075a732c229f901140@linux-foundation.org/">requested</a>
that patches carrying his <tt>Signed-off-by</tt> tag not be included in
stable updates in the absence of a specific request: "<q>At present this
-stable promiscuity is overriding the (sometime carefully) considered
decisions of the MM developers, and that's a bit scary</q>".
Kroah-Hartman <a
href="/ml/linux-kernel/YO7lZpqC4xrMPXQg@kroah.com/">asked</a> how the
decision to mark a patch for stable backporting is made and, specifically,
why a number of clear fixes were not selected; Morton <a
href="/ml/linux-kernel/20210714140911.6c45f8f4a9b129ed36bb9d06@linux-foundation.org/">explained
the thinking</a> this way:
<p>
<blockquote class="bq">
	Broadly speaking: end-user impact.  If we don't have reports of the
	issue causing a user-visible problem and we don't expect such
	things to occur, don't backport.  Why risk causing some regression
	when we cannot identify any benefit?
</blockquote>
<p>
Kroah-Hartman's <a
href="/ml/linux-kernel/YO6r1k7CIl16o61z@kroah.com/">position</a>, instead,
is that, if a patch fixes a bug, it should be included in the stable
updates:
<p>
<blockquote class="bq">
	But it really feels odd that you all take the time to add a "Hey,
	this fixes this specific commit!" tag in the changelog, yet you do
	not actually want to go and fix the kernels that have that commit
	in it.  This is an odd signal to others that watch the changelogs
	for context clues.
</blockquote>
<p>
Sasha Levin (who also works on the stable updates) <a
href="/ml/linux-kernel/YO8DJkVzHFmPv6vz@sashalap/">added</a> that a lot of
important fixes are missed if only the explicitly tagged patches are
backported into the stable kernels.  Some of those fixes then find their
way into distributor kernels via other paths, which doesn't seem ideal.
<p>
In the end, this is what the disagreement comes down to: a difference of
opinion on what is the best way to create stable updates that are truly
stable and free of problems.
<p>
<ul class="spacylist">
<li> Many developers see the stable updates as a carefully curated
     collection of hand-selected fixes, each of which has been extensively
     reviewed for importance and the lack of regression potential.  These
     kernels should be safe to update to, since they should have a minimal
     chance of introducing problems not seen in their predecessors.
     This position tends to be taken by the developers of complex, core
     subsystems that have a high potential for subtle regressions.
     <p>
     The
     memory-management subsystem is a classic example; there was also <a
     href="/Articles/838819/">a similar discussion with the XFS filesystem
     developers</a> in late 2020.  Memory management requires
     predicting the future; as a result, the code is a large collection of
     complicated heuristics that have to work with a huge variety of
     workloads.  It is not uncommon for an innocent-seeming change to
     create a performance regression for some private customer workload that
     won't surface until years have passed.  Memory-management developers
     have learned that their lives run much more smoothly in the absence of
     such regressions, so they go out of their way to avoid making
     unnecessary changes to stable kernels.

<p>
<li> Others, including the stable maintainers, feel that the best kernel is
     to be had by including every fix that can be reasonably backported.
     Many bugs have user impacts — including security problems — that are not
     obvious to the developers when those bugs are being fixed; including
     all of the fixes will head off a lot of problems before they are
     discovered.
<p>
     Some distributors have taken this position and, as a result, are happy
     with how things are working; Justin Forbes <a
     href="/ml/linux-kernel/CAFxkdAqE0vKCyr4qFjtKmn46rHn+RJsn7m_MX6jjbN6FZcDLMA@mail.gmail.com/">wrote</a>
     that "<q>the current stable process has fixed more bugs than it has
     introduced</q>".  The Android kernel is increasingly tied to the
     stable updates as a way of getting as many fixes as possible; based on
     this experience, Kroah-Hartman <a
     href="/ml/linux-kernel/YO8GLupNQWpqsrT6@kroah.com/">said</a>:
     "<q>I have numbers to back up the other side, along with the
     security research showing that to ignore these stable releases puts
     systems at documented risk</q>".
</ul>
<p>

Which position is "correct" is not entirely clear, but there is no doubt
about which position is "winning".  As always in the Linux world, the
people who are doing the work will decide how the work is to be done, and
the stable maintainers have opted for the "promiscuous" approach.  It would
be interesting to see if there would be a user community for ultra-stable
kernels maintained using the more restrictive approach, but it is doubtful
that anybody has the time to create such a thing.
<p>
There is always room for tweaking around the edges and opting out certain
subsystems; this seems likely to happen with regard to memory management.
More testing would also certainly help; the testing picture for stable
releases has improved considerably over the years but could still get
better.  Ted Ts'o <a
href="/ml/linux-kernel/YO8EQZF4+iQ13QU%2F@mit.edu/">suggested</a> that
there could be a role for a "perfbot" system that looked for performance
regressions in particular, if the resources could be found to create that
sort of facility.  Performance regressions are particularly difficult to
test for, though; the resource requirements are large and it is nearly
impossible to simulate every type of workload.

<p>
In any case it seems that large stable updates will continue to be the rule
going 
forward.  With luck they will continue to become less regression-prone, but
they will never be completely regression-free.  So it is safe to predict
that the debates over what should and should not go into stable updates
will continue indefinitely.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Development_model-Stable_tree">Development model/Stable tree</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/863505/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor864015"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 22, 2021 17:37 UTC (Thu)
                               by <b>jgg</b> (subscriber, #55211)
                              [<a href="/Articles/864015/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The -stable is probably better described as -secure, as the article explains the motivation and goal seems to be to get all bug fixes because any could be a security issue. It is not about the very low change, highly predicable safe upgrade that you might expect from an enterprise distro stable stream.<br>
<p>
On the other side we also have distros and other consumers with thier own, quite different, policies.<br>
<p>
IMHO this debate basically boils down to the fact there are lots of people in the backporting world consuming the &quot;cc: stable&quot; and &quot;Fixes&quot; tags and all have their own incompatible expectations on what they should mean.<br>
<p>
What I&#x27;ve sort of settled on is &quot;cc: stable&quot; means this is really important and we know it needs attention for some reason. Everyone doing backports should look at this.<br>
<p>
&quot;Fixes&quot; means this fixes something, and should be evaluated according to each back porter&#x27;s criteria. Commit messages are supposed to be good enough to help them decide this. No tag means this probably is new features/functions.<br>
<p>
With all the AI and algorithms -stable is really strongly QA dependent. If you are using a part of the kernel that doesn&#x27;t have QA coverage on the -stable tree, run away. This has created something of a chicken and egg as in my world most users are not using -stable, and I can&#x27;t justify investing in more QA without users.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864015/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor864037"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 22, 2021 19:27 UTC (Thu)
                               by <b>post-factum</b> (subscriber, #53836)
                              [<a href="/Articles/864037/">Link</a>] (16 responses)
      </p>
      
      </div>
      </summary>
      FWIW, it got funny recently with -stable and -mm.<br></br>
<a href="https://lore.kernel.org/lkml/20210426123316.806267-1-linmiaohe@huawei.com/">This series</a> was backported partially (<em>2 out of 4 patches were picked for some reason</em>), obviously introducing a visible regression because of broken locking. Those 2 patches are set to be reverted in 5.13.5 so that the regression will be addressed.<br></br>
But what's the logic behind this? First, a partial fix for a real problem is backported, introducing yet another issue. Then, this fix, instead of being backported fully, gets completely reverted.<br></br>
Stable is not stable any more?





      
          <div class="CommentReplyButton">
            <form action="/Articles/864037/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864063"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 1:42 UTC (Fri)
                               by <b>willy</b> (subscriber, #9762)
                              [<a href="/Articles/864063/">Link</a>] (14 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That is an insanely rare race. When was the last time you invoked &quot;swapoff&quot; *while the system was actively swapping to that swap device*? ie not part of shutdown.<br>
<p>
I think I&#x27;ve done that maybe twice in my entire life. And the race window is several instructions long.<br>
<p>
I honestly wonder if it&#x27;s worth fixing at all. It&#x27;s certainly not worth backporting to -stable. I&#x27;ve asked Sasha to see if his bot can notice that a patch is part of an N part series and refuse to backport M/N if part 1 to M-1 are not going to be backported.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864063/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864073"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 6:01 UTC (Fri)
                               by <b>post-factum</b> (subscriber, #53836)
                              [<a href="/Articles/864073/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
So, -stable is for fixes, but not for all fixes. But for what fixes specifically -stable is?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864073/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864082"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 9:34 UTC (Fri)
                               by <b>pbonzini</b> (subscriber, #60935)
                              [<a href="/Articles/864082/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
For those that the maintainers deem worthy, depending on risk of regressions, risk of botched backports, and likelihood of actually encountering the bug in the wild, among other things.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864082/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864086"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 10:24 UTC (Fri)
                               by <b>post-factum</b> (subscriber, #53836)
                              [<a href="/Articles/864086/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; maintainers</font><br>
<p>
Subsystem maintainers? -stable maintainers?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864086/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864159"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 14:39 UTC (Fri)
                               by <b>lsl</b> (subscriber, #86508)
                              [<a href="/Articles/864159/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Those that do the work, so -stable maintainers.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864159/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864215"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 24, 2021 13:51 UTC (Sat)
                               by <b>pbonzini</b> (subscriber, #60935)
                              [<a href="/Articles/864215/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Nope. Those that know the code best and are on the hook if somebody reports a regression, that is subsystem maintainers.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864215/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor864089"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 11:39 UTC (Fri)
                               by <b>willy</b> (subscriber, #9762)
                              [<a href="/Articles/864089/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If only somebody had written those rules down.<br>
<p>
<a href="https://www.kernel.org/doc/html/latest/process/stable-kernel-rules.html">https://www.kernel.org/doc/html/latest/process/stable-ker...</a><br>
<p>
 * It must fix a real bug that bothers people (not a, “This could be a problem…” type thing).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864089/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor864096"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 13:21 UTC (Fri)
                               by <b>wtarreau</b> (subscriber, #51152)
                              [<a href="/Articles/864096/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;  But for what fixes specifically -stable is?</font><br>
<p>
All those where the benefit/risk ratio is extremely high. I.e. any fix whose risk is zero, and fixes of high importance when there is a non-negligible risk. For example Andy&#x27;s ESPFIX series a few years ago were not trivial to backport and required to modify some of the exception handling code that otherwise is never ever touched in a patch series. I remember that I was really scared when touching such areas (I don&#x27;t remember if that was on 2.6.32 or 3.10, but I still remember about that topic), but regardless of the risks, that was required, and the risks were addressed with a good dose of cross-maintainer help and testing. All the spectre/meltdown/l1tf etc stuff was orders of magnitude more complex and more risky, but had to be done as well.<br>
<p>
In short, -stable is for those who use Linux. If you&#x27;re uncertain to be able to gauge a risk/benefit ratio yourself, let those who it&#x27;s the job do it.<br>
<p>
It&#x27;s worth noting that for those dealing with patched kernels (distros, product vendors etc), the situation is even worse. While -stable maintainers have the freedom to decide how to modify their kernel to reduce some risks, those at the end of this supply chain do not have this luxury if some of their patches rely on the modified parts. This can sometimes imply more modifications in their own patches just to adapt to the last changes, and such modifications will be done with less chance of peer review, let alone public review, and sometimes even no chance to try the code in field if the issue is still under embargo. This alone is a great motivation for upstreaming your local work as much as possible.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864096/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor864294"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 26, 2021 13:18 UTC (Mon)
                               by <b>immibis</b> (guest, #105511)
                              [<a href="/Articles/864294/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
How would you tell the system not to actively swap to that swap device, if not by using swapoff?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864294/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864297"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 26, 2021 13:28 UTC (Mon)
                               by <b>willy</b> (subscriber, #9762)
                              [<a href="/Articles/864297/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
swapoff is, of course, how you tell the system to stop using a swap device.<br>
<p>
My question is, how often do you do this (other than as part of shutdown)? Once an hour? Once a week? Ever?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864297/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864440"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 27, 2021 16:00 UTC (Tue)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/864440/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I&#x27;ve had scenarios along the lines of “oh shit, this linker process is about to fill up zram swap after a day long chromium build, better move it to disk so the loadavg doesn&#x27;t zoom off into 3 digits forever”.<br>
<p>
If the kernel decides to panic at that point because I&#x27;m holding the bailing-out bucket wrong I&#x27;d not be too happy.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864440/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864441"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 27, 2021 16:08 UTC (Tue)
                               by <b>willy</b> (subscriber, #9762)
                              [<a href="/Articles/864441/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That&#x27;s swapon though, right? Not swapoff?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864441/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864932"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 2, 2021 18:51 UTC (Mon)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/864932/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That&#x27;s kind of both. Adding a higher priority swap space when zram can&#x27;t keep up only stops things getting exponentially worse - zram won&#x27;t shrink its RAM usage without a kick from an operator, and the kernel isn&#x27;t great with cases where swap also contributes to memory use. It&#x27;s like the swap-on-NFS problem but worse.<br>
<p>
(Fortunately for me I&#x27;ve got enough RAM nowadays to not care about that kind of thing, but I&#x27;d spare a thought for people that still do.)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864932/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor864662"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2021 13:16 UTC (Fri)
                               by <b>droundy</b> (subscriber, #4559)
                              [<a href="/Articles/864662/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I&#x27;ve used &quot;swapoff -a &amp;&amp; swapon -a&quot; relatively frequently to recover from the situation where my system has written a few gigabytes to swap and when the memory pressure receded, zoom was still being incredibly slow, presumably due to slowing swapping memory back in.  Without this trick it takes ages to get things back to to speed. Not sure what zoom does with all that RAM, maybe garbage collection?<br>
<p>
Of course, I try to do this *after* the swap storm and when there&#x27;s plenty of memory free, but I&#x27;m a human who is not fully able to predict the future.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864662/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864727"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 31, 2021 1:35 UTC (Sat)
                               by <b>pabs</b> (subscriber, #43278)
                              [<a href="/Articles/864727/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I&#x27;ve used that trick before too, it does help quite a bit in some situations.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864727/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
<a name="CommAnchor864259"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 25, 2021 18:06 UTC (Sun)
                               by <b>willy</b> (subscriber, #9762)
                              [<a href="/Articles/864259/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
... and at least one of those two patches is buggy. Hugh asked for it to be reverted upstream. Reverting from stable was clearly the right decision.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864259/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor864048"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 22, 2021 21:42 UTC (Thu)
                               by <b>roc</b> (subscriber, #30627)
                              [<a href="/Articles/864048/">Link</a>] (24 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
&quot;fixed more bugs than it has introduced&quot; seems like a weird way to evaluate &quot;stable&quot; updates. For users, the cost of an introduced regression is typically much higher than the value of a fixed bug. Something that was broken before starting to work -&gt; nice to have. Something that was working before doesn&#x27;t work -&gt; wailing and gnashing of teeth, time spent diagnosing the problem and possibly downgrading the kernel.<br>
<p>
Also each regression teaches users to be afraid of updating the kernel, and even to be afraid of upgrading other software components, making them less likely to accept future updates, and thus exposed to ongoing to security issues.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864048/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864067"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 3:24 UTC (Fri)
                               by <b>wtarreau</b> (subscriber, #51152)
                              [<a href="/Articles/864067/">Link</a>] (23 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That&#x27;s why it&#x27;s generally recommended not to immediately upgrade sensitive machines to the latest -stable, especially if it looks quite fat. Others can see these regressions before you and you stay safe.<br>
<p>
Stable kernels have become extremely reliable these days. The likelihood of facing a regression there is extremely low, and these kernels experience a lot of tests by various teams before being released. Even if a regression is introduced, it&#x27;s often unlikely that you&#x27;ll actually face it due to the wide spectrum of areas covered by each version.<br>
<p>
As I once mentioned, in many years of rebasing our products onto the latest -stable, we&#x27;ve met a regression only once, and it was not caused by the official kernel but by one of our patches being applied at the wrong place. Because that&#x27;s also something important to remind, that many stable users do have extra patches on top of the kernel. Some of these patches are extra features/drivers, and some used to be fixes relevant to the use case, that can often be dropped after they&#x27;re merged into -stable.<br>
<p>
From an ex-stable maintainer&#x27;s perspective I find the size of current kernels scary, for me the limit was around ~200 at once, entirely handled manually and with limited testing. But with all the current tooling and tests, I&#x27;m not shocked by 800 patches. The current kernel development process probably is one of the most efficient, scalable and robust of all the software industry, and I&#x27;m sure it still has some margin to further improve!<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864067/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864072"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 6:41 UTC (Fri)
                               by <b>bgilbert</b> (subscriber, #4738)
                              [<a href="/Articles/864072/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <p>At CoreOS in late 2017/early 2018 we switched to shipping the latest stable LTS kernels, with a single-digit number of (small) patches on top.  We learned to be more cautious after we had <a href="https://lists.linuxfoundation.org/pipermail/ksummit-discuss/2018-September/005287.html">six regressions in seven months</a>.</p>

<p>The last straw was a bug that caused large downloads to run at ~300 bytes/sec, which rather interfered with shipping a fix.  That change had landed in the stable tree &mdash; against the policy of the networking subsystem &mdash; after someone submitted it to the stable@ mailing list.  It turned out to be part two of a two-patch series.</p>







      
          <div class="CommentReplyButton">
            <form action="/Articles/864072/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864209"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 24, 2021 9:44 UTC (Sat)
                               by <b>wtarreau</b> (subscriber, #51152)
                              [<a href="/Articles/864209/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That&#x27;s indeed rather bad and doesn&#x27;t translate my experience. Don&#x27;t you feel that the quality has overall improved over the last 3 years since you faced this ?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864209/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor864211"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 24, 2021 9:54 UTC (Sat)
                               by <b>pabs</b> (subscriber, #43278)
                              [<a href="/Articles/864211/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Do you have automated testing in place to detect the next set of regressions? Can that testing be done upstream in KernelCI and other places?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864211/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864224"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 24, 2021 19:39 UTC (Sat)
                               by <b>bgilbert</b> (subscriber, #4738)
                              [<a href="/Articles/864224/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <p>We had automated tests for common uses of the distro, and those did occasionally catch regressions before release.  (Those tests were unfortunately pretty tied to our custom test framework.)  The regressions we didn't catch usually affected a non-default configuration or network environment.  These were often things that an upstream subsystem test suite might reasonably be expected to test, but from our perspective as a downstream consumer, we had no hope of QA'ing an entire kernel ourselves.  We ultimately addressed this with a policy change: no upstream stable release would be promoted to our stable channel until it had spent a week in our beta channel, being exposed to user workloads.</p>

<p>I agree with roc that regressions in stable kernels should be viewed as a failure of upstream QA, not of downstream QA.  I wonder if some of the friction could be addressed by setting expectations properly.  If the stable maintainers don't intend their kernels to be used without significant additional validation, and consistently said so, then others wouldn't keep discovering these problems the hard way.  But in my experience, the current maintainers tend to push users to run the latest releases (sometimes <a href="https://github.com/coreos/linux/pull/302#issuecomment-462918750">quite directly</a>) while being <a href="https://lwn.net/Articles/769253/">less than entirely responsive</a> to stability concerns.</p>











      
          <div class="CommentReplyButton">
            <form action="/Articles/864224/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864275"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 25, 2021 22:34 UTC (Sun)
                               by <b>rodgerd</b> (guest, #58896)
                              [<a href="/Articles/864275/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; I agree with roc that regressions in stable kernels should be viewed as a failure of upstream QA, not of downstream QA.</font><br>
<p>
Otherwise it&#x27;s just an attempt to have it both ways: harangue users for not using &quot;stable&quot; kernels instead of distro kernels, while refusing to provide users the same level of guarantees that Debian, Red Hat, Ubuntu, etc offer their users.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864275/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864353"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 26, 2021 16:48 UTC (Mon)
                               by <b>wtarreau</b> (subscriber, #51152)
                              [<a href="/Articles/864353/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
A regression is always a failure, from all those involved in the operation that led to that regression: the author of the original code that had to be patched; the author of the patch that possibly overlooked some side effects or was not precise enough regarding the backport instructions; those who thought they understood the changes enough to apply them or to ignore a companion patch, etc. <br>
<p>
There is no excuse for a regression, and it&#x27;s pointless to try to blame this one or that one, everyone should work together to get it fixed ASAP and limit the risk that the same situation can repeat. It will always happen but it has to remain exceptionally rare.<br>
<p>
But there&#x27;s something worse than regressions, it&#x27;s not applying fixes. And that&#x27;s precisely the problem regressions are causing: by lack of trust, users tend to apply fixes less often or to only pick some; and by excess of upstream validation, the amount of efforts can slow down creation or adoption of fixes. A good balance is required, and ideally a target of number of regressions per year should be established as a reference to gauge the overall quality (e.g. no more than 3 minor and 1 major per year).<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864353/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864356"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 26, 2021 17:37 UTC (Mon)
                               by <b>bgilbert</b> (subscriber, #4738)
                              [<a href="/Articles/864356/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I agree with most of your post, but it&#x27;s framed around a premise I don&#x27;t think is right:<br>
<p>
<font class="QuotedText">&gt; But there&#x27;s something worse than regressions, it&#x27;s not applying fixes.</font><br>
<p>
We do ourselves a disservice by thinking of fixes as the greatest possible good.  As roc pointed out upthread, lots of users don&#x27;t see things that way.  They think in terms of risk/reward tradeoffs, and thus so should we.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864356/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864367"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 26, 2021 20:46 UTC (Mon)
                               by <b>wtarreau</b> (subscriber, #51152)
                              [<a href="/Articles/864367/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;  We do ourselves a disservice by thinking of fixes as the greatest possible good. As roc pointed out upthread, lots of users don&#x27;t see things that way. They think in terms of risk/reward tradeoffs, and thus so should we.</font><br>
<p>
They think like this until they&#x27;re seriously hit by a bug and ask for their data to come back. The worst issues you can have (IMHO) are those which silently destroy your data. Memory corruption bugs can be part of them sometimes, file-system bugs as well. Bugs where a network driver can receive packets larger than the allocated buffer can cause this. All of such bugs are totally ignored by the vast majority of the users, which is why they believe they&#x27;d rather not apply fixes. But when they find zeroes or random stuff inside their source files or their holidays photos, and that all their backups are corrupted because what was backed up is what was written, then they seriously complain that it&#x27;s criminal not to integrate fixes for such issues.<br>
<p>
However I do agree that the vast majority don&#x27;t are about bugs that cause crashes from time to time, or instabilities that require a reboot to stay on the safe side. But the frontier between the two categories is often extremely blury.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864367/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor864081"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 9:32 UTC (Fri)
                               by <b>mjg59</b> (subscriber, #23239)
                              [<a href="/Articles/864081/">Link</a>] (10 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; That&#x27;s why it&#x27;s generally recommended not to immediately upgrade sensitive machines to the latest -stable</font><br>
<p>
Then how do you ensure they receive relevant security updates?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864081/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864099"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 13:32 UTC (Fri)
                               by <b>wtarreau</b> (subscriber, #51152)
                              [<a href="/Articles/864099/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;  Then how do you ensure they receive relevant security updates?</font><br>
<p>
How do you ensure that any security update that&#x27;s relevant to you isn&#x27;t irrelevant to the rest of the world, or that any fix for a file-system corruption, or a bug that causes 3 reboots per hour is in ?<br>
<p>
The process is always the same, quick glance at the first column of the change log, look for the subsystems you rely on, if they&#x27;re not present you possibly don&#x27;t care. If you see a ton of them, you probably care but it can represent a risk. That&#x27;s where you have to plan to &quot;upgrade soon&quot;. If something breaks badly, usually within a day or two, a new version follows with very few fixes. Subtle breakage can take a week or two.<br>
<p>
And the extremely rare, critical security updates that require everyone to upgrade are always publicly discussed and relayed everywhere (like here) so that everyone knows that it&#x27;s about time to upgrade.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864099/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864194"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 20:58 UTC (Fri)
                               by <b>roc</b> (subscriber, #30627)
                              [<a href="/Articles/864194/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It is absurd to expect Linux end users to inspect kernel changelogs to decide whether or when to apply a kernel update.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864194/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864203"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 23:13 UTC (Fri)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/864203/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Indeed. I&#x27;m pretty tech-savvy, but if someone were to ask me if the frobnitz subsystem is important to me, I&#x27;d have to say…not sure? Given the obtuseness of many driver names, it&#x27;s not something one is likely to be able to remember easily.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864203/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864210"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 24, 2021 9:49 UTC (Sat)
                               by <b>wtarreau</b> (subscriber, #51152)
                              [<a href="/Articles/864210/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
In my opinion, when you build your own kernels it&#x27;s because you&#x27;re not interested in the distro&#x27;s kernel so you know what you&#x27;re using.<br>
<p>
The situation is problematic for distros, though, who have to swallow everything because everything is used in field. But in this case, being late by a week or two avoids shipping the rare versions that are extremely broken like @dgilbert faced above.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864210/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864279"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 26, 2021 4:58 UTC (Mon)
                               by <b>roc</b> (subscriber, #30627)
                              [<a href="/Articles/864279/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Unfortunately, shipping security updates late by a week or two is a huge problem these days. The bad guys can reverse engineer bugs from patches and deploy exploits in under a week.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864279/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864282"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 26, 2021 6:09 UTC (Mon)
                               by <b>wtarreau</b> (subscriber, #51152)
                              [<a href="/Articles/864282/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; The bad guys can reverse engineer bugs from patches and deploy exploits in under a week.</font><br>
<p>
The bad guys often have discovered these vulns long before they were reported, because there&#x27;s a real economy behind finding and selling vulnerabilities, and when one becomes reported, it can be one that was already in active use (or waiting to be used), too bad for the bad guys then, or one that was already worn out and about to be disclosed thus not interesting enough for them anymore. E.g. <a href="http://zerodium.com/program.html">http://zerodium.com/program.html</a><br>
<p>
When you figure you have an opportunity to sell your discovery for $2.5M, would you report it or sell it ? Hard to tell. Probably that the second one to try to sell it fails because it&#x27;s already known from the buyer, then it&#x27;s time to report it, give it a name and logo, and become famous :-/<br>
<p>
For sure there are a number of vulnerabilities that are first discovered by the reporter, but I&#x27;m far from being convinced they&#x27;re the majority.<br>
<p>
In fact what embargoes protect against are mostly script kiddies having fun with their OS, leaving no quick solution to their admin.<br>
In addition, even in sensitive places, lots of admins don&#x27;t update and reboot immediately after a vulnerability was disclosed and fixed. Even if there&#x27;s a know exploit. That&#x27;s why in practice reducing the attack surface by disabling all unused features remains way more of an effective protection than instantly jumping on the last update, because it protects you *before* the vulnerability is public.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864282/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864382"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 27, 2021 2:27 UTC (Tue)
                               by <b>roc</b> (subscriber, #30627)
                              [<a href="/Articles/864382/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It&#x27;s certainly true that many vulnerabilities are discovered by *someone* before the fix is released, but it is also true that they are discovered by many more people *after* the fix is released.<br>
<p>
<font class="QuotedText">&gt; That&#x27;s why in practice reducing the attack surface by disabling all unused features remains way more of an effective protection than instantly jumping on the last update</font><br>
<p>
This is only makes sense for kernel users who are also kernel developers. *Maybe* conscientious developers of embedded devices would do this before they ship (though developers of such devices are not known for being conscientious). Anyone using third-party software is very unlikely to disable standard kernel features because the risk of breakage is very high. I&#x27;ve certainly never heard of cloud or desktop Linux users doing this.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864382/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864386"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 27, 2021 6:28 UTC (Tue)
                               by <b>wtarreau</b> (subscriber, #51152)
                              [<a href="/Articles/864386/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;  This is only makes sense for kernel users who are also kernel developers.</font><br>
<p>
Not kernel developers, but anyone interested in doing a bit of tuning. Rebuilding one&#x27;s kernel is often considered as a milestone in one&#x27;s discovery of Linux.<br>
<p>
<font class="QuotedText">&gt; *Maybe* conscientious developers of embedded devices would do this before they ship (though developers of such devices are not known for being conscientious).</font><br>
<p>
In most embedded devices, it&#x27;s very common for two reasons:<br>
  - resources usage / kernel size reduction<br>
  - you know exactly what is required by your machine and you precisely prefer to reduce the attack surface because it buys you some time to deliver updates. It&#x27;s very convenient to be able to tell a customer &quot;don&#x27;t worry, you&#x27;re not affected&quot;.<br>
<p>
<font class="QuotedText">&gt; Anyone using third-party software is very unlikely to disable standard kernel features because the risk of breakage is very high.</font><br>
<p>
Absolutely!<br>
<p>
<font class="QuotedText">&gt; I&#x27;ve certainly never heard of cloud or desktop Linux users doing this.</font><br>
<p>
In clouds it&#x27;s pretty rare because if your machine doesn&#x27;t restart sometimes it&#x27;s hard to access the console to fix it. But on desktop it used to be unavoidable for some time at the beginning: you had to compile your kernel to set the NIC&#x27;s address on the ISA slot, to set the sound card&#x27;s address/IRQ/DMA, then later to enable frame buffer only for your own graphics card because there were multiple drivers available and some didn&#x27;t work as modules or would take over yours, etc. Things have progressed a lot since, but those who were used to such practices have probably continued. At least all my machines continue to run LTS kernels that I configure and build myself because they perfectly match what I need or the tunings I prefer. &quot;make oldconfig&quot; is also a great way to discover new features, new filesystems, etc.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864386/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864608"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 29, 2021 20:16 UTC (Thu)
                               by <b>Wol</b> (subscriber, #4433)
                              [<a href="/Articles/864608/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Don&#x27;t forget Gentoo ...<br>
<p>
Cheers,<br>
Wol<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864608/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor864444"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 27, 2021 16:10 UTC (Tue)
                               by <b>flussence</b> (guest, #85566)
                              [<a href="/Articles/864444/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
How do people cope in the Windows world?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864444/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor864195"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 21:21 UTC (Fri)
                               by <b>roc</b> (subscriber, #30627)
                              [<a href="/Articles/864195/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; The current kernel development process probably is one of the most efficient, scalable and robust of all the software industry</font><br>
<p>
That may be true but only because most of the software industry is a disaster area. In reality, the kernel development process is pretty far behind well-run projects. E.g.<br>
<p>
There is no systematic bug tracking. You report bugs by emailing a bunch of people and LKML and hoping that they don&#x27;t all ignore you. If it&#x27;s a regression, you have to manually track whether it has been fixed in time for a release, nag people if it hasn&#x27;t, etc. It&#x27;s often unclear who, if anyone, is taking responsibility for the bug. Good projects have a bug tracking system that they actually use, so at any point in time anyone can pull up a list of the bugs that need to be fixed before the release and who&#x27;s responsible for them.<br>
<p>
Testing is still very weak. Good projects expect that when you submit a bug fix, you also submit an automated test for the bug. The kernel has no such expectation. And the kernel tests are still not being run frequently enough: there should be a large set of tests running on every significant change. Progress is being made, but there&#x27;s a long way to go.<br>
<p>
One thing that the kernel dev process definitely is *not*: efficient. Maybe it&#x27;s efficient for the core developers but for people outside that core --- wrangling bugs, doing QA, dealing with LKML, inspecting changelogs to decide whether they should update to -stable today --- it is horrendously inefficient.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864195/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864204"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 24, 2021 0:07 UTC (Sat)
                               by <b>pizza</b> (subscriber, #46)
                              [<a href="/Articles/864204/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Testing is still very weak. Good projects expect that when you submit a bug fix, you also submit an automated test for the bug. The kernel has no such expectation. And the kernel tests are still not being run frequently enough: there should be a large set of tests running on every significant change. Progress is being made, but there&#x27;s a long way to go.</font><br>
<p>
There are a _huge_ number of tests being routinely run on the Linux kernel, and more are constantly being written.  But those doing the testing tend to focus on the use cases they care about, which may or may not overlap with what anyone else cares about.<br>
<p>
While many of the kernel subsystems can be independently tested, &gt;80% of the kernel sources consists of device drivers whose corresponding hardware exhibits complex behaviors that depend heavily on what is going on outside the device, even before the huge combinatorial challenge of platform/arch-specific CONFIG_* options is factored in.<br>
<p>
As an example of this, I spent most of the last few days trying to hunt down the cause of a firmware panic with an Intel AX200 card on a custom aarch64-based board -- turns out that at the time the SoC vendor kernel was forked, the iwlwifi driver (and that card+firmware combo) had not been tested on a system that didn&#x27;t have ACPI.<br>
<p>
But how exactly are we to ensure a similar regression doesn&#x27;t occur, without actually executing that particular set of kernel options on that particular board with that hardware?   No matter where you draw the line, it&#x27;s going to necessarily exclude some usecases.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864204/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864281"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 26, 2021 5:03 UTC (Mon)
                               by <b>roc</b> (subscriber, #30627)
                              [<a href="/Articles/864281/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Indeed, you can&#x27;t test all combinations of features. But the kernel is a long way from that being the biggest problem. For example AFAIK there is still no automated testing of all 32-bit-compat wrappers for 64-bit syscalls. (We have such testing in the rr testsuite, which has detected quite a few kernel bugs.)<br>
<p>
A huge number of tests is not impressive by itself, since the kernel is a huge project.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864281/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor865367"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 5, 2021 17:31 UTC (Thu)
                               by <b>tuna</b> (guest, #44480)
                              [<a href="/Articles/865367/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Isn&#x27;t this what you pay Redhat etc to do for you (if you do not want to invest the engineering resources yourself)?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/865367/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor864050"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 22, 2021 22:05 UTC (Thu)
                               by <b>ojab</b> (guest, #54051)
                              [<a href="/Articles/864050/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
With highly scientific script <br>
```ruby<br>
require &#x27;open3&#x27;<br>
require &#x27;csv&#x27;<br>
<p>
tags = `git tag`<br>
  .lines<br>
  .grep_v(/v2\.6/)<br>
  .grep(/^v[0-9]\./)<br>
  .map { |tag| Gem::Version.new(tag[1..-1]) }<br>
  .reject(&amp;:prerelease?)<br>
<p>
releases = tags.chunk { |version| tags.first.segments[0, 2] }<br>
<p>
versions = {}<br>
releases.each do |major, minors|<br>
  minors.sort.each_cons(2) do |prev, current|<br>
    stdout_str, status = Open3.capture2(&#x27;git&#x27;, &#x27;rev-list&#x27;, &#x27;--count&#x27;, &quot;v#{prev}..v#{current}&quot;)<br>
    versions[current] = Integer(stdout_str.strip)<br>
  end<br>
end<br>
<p>
CSV.open(&#x27;/tmp/kern.csv&#x27;, &#x27;wb&#x27;) do |csv|<br>
  versions.each do |gem_version, commits_count|<br>
    csv &lt;&lt; [gem_version.to_s, commits_count.to_s]<br>
  end<br>
end<br>
``` <br>
I got data in <a href="https://docs.google.com/spreadsheets/d/1ieNTu9qyaOSx00A8BxVVcowUqshsuZMr5TvJtw8RtY4/edit?usp=sharing">https://docs.google.com/spreadsheets/d/1ieNTu9qyaOSx00A8B...</a> (hopefully it works, google docs is hard).<br>
<p>
So while we have many commits here, kernel-3.16.35 has 3960 more commits than 3.16.34 which is way bigger than any of the mentioned kernels.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864050/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864052"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 22, 2021 23:00 UTC (Thu)
                               by <b>ojab</b> (guest, #54051)
                              [<a href="/Articles/864052/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
And if we count rc and add tag date <a href="https://gist.github.com/e92a2fe68405f3acb621b1e1b5d5c863">https://gist.github.com/e92a2fe68405f3acb621b1e1b5d5c863</a> we would have <a href="https://docs.google.com/spreadsheets/d/1LJL1o6IBRZb3bb2PnEYDAgWdJNiLpdwZorLPX28fPxE/edit?usp=sharing">https://docs.google.com/spreadsheets/d/1LJL1o6IBRZb3bb2Pn...</a> table.<br>
<p>
While 5.13.2 after 5.14-rc1 has 803 commits, it&#x27;s not really unusual number at all. 5.12.4 after 5.13-rc1 had 676 commits, 5.11.3 after 5.12-rc1 had 773 commits, etc.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864052/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864054"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 22, 2021 23:08 UTC (Thu)
                               by <b>ojab</b> (guest, #54051)
                              [<a href="/Articles/864054/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Overall looks like maintainer/gregkh scripts was changed after 5.10-rc1, there is ~2x jump from ~450 to 750+ patches to the current stable after rc1.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864054/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor864025"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 22, 2021 22:51 UTC (Thu)
                               by <b>zblaxell</b> (subscriber, #26385)
                              [<a href="/Articles/864025/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <blockquote> the development cycle is not even close to being finished when Linus Torvalds applies a tag and leaves the building.</blockquote>

 "One kernel release good enough for everyone" has never happened before in human history, and it's certainly not going to happen for the first time within the lifetime of the Linux kernel project.

<p>Every project I've ever worked on, witnessed, or even _heard of_ follows one of two patterns for at-scale user deployments:

<ol>
<li>  Start from upstream (Linus in this case) and run it through weeks, months, or years of review and testing in a multi-stage QA pipeline, until it's finally <s>ready for general user workloads</s> not worse for some specific workload than what your specific users are running now.

<li>  Ship it downstream without testing because upstream signed off on it, and wonder why the UX is so terrible that users have started following you around with pitchforks and torches--or switched to some other upstream, and no longer following you at all.
</ol>

If you don't want pattern #2, you have to drastically narrow the scope to the parts of the software you can test, and (for security) make sure software you're not using can't be brought into scope.  There's finite resources available and choices have to be made.  Users downstream from you might disagree with your choices.  One of the awesome things about the Linux development model is that <em>this disagreement doesn't matter</em>, because users can choose the QA filter path between them and Linus.  As long as downstream QA sends feedback upstream so that upstream eventually improves, and users can reposition themselves at the output end of a QA filter appropriate for their needs (or build their own custom filter), it all more or less works.

<p>It follows that all downstream users are QA filters, all the way to the end user.  Distro follows kernel.org, maybe applies a few extra fixes or drops entire releases, or imposes a 6-week delay so that users of other distros can report bugs.  Corporate IT follows distro, runs more specialized tests for product owners.  Product owners run their own product's tests against new kernels.  If the product stops working, there shall be no kernel upgrade that week ("concrete outage" usually trumps "theoretical vulnerability").  App users who fail to get service because one of the above didn't do their QA diligence will migrate to some other startup's product.  IoT vendors who let a bad kernel upgrade slip through might experience a business-terminating event.  Even individual hobbyists will back out a bad kernel upgrade after the fact, and try upgrading again next week.

<p>10-20% of kernel.org kernels currently fail product regression tests every year, so this filtering process is more or less mandatory for users running Linux in production.  With more aggressive -rc kernel fix scraping, that defect rate might rise to 40% and not cause any real problems for anyone:  some users might discover they are not positioned at the output end of QA filter appropriate for their needs, and maybe it's a few months between usable upstream kernels instead of a few weeks, but the overall flow won't change.   It will still be necessary to distill every -stable kernel before use even if the defect rate was magically orders of magnitude lower.

<p>On the other side of Linus (i.e. where Linus is downstream) it's a very different problem.  Subsystem maintainers spend a lot of resources on testing changes in groups (i.e. the entire content of a pull request) and comparatively little on testing all possible combinations of individual commits.   Scraping individual patches out of -rc avoids the benefit of that pre-integration testing (at some level of abstraction, this is what led to the late-2020 XFS regression).  Subsystem maintainer's QA tests will pass because the PR has all the critical dependencies in place, while the scraped commits version fails because critical dependencies weren't declared by tags.  Sometimes it's only possible to know what a commit truly depends on by bisection testing, so it's too burdensome to ask the maintainer to declare dependencies--it would be less work to have the maintainer send the PR, or a bespoke modified version of it, to -stable, than to fill in tags everywhere in case a robot might one day use them.

<p>If the scraping becomes too aggressive,<ol><li>  subsystem maintainers will have to divert some resources to testing the scraper's output in addition to their existing work (the scraper's input), <li>someone will have to contribute resources to replicate the subsystem tests on the scraper's output side, or <li> everyone will have to accept the net decrease in -stable kernel quality.</ol>

I think if we want more aggressive -stable backporting, we really have to directly ask subsystem maintainers to provide that, and maybe contribute some humans to specialize in that work.  The robot is like a mediocre intern, creating more work for others than it accomplishes itself.






































































      
          <div class="CommentReplyButton">
            <form action="/Articles/864025/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864055"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 22, 2021 23:27 UTC (Thu)
                               by <b>roc</b> (subscriber, #30627)
                              [<a href="/Articles/864055/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This &quot;let downstream be responsible for QA&quot; approach creates a lot of problems.<br>
<p>
One problem is, a lot of users use distros that ship -stable releases with minimal testing. So users *do* get burned because their QA path is too short.<br>
<p>
On the other hand, distros kind of *need* to ship -stable releases with minimal testing because you need to ship security updates quickly and kernel upstream intentionally conceals information about which commits are security fixes. I guess in some cases this information is circulated on private mailing lists, but AFAIK that&#x27;s not true for all security fixes.<br>
<p>
Another problem is, users experiencing kernel regressions often misattribute the issue to other software, and developers of that software are burdened. Happens to us with rr from time to time.<br>
<p>
Another problem is, the more &quot;downstream QA&quot; is required, the slower and less reliable is the process of reporting and fixing regressions.<br>
<p>
Another problem is, all the downstream kernel testing and bug reporting duplicates work. When users find a regression it&#x27;s usually not just one user, but many who hit the bug, diagnose it, track down whether it has been reported, and often end up reporting it multiple times. I imagine the same is true to a lesser extent at the distro level.<br>
<p>
But &quot;Downstream is responsible for QA&quot; is a great model for kernel developers and that trumps all.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864055/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864077"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 7:48 UTC (Fri)
                               by <b>taladar</b> (subscriber, #68407)
                              [<a href="/Articles/864077/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
As long as downstream wants to change which commits are included in their kernel they will have to do QA. As the person you replied to said, you can not expect developers to test every possible combination of commits for possible bugs or regressions.<br>
<p>
What is really at the core of the issue here is the false concept of &quot;stable&quot; versions based on backports. A &quot;stable&quot; version is nothing more than a completely new and untested version of the software that no developer has seen in that form. The fact that it is new and untested not based on new development but based on selecting a subset of the patches between the old &quot;stable&quot; and the latest released version does not mean it gets any more stability.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864077/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864197"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 21:25 UTC (Fri)
                               by <b>roc</b> (subscriber, #30627)
                              [<a href="/Articles/864197/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Downstream has to do some QA, yes, but that can and should be minimised.<br>
<p>
The attitude should be &quot;if a bug introduced upstream reaches downstream, that is a failure of upstream QA which should be fixed&quot;.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864197/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor864069"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 3:34 UTC (Fri)
                               by <b>wtarreau</b> (subscriber, #51152)
                              [<a href="/Articles/864069/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I know pretty well this trouble for facing it in haproxy. There, we ask that bug fixes are explicitly marked as such, and that when known, developers try to mention how far that should be backported (not surprising that I was one of the proponents of &quot;Fixes:&quot; long ago :-))<br>
<p>
What I&#x27;m used to doing there is to *explicitly* mention in a commit message &quot;no backport needed&quot; if I prefer it not to be backported. I know that some devs will not make any mention if they don&#x27;t want it to be backported, it mostly depends on what developers work on (i.e. perpetual core development usually causes bugs that require a quick fix that has nothing to do in stable, while peripheral areas tends to be stabler and should get their fixes backported unless specified otherwise).<br>
<p>
Here we&#x27;re still missing the notion of &quot;this is a fix&quot;, it often comes in the &quot;fixes:&quot; tag but given that it has to contain a commit ID, it&#x27;s not always trivial to get or developers are lazy. I really think that including &quot;fix&quot; or &quot;bug&quot; in the subject does help a lot to get that info.<br>
And from this, depending on the indication *and* the person, you know the policy: explicit no-backport (written), implicit no-backport (person), implicit backport (person), explicit backport (written).<br>
<p>
This approach gives us a lot of flexibility. For example some developers occasionally provide significant improvements in certain areas that are considered worth backporting after some observation time. They can mention it in their commit message like &quot;it might be worth backporting; if done, this patch also requires the following patches to be backported: &lt;list&gt;&quot;. And that&#x27;s used quite a bit because it&#x27;s actually rewarding for developers to see their improvements adopted faster. For example when you change a test from O(n^2) to O(n*log(n)), sometimes it&#x27;s worth backporting if O(n^2) was causing stability trouble to some users even if it&#x27;s not technically a fix.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864069/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864092"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 12:35 UTC (Fri)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/864092/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It seems like it&#x27;d be useful to drop a note to the original patch submission thread that &quot;hi, patches A, B, and C from this series has been selected for stable trees X, Y, and Z&quot; (bonus points if the bit that hinted that it should be backported could be teased from the ML tool and mentioned as well) to start discussion about it. Then authors and reviewers can give feedback of &quot;you can&#x27;t just pull a subset of these patches&quot; or &quot;your machine is wrong, please add this as a negative case for training purposes&quot;. It&#x27;s certainly better than expecting everyone to be on top of an 800 patch series review that&#x27;s go-or-no-go in 2 days.<br>
<p>
However, I believe this likely requires improved metadata tracking throughout the kernel development workflow which opens *that* topic.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864092/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864095"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 12:59 UTC (Fri)
                               by <b>wtarreau</b> (subscriber, #51152)
                              [<a href="/Articles/864095/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I was about to say that what you&#x27;re proposing is already handled by being CCed when the patches are sent to the queue, but no, I get your point and I think you&#x27;re right. Having a synthetic summary as a response to an old thread making it clear that only a subset was picked can be useful. In addition, reviewers/authors/participants could also respond &quot;wait a minute, that was broken, we added two extra patches later&quot;. Rememeber the Spectre series of fixes ?<br>
<p>
With lore.kernel.org in place, and ability to identify threads and patch series, I think this should not be too difficult anymore to spot the relevant thread, message ID and CC list and respond there. Of couse it&#x27;s definitely extra work to be implemented, but probably worth it.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864095/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor864079"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 8:42 UTC (Fri)
                               by <b>mkubecek</b> (guest, #130791)
                              [<a href="/Articles/864079/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Many developers see the stable updates as a carefully curated collection of hand-selected fixes, each of which has been extensively reviewed for importance and the lack of regression potential.</font><br>
<p>
One can hardly blame them if we still carry file Documentation/process/stable-kernel-rules.rst in the kernel tree and its first section still says essentially what these people think. It&#x27;s really interesting to go through these rules and compare them to how stable backports are actually done these days (and have been for a few years). Things can certainly change but if stable maintainers decided that stable branches should work in a completely different way than they were originally meant to, they should IMHO start by rewriting those rules to avoid confusion and make it clear that stable is no longer what it used to be.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864079/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864084"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 23, 2021 9:42 UTC (Fri)
                               by <b>pbonzini</b> (subscriber, #60935)
                              [<a href="/Articles/864084/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I&#x27;m comforted that I am not the only one having had discussions similar to <a href="https://lore.kernel.org/linux-mm/20190808163928.118f8da4f4289f7c51b8ffd4@linux-foundation.org/">https://lore.kernel.org/linux-mm/20190808163928.118f8da4f...</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864084/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor864288"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 26, 2021 14:58 UTC (Mon)
                               by <b>tlamp</b> (subscriber, #108540)
                              [<a href="/Articles/864288/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; As always in the Linux world, the people who are doing the work will decide how the work is to be done, and the stable maintainers have opted for the &quot;promiscuous&quot; approach.</font><br>
<p>
But they do *not* have to do the work to diagnose weird regressions in a specific sub system, find out what -stable even did backport (as often preparatory stuff is missed) and then see how to fix, that&#x27;s done by either the maintainer themselves after getting reports from users or from some downstream project, that was naive enough to think the name of the -stable tree and its documentation[0] are actually resembling reality.<br>
<p>
This is asymmetric work generation, a few people use semi-transparent, automated processes, which cannot be that much work (as how else could one churn out multiple stable releases with hundreds to thousands of commits almost daily), to create quite some amount of  pain and diagnostic + fixing work for a lot of people.<br>
<p>
As it seems, even those producing the actual fixes for a completely different code tree cannot even request otherwise, i.e., that some patches are excluded from those dumb scripts, but have no choice and are then forced to react and face the negative image - as from the outside one sees mostly that the respective subsystem took in the &quot;bad patch&quot; (even if it has gone bad only due to backporting).<br>
<p>
So, the people that have to do the actual work do not seem like being able to decide much...<br>
<p>
[0]: <a href="https://www.kernel.org/doc/html/v5.10/process/stable-kernel-rules.html">https://www.kernel.org/doc/html/v5.10/process/stable-kern...</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864288/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864354"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 26, 2021 17:04 UTC (Mon)
                               by <b>wtarreau</b> (subscriber, #51152)
                              [<a href="/Articles/864354/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;  This is asymmetric work generation, a few people use semi-transparent, automated processes, which cannot be that much work (as how else could one churn out multiple stable releases with hundreds to thousands of commits almost daily), to create quite some amount of pain and diagnostic + fixing work for a lot of people.</font><br>
<p>
I strongly disagree with the oversimplification you&#x27;re making here.<br>
<p>
For having extended a few kernels in the past, the last two being 2.6.32 and 3.10, I can tell you that backporting requires a huge amount of work. In order to propose 200 patches for review, I had to work 2 week-ends full-time.<br>
<p>
In such a situation you try to automate whatever you can but that only solves the easy parts. There&#x27;s a lot of background work, discussions with authors to ask whether something that looks important and resists the backport is really important, etc. For sure, Sasha developed some tools to ease the work. They&#x27;re mostly about pre-selecting fixes that look relevant but were not tagged (since the identified problem in the first place is that maintenance is far from being a primary concern from many submitters). But the backport work has to be done anyway. You can instrument your tools to try to fit a patch into a version to try to figure which one of the surrounding patches helps fix the context, and if it&#x27;s relevant or not. Yet there&#x27;s a lot of manual work.<br>
<p>
And I would say that most of the patches that backport without efforts are unlikely to be the ones causing the most regressions because they&#x27;re trivial and in code that almost never changes.<br>
<p>
If Greg recently threatened not to extend 5.10 if he didn&#x27;t get more arms to help him, it was not to make noise, it was because this really is a tough job. I personally offered to try to do a little bit more but I don&#x27;t have the energy to work as much as I used to on this. Two 16-hours-a-day week-ends per release to review 6000 patches and pick 200 is way too much for me now.<br>
<p>
Now if you think that you&#x27;d do better than what the stable team currently does, I strongly encourage you to contact stable@kernel.org to propose your help, which will really be welcome.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864354/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864388"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 27, 2021 7:15 UTC (Tue)
                               by <b>tlamp</b> (subscriber, #108540)
                              [<a href="/Articles/864388/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It was really an oversimplification, sorry about that.<br>
<p>
But the point I rather wanted to convey that why not allow maintainers their say in the matter?<br>
<p>
If a maintainer, i.e., one of the persons that knows their subsystem best, objects to backporting stuff they do not deem as fit for that it should be respected? As, yes while assembling stable kernels is surely more work than my oversimplification may have tried to make it look like, it&#x27;s also a lot of work to get forced into fixing up something you did object in the first place.<br>
<p>
So why not keep the automatic process and scoop up as much as stuff one thinks that it could possibly fix something, but also honor the objection of some maintainers?<br>
<p>
<font class="QuotedText">&gt; Now if you think that you&#x27;d do better than what the stable team currently does, I strongly encourage you to contact stable@kernel.org to propose your help, which will really be welcome.</font><br>
<p>
I do not necessarily think that, and I also did not state that.<br>
FWIW, my downstream kernel was bitten by such backports which I spent quite some time to diagnose and untangle and also sent the result to the stable list.<br>
<p>
This is also something a newcomer could not really help/change, it&#x27;s a more general decision and a single person not proposing backports a maintainer person does not seem fit, won&#x27;t stop the existing ones of doing so.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864388/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor864369"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 26, 2021 21:24 UTC (Mon)
                               by <b>NYKevin</b> (subscriber, #129325)
                              [<a href="/Articles/864369/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; But they do *not* have to do the work to diagnose weird regressions in a specific sub system, find out what -stable even did backport (as often preparatory stuff is missed) and then see how to fix, that&#x27;s done by either the maintainer themselves after getting reports from users or from some downstream project, that was naive enough to think the name of the -stable tree and its documentation[0] are actually resembling reality.</font><br>
<p>
What would happen if the various maintainers and downstreams just stopped doing that work? &quot;Nope, sorry, it doesn&#x27;t repro on Linus&#x27;s tree, so this bug is WONTFIX. Go complain to whoever backported your kernel for you, whether that&#x27;s -stable or your distro.&quot;<br>
<p>
I tend to imagine this would be disruptive, but it also strikes me that, ultimately, this is a volunteer project. If you don&#x27;t want to do the work, you always have the option of, well, not doing it.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864369/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864387"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 27, 2021 7:04 UTC (Tue)
                               by <b>tlamp</b> (subscriber, #108540)
                              [<a href="/Articles/864387/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;  I tend to imagine this would be disruptive, but it also strikes me that, ultimately, this is a volunteer project. If you don&#x27;t want to do the work, you always have the option of, well, not doing it.</font><br>
<p>
Sure, but as mentioned your subsystem would also face &quot;bad press&quot;, user sees only that the specific hardware, file system, or what not would be brittle, not the reasoning behind that. So, as most maintainers want their work to be actually useful and not riddled by issues, you have some pressure to do that work to a certain degree.<br>
<p>
I do not want to say the stable maintainers are doing this intentionally, I get their reasoning, but if a maintainer cannot even opt out for patches they do not see fit for backport (who&#x27;d be better to judge that as the maintainer?) this (badly worded) &quot;getting forced to act for something you did not want&quot; can be the result, at least sometimes.<br>
<p>
The process can be Ok in general, but why not allow the actual maintainers their say, as they are the ones that would actually do the work cleaning up any mess?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864387/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864409"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 27, 2021 14:32 UTC (Tue)
                               by <b>wtarreau</b> (subscriber, #51152)
                              [<a href="/Articles/864409/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; The process can be Ok in general, but why not allow the actual maintainers their say, as they are the ones that would actually do the work cleaning up any mess?</font><br>
<p>
They&#x27;re always consulted about this, this is exactly what&#x27;s asked during the patch review:<br>
<p>
.... &quot;If anyone has any issues with these being applied, please let me know.&quot; ....<br>
<p>
Maybe it&#x27;s just that the review duration is too short. But it&#x27;s hard to make the subject less visible, it precisely indicates the version and the patch. If maintainers don&#x27;t want to check because they don&#x27;t care, there&#x27;s nothing that can be done for their subsystems. I can understand that some don&#x27;t want to be bothered with this and turn backports off by default though.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864409/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864419"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 27, 2021 15:19 UTC (Tue)
                               by <b>tlamp</b> (subscriber, #108540)
                              [<a href="/Articles/864419/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; They&#x27;re always consulted about this, this is exactly what&#x27;s asked during the patch review:</font><br>
<p>
But the article we&#x27;re commenting on states: <br>
<p>
<font class="QuotedText">&gt; &quot;At present this -stable promiscuity is overriding the (sometime carefully) considered decisions of the MM developers, and that&#x27;s a bit scary.&quot; </font><br>
<font class="QuotedText">&gt; -- Andrew Morton</font><br>
<p>
So the maintainer would need to track all proposed series for all stable releases, check for any patches that they did not ack&#x27;ed for backport and explicitly NAK them, and reading GKH response here it feels a bit like they&#x27;d  then probably would need an actually Good Reason™ for each NAK, that sounds a bit backwards to me and quite the work (but granted, I&#x27;m only contributing occasionally, so that does not need to mean much, good filters and a bot could automate that if an actual maintainer would feel really that much pressured).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864419/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864463"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 28, 2021 3:08 UTC (Wed)
                               by <b>wtarreau</b> (subscriber, #51152)
                              [<a href="/Articles/864463/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
As I said previously, the only purpose of the bot is to collect the fixes from all those not used to explicitly marking their patches for backporting. As long as some maintainers are trusted and state that they take the responsibility for mentioning that and do not want to be bothered for each of their patch, that&#x27;s great. That&#x27;s exactly where the bot needs to support filters basically saying &quot;let&#x27;s trust that maintainer that he does not want his patch backported&quot;. But based on what&#x27;s currently merged, it just happens to be a faint minority.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864463/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor864690"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 30, 2021 15:40 UTC (Fri)
                               by <b>ecree</b> (guest, #95790)
                              [<a href="/Articles/864690/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I&#x27;ve definitely experienced at least once that I NAK&#x27;ed an autosel patch and then a couple of weeks later it showed up again in autosel and I had to NAK it again.  Idk whether the process has been fixed to prevent that — it hasn&#x27;t come up recently, probably because I&#x27;ve not been sending much upstream — but it certainly left a sour taste as to the workload of watching autosel like a hawk to catch it when it tries to screw up our driver.  I can well understand why people with responsibility for subsystems with a larger patch volume are getting frustrated.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864690/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor864380"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 27, 2021 2:03 UTC (Tue)
                               by <b>calumapplepie</b> (guest, #143655)
                              [<a href="/Articles/864380/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Lets add some better tags for these poor patches.<br>
<p>
There are other comments and people talking about better ways to structure the kernel workflow than &quot;lob everything at a mailing list and hope for the best&quot;.  Lets assume, for now, that they all fail miserably and we are forever stuck with the current email based workflow.<br>
<p>
Why not add a few more tags, to better indicate the nature of a given fix?  For instance:<br>
<p>
Severity:{cosmetic,minor,normal,important,grave}: describes how bad the  Grave patches are always backported.   Cosmetic ones are never backported, and minor patches are only backported as part of a larger set.  Obviously, this should be paired with a Fixes:.  Secret security issues can be marked Normal: or Important: public ones should (obviously) be marked grave.  <br>
<p>
Stable-suitability:{Certain,possible,doubtful,unsuitable,breaking} Certain should come with a CC to the stable- address: doubtful indicates a patch that the maintainer believes is not suitable for stable (like, say,  unsuitable and breaking both indicate patches that shouldn&#x27;t be backported, but an &quot;unsuitable&quot; patch might able to be backported with effort, rewriting, and (possibly) rethinking, while a &quot;breaking&quot; patch should just not backported.  Declaring &quot;breaking&quot; would require some justification: &quot;this might break stuff&quot; isnt.  <br>
<p>
(if a person can&#x27;t decide between two options, then stringing them together is acceptable.  for instance, &quot;Stable-suitability:certain-certain-possible&quot; means &quot;I&#x27;m 66% certain this should go in a backport, but its possible I&#x27;m wrong, so read the commit message&quot;)<br>
<p>
Impact:{None,Insignificant,Small,Large}: indicates the amount of other code that could be broken by the change. &quot;None&quot; is for changes that have no impact on the external behavior of the function (so, adding handling for out of memory would be None, since the situation is rare and the alternative is Firey Death, but adding a new error code wouldn&#x27;t be, since callers might have assumed the only possible error is OOM).  <br>
<p>
----<br>
<p>
Obviously a more rigorous spec would be needed, and probably some better names, but I think this would serve as a stopgap for kernel patchers to make their intent more clear while smarter folks try to completely rework the workflow.  It wouldn&#x27;t be obligatory, and I don&#x27;t think it adds much to the workload of a patcher: it&#x27;s just a machine-parsable way of saying things that a reviewer should already be able to tell from the patch and the notes.   The stable-suitability tag and severity tags are probably the most needed, since they directly address significant problems we have right now.<br>
<p>
- just some nonsense from a maniac<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864380/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864385"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 27, 2021 6:01 UTC (Tue)
                               by <b>wtarreau</b> (subscriber, #51152)
                              [<a href="/Articles/864385/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I generally agree with this, not necessarily with the details, but with the principle. I&#x27;ve defended &quot;fixes&quot; as a way to improve this in the past. The only thing is that &quot;fixes&quot; mentions a commit ID, and backportability is inferred from this, which is not the same as giving instructions.<br>
<p>
In haproxy we don&#x27;t use tags for this to force the persons doing the backport to read the commit message and figure by themselves, where the backporting instructions are. But at a larger scale tags would definitely help.<br>
<p>
However having just tokens in the tags doesn&#x27;t work well because very often you&#x27;ll see this pattern:<br>
  - a bug is introduced by patch X merged into, say, 2.6.35<br>
  - a fix for it is introduced in 3.4 and backported to stable releases between X and 3.4<br>
  - later in 5.14-rc it&#x27;s found that the fix introduced a vulnerability.<br>
  - the analysis shows that it&#x27;s only been an exploitable vulnerability since 5.8, that it possibly presented a severe risk of random crashes since 5.3, that it could have caused oopses since 4.12 and that it could only have caused misleading debug messages since 4.0.<br>
  - the fix requires to change the way a recent API is used<br>
<p>
=&gt; the severity often depends on the version, due to interactions with other code parts<br>
=&gt; the solution requires tricky adaptations for older versions, and the trickier the adaptations, the less severe the bug was<br>
=&gt; the risks and benefits of the backport are also dependent on the version.<br>
<p>
Thus, we definitely need to encourage one to write instructions for the stable team. If only 10% of the patches have full-text instructions and these patches are the most painful and riskiest to backport, it makes sense to stay away from a machine-readable format for these instructions for them, and rely on a human to quickly sort them out (sometimes suggestions like &quot;might be easier if commit XXX is also backported&quot; are helpful).<br>
<p>
In addition, for complicated backports, some maintainers may want to observe before going further. That&#x27;s a &quot;cool down&quot; period where only the latest stable and latest LTS get the patch but not previous ones.<br>
<p>
The impact on the code size is not always easy to gauge without doing the backport, and sometimes the amount of code is not a valid metric because you could imagine just backporting some library code for example, that usually passes well. But code that relies on changing semantics is much trickier. It can be a two-liner relying on a new locking scheme that didn&#x27;t exist in the past and that would require a totally different approach for example.<br>
<p>
Thus we could have a &quot;severity&quot; tag with estimates at the time of writing, plus another value such as &quot;depends&quot; which indicates that it depends on the version and that the text has to be done, a &quot;risk&quot; field indicating the estimated risk of backporting the fix, including references to interactions with other subsystems, and possibly just a &quot;stable:&quot; tag for instructions to the humans. This is the one that could also be used to write &quot;stable: please do not backport this beyond 5.4&quot;, &quot;no backport at all&quot;, or &quot;wait one month before 5.4&quot;. And it saves the person from having to read the whole commit message when the tag is present.<br>
<p>
Also the field names should be short and easy to remember. But given that &quot;fixes&quot; is already just seldom used, just like &quot;cc:stable&quot;, I&#x27;m wondering how well that would work without a bit more education :-/<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864385/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor864411"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 27, 2021 14:40 UTC (Tue)
                               by <b>abatters</b> (<b>&#x272D; supporter &#x272D;</b>, #6932)
                              [<a href="/Articles/864411/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Another problem is that more information about the effects of a patch becomes available after commit, so the commit message becomes out-of-date.  It might be useful to have the ability to append more information to a commit after it has been accepted, in some kind of online database that supplements git.  If you submit a patch that caused an issue, you can append some notes to it later.  If you do a git bisect to find a bad commit, you can add a note to that commit, even if no one else bothers to fix the problem.  If you change your mind about whether or not a patch is suitable for backporting to -stable, you can add a note about it.  etc.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864411/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor865789"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Aug 10, 2021 1:09 UTC (Tue)
                               by <b>calumapplepie</b> (guest, #143655)
                              [<a href="/Articles/865789/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
*pokes git-notes* you got anything to say for yourself?<br>
<p>
Of course, that can&#x27;t be (easily) pushed/pulled from origin: but it might help.  Perhaps someone could tweak Git to do that by default?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/865789/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor864529"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The core of the -stable debate</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Jul 28, 2021 19:09 UTC (Wed)
                               by <b>johannbg</b> (guest, #65743)
                              [<a href="/Articles/864529/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Andrew Morton and other devs that share his views are seemingly basing their assumption that users actually report the issue they are faced with, which more often than not, is not the case...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/864529/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2021, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
