        <!DOCTYPE html>
        <html lang="en">
        <head><title>The evolution of control groups [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/571977/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/571558/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/571977/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>The evolution of control groups</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>We're bad at marketing</b>
<p>
We can admit it, marketing is not our strong suit. Our strength is
writing the kind of articles that developers, administrators, and
free-software supporters depend on to know what is going on in the
Linux world. Please <a href="/Promo/nsn-bad/subscribe">subscribe today</a> to help us keep doing that, and so
we donâ€™t have to get good at marketing.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>October 29, 2013</br>
           <hr>
<a href="/Articles/KernelSummit2013/">2013 Kernel Summit</a>
</div>
The control group (cgroup) subsystem is currently under intensive
development; some of that work will lead, eventually, to ABI changes that
are visible from user space.  Given the amount of controversy around this
subsystem, it was not surprising to see control groups show up on the
2013 Kernel Summit agenda.  Tejun Heo led a session to describe the
consensus that had been reached on the cgroup interface, only to find that
there are still a few loose ends to be tied down.
<p>
Tejun started by reminding the group that the multiple hierarchy
feature of cgroups, whereby processes can be placed in multiple, entirely
different 
hierarchies, is going away.  The unified hierarchy work is not entirely

<a href="/Articles/572012/"><img
src="https://static.lwn.net/images/conf/2013/lce-ks/TejunHeo-sm.jpg" width=125 height=156
alt="[Tejun Heo]" border=0 hspace=3 vspace=3 align="left"></a>

usable yet, though, because it requires that all controllers be enabled for
the full hierarchy.  Some controllers still are not hierarchical at all;
they are being fixed over time.  The behavior of controllers is being made
more uniform as well.
<p>
One big change that has been decided upon recently is to make cgroup
controllers work on a per-process basis; currently they apply per-thread
instead.  Among other things, that means that threads belonging to the same
process can be placed in different control groups, leading to various
headaches.  Of all the controllers only the CPU controller has any business
working with individual threads.  For that case, some sort of special
interface will be introduced that will, among other things, allow processes
to set CPU policies for their own threads.  
<p>
That interface, evidently, might be implemented with yet another
special-purpose virtual filesystem.  There was some concern about how the
cgroup subsystem may be adding features that, essentially, constitute new
system calls without review; there were also concerns about how the
filesystem-based interface suffers from race conditions.  Peter Zijlstra
worried about how the new per-thread interface might look, saying that
there were a lot of vague details that still need to be worked out.  Linus
wondered if it was really true that only the CPU controller needs to look
at individual threads; some server users, he said have wanted per-thread
control for other resources as well.
<p>
Linus also warned that it might not be possible to remove the old cgroup
interface for at least ten years; as long as somebody is using it, it will
need to be supported.  Tejun seemed unworried about preserving the old
interface for as long as it is needed.  Part of Tejun's equanimity may come
from a feeling that it will 
not actually be necessary to keep the old interface for that long; he said
that even Google, which has complained about the unified hierarchy plans in
the past, has admitted that it can probably make that move.  So he doesn't
see people needing the old interface for a long time.
<p>
In general, he said, the biggest use for multiple hierarchies has been to
work around problems in non-hierarchical controllers; once those problems
are fixed, there will be less need for that feature.  But he still agrees
that it will need to be maintained for some years, even though
removal of multiple hierarchy support would simplify things a lot.  Linus
pointed out that, even if nobody is using multiple hierarchies currently,
new kernels will still need to work on old distributions for a long time.
Current users can be fixed, he said, but Fedora&nbsp;16 cannot.
<p>
Hugh Dickins worried that, if the old interface is maintained, new users
may emerge in the coming years.  Should some sort of warning be added to
tell those users to shift to the new ABI?  James Bottomley said, to general
agreement, that deprecation warnings just don't work; distributions just
patch them out to avoid worrying their users.  Tejun noted that new
features will only be supported in the new ABI; that, hopefully, will
provide sufficient incentive to use it.  Hugh asked what would happen if
somebody submitted a patch extending the old ABI; Tejun said that the bar
for acceptance would be quite high in that case.
<p>
From the discussion, it was clear that numerous details are still in need
of being worked out.  Paul Turner said that there is a desire for a notification
interface for cgroup hierarchy changes.  That, he said, would allow a
top-level controller to watch and, perhaps, intervene; he doesn't like that
idea, since Google wants to be able to delegate subtrees to other
processes.  In general, there seems to be a lack of clarity about who will
be in charge of the cgroup hierarchy as a whole; the systemd project has
plans in that area, but that creates difficulties when, for example, a
distribution is run from within a container.  Evidently some sort of accord
is in the works there, but there are other interesting questions, such as
what happens when the new and old interfaces are used at the same time.
<p>
All told, there is a fair amount to be decided still.  Meanwhile, Tejun
said, the next concrete step is to fix the locking, which is currently too
strongly tied to the internal locking of the virtual filesystem layer.
After that is done, it should be possible to post a prototype showing how
the new scheme will work.  That posting may happen by the end of the year.
<p>
[Next: <a href="/Articles/571980/">Linux-next and -stable</a>].<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Control_groups">Control groups</a></td></tr>
            <tr><td><a href="/Archives/ConferenceIndex/">Conference</a></td><td><a href="/Archives/ConferenceIndex/#Kernel_Summit-2013">Kernel Summit/2013</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/571977/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor572166"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 30, 2013 0:41 UTC (Wed)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/572166/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
What about cgroups that are meant to be NOT hierarchic, like the freezer cgroup?<br>
<p>
For example, I might want to freeze MySQL and Apache together even though they might be in entirely different cgroup subtrees.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572166/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor572188"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 30, 2013 8:17 UTC (Wed)
                               by <b>johannbg</b> (guest, #65743)
                              [<a href="/Articles/572188/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
"systemd project has plans in that area, but that creates difficulties when, for example, a distribution is run from within a container" <br>
<p>
Jonathan could you clarify what exactly those difficulties are?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572188/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572201"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Systemd in containers</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 30, 2013 12:44 UTC (Wed)
                               by <b>corbet</b> (editor, #1)
                              [<a href="/Articles/572201/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      I do <i>not</i> have any detailed knowledge there, that's just what was said.  But, clearly, anything running in a container will also be in a subtree of the control group hierarchy.  If systemd wants to control the *whole* hierarchy, there could be trouble: systemd running in the container wrestling with systemd outside of the container in particular.  
<p>
But it's possible I'm totally confused.
      
          <div class="CommentReplyButton">
            <form action="/Articles/572201/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572287"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Systemd in containers</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 30, 2013 16:25 UTC (Wed)
                               by <b>dowdle</b> (subscriber, #659)
                              [<a href="/Articles/572287/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
systemd offers the systemd-detect-virt command which helps systemd become aware if it is inside of a VM, a container, or a container within a VM.  What it does with that knowledge, I'm not sure... but I would expect it to not assume it is king of the system... and that there may or may not be another systemd running on the virt/container host.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572287/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor572524"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 31, 2013 17:16 UTC (Thu)
                               by <b>luto</b> (subscriber, #39314)
                              [<a href="/Articles/572524/">Link</a>] (18 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
This is the first thing that actively worries me about systemd.  Every other systemd feature is in the category if "if you don't want it, don't use it".<br>
<p>
The problem with a single control group hierarchy is that, if something like systemd claims control of that hierarchy and you want to use cgroups for something else, you're screwed.  There's one hierarchy, and systemd is using it.<br>
<p>
I would *love* to see some minimal extra kernel functionality added to allow efficiently tracking and killing process subtrees.  Then systemd could use that instead of control groups and life would be good.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572524/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572533"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 31, 2013 18:29 UTC (Thu)
                               by <b>raven667</b> (subscriber, #5198)
                              [<a href="/Articles/572533/">Link</a>] (17 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Well the drive for a single userspace cgroup client is coming from the kernel side, to try and control the complexity of API by making a guarantee that only one thing is fiddling with it on a system.  As long as systemd provides it's own userspace API, over dbus maybe, for informing it of the changes you want to make then I think it will be good for all practical purposes.  <br>
<p>
I'm not an expert on cgroups but if I've been reading the coverage correctly it seems that one of the problems with delegated and multiple access in the existing system is that you can set priorities which are global values but you can only see the values for the processes in your group so you can't know whether your priorities will play well with the rest of the system.  For example is 43 (out of 1-1024) more or less than another containers priority?  Only a control daemon (or administrator) which can see everything knows what the "right" values are for priorities to be able to set them in a meaningful way.  A global control daemon can have a more complex policy as to what priority values clients can actually get set to, preventing a container guest from setting priority higher than your management processes for example. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572533/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572535"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 31, 2013 18:33 UTC (Thu)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/572535/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt;I'm not an expert on cgroups but if I've been reading the coverage correctly it seems that one of the problems with delegated and multiple access in the existing system is that you can set priorities which are global values but you can only see the values for the processes in your group so you can't know whether your priorities will play well with the rest of the system. </font><br>
This is a red herring. It's extremely easy to work around this by introducing an extra level of hierarchy.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572535/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor572534"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 31, 2013 18:40 UTC (Thu)
                               by <b>luto</b> (subscriber, #39314)
                              [<a href="/Articles/572534/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <blockquote>As long as systemd provides it's own userspace API, over dbus maybe, for informing it of the changes you want to make then I think it will be good for all practical purposes.</blockquote>

I disagree.  This might be good for all practical purposes if:
<ol><li>Systemd were widely-enough deployed that writing code that required systemd were a reasonably thing to do.
<li>Systemd's API provided access to the full set of functionality available from the kernel
<li>Systemd's API allowed the creation of a cgroup hierarchy isn't just subclasses of systemd units
</ol>

(1) isn't true and won't be unless Canonical has a major change of heart.  (2) is a big unknown, since AFAIK no one has seen this API.  (3) appears to be about as likely as hell freezing over, for two reasons.  First, the systemd people probably don't want to do that.  Second, and more importantly, systemd needs the cgroup hierarchy for its own in<s>f</s>ternal purposes, and, since there's only one hierarchy, systemd <i>can't</i> expose a hierarchy that's too different from its own.
<p>
Since process subtree tracking is independently useful (see, for example, the subreaper stuff) and semantically has <i>nothing whatsoever</i> to do with partitioning kernel resources, it would be nice to see it split out.
<p>
Then, the One True Userspace Cgroup Daemon could be a separate project (that would cooperate with systemd by default) and which, importantly, could be turned off if you don't want it.


      
          <div class="CommentReplyButton">
            <form action="/Articles/572534/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572551"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 31, 2013 20:56 UTC (Thu)
                               by <b>raven667</b> (subscriber, #5198)
                              [<a href="/Articles/572551/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
#1 seems like a non-sequitur, what systemd provides for an API is only relevant to machines running systemd, if the machines you run are running upstart or something else then you'll need to create your own management daemon and API with whatever rules you want.  I'm sure some workloads will have custom cgroup managers created to handle them but if there isn't enough interest to create alternative generic management daemons, then there isn't enough interest to create alternative management daemons.  <br>
<p>
#3 In the new API that the kernel developers want which has just one complete hierarchy then any subtree is going to be a child of something no matter what you use to manage it.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572551/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572553"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 31, 2013 21:38 UTC (Thu)
                               by <b>luto</b> (subscriber, #39314)
                              [<a href="/Articles/572553/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <blockquote>#1 seems like a non-sequitur, what systemd provides for an API is only relevant to machines running systemd, if the machines you run are running upstart or something else then you'll need to create your own management daemon and API with whatever rules you want. I'm sure some workloads will have custom cgroup managers created to handle them but if there isn't enough interest to create alternative generic management daemons, then there isn't enough interest to create alternative management daemons.</blockquote>

On current kernels, I can use cgroups without systemd.  But in the new regime, if I want to write a program that uses cgroups, I'll have to write a version for systemd boxes and a version for non-systemd boxes.  I can't just link against libsystemdcgroups and expect it to work on all machines.  This sucks.

<blockquote>#3 In the new API that the kernel developers want which has just one complete hierarchy then any subtree is going to be a child of something no matter what you use to manage it.</blockquote>

Easy example: suppose I want to have httpd live in a cgroup.  Then I want to run, from the terminal, a program in the same cgroup as httpd.service.
<p>
Currently, this is possible and works fine (although it's ugly and I understand the kernel folks' desire to change it).
<p>
In a sensible new design, it would still be possible -- I would just switch my process into httpd's cgroup.  No sweat.  There's still just one hierarchy.
<p>
In the new systemd design, this is impossible.  My program isn't in httpd.service from systemd's point of view (and it won't be), so I can't do it.  But this is absurd -- I want to be able to tell systemd to fsck off and let me manage my own cgroups.  This will not be possible anymore.


      
          <div class="CommentReplyButton">
            <form action="/Articles/572553/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor572537"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 31, 2013 18:54 UTC (Thu)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/572537/">Link</a>] (12 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; As long as systemd provides it's own userspace API, over dbus maybe, for informing it of the changes you want to make then I think it will be good for all practical purposes. </font><br>
I really detest the DBUS part, actually. I have a couple of systems that use subtree delegation just fine, all I need to do is to set appropriate permissions on the cgroups tree. I can use traditional Linux access control for that, no need for anything fancy.<br>
<p>
In the DBUS use-case I don't even know where to begin - what access control systems are used there?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572537/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572602"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 1, 2013 17:07 UTC (Fri)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/572602/">Link</a>] (11 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Probably polkit. It's used to deny access to things like the Suspend and Hibernate methods for powerkit (which is now provided by logind; not sure what access controls it uses).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572602/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572621"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 1, 2013 22:05 UTC (Fri)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/572621/">Link</a>] (10 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
polkit? You mean the program which has just thrown away all user policy customization and required everyone to rewrite all their local security policies in Javascript?<br>
<p>
*That* horror?<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572621/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572623"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 1, 2013 22:15 UTC (Fri)
                               by <b>luto</b> (subscriber, #39314)
                              [<a href="/Articles/572623/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
To be fair, in my opinion it's a considerable improvement over writing the policies in pkla language.<br>
<p>
(Also, there wasn't really an intelligent solution to the problem that polkit is solving before.  The disaster that is /etc/security isn't really better.  Neither are groups, especially if you want to tie actions to physical presence.)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572623/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572624"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 1, 2013 22:18 UTC (Fri)
                               by <b>Cyberax</b> (<b>&#x272D; supporter &#x272D;</b>, #52523)
                              [<a href="/Articles/572624/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Right now cgroups are pretty much close to my perfect solution - I just can set the regular file permissions and inspect them using the usual tools.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572624/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor572625"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 1, 2013 22:21 UTC (Fri)
                               by <b>rahulsundaram</b> (subscriber, #21946)
                              [<a href="/Articles/572625/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<p>
<p>
<a href="https://fedorahosted.org/polkit-pkla-compat/">https://fedorahosted.org/polkit-pkla-compat/</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572625/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572627"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 1, 2013 22:24 UTC (Fri)
                               by <b>luto</b> (subscriber, #39314)
                              [<a href="/Articles/572627/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
At least you don't have to use this thing :)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572627/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572628"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 1, 2013 22:28 UTC (Fri)
                               by <b>rahulsundaram</b> (subscriber, #21946)
                              [<a href="/Articles/572628/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Compatibility plugs are usually a transitional mechanism. So no, you don't have to use it.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572628/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor572635"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 1, 2013 23:07 UTC (Fri)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/572635/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Nice! This should have been highlighted in huge flashing letters by the policy-kit people when they pushed this incompatible change on us. (Not that it *is* entirely compatible: I was *using* ReturnValue, dammit.)<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572635/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572637"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 1, 2013 23:31 UTC (Fri)
                               by <b>rahulsundaram</b> (subscriber, #21946)
                              [<a href="/Articles/572637/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That wouldn't have been possible.  This was developed independent of the polkit developers sometime later.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572637/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572694"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 3, 2013 19:54 UTC (Sun)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/572694/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
That's... a bit of an indictment of the polkit developers. Should we trust them not to break all our configuration again without caring about the people they leave out in the cold? They did it once before, after all...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572694/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572696"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 3, 2013 20:18 UTC (Sun)
                               by <b>rahulsundaram</b> (subscriber, #21946)
                              [<a href="/Articles/572696/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The older version is afaik parallel installable (Older version: PolicyKit, new version: polkit), so if you want to continue using the older format, you can as long as the distros include it.  However the compatibility layer made the older version unnecessary. If you want to be relatively sure, you can ask them directly.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572696/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor573073"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 6, 2013 17:55 UTC (Wed)
                               by <b>nix</b> (subscriber, #2304)
                              [<a href="/Articles/573073/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Unfortunately that's not true, as the naming change happened at a different time to (a lot earlier than) the config change. Anyone in the middle is stuck. Ah well, the compat thing should do the trick, with a bit of effort...<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/573073/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor572855"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The evolution of control groups</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 5, 2013 16:12 UTC (Tue)
                               by <b>sbohrer</b> (guest, #61058)
                              [<a href="/Articles/572855/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <blockquote>Of all the controllers only the CPU controller has any business working with individual threads. For that case, some sort of special interface will be introduced that will, among other things, allow processes to set CPU policies for their own threads.</blockquote>

<p>And what about the cpuset controller?  Apparently I have no business wanting my threads to have different CPU affinities?  Yes I know about sched_setaffinity() and pthread_setaffinity_np().  Using cpusets also allows creating/tweaking scheduler policies with cpuset.sched_load_balance and cpuset.sched_relax_domain_level and I'm not currently aware of any other APIs that do this.</p>

<p>The other advantage of using cpusets over sched_setaffinity() is that it becomes trivial to see and manage which threads/processes are pinned to which cores by walking the cpuset cgroups.  For example you could make one cpuset group per core, plus a generic sysdefault group that contains everything else not specifically pinned. Then threads/processes can easily find and pin themselves to an empty core group and a master management daemon can twiddle the CPU affinity of the sysdefault group to keep all of the generic OS crap off of the cores that have tasks pinned.  Again, yes this all could be done by repeatedly walking /proc and trying to identify and set the affinity of all processes in the system, but that sucks.</p> 

      
          <div class="CommentReplyButton">
            <form action="/Articles/572855/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2013, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
