        <!DOCTYPE html>
        <html lang="en">
        <head><title>The second half of the 5.13 merge window [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/855140/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/855622/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/855140/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>The second half of the 5.13 merge window</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Did you know...?</b>
<p>
LWN.net is a subscriber-supported publication; we rely on subscribers
       to keep the entire operation going.  Please help out by <a
       href="/Promo/nst-nag4/subscribe">buying a subscription</a> and keeping LWN on the
       net.
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>May 10, 2021</br>
           </div>
By the time the last pull request was acted on and <a
href="/ml/linux-kernel/CAHk-=wiWTU+=wK9pv_YG01rXSqApCS_oY+78Ztz5-ORH5a-kvg@mail.gmail.com/">5.13-rc1</a>
was released, a total of 14,231 non-merge commits had found their way into
the mainline.  That makes the 5.13 merge window larger than the entire 5.12
development cycle (13,015 commits) and just short of all of 5.11 (14,340).
In other words, 5.13 looks like one of the busier development cycles we
have seen for a little while.
About 6,400 of these commits came in after <a href="/Articles/854536/">the
first-half summary</a> was written, and they include a number of
significant new features.
<p>
Changes merged in the second half of the 5.13 merge window include:
<p>

<h4>Architecture-specific</h4>
<p>
<ul class="spacylist">
<li> The arm64 architecture has <a
     href="https://git.kernel.org/linus/782276b4d0ad">settled on</a>
     <tt>SPARSEMEM_VMEMMAP</tt> as the only supported <a
     href="/Articles/789304/">memory-management model</a>.
<li> 32-Bit PowerPC systems now have support for extended BPF and
     the <a href="/Articles/835542/">KFENCE</a> debugging system.
<li> PowerPC systems now support <a href="/Articles/766089/">time
     namespaces</a>.
<li> The RISC-V architecture has gained support for <a
     href="https://man7.org/linux/man-pages/man2/kexec_file_load.2.html">kexec</a>,
     crash dumps via kexec, execute-in-place, and kprobes.
<li> s390 systems can now do stack-offset randomization in system-call
     handlers.

</ul>


<p>
<h4>Core kernel</h4>
<p>
<ul class="spacylist">

<li> BPF tracing programs may now make use of task-local storage, which
     provides a number of performance benefits over using maps.
<li> There is a new mechanism by which BPF programs can call kernel
     functions directly; its initial use is in the implementation of TCP
     congestion-control algorithms.  Functions must be explicitly
     whitelisted to be made available for calling from BPF.  Some
     information can be found in <a
     href="https://git.kernel.org/linus/e6ac2450d6de">this commit</a>.
<li> The function tracer (ftrace) has a new <tt>func-no-repeats</tt> option that
     causes multiple, consecutive calls to a function to be coalesced into
     a simple count in the output.
<li> User-space page-fault handling with <a
     href="https://man7.org/linux/man-pages/man2/userfaultfd.2.html"><tt>userfaultfd()</tt></a>
     can now manage minor faults (those where a valid page exists but a
     valid page-table entry does not).  See  <a
     href="https://git.kernel.org/linus/7677f7fd8be7">this commit</a> for
     information on this feature and how it is meant to be used.
<li> The old (but dangerous) <tt>/dev/kmem</tt> special file, which
     provided access to the kernel's address space, <a
     href="/Articles/851531/">has been removed</a> at last.
</ul>

<p>
<h4>Filesystems and block I/O</h4>
<p>
<ul class="spacylist">

<li> The exFAT filesystem has gained support for the <tt>FITRIM</tt>
     <tt>ioctl()</tt> command, which is used to inform the storage device
     about blocks that are no longer used.
<li> The XFS filesystem now can remove space from the last allocation
     group in the filesystem; this is a first step toward the ability to
     shrink XFS filesystems in general.
<li> There is a new quota-related system call:
     <p>
<pre>
    int quotactl_path(unsigned int cmd, const char *mountpoint, qid_t id,
    		      void *addr);
</pre>
     Its behavior is similar to <a
     href="https://man7.org/linux/man-pages/man2/quotactl.2.html"><tt>quotactl()</tt></a>,
     except that it expects the path to the mount point of a filesystem
     rather than the block special device holding that filesystem.
<li> The <a
     href="https://man7.org/linux/man-pages/man7/fanotify.7.html">fanotify</a>
     mechanism has always restricted a number of features to privileged
     users, but some 
     of those restrictions have been removed for 5.13.  See <a
     href="https://git.kernel.org/linus/7cea2a3c505e">this commit</a> for a
     cryptic description of what's allowed and what is not.
<li> The ext4 filesystem will now <a href="/Articles/854054/">overwrite
     directory entries</a> when files are deleted.  Ext4 can now also
     handle filesystems that use both case folding and encryption.
</ul>

<p>
<h4>Hardware support</h4>
<p>
<ul class="spacylist">

<li> <b>Human-interface devices</b>:
     FTDI FT260 USB HID to I2C host bridges,
     Microsoft Surface system aggregator module HID transports,
     Azoteq IQS626A capacitive touch controllers,
     MStar msg2638 touchscreens,
     Ilitek I2C 213X/23XX/25XX/Lego series touch controllers, and
     Hycon hy46xx touchscreens.
<li> <b>Miscellaneous</b>:
     Silicon Labs CP2615 USB  I2C adapters,
     HiSilicon I2C controllers,
     Unisoc IOMMUs,
     Intel Data Accelerators performance monitors,
     Toshiba Visconti pulse-width modulators,
     MediaTek Gen3 PCIe controllers, and
     SiFive FU740 PCIe host controllers.
<li> <b>Networking</b>:
     Marvell 88X2222 PHYs,
     Broadcom BCM6368 MDIO bus multiplexers,
     Actions Semi Owl Ethernet MACs,
     Microsoft Azure network adapters,
     NXP C45 TJA11XX PHYs, and
     Microchip KSZ8863 and KSZ8873 switches.
<li> <b>Pin control</b>:
     Broadcom BCM63xx GPIO controllers,
     Mediatek MT8195 pin controllers,
     Xilinx ZynqMP pin controllers, and
     Realtek Otto GPIO controllers.
<li> <b>Sound</b>:
     Realtek RT1316 codecs,
     Realtek RT711 and RT715 SDCA codecs,
     Realtek RT1019 mono class-D audio amplifiers, and
     MediaTek MT6359 ACCDET jack controllers.
<li> <b>Virtio</b>: new virtio drivers have been added for Bluetooth
     controllers and sound devices.

</ul>

<p>
<h4>Security-related</h4>
<p>
<ul class="spacylist">

<li> After years of work and 34 revisions, the <a
     href="/Articles/703876/">Landlock security module</a> has finally been
     merged.
<p>
<blockquote class="bq">
	The goal of Landlock is to enable to restrict ambient rights (e.g.
     	global filesystem access) for a set of processes. Because Landlock
     	is a stackable LSM, it makes possible to create safe security
     	sandboxes as new security layers in addition to the existing
     	system-wide access-controls.
</blockquote>
<p>
     See <a
     href="https://landlock.io/">landlock.io</a> for more information.

</ul>

<p>
<h4>Internal kernel changes</h4>
<p>
<ul class="spacylist">

<li> <tt>vmalloc()</tt> can now
     create huge-page mappings.
<li> There are some new functions for allocating batches of pages in a
     single call: <tt>alloc_pages_bulk()</tt> and
     <tt>alloc_pages_bulk_array()</tt>.   Documentation is scarce, but some
     information can be found in <a
     href="https://git.kernel.org/linus/387ba26fb1cb">this commit</a> and
     <a href="https://git.kernel.org/linus/0f87d9d30f21">this one</a>.
<li> See also <a href="/Articles/855226/">this article</a> for more
     information on both of the above changes.
</ul>

<p>
One feature that failed to make it this time around is the proposed
<a href="/Articles/835342/"><tt>memfd_secret()</tt></a> system call, which
creates areas of memory that are hidden from the rest of the system
(including the kernel).  Andrew Morton <a
href="/ml/linux-kernel/20210505120806.abfd4ee657ccabf2f221a0eb@linux-foundation.org/">expressed
doubts</a> about the utility of the feature, which brought out a few
potential users saying that they would like to have it.  Morton <a
href="/ml/linux-mm/20210506180126.03e1baee7ca52bedb6cc6003@linux-foundation.org/">now
appears to be convinced</a> but, by the time that happened, it was <a
href="/ml/linux-mm/CAHk-=wjHOZk_WdgsHQ2U+y5GGMWc+Psfc3jAzd4FJC9bQh7ApA@mail.gmail.com/">too
late</a> for 5.13.  So <tt>memfd_secret()</tt> looks set to make its
appearance in 5.14 instead.
<p>
If the 5.13 kernel is released after seven -rc cycles, it will come out on
June&nbsp;27; if a -rc8 is required, 5.13 will supply an added cause for
fireworks and celebration in the US on July&nbsp;4.  There will need to be
a lot of testing and fixing between now and then and, if past experience
holds, approximately 2,000 more commits.  The merge window is done, but
there is still a fair amount of work to be done to get the next kernel
release out.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Releases-5.13">Releases/5.13</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/855140/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor855954"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The second half of the 5.13 merge window</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 11, 2021 5:11 UTC (Tue)
                               by <b>smurf</b> (subscriber, #17840)
                              [<a href="/Articles/855954/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; quotactl_path</font><br>
<p>
Wait, a new path-related system call without a fd_at argument and without flags?<br>
<p>
Looks like &quot;lesson not learned&quot; to me.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/855954/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor855958"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The second half of the 5.13 merge window</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 11, 2021 6:48 UTC (Tue)
                               by <b>matthias</b> (subscriber, #94967)
                              [<a href="/Articles/855958/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Should be ok for this syscall. This is a quite complex syscall that takes a cmd field and a structure. If the need for flags arises, they can be put into the cmd field or the structure.  Also, an additional flags field would make no sense at all. This syscall should behave like the quotactl syscall, which does not have flags. Thus any needed flags would be put into the existing cmd field and structure anyway, even if the new syscall would get a flags field.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/855958/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor856004"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The second half of the 5.13 merge window</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 11, 2021 18:20 UTC (Tue)
                               by <b>nybble41</b> (subscriber, #55106)
                              [<a href="/Articles/856004/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; This is a quite complex syscall that takes a cmd field and a structure.</font><br>
<p>
Each command takes a *different* structure, or in some cases no structure at all. And not all of the structures are versioned to allow them to be extended with extra fields. A new system call which takes a path string but no fd_at argument or flags related to path resolution (RESOLVE_BENEATH, RESOLVE_IN_ROOT, etc.) seems like a step backward to me as well. These ought to be standard for any new path-based system call.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/856004/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor856030"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">The second half of the 5.13 merge window</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted May 12, 2021 11:08 UTC (Wed)
                               by <b>jan.kara</b> (subscriber, #59161)
                              [<a href="/Articles/856030/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Guys, these are good points for consideration. Thanks for them. Sadly, nobody pointed these out when this syscall was posted to linux-api mailing list back in March. Maybe you should hang out there? ;) Anyway, AFAIK there&#x27;s no userspace using this syscall yet and it hasn&#x27;t been released in a major release so we still have a few weeks to decide what to do. I&#x27;ve resumed the discussion in relevant mailing lists...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/856030/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2021, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
