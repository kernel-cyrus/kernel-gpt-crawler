        <!DOCTYPE html>
        <html lang="en">
        <head><title>TTY-based group scheduling [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/415740/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/414817/">Return to the Kernel page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/415740/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>TTY-based group scheduling</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>Benefits for LWN subscribers</b>
<p>
The primary benefit from <a href="/Promo/nst-nag5/subscribe">subscribing to LWN</a>
       is helping to keep us publishing, but, beyond that, subscribers get
       immediate access to all site content and access to a number of extra
       site features.  Please sign up today!
</blockquote>
<div class="FeatureByline">
           By <b>Jonathan Corbet</b><br>November 17, 2010</br>
           </div>
As long as we have desktop systems, there will almost certainly be concerns
about desktop interactivity.  Many complex schemes for improving
interactivity have come and gone over the years; most of them seem to leave
at least a subset of users unsatisfied.  Miracle cures are hard to come by,
but it seems that a recent patch has come close, at least for some users.
Interestingly, it is a conceptually simple solution that may not
need to be in the kernel at all.
<p>
The core idea behind the completely fair scheduler is its complete
fairness: if there are N processes competing for the CPU, each with equal
priority, than each will get 1/N of the available CPU time.  This policy
replaced the rather complicated "interactivity" heuristics found in the
O(1) scheduler; it yields better desktop response in most situations.
There are places where this approach falls down, though.  If a user is
running ten instances of the compiler with <tt>make&nbsp;-j&nbsp;10</tt>
along with one video playback application, each process will get a "fair" 9% of
the CPU.  That 9% may not be enough to provide the video experience that
the user was hoping for.  So it is not surprising that many users see
"fairness" differently; wouldn't 
be nice if the compilation job as a whole got 50%, while the video
application got the other half?
<p>
The kernel has been able to implement that kind of fairness for years
though a feature known as <a href="/Articles/240474/">group
scheduling</a>.  A set of processes placed within a group will each get a
fair share of the CPU time allocated to the group as a whole, but groups
will, themselves, compete for a fair share of the CPU.  So, if the video
player were to be placed in one group and the compilation in another, each
group would get half of the available processor time.  The various
processes doing the compilation would then get a fair share of their
group's half; 
they will compete with each other, but not with the video player.  This
arrangement will ensure that the video player gets enough CPU time to keep
up with the stream and any interactivity requirements.
<p>
Groups are thus a nice feature, but they have not seen heavy use since they
were merged for the 2.6.24 release.  The reasons for that are clear: groups
require administrative work and root privileges to set up; most users do
not know how to tweak the knobs and would really rather not learn.  What
has been missing all these years is a way to make group scheduling "just
work" for ordinary users.  That is the goal of <a
href="/Articles/415742/">Mike Galbraith's per-TTY task groups patch</a>.
<p>
In short, this patch automatically creates a  group attached to each TTY
in the system.  All processes with a given TTY as their controlling
terminal will be placed in the appropriate group; the group scheduling code
can then share time between groups of processes as determined by their
controlling terminals.  A compilation job is typically started by typing
"<tt>make</tt>" in a terminal emulator window; that job will have a
different controlling TTY than the video player, which may not have a
controlling terminal at all.  So the end result is that per-TTY grouping
automatically separates tasks run in terminals from those run via the
window system.
<p>
This behavior <a href="/Articles/415748/">makes Linus happy</a>; Linus,
after all, is just the sort of person who might try to sneak in a quick video
while waiting for a highly-parallel kernel compilation.  He said:
<p>
<div class="BigQuote">
	So I think this is firmly one of those "real improvement" patches.
	Good job. Group scheduling goes from "useful for some specific
	server loads" to "that's a killer feature".
</div>
<p>
Others have also reported significant improvements in desktop response, so
this feature looks like one which has a better-than-average chance of
getting into the mainline in the next merge window.  There are, however, a
few voices of dissent, most of whom think that the TTY is the wrong marker
to use when placing processes in group.
<p>
Most outspoken - as he often is - is Lennart Poettering, who <a
href="/Articles/415750/">asserted</a> that "<q>Binding something like
this to TTYs is just backwards</q>"; he would rather see something which
is based on sessions.  And, he said, all of this could better be done in
user space.  Linus was, to put it politely, <a
href="/Articles/415751/">unimpressed</a>, but Lennart <a
href="/Articles/415753/">came back</a> with a few lines of bash scripting
which achieves the same result as Mike's patch - with no kernel patching
required at all. 
It turns out that working with control groups is not necessarily that hard.
<p>
Linus, however, <a href="/Articles/415754/">still likes the kernel
version</a>, mainly because it can be made to "just work" with no user
intervention required at all:
<p>
<div class="BigQuote">
	Put another way: if we find a better way to do something, we should
	_not_ say "well, if users want it, they can do this &lt;technical
	thing here&gt;". If it really is a better way to do something, we
	should just do it. Requiring user setup is _not_ a feature.
</div>
<p>
In other words, an improvement that just comes with a new kernel is 
likely to be available to more users than something which requires each
user to make a (one-time) manual change.
<p>
Lennart <a href="/Articles/415756/">isn't buying it</a>.  A real user-space
solution, he says, would not come in the form of a requirement that users
edit their <tt>.bashrc</tt> files; it, too, would be in a form that "just
works."  It should come as little surprise that the form he envisions is
systemd; it seems that future plans involve systemd taking over session
management, at which time per-session group scheduling will be easy to
achieve.  He believes that this solution will be more flexible; it will be
able to group processes in ways which make more sense for "normal desktop
users" than TTY-based grouping.  It also
will not require a kernel upgrade to take effect.  
<p>
Another idea which has
been raised is to add a "run in separate group" option to desktop
application launchers, giving users an easy way to control how the
partitioning is done.
<p>
Linus <a href="/Articles/415759/">seems to be holding his line</a> on the
kernel version of the patch:
<p>
<div class="BigQuote">
	Anyway, I find it depressing that now that this is solved, people
	come out of the woodwork and say "hey you could do this". Where
	were you guys a year ago or more?
<p>
	Tough. I found out that I can solve it using cgroups, I asked
	people to comment and help, and I think the kernel approach is
	wonderful and _way_ simpler than the scripts I've seen. Yes, I'm
	biased ("kernels are easy - user space maintenance is a big pain").
</div>
<p>
The next merge window is not due until January, though; that is a fair
amount of time for people to demonstrate other approaches.  If a solution
based in user space turns out to be more flexible and effective in the long
run, it may yet prevail.  That is especially true because merging Mike's
patch does not in any way inhibit user-space solutions; if a systemd-based
approach shows better results, that may be what the distributors decide to
enable.  One way or the other, it seems like better interactive response is
coming in the near future.<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Group_scheduling">Group scheduling</a></td></tr>
            <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Interactivity">Interactivity</a></td></tr>
            <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Scheduler-Group_scheduling">Scheduler/Group scheduling</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/415740/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor415973"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 2:27 UTC (Thu)
                               by <b>neilbrown</b> (subscriber, #359)
                              [<a href="/Articles/415973/">Link</a>] (15 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I cannot see that there is any conflict between Linus' approach and Lennart's approach.  They should both work together quite nicely.  Neither excludes the other.<br>
<p>
Those of us who use xterms (or whatever the program is called today) can benefit from Linus' approach now.   Those who only use GUIs with no tty involved might have to wait for systemd to achieve desktop domination, but that isn't being slowed down by the per-tty approach ... is it?<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/415973/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor415977"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 2:43 UTC (Thu)
                               by <b>mjg59</b> (subscriber, #23239)
                              [<a href="/Articles/415977/">Link</a>] (12 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yeah, I don't see them as conflicting. I think Lennart's objection was primarily down to the idea that this patch helps desktop users. The majority of desktop users never run anything tied to a TTY, so it's not a win there - it just helps the fairly niche crowd that use the desktop while simultaneously launching heavy jobs from terminals.<br>
<p>
...which isn't inherently a bad thing. The people that do do that kind of thing are the people that are more likely to update their kernel more often than their userspace, and they're also the kind of enthusiast population that test kernels early and often and let us know when things have broken. There's obvious benefits in catering to them, but we shouldn't lose sight of the fact that there's way more people using Linux as something to run a web browser and a music player than there are people who ever launch a terminal.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/415977/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor415978"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 3:03 UTC (Thu)
                               by <b>Trelane</b> (subscriber, #56877)
                              [<a href="/Articles/415978/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
which seems to argue for integration into KDE or GNOME, not just systemd, no?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/415978/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor415983"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 3:17 UTC (Thu)
                               by <b>foom</b> (subscriber, #14868)
                              [<a href="/Articles/415983/">Link</a>] (8 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Yes.<br>
<p>
But, the plan is for systemd (as a per-user process, separate from the root/pid 1 process) to take over as the session manager for GNOME (and who knows, maybe KDE too). Because, in the end, a user session manager has to do almost the same things as a root daemon manager anyways.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/415983/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor415985"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 3:24 UTC (Thu)
                               by <b>Trelane</b> (subscriber, #56877)
                              [<a href="/Articles/415985/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
ah, I'd missed that somewhere.<br>
<p>
Honestly, I don't care who does it as long as it doesn't suck. :)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/415985/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor416179"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 20:03 UTC (Thu)
                               by <b>aleXXX</b> (subscriber, #2742)
                              [<a href="/Articles/416179/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Lennart didn't appear yet on kde-core-devel to propose systemd as a session manager for KDE, or asking for input, or anything.<br>
<p>
Alex<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416179/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor416190"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 20:49 UTC (Thu)
                               by <b>rahulsundaram</b> (subscriber, #21946)
                              [<a href="/Articles/416190/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Afaik,  Lennart isn't personally interested in driving the KDE side of things.  Someone else from KDE can look into it though, ask questions etc<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416190/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor416219"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 23:27 UTC (Thu)
                               by <b>cyd</b> (guest, #4153)
                              [<a href="/Articles/416219/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The modus operandi, if PulseAudio is any guide, would be to break KDE and let its developers try to sort it out.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416219/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor416226"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 19, 2010 0:00 UTC (Fri)
                               by <b>drag</b> (guest, #31333)
                              [<a href="/Articles/416226/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Certainly PulseAudio and proper integration into Gnome is now one of the best things that ever happened for my desktop Audio-wise. <br>
<p>
Gone are the days of mucking around with my ~/.asoundrc file. Good riddance to them.<br>
<p>
I couldn't imagine going back now.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416226/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor416231"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 19, 2010 0:43 UTC (Fri)
                               by <b>sfeam</b> (subscriber, #2841)
                              [<a href="/Articles/416231/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Interesting to hear that PulseAudio was actually an improvement on the gnome side.  I guess it comes down to what state things were in before.  I was perfectly happy with audio integration and performance under KDE; then PulseAudio came along and made everything worse. So I greatly sympathize with the comment upthread, since history seems to indicate that Lennart doesn't consider breaking KDE to be a show-stopper.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416231/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor416256"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 19, 2010 9:36 UTC (Fri)
                               by <b>marcH</b> (subscriber, #57642)
                              [<a href="/Articles/416256/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; Certainly PulseAudio and proper integration into Gnome is now one of the best things that ever happened for my desktop Audio-wise.</font><br>
<p>
Yeah, but the other question is: how long and how much pain did this require?<br>
<p>
When there is always something (different) broken, the dawn of the Linux Desktop is always "tomorrow".<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416256/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor416376"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 20, 2010 0:18 UTC (Sat)
                               by <b>mezcalero</b> (subscriber, #45103)
                              [<a href="/Articles/416376/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Well, I consider myself a GNOME developer and am a GNOME foundation member. That's my priority. I do not use KDE, and neither do I use LXDE or any of the other DE. Please understand that I am just one person and will not fix all desktop environments for you thank you very much. If KDE people are interested in systemd then they are very much welcome and should talk to us, and I'd be happy to work with them, but as KDE is not directly the project I am personally interested this has to come from them, I will not become a KDE hacker.<br>
<p>
Also note that the man who currently does most of the maintenance work on PA during my hiatus working on systemd is actually a KDE contributor (Phonon), Colin Guthrie, so this worked out quite well in the end.<br>
<p>
If KDE wants to be a leader in innovation when it comes to developing the infrastructure of the Linux desktop, then it actually has to become active and work with us. It's their duty, nor ours. So far however, with HAL/udev, NM, PA, Gst and all the other techs we pushed from the GNOME side they ended up catching up eventually, but never led development. I would be happy if they'd work more with those doing the ground work.<br>
<p>
Lennart<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416376/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor415984"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 3:23 UTC (Thu)
                               by <b>russell</b> (guest, #10458)
                              [<a href="/Articles/415984/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
'we shouldn't lose sight of the fact that there's way more people using Linux as something to run a web browser and a music player than there are people who ever launch a terminal."<br>
<p>
really? who?  He's missing out on all the fun things.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/415984/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor415986"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 3:25 UTC (Thu)
                               by <b>mjg59</b> (subscriber, #23239)
                              [<a href="/Articles/415986/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I've only been married a bit over a week, but I'm pretty sure that my wife's a she.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/415986/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor416051"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 12:09 UTC (Thu)
                               by <b>dgm</b> (subscriber, #49227)
                              [<a href="/Articles/416051/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Or, if they do not work together, you can keep the one you like best, because the kernel solution can be easily disabled.<br>
<p>
I think Lennart has a point, policy may not belong to the kernel. But providing a sane default when we can sounds like music to my ears. Just let users override it if/when they can do better.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416051/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor416098"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 14:38 UTC (Thu)
                               by <b>vgoyal</b> (subscriber, #49279)
                              [<a href="/Articles/416098/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
They don't necessarily conflict but I do have few concerns with kernel approach.<br>
<p>
- I have always been told that kernel should implement mechanism and not policy and this sounds like a policy to me. Not sure where to draw the line<br>
though.<br>
<p>
- tty groups are hidden and and don't appear in cgroup hierarchy and are not user visible. So if some controller is implementing the upper limit, these groups might not be subjected to those limits.<br>
<p>
- Once cgroups are visible to user space, one can write a nice monitoring tool to list all the cgroups, their resource consumption, processes running in these etc. With hidden group, one can't do that.<br>
<p>
So IMHO, this kind of automatic group creation is more of policy and should be done in user space. Even if we do it in kernel, atleast we need to make sure these groups become visible in appropriate cgroup hierarchy and are user controllable as regular cgroups are.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416098/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor416044"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">R E S P E C T</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 11:10 UTC (Thu)
                               by <b>kragil</b> (guest, #34373)
                              [<a href="/Articles/416044/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Reading Linus second comment it seems clear to me that he does not really care for openrespect.org ;)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416044/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor416049"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">R E S P E C T</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 11:53 UTC (Thu)
                               by <b>dgm</b> (subscriber, #49227)
                              [<a href="/Articles/416049/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Come on. Respect is boooooring! Linus is... well, Linus.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416049/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor416475"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">R E S P E C T</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 21, 2010 11:28 UTC (Sun)
                               by <b>Darkmere</b> (subscriber, #53695)
                              [<a href="/Articles/416475/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I haven't gotten around to writing my own rant about "Respect" but I can link you to one that's more in line with how I think than the "Open Respect . Org" one is.<br>
<p>
<a href="http://www.bigrockcandymountain.info/2010/11/20/disrespect">http://www.bigrockcandymountain.info/2010/11/20/disrespect</a><br>
<p>
Just because you feel entitled doesn't mean I have to care.  Just because I do not care doesn't mean I can be an arse. However, if we continue off this tangent I'll be insulting more people here.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416475/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor416055"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Policy</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 12:34 UTC (Thu)
                               by <b>nikanth</b> (guest, #50093)
                              [<a href="/Articles/416055/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Now policy belongs to kernel space<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416055/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor416121"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Policy belongs to kernel space</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 16:36 UTC (Thu)
                               by <b>hmh</b> (subscriber, #3838)
                              [<a href="/Articles/416121/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It always did belong to kernel space when it made sense to do so.<br>
<p>
The correct way to go about it is: policy belongs where it can be *realistically* made to work best by default.<br>
<p>
Every interface that requires a kernel-&gt;userspace-&gt;kernel roundtrip to set policy _for no other reason_ than the "policy belongs in userspace" mentality, is clearly the product of bad engineering.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416121/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor416162"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Policy belongs to kernel space</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 18:27 UTC (Thu)
                               by <b>vonbrand</b> (subscriber, #4458)
                              [<a href="/Articles/416162/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <p>
The "policy is userspace" mentality is exactly one of the things that make Unixy systems flexible (and got Linux running from smartphones to Google). If it truly is setting policy, a roundtrip through the kernel won't be expensive enough to make any difference anyway.

      
          <div class="CommentReplyButton">
            <form action="/Articles/416162/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
<a name="CommAnchor416059"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 12:51 UTC (Thu)
                               by <b>mjthayer</b> (guest, #39183)
                              [<a href="/Articles/416059/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If I run make -j10 and a video player in parallel on a single core system and make takes over most of the CPU isn't that reasonable behaviour?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416059/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor416160"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 18:20 UTC (Thu)
                               by <b>Chousuke</b> (subscriber, #54562)
                              [<a href="/Articles/416160/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
It's *justifiable* behaviour, but it's not the best behaviour. <br>
<p>
If you can't watch video while the compilation is underway, what's the point of the scheduler allowing the video player to consume resources at all?<br>
<p>
You can't tell users it's too much to demand decent interactivity while heavy background processes are running.<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416160/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor416061"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 13:14 UTC (Thu)
                               by <b>iq-0</b> (subscriber, #36655)
                              [<a href="/Articles/416061/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
TTY is just being used as a heuristic in this case. Why not mirror the process-tree or build a process-group-tree?<br>
This could even be applied more generically in other schemes (systemd creating a cgroup and subgroups are automagically created within their parents group).<br>
<p>
But I fear cgroups don't scale to 1 level per process/process-group. Otherwise I think this would automagically work for all users (eg. running chrome (multiprocess possibly cpu hog) a game and listing to some music in another app instead of the in-game music).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416061/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor416194"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 21:09 UTC (Thu)
                               by <b>jzbiciak</b> (guest, #5246)
                              [<a href="/Articles/416194/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <P>Yeah, I'm skeptical that assigning groups by TTY is the way to go for the average user.  For folks like me with 50-bazillion terminal windows open trying to multitask while running lots of compute?  Yeah, sure.  For someone who has never opened a terminal window?  I can't see how it could possibly help.</P>
<P>For giggles, I just logged into my wife's computer remotely over ssh.  Out of ~167 processes, only 10 had controlling terminals.  6 were idle gettys on tty1-6, 1 was Xorg on tty7, and the other 3 were processes associated with my ssh session.  What process group(s) would all the other 150+ tasks be assigned to?  Or all they all effectively in their own per-process groups by default?  How would this patch benefit users like my wife, who open few if any interactive sessions?</P>
<P>It also breaks if you're the type that launches a bunch of GUI apps in the background from the same shell window.  They might all inherit the same TTY but never use it.  Now they'd get lumped in the same group.</P>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416194/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor416386"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 20, 2010 1:39 UTC (Sat)
                               by <b>sayap</b> (guest, #71380)
                              [<a href="/Articles/416386/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Con Kolivas has developed a hierarchical tree-based penalty patch and has since dropped it, because desktop doesn't need more heuristics. Read more here: <a rel="nofollow" href="http://ck-hack.blogspot.com/2010/11/create-task-groups-by-tty-comment.html">http://ck-hack.blogspot.com/2010/11/create-task-groups-by...</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416386/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor416109"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Responsiveness under disk I/O</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 15:33 UTC (Thu)
                               by <b>Cato</b> (guest, #7643)
                              [<a href="/Articles/416109/">Link</a>] (4 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I think the real problem still to be solved is responsiveness under I/O as in <a href="https://bugzilla.kernel.org/show_bug.cgi?id=12309">https://bugzilla.kernel.org/show_bug.cgi?id=12309</a> - I find that large apps such as VMware and Firefox can cause keyboard input to freeze for many seconds using kernel 2.6.24 and Ubuntu 8.04, which should be a reliable combination by now.<br>
<p>
Probably it's a VM issue, but it's hard to understand why Linux can't keep up with my typing these days given much faster hardware, when it always used to back in the days of formatting floppy disks in background.<br>
<p>
Firefox is a key issue - with 100-200 tabs this freezing of keyboard input across the whole system is much more frequent, and "pidstat -d 5" shows that it and kjournald are doing some I/O, though at quite low rates.  This is on a Core 2 Duo system with 4 GB RAM and PAE enabled, and about 50% of RAM used by programs typically.<br>
<p>
Linux always used to be stunningly fast and responsive compared to Windows - with bugs like this, and the choice of a lumbering Firefox vs. a Chrome that lacks key extensions, it's still not quite there as a desktop.  My main desktop is still Linux but I'd really like it to perform more consistently.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416109/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor416125"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Responsiveness under disk I/O</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 16:42 UTC (Thu)
                               by <b>vgoyal</b> (subscriber, #49279)
                              [<a href="/Articles/416125/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
There are close to 500 comments in the bz. So I have not read it yet. Can you just tell a quick summary about what is happening. IOW, here one person has to be doing lots of IO behind which other IO gets delayed. So in this case is it VM or firefox which is doing lots of buffered WRITES or direct WRITES or what. Some blktracing might help.<br>
<p>
You also might want to play a bit with blkio cgroup controller. Try putting firefox/VM in a separate cgroup or try putting your terminal in a separate cgroup and see if it helps. <br>
<p>
For further information look at Documentation/cgroups/blkio-controller.txt<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416125/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor416203"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Responsiveness under disk I/O</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 21:33 UTC (Thu)
                               by <b>clugstj</b> (subscriber, #4020)
                              [<a href="/Articles/416203/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
100-200 tabs in Firefox?  I don't really think Firefox was designed for that.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416203/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor416272"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Responsiveness under disk I/O</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 19, 2010 12:03 UTC (Fri)
                               by <b>Cato</b> (guest, #7643)
                              [<a href="/Articles/416272/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
You're probably right, but since I keep Firefox open for weeks with session recovery enabled, it's quite easy to build up to that.  It's also a good way to stress a Linux system, and I have similar tab counts on Windows 7 which doesn't exhibit this intermittent system-wide pause/freeze behaviour (as long as I don't let it page too much).<br>
<p>
I'm experimenting with a very small swapfile on Linux (512MB) etc but that hasn't solved this.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416272/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor417326"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Responsiveness under disk I/O</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 26, 2010 9:11 UTC (Fri)
                               by <b>jospoortvliet</b> (guest, #33164)
                              [<a href="/Articles/417326/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Don't worry, you don't need 200 tabs in Firefox to get this behavior. I get it all the time by just running a few more apps than (apparently) the kernel with this hardware can handle. Often - memory at 50%, cpu low, but IO spikes up and typing an email is going back to the '80s with having to wait +5 sec for each character to appear. Embarasing, considering I have little if anything running that requires real resources or IO (mail, chat, feedreader, few browser windows, text editor, filemanager, calendar - that's it).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/417326/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
<a name="CommAnchor416170"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">TTY-based group scheduling</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 18, 2010 19:20 UTC (Thu)
                               by <b>ccurtis</b> (guest, #49713)
                              [<a href="/Articles/416170/">Link</a>] 
      </p>
      
      </div>
      </summary>
      I'm fine with the tty-based approach personally, but it doesn't really seem ideal as more gui gets involved.  Desktops - at the risk of portability - can integrate the feature, but what about another trigger?
<p>
I'm thinking of fork():  What about an approach like:

<ul>
<li> Add a field to compliment 'nice', such as 'penalty'.
<li> Each time fork() is called, increment 'penalty' for the child.
<li> If the task gets reparented to init(1), clear the penalty.
<li> Schedule the task based on niceness + penalty.
</ul>

This is just conceptual, of course.  I imagine 'penalty' to be something like 1/10 or 1/8 of a 'nice', so the scheduler would use a value like (nice &lt;&lt; 3 | penalty).
<p>
In the 'make + video' scenario, all the 'gcc' processes will have a penalty while the video will perform with higher priority.  In the daemon scenario, they will be reparented and thus have their penalty cleared.  I expect a 'renice' would also want to clear any penalties.
<p>
Now, this isn't the same as creating a cgroup automatically - but it does seem like the place to do this is within the shell.  Or with a shell script as Lennart posted.  But there may be another heuristic around fork() that makes more sense than simply the controlling tty.


      
          <div class="CommentReplyButton">
            <form action="/Articles/416170/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor416248"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Very poor underlying assumptions.</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 19, 2010 5:43 UTC (Fri)
                               by <b>naptastic</b> (guest, #60139)
                              [<a href="/Articles/416248/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
The user should know better than doing "make -j10" while trying to watch video, unless they have an 11-core CPU.<br>
<p>
The problem isn't that the scheduler allocates time fairly; the problem is that the operating system sets all 10 children of make and the video player to the same priority. This is not a sane default. The Operating System should have an idea how much priority an application needs, and an end-user who doesn't know about .bashrc files shouldn't have to think about it. Make and its children should be reniced to 15 (for example) and totem should be reniced to -15 (for example) without any user intervention. Audio and video applications should have high priorities; Firefox, Thunderbird, Solitaire and OpenOffice should have medium priorities; video encoding and compilation should have low priorities by default.<br>
<p>
If assigning arbitrary numbers to applications by category so they sort themselves out correctly seems crazy, remember that System V init has been doing it for years: every init script has a 2-digit number, and those numbers determine the order in which scripts are run.<br>
<p>
A quick look at top on my system (Ubuntu 10.10) shows only 4 tasks with priorities != 1, and only 2 tasks with nice values != 0. Nice values and priorities are a simple tool that can solve these problems (assuming desktop preemption) so why aren't we using them? Cgroups are a great tool (killer feature!) but it seems like swatting a mosquito with a laser-guided rocket-propelled grenade launcher.<br>
<p>
(Someday I want to try swatting a mosquito with a laser-guided rocket-propelled grenade launcher.)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416248/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor416331"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">OT : Mosquito</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 19, 2010 18:50 UTC (Fri)
                               by <b>holstein</b> (guest, #6122)
                              [<a href="/Articles/416331/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Sorry, can't resist (hey, it's friday!):<br>
<p>
apparently, someone DID build something that uses laser to kill mosquito (no grenade though):<br>
<p>
<a href="http://blog.makezine.com/archive/2010/09/make_23_how_to_shoot_mosquitoes_wit.html">http://blog.makezine.com/archive/2010/09/make_23_how_to_s...</a><br>
<p>
Besides,more on topic, the nice thing about this cgroup utilisation is that it's more or less automatic: no need to chase down pid to renice. Maybe both could be used together somehow?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416331/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor416384"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">tty-based scheduler grouping vs scheduler priorities</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 20, 2010 1:10 UTC (Sat)
                               by <b>giraffedata</b> (guest, #1954)
                              [<a href="/Articles/416384/">Link</a>] 
      </p>
      
      </div>
      </summary>
      I don't know that you can say make is a generally a low-priority thing.  When I type 'make' and am waiting for it to finish (which I expect to be in less than a minute), there's not much I'd like to see get CPU time before my make.
<p>
The video player is a special case, and there's a name for what it requires: real time scheduling.  It's special because its correct execution is tied to the passage of real time.  Well, we <em>have</em> real time scheduling facilities in Linux.  Why doesn't the movie player program use them?
<p>
So the example in the article is probably not the best example of how the CTTY-based scheduling policy for non-realtime processes is good.

      
          <div class="CommentReplyButton">
            <form action="/Articles/416384/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor416258"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">I/O is the problem, not CPU</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 19, 2010 10:13 UTC (Fri)
                               by <b>job</b> (guest, #670)
                              [<a href="/Articles/416258/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
When was the last time you actually pegged your CPU so the behaviour of the scheduler was important to you? Sure, some people who do render jobs or large compile jobs do this regularly, but I expect a growing amount of this to be done on dedicated hardware.<br>
<p>
Personally I have a problem with disk I/O a lot more often. I suspect there is a significant amount of CPU work involved in SATA I/O and that this activity is not scheduled together with userspace, because when there is heavy disk usage interactivity in my terminals becomes very choppy.<br>
<p>
This was actually better ten years ago, on yesterday's hardware, so something must have changed since then. If you want to help dekstop interactivity, test under disk activity first. Your users will thank you (at least I would).<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416258/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor416337"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">I/O is the problem, not CPU</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 19, 2010 19:47 UTC (Fri)
                               by <b>Hypatia</b> (guest, #57397)
                              [<a href="/Articles/416337/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I do peg my CPU with reasonable frequency, but You are right on with your point on I/O. Disk I/O is the bottleneck far more often than CPU is.<br>
<p>
That said, I fear that with this scheduling scheme I will have to stop launching my headless VMs from the commandline, since they will be badly throttled while my wobbly windows wobble smoothly and my screen saver dazzles an empty room at high priority. I use the 'nice' command a lot , especially back in the days when I did a lot of kernel compiling. Nice has  always worked pretty well for me. Is this patch different than auto-nicing your interactive bash shells?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416337/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor416418"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">I/O is the problem, not CPU</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 20, 2010 18:16 UTC (Sat)
                               by <b>mfedyk</b> (guest, #55303)
                              [<a href="/Articles/416418/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I peg my cpu with firefox all of the time, and I have a dual core 64 bit cpu. firefox also manages to use all 4 gb and full up swap until I get my tab count down to about 200 or so.<br>
<p>
btw, chrome does the same with memory at about 50 tabs...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416418/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor416371"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Prediction</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 19, 2010 23:35 UTC (Fri)
                               by <b>dmarti</b> (subscriber, #11625)
                              [<a href="/Articles/416371/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      Someday when Lennart Poettering is 96 years old, he'll be sitting in the park painting a watercolor of a duck, and some LWN reader is going to come up to him, take one look at the painting, and say, "D3WD THAT SUX! PULSEAUDIO TOTALLY BR0KE MY SOUND IN 2004!!1!!"
      
          <div class="CommentReplyButton">
            <form action="/Articles/416371/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor416414"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">Prediction</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Nov 20, 2010 17:33 UTC (Sat)
                               by <b>nlucas</b> (guest, #33793)
                              [<a href="/Articles/416414/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Don't worry, another bystander will drop in and say something like, "YEAH!! BUT I STILL REMEMBER THE KDE 4.0 FIASCO!!1!!", allowing Lennart to finish his painting and go home while they continue the discussion...<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/416414/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2010, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
