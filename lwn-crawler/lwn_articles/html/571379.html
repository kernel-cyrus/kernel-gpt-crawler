        <!DOCTYPE html>
        <html lang="en">
        <head><title>A kernel panel convenes in Edinburgh [LWN.net]</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="robots" CONTENT="noai, noimageai">
        <link rel="icon" href="https://static.lwn.net/images/favicon.png"
              type="image/png">
        <link rel="alternate" type="application/rss+xml" title="LWN.net headlines" href="https://lwn.net/headlines/rss">
<link rel="alternate" type="application/rss+xml" title="Comments posted to this article" href="https://lwn.net/headlines/571379/">
        <link rel="stylesheet" href="/CSS/lwn">
<link rel="stylesheet" href="/CSS/nosub">

        
<script type="text/javascript">var p="http",d="static";if(document.location.protocol=="https:"){p+="s";d="engine";}var z=document.createElement("script");z.type="text/javascript";z.async=true;z.src=p+"://"+d+".adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script type="text/javascript">
var ados_keywords = ados_keywords || [];
if( location.protocol=='https:' ) {
        ados_keywords.push('T:SSL');
} else {
        ados_keywords.push('T:HTTP');
}

var ados = ados || {};
ados.run = ados.run || [];
ados.run.push(function() {

ados_add_placement(4669, 20979, "azk13321_leaderboard", 4).setZone(16026);

ados_add_placement(4669, 20979, "azk93271_right_zone", [5,10,6]).setZone(16027);

ados_add_placement(4669, 20979, "azk31017_tracking", 20).setZone(20995);



ados_setKeywords(ados_keywords.join(', ')); 
ados_load();
});</script>

        </head>
        <body>
        <a name="t"></a>
<div id="menu"><a href="/"><img src="https://static.lwn.net/images/logo/barepenguin-70.png" class="logo"
                 border="0" alt="LWN.net Logo">
           <span class="logo">LWN<br>.net</span>
           <span class="logobl">News from the source</span></a>
           <a href="/"><img src="https://static.lwn.net/images/lcorner-ss.png" class="sslogo"
                 border="0" alt="LWN"></a><div class="navmenu-container">
           <ul class="navmenu">
        <li><a class="navmenu" href="#t"><b>Content</b></a><ul><li><a href="/current/">Weekly Edition</a></li><li><a href="/Archives/">Archives</a></li><li><a href="/Search/">Search</a></li><li><a href="/Kernel/">Kernel</a></li><li><a href="/Security/">Security</a></li><li><a href="/Calendar/">Events calendar</a></li><li><a href="/Comments/unread">Unread comments</a></li><li><hr></li><li><a href="/op/FAQ.lwn">LWN FAQ</a></li><li><a href="/op/AuthorGuide.lwn">Write for us</a></li></ul></li>
<li><a class="navmenu" href="#t"><b>Edition</b></a><ul><li><a href="/Articles/570640/">Return to the Front page</a></li></ul></li>
</ul></div>
</div> <!-- menu -->
<div class="not-handset"
            	     style="margin-left: 10.5em; display: block;">
                   <div class="not-print"> <div id="azk13321_leaderboard"></div> </div>
                </div>
            <div class="topnav-container">
<div class="not-handset"><form action="https://lwn.net/Login/" method="post" name="loginform"
                 class="loginform">
        <label><b>User:</b> <input type="text" name="uname" value="" size="8" id="uc" /></label> 
		<label><b>Password:</b> <input type="password" name="pword" size="8" id="pc" /></label> <input type="hidden" name="target" value="/Articles/571379/" /> <input type="submit" name="submit" value="Log in" /></form> |
           <form action="https://lwn.net/subscribe/" method="post" class="loginform">
           <input type="submit" name="submit" value="Subscribe" />
           </form> |
           <form action="https://lwn.net/Login/newaccount" method="post" class="loginform">
           <input type="submit" name="submit" value="Register" />
           </form>
        </div>
               <div class="handset-only">
               <a href="/subscribe/"><b>Subscribe</b></a> /
               <a href="/Login/"><b>Log in</b></a> /
               <a href="/Login/newaccount"><b>New account</b></a>
               </div>
               </div><div class="maincolumn flexcol">
<div class="middlecolumn">
<div class="PageHeadline">
<h1>A kernel panel convenes in Edinburgh</h1>
</div>
<div class="ArticleText">
<blockquote class="ad">
<b>LWN.net needs you!</b>
<p>
Without subscribers, LWN would simply not exist.  Please consider
       <a href="/Promo/nst-nag2/subscribe">signing up for a subscription</a> and helping
       to keep LWN publishing.
</blockquote>
<div class="FeatureByline">
           By <b>Jake Edge</b><br>October 23, 2013</br>
           <hr>
<a href="https://lwn.net/Archives/ConferenceByYear/#2013-LinuxCon_Europe">LinuxCon Europe</a>
</div>
<p>
One of the most popular sessions at any LinuxCon is the kernel panel,
Jim Zemlin, executive director of the Linux Foundation, said in his
introduction.  Another lively panel made its appearance on October 22 in
Edinburgh, Scotland as part of <a
href="http://events.linuxfoundation.org/events/linuxcon-europe">LinuxCon
Europe</a>.  The panel was ostensibly focused on "core and embedded", but
predictably ranged further than that.
</p>

<p>
The panel was moderated by LWN executive editor Jonathan Corbet and had
four panelists who are developers from all over the kernel.  Each panelist
introduced himself, with Greg Kroah-Hartman starting things off. He, of
course, works for the Linux Foundation on a number of different kernel
areas including USB and the driver core as well as both the stable and
staging trees, which he called "the two extremes in the kernel".  Will
Deacon works for ARM on very low-level architecture-specific code like
memory barriers and TLB handling—"stuff that most people hate".  He also
co-maintains the 64-bit ARM (aarch64) support in the kernel.
</p>

<p>
Sebastian Hesselbarth was invited as a "hobbyist" attendee to the Kernel
Summit.  He started working on the mainline kernel about a year ago.  Peter
Zijlstra from Red Hat rounded things out.  He rattled off a number of
things that he co-maintains with Ingo Molnar including the scheduler, perf,
and lockdep. He also works on the memory management subsystem, IRQs,
timers, and various low-level architectures "when I have to".  "I get
around a bit", he said.
</p>

<p>
Corbet noted that there is a huge amount of code coming in now from the
mobile and embedded world mostly in the ARM tree, but that when you look at just the contributions
to the 
core kernel (scheduler, kernel and mm directories), it is companies like
Red Hat and IBM.  He asked "are we able to work together and make one
kernel that works for everybody?"  Zijlstra said that it was a "fun
exercise" to make
one kernel that scaled from tiny little machines to the largest ones out
there.
</p>

<h4>Power</h4>

<p>
That led Corbet to direct a question to Zijlstra about some frustrations he
had heard from the ARM community about getting scheduler patches reviewed.
Zijlstra said that he wants to avoid having a different scheduler for every
architecture.  Power-awareness is important to ARM, but it will be (or
already is)
important for others as well. There are several subsystems that currently
work together to handle power management (CPU idle, CPU frequency, and the
scheduler), but he wants to see a "coherent framework"
proposed that will help solve all the problems and not just "random tweaks
here and there".  There is a mini-summit
for power-aware scheduling later in the week, he said, where he hoped that
some of the issues could be resolved.
</p>

<p>
But, as Deacon pointed out, the problem is not just for ARM and mobile,
the server community is interested in better power performance as well.
Zijlstra agreed but noted that it is "difficult to get a straight answer"
from that community about its needs.  The hardware vendors really don't
want to talk to each other, he said.  Deacon pointed out that it might just
be that they aren't used to talking to each other and that they see it as
much easier 
to get things done when they don't have to.  Kroah-Hartman said that the
reason hardware vendors start out with 
drivers is because they are self-contained and don't require coordination
with other vendors.  It is harder to change the core kernel, he said, as it
should be, but companies eventually get there.  Neither Intel nor IBM
worked on the core a while back, but now that's a large part of what they
do.  Moving into the core is simply a migration that many companies
eventually make.
</p>

<p>
The ARM big.LITTLE architecture is different than anything we have seen
before, moving us from symmetric multiprocessing (SMP) to asymmetric,
heterogeneous multiprocessing, Corbet said.  He asked how that would impact
the scheduler.  Zijlstra was upbeat about supporting that model, saying
that the scheduler already deals with SMP 
systems that have asymmetric loads due to realtime or interrupt processing.
Big.LITTLE is different than that, certainly, but there are enough
similarities that some of the code which tries to balance "fairness" 
by tracking the realtime and interrupt usage on the CPUs, which could map
to more and 
less powerful processors
</p>

<p>
Kroah-Hartman isn't sure that the idea behind big.LITTLE will really pan
out.  There are other system components (memory, buses, etc.) that take
more power and still need 
to stay powered up even when only a "little" CPU is running, so it's not
clear that just turning off 
the more
power-expensive processors is enough of a win.  It may be an "experiment
that is failing", he said.  Deacon had not heard that, he said.  Companies
are putting big.LITTLE into products, so they believe it will bring power
savings. We should see proof one way or another before too long, he said.
</p>

<h4>Large, small, and tiny</h4>

<p>
There have long been complaints that the kernel is enterprise-focused,
though they have died out some over the years; does that make it hard for the
embedded side, Corbet asked.  Deacon said that there is a history of that
in the kernel, and that many of the maintainers came about during that era,
but that he, at least, didn't see a real problem with that.  As the kernel
evolves, so do the maintainers and the focus; it all balances out.
Kroah-Hartman was quick to note that the enterprise systems of five or ten
years ago 
were now in many people's pockets, so that those differences flatten out
over time. 
In addition, the choices rarely come down to making one better completely at the
expense of the other, Deacon said, so people air their concerns and a
compromise is found.
</p>

<p>
Going the other direction, Corbet noted that Tim Bird has been concerned
that Linux is leaving tiny systems behind.  Most embedded devices these
days are fairly capable systems with fewer memory and other constraints
from years past, but ignoring the really small systems may leave Linux out
of the "internet of things".  He asked if the panelists were concerned
about that.  
</p>

<p>
Zijlstra didn't think it was a real problem as there are patches to shrink
the kernel that are still accepted.  In addition, a recent suggestion to
remove uniprocessor (UP) support—essentially turning it into an SMP system with
one processor, though with all of the extra SMP data structure overhead—was
rejected as there are still plenty of single-core processors out there and Intel
recently introduced more with the Quark UP line.  Deacon noted that support for a
tiny ARM core ("M class") was recently merged as well. As long as people
are still running tiny systems and are willing to put in the work, support
for the super low-end should be fairly easy to maintain, but once the use
of UP systems goes away, for example, "that code will bitrot really fast",
Zijlstra said. "I can't wait for that day, but I'm afraid I will have to
wait a long time."
</p>

<h4>Community</h4>

<p>
Somewhat controversially, this year's Kernel Summit committee set aside
summit 
slots for hobbyists, Corbet said, so he
wanted to explore that a bit.  He asked the audience how many had contributed
a patch to the kernel and somewhere around one-third raised their hands;
perhaps half of those indicated they had done it on their own, not as part
of their job. On stage, Hesselbarth served as a representative from the
hobbyist community; Corbet started by asking him why he contributed to the
kernel on his own when so many around him were being paid to do so.
</p>

<p>
Hesselbarth said that he had a personal interest in tiny devices, but that
he probably was not  a prototypical Linux hobbyist. He is a hardware
engineer with an interest in
building systems-on-chip (SoCs) for devices.  He writes Linux drivers as
part of his job, which led him to work on the ARM SoC code on the side.
</p>

<p>
Corbet asked: "Is our community friendly?"  He wondered if Hesselbarth was
able to get the answers he needed on mailing lists, for example.
Hesselbarth said that it depends on how you approach the mailing lists.  If
you start out "kindly", most on the list will accept you, will look at your
code, and will correct you if you are wrong, even if they have done that
many times for others in the past.  Zijlstra had some advice for anyone
looking for assistance: ask specific questions, and always on the mailing
list.  Specific questions are easier to answer and emailing him privately
puts a message on "a very short path to /dev/null".
</p>

<p>
Corbet brought up the steady decline in the percentage of hobbyist
developer patches over the
years. Zijlstra and Deacon both thought that perhaps the absolute numbers
weren't really declining that much, it was that the number of paid
contributors has risen so much.  Kroah-Hartman said that people who show
any ability to get patches into the kernel immediately get job offers.  He
knows of at least five people who were doing style patches to staging
drivers in their spare time, got offers, and now do kernel development full
time. It is quite difficult to find kernel developers, so companies watch
the lists and ask other kernel developers for leads on new employees, he said.
</p>

<p>
When everyone gets hired, though, that causes a problem as sometimes they
can no longer maintain the code they were working on.  Or, as Zijlstra
pointed out, they get reassigned to a different project and maintenance
falters. Corbet mentioned that he sat in on a Matthew Garrett talk earlier
in the conference where he
talked about some buggy code
he had merged before getting reassigned and just kind of left it all behind.

<p>
Relatedly,
Kroah-Hartman recently backed out a change when the
email to the developer bounced.  It is a problem, Kroah-Hartman said,
because a maintainer needs to trust that someone contributing will be around
to fix the code, "or I have to".  He noted a "big, hairy" network change
that went in a few years ago, where, literally, email to the developer
started bouncing the day after it was merged.  It took many months to
unwind those changes, which is part of what makes it difficult to get large
changes into the network subsystem today.
</p>

<h4>Device tree woes</h4>

<p>
Non-discoverable hardware and the ARM device tree solution for that was
next up. Once upon a time, the devices attached to a system could be
determined at run time, but that is often not the case anymore, so some kind of
external description of those devices is required.  For ARM, device trees
are being used to do that, but there are some problems with the consistency
in how those
device trees are specified (i.e. the bindings).  A bigger issue is whether
device tree bindings constitute an unbreakable kernel ABI, which means that
even more care is required before merging any device tree support.  Corbet
asked: "Is device tree the right answer, what have we done wrong, and how
can we fix that?"
</p>

<p>
Deacon said that a full day of the ARM mini-summit (concurrent with the
conference) is devoted to trying to work out those problems.  Device tree
has been an improvement over the older mechanisms, and it has allowed a lot
more code and drivers to go into the kernel.  The ABI question is a
"religious" one and there is a fundamental disagreement between those who
think it is an unstable interface that shouldn't be used in any products
and those who think it is an unbreakable ABI that is fixed in stone.  He
was hopeful that some of that could be ironed out in the mini-summit.
</p>

<p>
Hesselbarth found that device tree makes things harder for hobbyists
because they have to consider all of the possible ways that someone might hook
up a particular IP block when designing the device tree for it.  There is
something of a trend to cut the static configuration data right out of the
drivers and essentially paste it into a device tree, Deacon said, which is
not the right way to approach creating a device tree entry. In addition,
Kroah-Hartman said that it is hard for driver maintainers to decide
whether to merge a driver because they are unsure if the device tree
support is "correct"—or even what "correct" looks like.
</p>

<p>
Kernel ARM maintainer Russell King recently put out a detailed critique of
device tree that Corbet said he hadn't had a chance to digest yet, but
clearly concerned the ability of device tree to describe the complexities
of today's devices. They are no longer just a single device, often, but a
collection of devices connected by buses.  "Is there a fundamental flaw
there?", he asked.
</p>

<p>
Kroah-Hartman likened the problem to that which the Video4Linux (V4L)
developers have been grappling with for years.  There needs to be a way to
describe 
devices and how they interconnect, which is a complex problem, but it has
to be described somewhere.  "What's
wrong with making it all discoverable?", Zijlstra asked.  That's what
kernel developers want, but it's difficult to convince the hardware makers,
Kroah-Hartman said.  Zijlstra's suggestion to "take them out back" and make
them "do what we want" was greeted with laughter, but lots of nodding heads
as well.
</p>

<p>
Corbet noted that there was a trend toward getting the knowledge from user
space, both in the V4L world with the <a href="/Articles/415714/">media
controller interface</a> and in the <a href="/Articles/480055/">ION memory
allocator</a>; are we getting to the point where we just can't solve those
problems in the kernel, he asked.  Deacon said that he doesn't think it is
unsolvable, but it isn't fun to think about how to solve and it is easier
to think it is someone else's problem.  He said that not only is hardware
configuration being pushed into user space, it is also being pushed into
the firmware. 
</p>

<p>
The hardware today is "plug and play" modules, Kroah-Hartman said, where
hardware makers buy IP blocks from multiple vendors and hook them all up in
different ways.  Linux has drivers for each of the pieces, but not all the
different ways they might be hooked up and communicate with each other.  The
hardware folks have solved the problem, but it needs to be handled on the
kernel side.  He returned to the discoverable hardware idea, noting that
simple, static tables that could be read by the kernel would help solve the
problem. Zijlstra suggested that perhaps the tools used by the hardware
designers could be changed to make it easier to provide the kernel what it
needed.  Hesselbarth seemed a bit skeptical that Synopsys and other tool
vendors would be all that interested in helping out.
</p>

<h4>Security</h4>

<p>
The conversation turned to security and whether the kernel developers were
doing enough to deliver a secure kernel.  Kroah-Hartman said that the
community can "always do better", but that the bugs reported to the
kernel security email address are fixed "as soon as we possibly can".  He
noted that various 
static code analysis tools are being run on the kernel and are finding lots
of bugs that get fixed right away. Some of the creators of those tools, Julia Lawall (Coccinelle) and Dan
Carpenter (Smatch) for example, have fixed more security bugs than anyone, he said.  It
is an area that is ripe for more research and the community is always open
to better ways.  
</p>

<p>
Some 4000 patches were made to the 3.0 kernel in the two years it has been
maintained as a stable kernel (it reached end of life with <a
href="/Articles/571242/">3.0.101</a>, which was released on the day of the
session). Corbet asked if that was reasonable.  Deacon said that you have
to trust that kernel developers are not adding bugs on purpose, so when
they are found, they  need to be fixed; "what's the alternative?", he asked.
Kroah-Hartman noted that many of those patches were for things like new
device IDs, but that the kernel developers are learning over time.
Mistakes were made—and fixed.
</p>

<p>
Corbet asked if we could expect fewer fixes for 3.10 (which will also be
supported for two years), but Kroah-Hartman said that there would likely be
more.  He now maintains the stable kernel as part of his job, so he has
more time to find patches that need to go into the tree.  Beyond that, the
code base has grown.  But the number of fixes going into the kernel starts
to tail off significantly after a year, he said.  For the stable updates
released on that day, 3.0 had eight patches, while 3.10 had nearly 100.
The world changes; processors speed up (which leads to new timing issues),
for example. "If we stop our rate of change, then we are dead", he said, we
have to keep up with the changes going on in the rest of the world.
</p>

<p>
Referring to Deacon's assertion that bugs are not being introduced on
purpose, Corbet asked the panel how it is we know that. The whole
maintenance system relies on trust, Deacon said, if that's missing, the
whole thing breaks down.  Kroah-Hartman said that if you look at the known
exploits, they are all attacking some "stupid" mistake that someone
(including him) has made,
not some kind of introduced backdoor.  People who research flaws per line
of code find Linux to have lower rates than anything else, he said, so we
are doing something right.  Corbet pointed out that the
kernel developers introduce enough bugs on their own, so there is no real
need for anyone else to do so—to some chuckles across the stage.
</p>

<h4>2038</h4>

<p>
While OpenBSD has fixed its "<a
href="http://en.wikipedia.org/wiki/Year_2038_problem">2038 problem</a>"
(when 32-bit timestamps will wrap), Linux still has not, Corbet said, and
wondered if Linux would be ready for that event. He also asked: Will
there be no 32-bit processors to be affected in 2038?  Deacon noted that
billions of 
32-bit ARM processors are shipping today, so it is hard to believe they
will all be gone in 25 years.  Kroah-Hartman said that Intel came out with
a 486-based processor recently as well.  He suggested that they could all come
out of retirement to fix the problems.

<p>
Corbet said that OpenBSD broke its ABI to
handle the change—something it can do because it ships its user space with the
kernel—but that is not something that Linux can do.  Something
clever will be required to fix the problem, which suggests we should be
thinking about it now.
Deacon indicated that he thought an ABI break will eventually have to
happen at some 
point.  The real problem will be for devices that are being deployed now
that will still be running in 2038.
</p>

<p>
That led to the last question, which is how to handle things like control
groups that were added to the kernel, but were "wrong" both internally and
externally. The internal problem can be fixed relatively easily, but how
can we continue on without carrying tons of baggage from early mistakes at
the ABI level, he asked.  Zijlstra said that even "simple things" need to
be written at least three times before you get them "sort of right".  Other
operating 
systems have a way to deprecate things, and some of those have been tried
in Linux without success, Kroah-Hartman said.
The Linux method is to write
something new and wait for the old one to die, then try to sneak the code
out of the kernel and wait to see if anyone screams, Zijlstra said.
</p>

<p>
On the other hand, Deacon said, if you wait for a perfect solution, you'll
never get anywhere.  Kroah-Hartman said that there is no model for Linux,
everything it is doing is new; it is at the forefront and we are learning how to deal with these kinds of
problems.  "We do it all in public", unlike companies that struggle with
the same things, he said.  There are lots of hard, and fun, problems to be
solved going forward, he said.  It is a high-quality problem to have,
Corbet said to general agreement.
</p>

<p>
With that, the time was up and Zemlin retook the stage.  Mostly, he wanted
to clear up some misinformation that he heard during the session:  Kroah-Hartman would not be
retired by 2038, Zemlin said—to laughter from the assembled attendees.
</p>

<p>
[Thanks to the Linux Foundation for travel assistance to Edinburgh for
LinuxCon Europe.]<br clear="all"><table class="IndexEntries">
           <tr><th colspan=2>Index entries for this article</th></tr>
           <tr><td><a href="/Kernel/Index">Kernel</a></td><td><a href="/Kernel/Index#Development_model">Development model</a></td></tr>
            <tr><td><a href="/Archives/ConferenceIndex/">Conference</a></td><td><a href="/Archives/ConferenceIndex/#LinuxCon_Europe-2013">LinuxCon Europe/2013</a></td></tr>
            </table><br clear="all">
<hr width="60%%" align="left">
            <form action="/Login/" method="post">
            <input type="hidden" name="target" value="/Articles/571379/" />
            <input type="submit" name="login" value="Log in" /> to post comments
            <p>
        
</div> <!-- ArticleText -->
<p><a name="Comments"></a>
<a name="CommAnchor571772"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A kernel panel convenes in Edinburgh</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 25, 2013 19:16 UTC (Fri)
                               by <b>Yorick</b> (guest, #19241)
                              [<a href="/Articles/571772/">Link</a>] (9 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
If we really were to break the 32-bit ABIs, perhaps it would be a good opportunity to fix other things at the same time. A 64-bit off_t is a clear candidate. Anything else?<br>
<p>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/571772/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor571777"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A kernel panel convenes in Edinburgh</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 25, 2013 20:21 UTC (Fri)
                               by <b>pr1268</b> (subscriber, #24648)
                              [<a href="/Articles/571777/">Link</a>] (7 responses)
      </p>
      
      </div>
      </summary>
      <blockquote><font class="QuotedText">A 64-bit off_t is a clear candidate.</font></blockquote>

<p>I believe they <a href="http://www.gnu.org/software/libc/manual/html_node/File-Position-Primitive.html#index-off64_005ft-1224">already have that</a>.  But, if I understand that page correctly,</p>

<ul>
<li>When compiled/built on a 64-bit arch, an <tt>off_t</tt> is 64 bits by default,</li>
<li>When compiled/built on a 32-bit arch, an <tt>off_t</tt> is 32 bits, and an <tt>off64_t</tt> is 64 bits (there's a <tt>lseek64()</tt> function available).</li>
<li>When compiled/built on a 32-bit arch, and <tt>-D_FILE_OFFSET_BITS=64</tt> is defined, then an <tt>off_t</tt> is 64 bits.</li>
</ul>

<p>From the looks of it, the GLibc folks engineered a solution that aimed to avoid API/ABI breakage while supporting large files and also both 32-bit and 64-bit architectures.  I'm unsure whether a similar solution could be engineered for <tt>time_t</tt> and the <tt>time(2)</tt> system call (and friends).</p>


      
          <div class="CommentReplyButton">
            <form action="/Articles/571777/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor571782"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A kernel panel convenes in Edinburgh</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 25, 2013 20:27 UTC (Fri)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/571782/">Link</a>] (6 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
I'm sure a solution could be engineered, but would it be used? 64-bit offsets allows one to work with files larger than 4GB (which is a limitation that is compelling enough to use the new symbols for). Who works with dates past 2038 these days (and would be willing to use time64_t and time64* functions)?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/571782/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor571803"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A kernel panel convenes in Edinburgh</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 25, 2013 22:53 UTC (Fri)
                               by <b>khim</b> (subscriber, #9252)
                              [<a href="/Articles/571803/">Link</a>] (5 responses)
      </p>
      
      </div>
      </summary>
      Everyone will use it if it'll be the only choice (or perhaps even if it'll be the default choice) by GLibC headers. GLibC never promised to mantain stable API and you can switch from 32bit time_t to 64bit time_t without breaking ABI.
      
          <div class="CommentReplyButton">
            <form action="/Articles/571803/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor571806"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A kernel panel convenes in Edinburgh</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 26, 2013 0:16 UTC (Sat)
                               by <b>mathstuf</b> (subscriber, #69389)
                              [<a href="/Articles/571806/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
No, that's incorrect. You can't redefine time_t to be different and expect it to work against old binaries. Sure, the ABI isn't broken, but you can have two libraries which are expecting different ABIs talking to each other which is just as bad.<br>
<p>
As an example:<br>
<p>
<font class="QuotedText">&gt; struct mystat {</font><br>
<font class="QuotedText">&gt;   time_t mtime;</font><br>
<font class="QuotedText">&gt;   time_t ctime;</font><br>
<font class="QuotedText">&gt;   time_t atime;</font><br>
<font class="QuotedText">&gt; };</font><br>
<font class="QuotedText">&gt; struct mystat *stat_file(char const* path);</font><br>
<p>
If libstat has this in its header, just where is "ctime" relative to that returned pointer from "stat_file"? 8? 4? You need to know which ABI *libstat* was compiled with and adhere to *it*, not what libc is calling time_t today.<br>
<p>
This is why GNOME[1] and KDE[2][3] have extra data members marked as "reserved" so that adding more members (GTK) and virtual methods (KDE) can preserve the ABI.<br>
<p>
[1]<a href="https://git.gnome.org/browse/webkitgtk-tarball-releases/tree/Source/WebKit2/UIProcess/API/gtk/WebKitWebView.h#n183">https://git.gnome.org/browse/webkitgtk-tarball-releases/t...</a><br>
[2]<a href="http://quickgit.kde.org/?p=kdelibs.git&amp;a=blob&amp;h=9d2375d9067d773a6b20723854c663b3efcc4391&amp;hb=2b9fe0333b09795ff82781b973f7ff8a8c65d3eb&amp;f=kdemacros.h.cmake#l289">http://quickgit.kde.org/?p=kdelibs.git&amp;a=blob&amp;h=9...</a><br>
[3]<a href="http://quickgit.kde.org/?p=palapeli.git&amp;a=blob&amp;h=edf9f7dd3e9cd891fee4f31f12dad33aa01dfabe&amp;hb=5704aefdc2a0bd5bd86446e3bc9d49c2e270c6dc&amp;f=libpala%2Fslicermode.h#l1">http://quickgit.kde.org/?p=palapeli.git&amp;a=blob&amp;h=...</a><br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/571806/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor571808"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A kernel panel convenes in Edinburgh</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 26, 2013 0:38 UTC (Sat)
                               by <b>khim</b> (subscriber, #9252)
                              [<a href="/Articles/571808/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <blockquote><font class="QuotedText">Sure, the ABI isn't broken, but you can have two libraries which are expecting different ABIs talking to each other which is just as bad.</font></blockquote>

<p>This is problem of these libraries. They need to decide if they want to support such usecase or not and if they want to do that then they need to decide how exactly they'll do that.</p>

<blockquote><font class="QuotedText">You need to know which ABI *libstat* was compiled with and adhere to *it*, not what libc is calling time_t today.</font></blockquote>

<p>Sure. Developers of libstat must provide updated version of headers and/or updated versions of libraries. This is natural consequence of API breakage.</p>

<blockquote><font class="QuotedText">This is why GNOME[1] and KDE[2][3] have extra data members marked as "reserved" so that adding more members (GTK) and virtual methods (KDE) can preserve the ABI.</font></blockquote>

<p>Yet they still break stuff regularly. That's because their attention in the wrong place: they try to keep both API and ABI stable and when it becomes too hard they break both. But in reality this is neither needed nor desired. ABI is more important and with careful design you can keep it unbroken for decades. Yes, it'll mean that old applications will be unbuildable with a new headers and will not be able to ever use some new features, but you <b>will be</b> able to use old applications. Instead if you want to run 10-years old application on modern Linux your best bet is WINE and Windows versions of said application. This is just pathetic.</p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/571808/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor571866"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A kernel panel convenes in Edinburgh</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 27, 2013 0:59 UTC (Sun)
                               by <b>mmorrow</b> (guest, #83845)
                              [<a href="/Articles/571866/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; and you can switch from 32bit time_t to 64bit time_t without breaking ABI.</font><br>
<p>
This is changing the ABI, since it will affect at least the layout of<br>
structs and calling conventions.<br>
<p>
At the very most you could say: "After a thorough audit of all uses of<br>
time_t in glibc, and for these N sets of (struct-layout,calling-conv)<br>
rule pairs, it just so happens that switching from a 32 to a 64bit time_t<br>
will not affect glibc's ABI."<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/571866/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor571867"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A kernel panel convenes in Edinburgh</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 27, 2013 1:21 UTC (Sun)
                               by <b>khim</b> (subscriber, #9252)
                              [<a href="/Articles/571867/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      <blockquote><font class="QuotedText">This is changing the ABI, since it will affect at least the layout of structs and calling conventions.</font></blockquote>

<p>Only for new programs. Old programs will see old layouts, new programs will see new layouts. . If you've not done that before then please go and read <a href="http://www.akkadia.org/drepper/dsohowto.pdf">How To Write Shared Libraries</a> right now. It explains how you can support almost any change in ABI without introducing new libraries. This approach was tested when GLibC 2.1 introduced 64-bit <code>off_t</code>. And yes, “latest and greatest” versions of GLibC are <b>still</b> compatible with GLibC 2.0 ABI with it's 32bit-only <code>off_t</code> (which was used both internally and externally, of course)</p>
      
          <div class="CommentReplyButton">
            <form action="/Articles/571867/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor571880"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A kernel panel convenes in Edinburgh</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 27, 2013 12:45 UTC (Sun)
                               by <b>paulj</b> (subscriber, #341)
                              [<a href="/Articles/571880/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
And for the kernel ABI, we at least have prctl() and personality() which allow userspace to co-ordinate with the kernel the switching to new, non-default interpretations of the kernel's userspace interface and ABI. <br>
<p>
There's no technical reason why we couldn't expand fields in data structures used in syscalls while keeping compatibility, AFAIK. :)<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/571880/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</details>
</details>
<a name="CommAnchor571779"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A kernel panel convenes in Edinburgh</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 25, 2013 23:42 UTC (Fri)
                               by <b>Jonno</b> (subscriber, #49613)
                              [<a href="/Articles/571779/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
<font class="QuotedText">&gt; If we really were to break the 32-bit ABIs, perhaps it would be a good opportunity to fix other things at the same time. A 64-bit off_t is a clear candidate. Anything else?</font><br>
<p>
Time measurements:  time_t, clock_t<br>
File(system) size:  off_t, blkcnt_t, fsblkcnt_t<br>
File count:  ino_t, fsfilcnt_t<br>
Resource limits:  rlim_t<br>
<p>
Note: rlim_t are used to put limit on resources measured using size_t, clock_t and off_t, so should be as large as the largest of these.<br>
<p>
<p>
On 32 bit architectures glibc already provides 64-bit versions of off_t, blkcnt_t, fsblkcnt_t, ino_t, fsfilcnt_t, rlim_t, and of all standard functions using them, but those are only exposed in the system headers if you build with -D_LARGEFILE64_SOURCE.  If you instead build with -D_FILE_OFFSET_BITS=64", the headers will do some preprocessor magic to transparently use the corresponding 64 bit versions instead of the original types or functions you might have in your code.<br>
<p>
Thus a library that has functions using one of these types in its ABI and cares about keeping ABI compatibility should use -D_LARGEFILE64_SOURCE and provide two versions of all such functions on architectures with 32 bit types, while applications and other libraries can simply use -D_FILE_OFFSET_BITS=64 and be done with it.<br>
<p>
Obviously you can't build an binary with -D_FILE_OFFSET_BITS=64 until its dependencies either have added 64 bit versions of all relevant functions, or been rebuilt with -D_FILE_OFFSET_BITS=64, and if you rebuild a library with -D_FILE_OFFSET_BITS=64 that will break its ABI and you will have to rebuild all reverse dependencies with -D_FILE_OFFSET_BITS=64 to get them working again...<br>
<p>
<p>
I would suggest adding something similar for time_t and clock_t as soon as possible (adding new system calls to linux; and new types, functions, and preprocessor magic to glibc).  Then about 10 years before the cut-off date (eg in 2028) make -D_FILE_OFFSET_BITS=64 and its time equivalent the defaults (over-ridable by explicitly specifying -D_FILE_OFFSET_BITS=32 of course).  That would be a fairly mild flag day, as all old binaries will still work with a new glibc, and the only new requirement is to rebuild all reverse dependencies after rebuilding an unfixed library (which hopefully should be rare by then).<br>
<p>
Then, in 2038 (when unfixed code not rebuilt with a recent glibc would be subtly broken anyway), support for -D_FILE_OFFSET_BITS=32 can be dropped, and the old glibc types/functions can be removed, at which point all architectures will be 64-bit safe and library writers will not have to worry about dual 32/64 bit support any longer.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/571779/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
<a name="CommAnchor571796"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A kernel panel convenes in Edinburgh</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 25, 2013 22:14 UTC (Fri)
                               by <b>dowdle</b> (subscriber, #659)
                              [<a href="/Articles/571796/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Video of the panel here:<br>
<a href="https://www.youtube.com/watch?v=VDsHxJjvKSk">https://www.youtube.com/watch?v=VDsHxJjvKSk</a><br>
<p>
There is a webm flavor.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/571796/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
<a name="CommAnchor572177"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A kernel panel convenes in Edinburgh</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 30, 2013 5:39 UTC (Wed)
                               by <b>glaesera</b> (guest, #91429)
                              [<a href="/Articles/572177/">Link</a>] (3 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Support for i386 processors was dropped already in current kernel versions, it is not completely impossible, that one day 32-bit support is going to be dropped, too.<br>
It is right, that the scalability of the kernel is one of the biggest pluses, it was improved enormously since the 2.4 days. Out of the box it is going to run almost everywhere. <br>
Especially on embedded and very large and massively multicore-servers, there should probably be a specific kernel built, because that reduces overhead and improves energy-efficiency. One does not have to be a kernel-developer in order to do it, in fact any system-administrator can configure and build his/her own kernel-version and leave unneeded drivers out and optimize things for the specific use case. If you need very low latency for example, you do not need to buy a server with 5 GHz+, just build your own kernel.<br>
The process is probably going to be more automated, so that average users can do it by means of some script by answering a some simple questions.<br>
Interesting article, lots of reading material, nice snapshot. <br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572177/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572180"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A kernel panel convenes in Edinburgh</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 30, 2013 6:57 UTC (Wed)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/572180/">Link</a>] (2 responses)
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Is there any progress on the idea of a "create a config for the hardware I'm running on"? It's been raised several times over the years, but it's been quiet for a while, did someone implement something I missed?<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572180/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572202"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A kernel panel convenes in Edinburgh</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 30, 2013 12:46 UTC (Wed)
                               by <b>corbet</b> (editor, #1)
                              [<a href="/Articles/572202/">Link</a>] (1 responses)
      </p>
      
      </div>
      </summary>
      There's "<tt>make localmodconfig</tt>".
      
          <div class="CommentReplyButton">
            <form action="/Articles/572202/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    <a name="CommAnchor572218"></a>
    <details class="CommentBox" open>
      <summary><h3 class="CommentTitle">A kernel panel convenes in Edinburgh</h3>
      <div class="AnnLine">
      <p class="CommentPoster"> Posted Oct 30, 2013 14:12 UTC (Wed)
                               by <b>dlang</b> (guest, #313)
                              [<a href="/Articles/572218/">Link</a>] 
      </p>
      
      </div>
      </summary>
      <div class="FormattedComment">
Thanks, I had missed that it had been implemented.<br>
</div>

      
          <div class="CommentReplyButton">
            <form action="/Articles/572218/comment" method="post">
            <input type="submit" value="Reply to this comment">
            </form>
          </div>
        
     <p>
     
    </details>
</details>
</details>
</details>
</div> <!-- middlecolumn -->
<div class="rightcol not-print">
<div id="azk93271_right_zone"></div>
</div>
</div> <!-- maincolumn -->

            <br clear="all">
            <center>
            <P>
            <span class="ReallySmall">
            Copyright &copy; 2013, Eklektix, Inc.<BR>
            This article may be redistributed under the terms of the
              <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons CC BY-SA 4.0</a> license<br>
            Comments and public postings are copyrighted by their creators.<br>
            Linux  is a registered trademark of Linus Torvalds<br>
            </span>
            </center>
            
            </body></html>
